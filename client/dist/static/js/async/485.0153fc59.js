"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["485"],{87017:function(e,a,r){r.d(a,{Co:()=>h,Cu:()=>c,Hb:()=>u});var l=r(79192),t=r(53195),s=r(70233),o=r(74502);r(41947);let n="/api",i="".concat(n,"/v2/advisory"),d="".concat(n,"/v2/sbom"),p=e=>{let a="application/json";return e.name.endsWith(".bz2")&&(a="application/json+bzip2"),a},c=(e,a)=>{let r=e.get(o.TB);return s.Z.post("".concat(i),r,(0,t._)((0,l._)({},a),{headers:{"Content-Type":p(r)}}))},u=(e,a)=>{let r=e.get(o.TB);return s.Z.post("".concat(d),r,(0,t._)((0,l._)({},a),{headers:{"Content-Type":p(r)}}))},h=e=>s.Z.get("".concat(d,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},46001:function(e,a,r){r.d(a,{B:()=>m});var l=r(24246),t=r(27378),s=r(51851),o=r(21714),n=r(40270),i=r(23056),d=r(91057),p=r(84335),c=r(13754),u=r(79551),h=r(32489),f=r(90519),y=r(81211),g=r(45882),v=r(22621),x=r(416);let m=e=>{let{uploads:a,handleUpload:r,handleRemoveUpload:m,extractSuccessMessage:j,extractErrorMessage:_}=e,[F,b]=t.useState(!1),[U,w]=t.useState("inProgress"),[q,C]=t.useState([]);!F&&a.size>0&&b(!0),t.useEffect(()=>{let e=Array.from(a.values());e.some(e=>"inProgress"===e.status)?w("inProgress"):e.every(e=>"complete"===e.status)?w("success"):w("danger")},[a]);let T=Array.from(a.values()).filter(e=>e.response).length;return(0,l.jsxs)(s.o,{onFileDrop:(e,a)=>{r(a)},dropzoneProps:{accept:{"application/xml":[".json",".bz2"]},onDropRejected:e=>{C(e)},useFsAccessApi:!1},children:[(0,l.jsx)(o.Y,{titleIcon:(0,l.jsx)(x.ZP,{}),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2"}),F&&(0,l.jsx)(n.M,{statusToggleText:"".concat(T," of ").concat(a.size," files uploaded"),statusToggleIcon:U,children:Array.from(a.entries()).map((e,a)=>{let[r,t]=e;return(0,l.jsx)(i.B,{customFileHandler:()=>{},fileIcon:(0,l.jsx)(v.ZP,{}),file:r,onClearClick:()=>(e=>{for(let a of e)m(a)})([r]),progressValue:t.progress,progressVariant:t.error?"danger":t.response?"success":void 0,progressHelperText:t.error?(0,l.jsx)(d.p,{isLiveRegion:!0,children:(0,l.jsx)(p.u,{variant:"error",children:_(t.error)})}):100!==t.progress||t.response?t.response?(0,l.jsx)(d.p,{isLiveRegion:!0,children:(0,l.jsx)(p.u,{variant:"default",children:j(t.response)})}):void 0:(0,l.jsx)(d.p,{isLiveRegion:!0,children:(0,l.jsxs)(p.u,{variant:"warning",children:[(0,l.jsx)(c.$,{isInline:!0}),"File uploaded. Waiting for the server to process it."]})})},"".concat(r.name,"-").concat(a))})}),(0,l.jsxs)(u.u,{isOpen:q.length>0,"aria-label":"unsupported file upload attempted",onClose:()=>C([]),variant:"small",children:[(0,l.jsx)(h.x,{title:"Unsupported files",titleIconVariant:"warning"}),(0,l.jsx)(f.f,{children:(0,l.jsx)(y.aV,{children:q.map(e=>(0,l.jsx)(g.H,{children:e.file.name},e.file.name))})})]})]})}},95169:function(e,a,r){r.d(a,{V:()=>c});var l=r(79192),t=r(53195),s=r(27378),o=r(74502),n=r(70233);let i="cancelled",d=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),p=(e,a)=>{switch(a.type){case"queueUpload":return(0,t._)((0,l._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,t._)((0,l._)({},e.uploads.get(a.payload.file)||d()),{status:"queued",cancelFn:a.payload.cancelFn}))});case"updateUploadProgress":return(0,t._)((0,l._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,t._)((0,l._)({},e.uploads.get(a.payload.file)||d()),{progress:a.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,t._)((0,l._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,t._)((0,l._)({},e.uploads.get(a.payload.file)||d()),{status:"complete",response:a.payload.response}))});case"finishUploadWithError":var r;return(0,t._)((0,l._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,t._)((0,l._)({},e.uploads.get(a.payload.file)||d()),{status:"complete",error:a.payload.error,wasCancelled:(null==(r=a.payload.error)?void 0:r.message)===i}))});case"removeUpload":{let r=new Map(e.uploads);return r.delete(a.payload.file),(0,t._)((0,l._)({},e),{uploads:r})}default:throw Error()}},c=e=>{let{parallel:a,uploadFn:r,onSuccess:l,onError:t}=e,[d,c]=s.useReducer(p,{uploads:new Map});return{uploads:d.uploads,handleUpload:e=>{let s=[];for(let a=0;a<e.length;a++){let r=e[a],d=new FormData;d.set(o.TB,r);let p=n.Z.CancelToken.source(),u={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var a;let l=null!=(a=e.total)?a:1;c({type:"updateUploadProgress",payload:{file:r,progress:Math.round(e.loaded/l*100)}})},cancelToken:p.token};c({type:"queueUpload",payload:{file:r,cancelFn:p}});let h={formData:d,config:u,thenFn:e=>{c({type:"finishUploadSuccessfully",payload:{file:r,response:e}}),l&&l(e,r)},catchFn:e=>{c({type:"finishUploadWithError",payload:{file:r,error:e}}),e.message!==i&&t&&t(e,r)}};s.push(h)}if(a)for(let e of s)r(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else s.reduce(async(e,a)=>(await e,r(a.formData,a.config).then(a.thenFn).catch(a.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var a,r;null==(r=d.uploads.get(e))||null==(a=r.cancelFn)||a.cancel(i)},handleRemoveUpload:e=>{c({type:"removeUpload",payload:{file:e}})}}}},99327:function(e,a,r){r.r(a),r.d(a,{default:()=>u});var l=r(24246),t=r(65783),s=r(45043),o=r(97339),n=r(18091),i=r(68802),d=r(46001),p=r(17598),c=r(9839);let u=()=>{let{uploads:e,handleUpload:a,handleRemoveUpload:r}=(0,p.tG)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.NP,{type:"breadcrumb",children:(0,l.jsxs)(o.a,{children:[(0,l.jsx)(n.g,{children:(0,l.jsx)(t.rU,{to:c.nB.advisories,children:"Advisories"})}),(0,l.jsx)(n.g,{isActive:!0,children:"Upload Advisory"})]})}),(0,l.jsx)(s.NP,{children:(0,l.jsxs)(i.V,{children:[(0,l.jsx)(i.V,{component:"h1",children:"Upload Advisory"}),(0,l.jsx)(i.V,{component:"p",children:"Upload a CSAF, CVE, or OSV Advisory."})]})}),(0,l.jsx)(s.NP,{children:(0,l.jsx)(d.B,{uploads:e,handleUpload:a,handleRemoveUpload:r,extractSuccessMessage:e=>"".concat(e.data.document_id," uploaded"),extractErrorMessage:e=>{var a;return(null==(a=e.response)?void 0:a.data)?e.message:"Error while uploading file"}})})]})}},17598:function(e,a,r){r.d(a,{N7:()=>v,VY:()=>g,gw:()=>x,sj:()=>j,tG:()=>m});var l=r(79192),t=r(53195),s=r(70186),o=r(1183),n=r(24038),i=r(68e3),d=r(75503),p=r(50576),c=r(40371),u=r(87017),h=r(49988),f=r(95169);let y="advisories",g=e=>{let{data:a,isLoading:r,error:l,refetch:t}=(0,o.a)({queryKey:[y,"labels",e],queryFn:()=>(0,c.sf)({client:p.L,query:{limit:10,filter_text:e}}),placeholderData:n.Wk});return{labels:(null==a?void 0:a.data)||[],isFetching:r,fetchError:l,refetch:t}},v=function(){var e,a,r;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,h.rm)(n),{q:f}=u,g=(0,s._)(u,["q"]),v=(0,h.Rb)(i),{data:x,isLoading:m,error:j,refetch:_}=(0,o.a)({queryKey:[y,n,v],queryFn:()=>(0,c.A1)({client:p.L,query:(0,t._)((0,l._)({},g),{q:[f,v].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==x||null==(e=x.data)?void 0:e.items)||[],total:null!=(r=null==x||null==(a=x.data)?void 0:a.total)?r:0,params:n},isFetching:m,fetchError:j||null,refetch:_}},x=e=>{let{data:a,isLoading:r,error:l}=(0,o.a)({queryKey:[y,e],queryFn:()=>(0,c.pB)({client:p.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==a?void 0:a.data,isFetching:r,fetchError:l}},m=()=>{let e=(0,i.NL)();return(0,f.V)({parallel:!0,uploadFn:(e,a)=>(0,u.Cu)(e,a),onSuccess:async()=>{await e.invalidateQueries({queryKey:[y]})}})},j=(e,a)=>{let r=(0,i.NL)();return(0,d.D)({mutationFn:e=>(0,c.m5)({client:p.L,path:{id:e.id},body:e.labels}),onSuccess:async(a,l)=>{e(),await r.invalidateQueries({queryKey:[y]})},onError:a})}}}]);