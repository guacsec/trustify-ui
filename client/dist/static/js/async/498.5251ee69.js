"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["498"],{25769:function(e,t,r){r.d(t,{D:()=>i});var a=r(24246);r(27378);var l=r(6364);let i=e=>{let{value:t}=e;return(0,a.jsx)(a.Fragment,{children:Object.entries(t).map((e,t)=>{let[r,i]=e;return(0,a.jsx)(l._,{isCompact:!0,children:`${r}=${i}`},t)})})}},3175:function(e,t,r){r.d(t,{o:()=>u});var a=r(24246);r(27378);var l=r(34747),i=r(46770),n=r(2499),s=r(35676),c=r(18142);let u=e=>{let{value:t,hideLabel:r}=e,u=c.V4[t],d=u.name;return(0,a.jsxs)(l.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,a.jsx)(i.B,{children:r?(0,a.jsx)(n.u,{content:d,children:(0,a.jsx)(s.ZP,{color:u.color.value})}):(0,a.jsx)(s.ZP,{color:u.color.value})}),!r&&(0,a.jsx)(i.B,{children:d})]})}},42835:function(e,t,r){r.d(t,{p:()=>i});var a=r(24246);r(27378);var l=r(40583);let i=e=>{let{paginationProps:t,isTop:r,isCompact:i=!1,noMargin:n=!1,idPrefix:s=""}=e;return(0,a.jsx)(l.t,{id:`${s?`${s}-`:""}pagination-${r?"top":"bottom"}`,variant:r?l.a.top:l.a.bottom,isCompact:i,...t,widgetId:"pagination-id"})}},37024:function(e,t,r){r.d(t,{hp:()=>y,qK:()=>f,Cx:()=>b});var a=r(24246);r(27378);var l=r(8305),i=r(13754),n=r(31423),s=r(11165),c=r(94154),u=r(48336),d=r(96582),o=r(610),h=r(68940),p=r(16668),m=r(22119);let x=e=>{let{title:t,description:r}=e;return(0,a.jsxs)(d.u,{variant:d.I.sm,children:[(0,a.jsx)(o.k,{icon:m.ZP}),(0,a.jsx)(h.D,{headingLevel:"h2",size:"lg",children:t}),r&&(0,a.jsx)(p.B,{children:r})]})},v=()=>(0,a.jsx)(x,{title:"No data available",description:"No data available to be shown here."}),y=e=>{let{numRenderedColumns:t,isLoading:r=!1,isError:d=!1,isNoData:o=!1,errorEmptyState:h=null,noDataEmptyState:p=null,children:m}=e;return(0,a.jsx)(a.Fragment,{children:r?(0,a.jsx)(n.p,{children:(0,a.jsx)(s.Tr,{children:(0,a.jsx)(c.Td,{colSpan:t,children:(0,a.jsx)(l.b,{children:(0,a.jsx)(i.$,{size:"xl"})})})})}):d?(0,a.jsx)(n.p,{"aria-label":"Table error",children:(0,a.jsx)(s.Tr,{children:(0,a.jsx)(c.Td,{colSpan:t,children:(0,a.jsx)(l.b,{children:h||(0,a.jsx)(u.y,{})})})})}):o?(0,a.jsx)(n.p,{"aria-label":"Table error",children:(0,a.jsx)(s.Tr,{children:(0,a.jsx)(c.Td,{colSpan:t,children:(0,a.jsx)(l.b,{children:p||(0,a.jsx)(v,{})})})})}):m})};var j=r(67918);let f=e=>{let{numColumnsBeforeData:t,numColumnsAfterData:r,children:l}=e;return(0,a.jsxs)(a.Fragment,{children:[Array(t).fill(null).map((e,t)=>(0,a.jsx)(j.Th,{screenReaderText:`before-data-${t}`},t)),l,Array(r).fill(null).map((e,t)=>(0,a.jsx)(j.Th,{screenReaderText:`after-data-${t}`},t))]})},b=e=>{let{isExpansionEnabled:t=!1,expandableVariant:r,isSelectionEnabled:l=!1,propHelpers:{getSingleExpandButtonTdProps:i,getSelectCheckboxTdProps:n},item:s,rowIndex:u,children:d}=e;return(0,a.jsxs)(a.Fragment,{children:[t&&"single"===r?(0,a.jsx)(c.Td,{...i({item:s,rowIndex:u})}):null,l?(0,a.jsx)(c.Td,{...n({item:s,rowIndex:u})}):null,d]})}},83330:function(e,t,r){r.d(t,{u:()=>d});var a=r(24246);r(27378);var l=r(34747),i=r(46770),n=r(28447),s=r(87445),c=r(18142),u=r(3175);let d=e=>{let{severities:t}=e,r=Object.values(t).reduce((e,t)=>e+t,0);return(0,a.jsxs)(l.k,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,a.jsx)(i.B,{style:{minWidth:15,textAlign:s.F2},children:r}),(0,a.jsx)(n.i,{orientation:{default:"vertical"}}),(0,a.jsx)(i.B,{children:(0,a.jsx)(l.k,{children:Object.entries(t).filter(e=>{let[t,r]=e;return r>0}).sort((0,c.A0)(e=>{let[t,r]=e;return t})).reverse().map((e,t)=>{let[r,n]=e;return(0,a.jsx)(i.B,{spacer:{default:"spacerXs"},children:(0,a.jsxs)(l.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,a.jsx)(i.B,{children:(0,a.jsx)(u.o,{value:r,hideLabel:!0})}),(0,a.jsx)(i.B,{children:n})]})},t)})})})]})}},18681:function(e,t,r){r.d(t,{H:()=>d});var a=r(27378),l=r(86602),i=r(71008);let n=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,s={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:{...s},fixed:{...s},not_affected:{...s},known_not_affected:{...s}}},u=e=>{let t=e.flatMap(e=>(e.status??[]).map(t=>{let r=(0,l.g)(t.average_severity);return{vulnerability:{...t.vulnerability,average_severity:r},vulnerabilityStatus:t.status,advisory:e}}).reduce((e,t)=>{let r=e.find(e=>n(e,t));return r?[...e.filter(e=>!n(e,r)),{...r,relatedSboms:[...r.relatedSboms,{advisory:t.advisory}]}]:[...e,{vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]}]},[])),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,a=t.vulnerability.average_severity,l=e.vulnerabilityStatus[r];return{...e,vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:l.total+1,severities:{...l.severities,[a]:l.severities[a]+1}}}}},c);return{vulnerabilities:t,summary:r}},d=e=>{let{pkg:t,isFetching:r,fetchError:l}=(0,i.ZA)(e);return{data:a.useMemo(()=>u(t?.advisories||[]),[t]),isFetching:r,fetchError:l}}},69694:function(e,t,r){r.d(t,{a:()=>o,u:()=>h});var a=r(24246),l=r(27378),i=r(55096),n=r(44072),s=r(94426),c=r(9771),u=r(71008),d=r(62126);let o=l.createContext({}),h=e=>{let{children:t}=e,r=(0,s.vZ)({tableName:"packages",persistenceKeyPrefix:n.yq.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:n.L4,title:"Filter text",placeholderText:"Search",type:i.vA.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:i.vA.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:i.vA.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:h,total:p},isFetching:m,fetchError:x}=(0,u.fF)((0,s.QO)({...r,hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}})),v=l.useMemo(()=>h.map(e=>({...e,decomposedPurl:(0,d.qX)(e.purl)})),[h]),y=(0,s.KC)({...r,idProperty:"uuid",currentPageItems:v,totalItemCount:p,isLoading:m,selectionState:(0,c.U)({items:v,isEqual:(e,t)=>e.uuid===t.uuid})});return(0,a.jsx)(o.Provider,{value:{totalItemCount:p,isFetching:m,fetchError:x,tableControls:y},children:t})}},94681:function(e,t,r){r.d(t,{L:()=>T});var a=r(24246),l=r(27378),i=r(65783),n=r(4835),s=r(14350),c=r(11165),u=r(67918),d=r(31423),o=r(94154),h=r(25769),p=r(42835),m=r(37024),x=r(11797),v=r(6364),y=r(35843),j=r(83330),f=r(18681);let b=e=>{let{packageId:t}=e,{data:r,isFetching:l,fetchError:i}=(0,f.H)(t);return(0,a.jsx)(y.u,{isFetching:l,fetchError:i,isFetchingState:(0,a.jsx)(x.O,{screenreaderText:"Loading contents"}),fetchErrorState:(0,a.jsx)(v._,{color:"red",children:"Error"}),children:(0,a.jsx)(j.u,{severities:r.summary.vulnerabilityStatus.affected.severities})})};var g=r(69694);let T=()=>{let{isFetching:e,fetchError:t,totalItemCount:r,tableControls:x}=l.useContext(g.a),{numRenderedColumns:v,currentPageItems:y,propHelpers:{paginationProps:j,tableProps:f,getThProps:T,getTrProps:S,getTdProps:P},expansionDerivedState:{isCellExpanded:K}}=x;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.i,{...f,"aria-label":"Package table",children:[(0,a.jsx)(s.h,{children:(0,a.jsx)(c.Tr,{children:(0,a.jsxs)(m.qK,{...x,children:[(0,a.jsx)(u.Th,{...T({columnKey:"name"})}),(0,a.jsx)(u.Th,{...T({columnKey:"namespace"})}),(0,a.jsx)(u.Th,{...T({columnKey:"version"})}),(0,a.jsx)(u.Th,{...T({columnKey:"type"})}),(0,a.jsx)(u.Th,{...T({columnKey:"path"})}),(0,a.jsx)(u.Th,{...T({columnKey:"qualifiers"})}),(0,a.jsx)(u.Th,{...T({columnKey:"vulnerabilities"})})]})})}),(0,a.jsx)(m.hp,{isLoading:e,isError:!!t,isNoData:0===r,numRenderedColumns:v,children:y.map((e,t)=>(0,a.jsx)(d.p,{children:(0,a.jsx)(c.Tr,{...S({item:e}),children:(0,a.jsxs)(m.Cx,{...x,item:e,rowIndex:t,children:[(0,a.jsx)(o.Td,{width:15,...P({columnKey:"name"}),children:(0,a.jsx)(i.OL,{to:`/packages/${e.uuid}`,children:e.decomposedPurl?e.decomposedPurl?.name:e.purl})}),(0,a.jsx)(o.Td,{width:15,modifier:"truncate",...P({columnKey:"namespace"}),children:e.decomposedPurl?.namespace}),(0,a.jsx)(o.Td,{width:10,modifier:"truncate",...P({columnKey:"version"}),children:e.decomposedPurl?.version}),(0,a.jsx)(o.Td,{width:10,modifier:"truncate",...P({columnKey:"type"}),children:e.decomposedPurl?.type}),(0,a.jsx)(o.Td,{width:10,modifier:"truncate",...P({columnKey:"path"}),children:e.decomposedPurl?.path}),(0,a.jsx)(o.Td,{width:20,...P({columnKey:"qualifiers"}),children:e.decomposedPurl?.qualifiers&&(0,a.jsx)(h.D,{value:e.decomposedPurl?.qualifiers})}),(0,a.jsx)(o.Td,{width:20,...P({columnKey:"vulnerabilities"}),children:(0,a.jsx)(b,{packageId:e.uuid})})]})})},e.uuid))})]}),(0,a.jsx)(p.p,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:j})]})}},71008:function(e,t,r){r.d(t,{D4:()=>d,ZA:()=>u,fF:()=>c});var a=r(1183),l=r(22285),i=r(54227),n=r(94426);let s="packages",c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:c,error:u,refetch:d}=(0,a.a)({queryKey:[s,e],queryFn:()=>(0,i.tj)({client:l.L,query:{...(0,n.rm)(e)}}),enabled:!t});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e},isFetching:c,fetchError:u,refetch:d}},u=e=>{let{data:t,isLoading:r,error:n}=(0,a.a)({queryKey:[s,e],queryFn:()=>(0,i.BK)({client:l.L,path:{key:e}})});return{pkg:t?.data,isFetching:r,fetchError:n}},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:c,error:u,refetch:d}=(0,a.a)({queryKey:[s,"by-sbom",e,t],queryFn:()=>(0,i.Pg)({client:l.L,path:{id:e},query:{...(0,n.rm)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t},isFetching:c,fetchError:u,refetch:d}}}}]);