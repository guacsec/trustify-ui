"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["484"],{87017:function(e,a,t){t.d(a,{Co:()=>h,Cu:()=>u,Hb:()=>p});var r=t(79192),l=t(53195),n=t(70233),s=t(74502);t(41947);let o="/api",i="".concat(o,"/v2/advisory"),d="".concat(o,"/v2/sbom"),c=e=>{let a="application/json";return e.name.endsWith(".bz2")&&(a="application/json+bzip2"),a},u=(e,a)=>{let t=e.get(s.TB);return n.Z.post("".concat(i),t,(0,l._)((0,r._)({},a),{headers:{"Content-Type":c(t)}}))},p=(e,a)=>{let t=e.get(s.TB);return n.Z.post("".concat(d),t,(0,l._)((0,r._)({},a),{headers:{"Content-Type":c(t)}}))},h=e=>n.Z.get("".concat(d,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},95169:function(e,a,t){t.d(a,{V:()=>u});var r=t(79192),l=t(53195),n=t(27378),s=t(74502),o=t(70233);let i="cancelled",d=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),c=(e,a)=>{switch(a.type){case"queueUpload":return(0,l._)((0,r._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,l._)((0,r._)({},e.uploads.get(a.payload.file)||d()),{status:"queued",cancelFn:a.payload.cancelFn}))});case"updateUploadProgress":return(0,l._)((0,r._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,l._)((0,r._)({},e.uploads.get(a.payload.file)||d()),{progress:a.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,l._)((0,r._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,l._)((0,r._)({},e.uploads.get(a.payload.file)||d()),{status:"complete",response:a.payload.response}))});case"finishUploadWithError":var t;return(0,l._)((0,r._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,l._)((0,r._)({},e.uploads.get(a.payload.file)||d()),{status:"complete",error:a.payload.error,wasCancelled:(null==(t=a.payload.error)?void 0:t.message)===i}))});case"removeUpload":{let t=new Map(e.uploads);return t.delete(a.payload.file),(0,l._)((0,r._)({},e),{uploads:t})}default:throw Error()}},u=e=>{let{parallel:a,uploadFn:t,onSuccess:r,onError:l}=e,[d,u]=n.useReducer(c,{uploads:new Map});return{uploads:d.uploads,handleUpload:e=>{let n=[];for(let a=0;a<e.length;a++){let t=e[a],d=new FormData;d.set(s.TB,t);let c=o.Z.CancelToken.source(),p={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var a;let r=null!=(a=e.total)?a:1;u({type:"updateUploadProgress",payload:{file:t,progress:Math.round(e.loaded/r*100)}})},cancelToken:c.token};u({type:"queueUpload",payload:{file:t,cancelFn:c}});let h={formData:d,config:p,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:t,response:e}}),r&&r(e,t)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:t,error:e}}),e.message!==i&&l&&l(e,t)}};n.push(h)}if(a)for(let e of n)t(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else n.reduce(async(e,a)=>(await e,t(a.formData,a.config).then(a.thenFn).catch(a.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var a,t;null==(t=d.uploads.get(e))||null==(a=t.cancelFn)||a.cancel(i)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},34473:function(e,a,t){t.r(a),t.d(a,{default:()=>T});var r=t(24246),l=t(27378),n=t(45043),s=t(68802),o=t(31757),i=t(51527),d=t(2075),c=t(27090),u=t(75165),p=t(31762),h=t(99),y=t(24787),v=t(90359),f=t(12621),g=t(17598),m=t(43959),x=t(51851),j=t(21714),F=t(40270),q=t(23056),_=t(91057),b=t(84335),w=t(13754),U=t(79551),E=t(32489),L=t(90519),K=t(81211),S=t(45882),P=t(22621),C=t(416);let R=e=>{let{uploads:a,handleUpload:t,handleRemoveUpload:n,extractSuccessMessage:s,extractErrorMessage:o}=e,[i,d]=l.useState(!1),[c,u]=l.useState("inProgress"),[p,h]=l.useState([]);!i&&a.size>0&&d(!0),l.useEffect(()=>{let e=Array.from(a.values());e.some(e=>"inProgress"===e.status)?u("inProgress"):e.every(e=>"complete"===e.status)?u("success"):u("danger")},[a]);let y=Array.from(a.values()).filter(e=>e.response).length;return(0,r.jsxs)(x.o,{onFileDrop:(e,a)=>{t(a)},dropzoneProps:{accept:{"application/xml":[".json",".bz2"]},onDropRejected:e=>{h(e)},useFsAccessApi:!1},children:[(0,r.jsx)(j.Y,{titleIcon:(0,r.jsx)(C.ZP,{}),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2"}),i&&(0,r.jsx)(F.M,{statusToggleText:"".concat(y," of ").concat(a.size," files uploaded"),statusToggleIcon:c,children:Array.from(a.entries()).map((e,a)=>{let[t,l]=e;return(0,r.jsx)(q.B,{customFileHandler:()=>{},fileIcon:(0,r.jsx)(P.ZP,{}),file:t,onClearClick:()=>(e=>{for(let a of e)n(a)})([t]),progressValue:l.progress,progressVariant:l.error?"danger":l.response?"success":void 0,progressHelperText:l.error?(0,r.jsx)(_.p,{isLiveRegion:!0,children:(0,r.jsx)(b.u,{variant:"error",children:o(l.error)})}):100!==l.progress||l.response?l.response?(0,r.jsx)(_.p,{isLiveRegion:!0,children:(0,r.jsx)(b.u,{variant:"default",children:s(l.response)})}):void 0:(0,r.jsx)(_.p,{isLiveRegion:!0,children:(0,r.jsxs)(b.u,{variant:"warning",children:[(0,r.jsx)(w.$,{isInline:!0}),"File uploaded. Waiting for the server to process it."]})})},"".concat(t.name,"-").concat(a))})}),(0,r.jsxs)(U.u,{isOpen:p.length>0,"aria-label":"unsupported file upload attempted",onClose:()=>h([]),variant:"small",children:[(0,r.jsx)(E.x,{title:"Unsupported files",titleIconVariant:"warning"}),(0,r.jsx)(L.f,{children:(0,r.jsx)(K.aV,{children:p.map(e=>(0,r.jsx)(S.H,{children:e.file.name},e.file.name))})})]})]})},T=()=>{let{uploads:e,handleUpload:a,handleRemoveUpload:t}=(0,m.km)(),{uploads:x,handleUpload:j,handleRemoveUpload:F}=(0,g.tG)(),q=l.createRef(),_=l.createRef();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.NP,{hasBodyWrapper:!1,children:(0,r.jsx)(s.V,{children:(0,r.jsx)(s.V,{component:"h1",children:"Upload"})})}),(0,r.jsx)(n.NP,{hasBodyWrapper:!1,children:(0,r.jsx)(o.Z,{children:(0,r.jsx)(i.e,{children:(0,r.jsxs)(d.m,{defaultActiveKey:0,children:[(0,r.jsx)(c.O,{eventKey:0,title:(0,r.jsx)(u.T,{children:"SBOM"}),actions:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.b,{ref:q,children:(0,r.jsx)(f.ZP,{})}),(0,r.jsx)(h.J,{bodyContent:(0,r.jsx)("div",{children:"Upload a Software Bill of Materials (SBOM) document. We accept CycloneDX versions 1.3, 1.4, 1.5 and 1.6, and System Package Data Exchange (SPDX) versions 2.2, and 2.3."}),triggerRef:q})]}),children:(0,r.jsx)(y.I,{id:"upload-sbom-tab-content",children:(0,r.jsx)(v.H,{hasPadding:!0,children:(0,r.jsx)(R,{uploads:e,handleUpload:a,handleRemoveUpload:t,extractSuccessMessage:e=>"".concat(e.data.document_id," uploaded"),extractErrorMessage:e=>{var a;return(null==(a=e.response)?void 0:a.data)?e.message:"Error while uploading file"}})})})}),(0,r.jsx)(c.O,{eventKey:1,title:(0,r.jsx)(u.T,{children:"Advisory"}),actions:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.b,{ref:_,children:(0,r.jsx)(f.ZP,{})}),(0,r.jsx)(h.J,{bodyContent:(0,r.jsx)("div",{children:"Upload a CSAF, CVE, or OSV Advisory."}),triggerRef:_})]}),children:(0,r.jsx)(y.I,{id:"upload-advisory-tab-content",children:(0,r.jsx)(v.H,{hasPadding:!0,children:(0,r.jsx)(R,{uploads:x,handleUpload:j,handleRemoveUpload:F,extractSuccessMessage:e=>"".concat(e.data.document_id," uploaded"),extractErrorMessage:e=>{var a;return(null==(a=e.response)?void 0:a.data)?e.message:"Error while uploading file"}})})})})]})})})})]})}},17598:function(e,a,t){t.d(a,{N7:()=>g,VY:()=>f,gw:()=>m,sj:()=>F,tG:()=>j,y2:()=>x});var r=t(79192),l=t(53195),n=t(70186),s=t(1183),o=t(24038),i=t(68e3),d=t(75503),c=t(50576),u=t(40371),p=t(87017),h=t(49988),y=t(95169);let v="advisories",f=e=>{let{data:a,isLoading:t,error:r,refetch:l}=(0,s.a)({queryKey:[v,"labels",e],queryFn:()=>(0,u.sf)({client:c.L,query:{limit:10,filter_text:e}}),placeholderData:o.Wk});return{labels:(null==a?void 0:a.data)||[],isFetching:t,fetchError:r,refetch:l}},g=function(){var e,a,t;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],p=(0,h.rm)(o),{q:y}=p,f=(0,n._)(p,["q"]),g=(0,h.Rb)(i),{data:m,isLoading:x,error:j,refetch:F}=(0,s.a)({queryKey:[v,o,g],queryFn:()=>(0,u.A1)({client:c.L,query:(0,l._)((0,r._)({},f),{q:[y,g].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==m||null==(e=m.data)?void 0:e.items)||[],total:null!=(t=null==m||null==(a=m.data)?void 0:a.total)?t:0,params:o},isFetching:x,fetchError:j||null,refetch:F}},m=e=>{let{data:a,isLoading:t,error:r}=(0,s.a)({queryKey:[v,e],queryFn:()=>(0,u.pB)({client:c.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==a?void 0:a.data,isFetching:t,fetchError:r}},x=(e,a)=>{let t=(0,i.NL)();return(0,d.D)({mutationFn:async e=>(await (0,u.Wr)({client:c.L,path:{key:e}})).data,onSuccess:async(a,r)=>{e(a,r),await t.invalidateQueries({queryKey:[v]})},onError:async e=>{a(e),await t.invalidateQueries({queryKey:[v]})}})},j=()=>{let e=(0,i.NL)();return(0,y.V)({parallel:!0,uploadFn:(e,a)=>(0,p.Cu)(e,a),onSuccess:async()=>{await e.invalidateQueries({queryKey:[v]})}})},F=(e,a)=>{let t=(0,i.NL)();return(0,d.D)({mutationFn:e=>(0,u.m5)({client:c.L,path:{id:e.id},body:e.labels}),onSuccess:async(a,r)=>{e(),await t.invalidateQueries({queryKey:[v]})},onError:a})}},43959:function(e,a,t){t.d(a,{Fz:()=>m,KQ:()=>b,Oh:()=>_,i5:()=>g,km:()=>F,p4:()=>x,qi:()=>U,s5:()=>j,t9:()=>q,uz:()=>w});var r=t(79192),l=t(53195),n=t(70186),s=t(1183),o=t(24038),i=t(68e3),d=t(75503),c=t(16072),u=t(50576),p=t(40371),h=t(95169),y=t(87017),v=t(49988);let f="sboms",g=e=>{let{data:a,isLoading:t,error:r,refetch:l}=(0,s.a)({queryKey:[f,"labels",e],queryFn:()=>(0,p.mh)({client:u.L,query:{limit:10,filter_text:e}}),placeholderData:o.Wk});return{labels:(null==a?void 0:a.data)||[],isFetching:t,fetchError:r,refetch:l}},m=function(){var e,a,t;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=(0,v.rm)(o),{q:h}=c,y=(0,n._)(c,["q"]),g=(0,v.Rb)(i),{data:m,isLoading:x,error:j,refetch:F}=(0,s.a)({queryKey:[f,o,g],queryFn:()=>(0,p.Wp)({client:u.L,query:(0,l._)((0,r._)({},y),{q:[h,g].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==m||null==(e=m.data)?void 0:e.items)||[],total:null!=(t=null==m||null==(a=m.data)?void 0:a.total)?t:0,params:o},isFetching:x,fetchError:j,refetch:F}},x=e=>{let{data:a,isLoading:t,error:r}=(0,s.a)({queryKey:[f,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,p._Q)({client:u.L,path:{id:e}}),enabled:void 0!==e});return{sbom:null==a?void 0:a.data,isFetching:t,fetchError:r}},j=(e,a)=>{let t=(0,i.NL)();return(0,d.D)({mutationFn:async e=>(await (0,p.WX)({client:u.L,path:{id:e}})).data,onSuccess:async(a,r)=>{e(a,r),await t.invalidateQueries({queryKey:[f]})},onError:async e=>{a(e),await t.invalidateQueries({queryKey:[f]})}})},F=()=>{let e=(0,i.NL)();return(0,h.V)({parallel:!0,uploadFn:(e,a)=>(0,y.Hb)(e,a),onSuccess:async()=>{await e.invalidateQueries({queryKey:[f]})}})},q=(e,a)=>{let t=(0,i.NL)();return(0,d.D)({mutationFn:e=>(0,p.zx)({client:u.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await t.invalidateQueries({queryKey:[f]})},onError:a})},_=function(e){var a,t,l;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:o,isLoading:i,error:d,refetch:c}=(0,s.a)({queryKey:[f,"by-package",e,n],queryFn:()=>(0,p.DU)({client:u.L,query:(0,r._)({purl:e},(0,v.rm)(n))})});return{result:{data:(null==o||null==(a=o.data)?void 0:a.items)||[],total:null!=(l=null==o||null==(t=o.data)?void 0:t.total)?l:0,params:n},isFetching:i,fetchError:d,refetch:c}},b=e=>{let{data:a,isLoading:t,error:r}=(0,s.a)({queryKey:[f,e,"advisory"],queryFn:()=>(0,p.NU)({client:u.L,path:{id:e}})});return{advisories:(null==a?void 0:a.data)||[],isFetching:t,fetchError:r}},w=e=>{let a=(0,c.h)({queries:e.map(e=>({queryKey:[f,e,"advisory"],queryFn:()=>(0,p.NU)({client:u.L,path:{id:e}})}))});return{advisories:a.map(e=>{let{data:a}=e;return(null==a?void 0:a.data)||[]}),isFetching:a.some(e=>{let{isLoading:a}=e;return a}),fetchError:a.map(e=>{let{error:a}=e;return a})}},U=e=>{let{data:a,isLoading:t,error:r}=(0,s.a)({queryKey:[f,e,"license-ids"],queryFn:()=>(0,p.J4)({client:u.L,path:{id:e}})});return{licenseIds:(null==a?void 0:a.data)||[],isFetching:t,fetchError:r}}}}]);