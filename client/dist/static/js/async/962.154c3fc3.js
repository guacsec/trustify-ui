"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["962"],{85790:function(e,l,i){i.d(l,{a:()=>r});var t=i(62540),a=i(69548);let r=e=>{let{value:l}=e;return(0,t.jsx)(t.Fragment,{children:Object.entries(l).map(e=>{let[l,i]=e;return(0,t.jsx)(a.J,{isCompact:!0,children:"".concat(l,"=").concat(i)},"".concat(l,"=").concat(i))})})}},77029:function(e,l,i){i.d(l,{l:()=>r});var t=i(62540),a=i(33468);let r=e=>{let{packageId:l,children:i}=e,{pkg:r,isFetching:n,fetchError:s}=(0,a.Si)(l);return(0,t.jsx)(t.Fragment,{children:i(r,n,s)})}},35913:function(e,l,i){i.d(l,{$:()=>v,G:()=>p});var t=i(32909),a=i(42642),r=i(63696),n=i(27875),s=i(33468);let c=(e,l)=>e.vulnerability.identifier===l.vulnerability.identifier&&e.vulnerabilityStatus===l.vulnerabilityStatus,u={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:(0,t._)({},u),fixed:(0,t._)({},u),not_affected:(0,t._)({},u),known_not_affected:(0,t._)({},u),under_investigation:(0,t._)({},u)}},d=e=>{let l=e.flatMap(e=>{var l;return(null!=(l=e.status)?l:[]).map(l=>{let i=(0,n.U)(l.average_severity);return{vulnerability:(0,a._)((0,t._)({},l.vulnerability),{average_severity:i,average_score:l.average_score}),vulnerabilityStatus:l.status,advisory:e}})}).reduce((e,l)=>{let i,r=e.find(e=>c(e,l));if(r)i=[...e.filter(e=>!c(e,r)),(0,a._)((0,t._)({},r),{relatedSboms:[...r.relatedSboms,{advisory:l.advisory}]})];else{let t={vulnerability:l.vulnerability,vulnerabilityStatus:l.vulnerabilityStatus,relatedSboms:[{advisory:l.advisory}]};i=[...e.slice(),t]}return i},[]),i=l.reduce((e,l)=>{let i=l.vulnerabilityStatus,r=l.vulnerability.average_severity,n=e.vulnerabilityStatus[i];return Object.assign(e,{vulnerabilityStatus:(0,a._)((0,t._)({},e.vulnerabilityStatus),{[i]:{total:n.total+1,severities:(0,a._)((0,t._)({},n.severities),{[r]:n.severities[r]+1})}})})},(0,t._)({},o));return{vulnerabilities:l,summary:i}},p=e=>{let{pkg:l,isFetching:i,fetchError:t}=(0,s.Si)(e);return{data:r.useMemo(()=>d((null==l?void 0:l.advisories)||[]),[l]),isFetching:i,fetchError:t}},v=e=>({data:r.useMemo(()=>d((null==e?void 0:e.advisories)||[]),[e])})},55178:function(e,l,i){i.d(l,{H:()=>u});var t=i(62540),a=i(15461),r=i(35913),n=i(24296),s=i(6160),c=i(92107);let u=e=>{let{pkg:l,isFetching:i,fetchError:u}=e,{data:o}=(0,r.$)(l);return(0,t.jsx)(n.a,{isFetching:i,fetchError:u,isFetchingState:(0,t.jsx)(s.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,t.jsx)(c.D,{error:e}),children:(0,t.jsx)(a.n,{severities:o.summary.vulnerabilityStatus.affected.severities})})}},13701:function(e,l,i){i.d(l,{Y:()=>v,a:()=>h});var t=i(32909),a=i(42642),r=i(62540),n=i(63696),s=i(27800),c=i(98259);i(21999);var u=i(73470),o=i(97773),d=i(33468),p=i(23909);let v=n.createContext({}),h=e=>{let{children:l}=e,[i,h]=n.useState(""),[m]=(0,s.Q3)(i,400),{result:{data:_}}=(0,o.K)({filters:[{field:c._G,operator:"~",value:m}],sort:{field:"license",direction:"asc"},page:{pageNumber:1,itemsPerPage:10}}),x=(0,u.MM)({tableName:"packages",persistenceKeyPrefix:c.rt.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",licenses:"Licenses",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:c._G,title:"Filter text",placeholderText:"Search",type:"search"},{categoryKey:"type",title:"Type",placeholderText:"Type",type:"multiselect",selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:"multiselect",selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]},{categoryKey:"license",title:"License",type:"asyncMultiselect",placeholderText:"Filter results by license",selectOptions:_.map(e=>({value:e.license,label:e.license})),onInputValueChange:h}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:y,total:b},isFetching:j,fetchError:g}=(0,d.Lx)((0,u.Ng)((0,a._)((0,t._)({},x),{hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}}))),f=n.useMemo(()=>y.map(e=>(0,a._)((0,t._)({},e),{decomposedPurl:(0,p.fe)(e.purl)})),[y]),T=(0,u.PB)((0,a._)((0,t._)({},x),{idProperty:"uuid",currentPageItems:f,totalItemCount:b,isLoading:j}));return(0,r.jsx)(v.Provider,{value:{totalItemCount:b,isFetching:j,fetchError:g,tableControls:T},children:l})}},66005:function(e,l,i){i.d(l,{N:()=>w});var t=i(32909),a=i(42642),r=i(62540),n=i(63696),s=i(74343),c=i(26917),u=i(16646),o=i(21758),d=i(40384),p=i(28516),v=i(78517),h=i(38139),m=i(52526),_=i(85790),x=i(93826),y=i(30448),b=i(67458),j=i(13701),g=i(55178),f=i(94279),T=i(16172),P=i(77029),S=i(6160),K=i(24296),k=i(92107);let E=e=>{var l,i,t,a;let{pkg:n,isFetching:c,fetchError:u}=e;return(0,r.jsx)(K.a,{isFetching:c,fetchError:u,isFetchingState:(0,r.jsx)(S.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,r.jsx)(k.D,{error:e}),children:(0,r.jsxs)(s.k2,{to:(0,s.tW)(b.Jh.packageDetails,{packageId:(null==n?void 0:n.uuid)||""}),children:[null!=(t=null==n||null==(l=n.licenses)?void 0:l.length)?t:0," ",(null!=(a=null==n||null==(i=n.licenses)?void 0:i.length)?a:0)>1?"Licenses":"License"]})})},w=()=>{let{isFetching:e,fetchError:l,totalItemCount:i,tableControls:S}=n.useContext(j.Y),{numRenderedColumns:K,currentPageItems:k,propHelpers:{paginationProps:w,tableProps:C,getThProps:F,getTrProps:M,getTdProps:N,getExpandedContentTdProps:L},expansionDerivedState:{isCellExpanded:I}}=S;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c.X,(0,a._)((0,t._)({},C),{"aria-label":"Package table",children:[(0,r.jsx)(u.d,{children:(0,r.jsx)(o.Tr,{children:(0,r.jsxs)(y.Ze,(0,a._)((0,t._)({},S),{children:[(0,r.jsx)(d.Th,(0,t._)({},F({columnKey:"name"}))),(0,r.jsx)(d.Th,(0,t._)({},F({columnKey:"namespace"}))),(0,r.jsx)(d.Th,(0,t._)({},F({columnKey:"version"}))),(0,r.jsx)(d.Th,(0,t._)({},F({columnKey:"type"}))),(0,r.jsx)(d.Th,(0,t._)({},F({columnKey:"licenses"}))),(0,r.jsx)(d.Th,(0,t._)({},F({columnKey:"path"}))),(0,r.jsx)(d.Th,(0,t._)({},F({columnKey:"qualifiers"}))),(0,r.jsx)(d.Th,(0,t._)({},F({columnKey:"vulnerabilities"})))]}))})}),(0,r.jsx)(y.nJ,{isLoading:e,isError:!!l,isNoData:0===i,numRenderedColumns:K,children:k.map((e,l)=>(0,r.jsx)(P.l,{packageId:e.uuid,children:(i,n,c)=>{var u,d,x,j,P,K,k,w;return(0,r.jsxs)(p.N,{children:[(0,r.jsx)(o.Tr,(0,a._)((0,t._)({},M({item:e})),{children:(0,r.jsxs)(y.Oi,(0,a._)((0,t._)({},S),{item:e,rowIndex:l,children:[(0,r.jsx)(v.Td,(0,a._)((0,t._)({width:15,modifier:"breakWord"},N({columnKey:"name"})),{children:(0,r.jsx)(s.k2,{to:(0,s.tW)(b.Jh.packageDetails,{packageId:e.uuid}),children:e.decomposedPurl?null==(u=e.decomposedPurl)?void 0:u.name:e.purl})})),(0,r.jsx)(v.Td,(0,a._)((0,t._)({width:15,modifier:"truncate"},N({columnKey:"namespace"})),{children:null==(d=e.decomposedPurl)?void 0:d.namespace})),(0,r.jsx)(v.Td,(0,a._)((0,t._)({width:10,modifier:"truncate"},N({columnKey:"version"})),{children:null==(x=e.decomposedPurl)?void 0:x.version})),(0,r.jsx)(v.Td,(0,a._)((0,t._)({width:10,modifier:"truncate"},N({columnKey:"type"})),{children:null==(j=e.decomposedPurl)?void 0:j.type})),(0,r.jsx)(v.Td,(0,a._)((0,t._)({width:10,modifier:"truncate"},N({columnKey:"licenses",isCompoundExpandToggle:!0,item:e,rowIndex:l})),{children:(0,r.jsx)(E,{pkg:i,isFetching:n,fetchError:c})})),(0,r.jsx)(v.Td,(0,a._)((0,t._)({width:10,modifier:"truncate"},N({columnKey:"path"})),{children:null==(P=e.decomposedPurl)?void 0:P.path})),(0,r.jsx)(v.Td,(0,a._)((0,t._)({width:20},N({columnKey:"qualifiers"})),{children:(null==(K=e.decomposedPurl)?void 0:K.qualifiers)&&(0,r.jsx)(_.a,{value:null==(k=e.decomposedPurl)?void 0:k.qualifiers})})),(0,r.jsx)(v.Td,(0,a._)((0,t._)({width:10},N({columnKey:"vulnerabilities"})),{children:(0,r.jsx)(g.H,{pkg:i,isFetching:n,fetchError:c})}))]}))})),I(e)?(0,r.jsx)(o.Tr,{isExpanded:!0,children:(0,r.jsx)(v.Td,(0,a._)((0,t._)({},L({item:e})),{className:m.A.pLg,children:(0,r.jsx)(h.g,{children:(0,r.jsx)("div",{className:m.A.ptLg,children:I(e,"licenses")?(0,r.jsx)(f.B8,{isPlain:!0,children:null==i||null==(w=i.licenses)?void 0:w.map((e,l)=>(0,r.jsx)(T.c,{children:e.license_name},"".concat(e.license_name,"-").concat(l)))}):null})})}))}):null]})}},e.uuid))})]})),(0,r.jsx)(x.n,{idPrefix:"package-table",isTop:!1,paginationProps:w})]})}},22549:function(e,l,i){i.d(l,{I:()=>v});var t=i(32909),a=i(42642),r=i(62540),n=i(63696),s=i(61360),c=i(35048),u=i(32490),o=i(21999),d=i(93826),p=i(13701);let v=e=>{let{showFilters:l}=e,{tableControls:i}=n.useContext(p.Y),{propHelpers:{toolbarProps:v,filterToolbarProps:h,paginationToolbarItemProps:m,paginationProps:_}}=i;return(0,r.jsx)(s.M,(0,a._)((0,t._)({},v),{"aria-label":"package-toolbar",children:(0,r.jsxs)(c.P,{children:[l&&(0,r.jsx)(o.Us,(0,t._)({},h)),(0,r.jsx)(u.T,(0,a._)((0,t._)({},m),{children:(0,r.jsx)(d.n,{idPrefix:"package-table",isTop:!0,paginationProps:_})}))]})}))}}}]);