"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["545"],{24296:function(e,t,l){l.d(t,{a:()=>s});var i=l(62540),a=l(59394),r=l(81595),n=l(40554);let s=e=>e.isFetching?e.isFetchingState||(0,i.jsx)(a.a,{children:(0,i.jsx)(r.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,i.jsx)(n.q,{}):e.children},92107:function(e,t,l){l.d(t,{D:()=>r});var i=l(62540),a=l(69548);let r=e=>{let{error:t}=e;return(0,i.jsxs)(a.J,{color:"red",children:[t.status," Error"]})}},15461:function(e,t,l){l.d(t,{n:()=>u});var i=l(62540),a=l(28338),r=l(70045),n=l(7261),s=l(86099),o=l(71284),c=l(45969);let u=e=>{let{severities:t}=e,l=Object.values(t).reduce((e,t)=>e+t,0);return(0,i.jsxs)(a.s,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,i.jsx)(r.Z,{"aria-label":"total",style:{minWidth:15,textAlign:s.pG},children:l}),(0,i.jsx)(n.c,{orientation:{default:"vertical"}}),(0,i.jsx)(r.Z,{children:(0,i.jsx)(a.s,{children:Object.entries(t).filter(e=>{let[t,l]=e;return l>0}).sort((0,o.Sx)(e=>{let[t,l]=e;return t})).reverse().map(e=>{let[t,l]=e;return(0,i.jsx)(r.Z,{spacer:{default:"spacerXs"},children:(0,i.jsxs)(a.s,{"aria-label":t,spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,i.jsx)(r.Z,{children:(0,i.jsx)(c.h,{value:t,score:null})}),(0,i.jsx)(r.Z,{children:l})]})},t)})})})]})}},3652:function(e,t,l){l.d(t,{RQ:()=>u,UI:()=>p,nm:()=>h});var i=l(32909),a=l(42642),r=l(63696),n=l(27875),s=l(30111);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},u={vulnerabilityStatus:{affected:(0,i._)({},c),fixed:(0,i._)({},c),not_affected:(0,i._)({},c),known_not_affected:(0,i._)({},c),under_investigation:(0,i._)({},c)}},d=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let l,r=e.find(e=>o(e,t));if(r){let n=e.filter(e=>!o(e,r)),s=r.vulnerability.average_score>t.vulnerability.average_score?r:t;l=[...n,(0,a._)((0,i._)({},s),{relatedPackages:[...r.relatedPackages,{advisory:t.advisory,packages:t.packages}]})]}else{let i={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};l=[...e.slice(),i]}return l},[]),l=t.reduce((e,t)=>{let l=t.vulnerabilityStatus,r=(0,n.U)(t.vulnerability.average_severity),s=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,a._)((0,i._)({},e.vulnerabilityStatus),{[l]:{total:s.total+1,severities:(0,a._)((0,i._)({},s.severities),{[r]:s.severities[r]+1})}})})},(0,i._)({},u));return{vulnerabilities:t,summary:l}},p=e=>{let{advisories:t,isFetching:l,fetchError:i}=(0,s.DH)(e);return{data:r.useMemo(()=>d(t||[]),[t]),isFetching:l,fetchError:i}},h=e=>{let{advisories:t,isFetching:l,fetchError:i}=(0,s.zY)(e);return{data:r.useMemo(()=>(null!=t?t:[]).map(e=>d(e||[])),[t]),isFetching:l,fetchError:i}}},98345:function(e,t,l){l.d(t,{f:()=>o});var i=l(62540),a=l(63696),r=l(91242),n=l(4392),s=l(30111);let o=e=>{let{sbom:t,onClose:l}=e,{pushNotification:o}=a.useContext(n.K),[c,u]=a.useState(""),[d,p]=a.useState("");a.useEffect(()=>{let e=setTimeout(()=>{p(c)},400);return()=>clearTimeout(e)},[c]);let{labels:h}=(0,s._P)(d),{mutate:m,isPending:b}=(0,s.cF)(()=>{o({title:"Labels updated for SBOM ".concat(t.name),variant:"success"}),l()},e=>{o({title:"Error while updating labels for SBOM ".concat(t.name),variant:"danger"})});return(0,i.jsx)(r.e,{title:"Labels of SBOM: ".concat(t.name),value:t.labels,isDisabled:b,onSave:e=>{m({id:t.id,labels:e})},onClose:l,onInputChange:u,options:h})}},46173:function(e,t,l){l.d(t,{L:()=>h,c:()=>m});var i=l(32909),a=l(42642),r=l(62540),n=l(63696),s=l(27800),o=l(98259),c=l(71284);l(21999);var u=l(73470),d=l(97773),p=l(30111);let h=n.createContext({}),m=e=>{var t;let{children:l}=e,[m,b]=n.useState(""),[x]=(0,s.Q3)(m,400),{labels:v}=(0,p._P)(x),[f,y]=n.useState(""),[_]=(0,s.Q3)(f,400),{result:{data:j}}=(0,d.K)({filters:[{field:o._G,operator:"~",value:_}],sort:{field:"license",direction:"asc"},page:{pageNumber:1,itemsPerPage:10}}),g=(0,u.MM)({tableName:"sbom",persistenceKeyPrefix:o.rt.sboms,persistTo:"urlParams",columnNames:{name:"Name",version:"Version",supplier:"Supplier",labels:"Labels",published:"Created on",packages:"Dependencies",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","published"],isFilterEnabled:!0,filterCategories:[{categoryKey:o._G,title:"Filter text",placeholderText:"Search",type:"search"},{categoryKey:"published",title:"Created on",type:"dateRange"},{categoryKey:"labels",title:"Label",type:"autocompleteLabel",placeholderText:"Filter results by label",selectOptions:v.map(e=>{let t=(0,c.m4)({key:e.key,value:e.value});return{value:t,label:t}}),onInputValueChange:b},{categoryKey:"license",title:"License",type:"asyncMultiselect",placeholderText:"Filter results by license",selectOptions:j.map(e=>({value:e.license,label:e.license})),onInputValueChange:y}],isExpansionEnabled:!1}),{result:{data:S,total:C},isFetching:k,fetchError:T}=(0,p.i$)((0,u.Ng)((0,a._)((0,i._)({},g),{hubSortFieldKeys:{name:"name",published:"published"}})),(null!=(t=g.filterState.filterValues.labels)?t:[]).map(e=>(0,c.Cb)(e))),K=(0,u.PB)((0,a._)((0,i._)({},g),{idProperty:"id",currentPageItems:S,totalItemCount:C,isLoading:k}));return(0,r.jsx)(h.Provider,{value:{totalItemCount:C,isFetching:k,fetchError:T,tableControls:K},children:l})}},74466:function(e,t,l){l.d(t,{Y:()=>Z});var i=l(32909),a=l(42642),r=l(62540),n=l(63696),s=l(74343),o=l(38927),c=l(80057),u=l(13021),d=l(24773),p=l(26917),h=l(16646),m=l(21758),b=l(40384),x=l(28516),v=l(78517),f=l(62101),y=l(71284),_=l(89705),j=l(12852),g=l(4392),S=l(93826),C=l(30448),k=l(98259),T=l(99528),K=l(30111),E=l(67458),w=l(23909),P=l(98345),I=l(6160),F=l(24296),L=l(92107),O=l(15461),D=l(3652);let M=e=>{let{sbomId:t}=e,{data:l,isFetching:i,fetchError:a}=(0,D.UI)(t);return(0,r.jsx)(F.a,{isFetching:i,fetchError:a,isFetchingState:(0,r.jsx)(I.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,r.jsx)(L.D,{error:e}),children:(0,r.jsx)(O.n,{severities:l.summary.vulnerabilityStatus.affected.severities})})};var B=l(46173);let Z=()=>{let{pushNotification:e}=n.useContext(g.K),{isFetching:t,fetchError:l,totalItemCount:I,tableControls:F}=n.useContext(B.L),[L,O]=n.useState(null),D=null!==L,{numRenderedColumns:Z,currentPageItems:N,propHelpers:{paginationProps:U,tableProps:V,getThProps:q,getTrProps:G,getTdProps:J},expansionDerivedState:{isCellExpanded:W},filterState:{filterValues:R,setFilterValues:A}}=F,{downloadSBOM:H,downloadSBOMLicenses:Q}=(0,T.m)(),X=()=>{O(null)},[Y,$]=n.useState(null),{mutate:z,isPending:ee}=(0,K.l6)(t=>{$(null),e({title:(0,k.B7)(t),variant:"success"})},t=>{e({title:(0,k.Ut)(t),variant:"danger"})});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(p.X,(0,a._)((0,i._)({},V),{"aria-label":"sbom-table",children:[(0,r.jsx)(h.d,{children:(0,r.jsx)(m.Tr,{children:(0,r.jsxs)(C.Ze,(0,a._)((0,i._)({},F),{children:[(0,r.jsx)(b.Th,(0,i._)({},q({columnKey:"name"}))),(0,r.jsx)(b.Th,(0,i._)({},q({columnKey:"version"}))),(0,r.jsx)(b.Th,(0,i._)({},q({columnKey:"supplier"}))),(0,r.jsx)(b.Th,(0,i._)({},q({columnKey:"labels"}))),(0,r.jsx)(b.Th,(0,i._)({},q({columnKey:"published"}))),(0,r.jsx)(b.Th,(0,i._)({},q({columnKey:"packages"}))),(0,r.jsx)(b.Th,(0,i._)({},q({columnKey:"vulnerabilities"})))]}))})}),(0,r.jsx)(C.nJ,{isLoading:t,isError:!!l,isNoData:0===I,numRenderedColumns:Z,children:N.map((e,t)=>(0,r.jsx)(x.N,{isExpanded:W(e),children:(0,r.jsx)(m.Tr,(0,a._)((0,i._)({},G({item:e})),{children:(0,r.jsxs)(C.Oi,(0,a._)((0,i._)({},F),{item:e,rowIndex:t,children:[(0,r.jsx)(v.Td,(0,a._)((0,i._)({width:20,modifier:"breakWord"},J({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t})),{children:(0,r.jsx)(s.k2,{to:(0,s.tW)(E.Jh.sbomDetails,{sbomId:e.id}),children:e.name})})),(0,r.jsx)(v.Td,(0,a._)((0,i._)({width:10,modifier:"truncate"},J({columnKey:"version"})),{children:e.described_by.map(e=>e.version).filter(e=>e).join(", ")})),(0,r.jsx)(v.Td,(0,a._)((0,i._)({width:10,modifier:"truncate"},J({columnKey:"supplier"})),{children:e.suppliers.join(", ")})),(0,r.jsx)(v.Td,(0,a._)((0,i._)({width:20,modifier:"truncate"},J({columnKey:"labels"})),{children:(0,r.jsx)(j.g,{value:e.labels,onClick:e=>{let{key:t,value:l}=e,r=(0,y.m4)({key:t,value:l}),n=R.labels;if(!(null==n?void 0:n.includes(r))){let e=n?[...n,r]:[r];A((0,a._)((0,i._)({},R),{labels:e}))}}})})),(0,r.jsx)(v.Td,(0,a._)((0,i._)({width:10,modifier:"truncate"},J({columnKey:"published"})),{children:(0,w.Yq)(e.published)})),(0,r.jsx)(v.Td,(0,a._)((0,i._)({width:10},J({columnKey:"packages"})),{children:e.number_of_packages})),(0,r.jsx)(v.Td,(0,a._)((0,i._)({width:20},J({columnKey:"vulnerabilities"})),{children:(0,r.jsx)(M,{sbomId:e.id})})),(0,r.jsx)(v.Td,{isActionCell:!0,children:(0,r.jsx)(f.G,{items:[{title:"Edit labels",onClick:()=>{O(e)}},{isSeparator:!0},{title:"Download SBOM",onClick:()=>{H(e.id,"".concat(e.name,".json"))}},{title:"Download License Report",onClick:()=>{Q(e.id)}},{isSeparator:!0},{title:"Delete",onClick:()=>{$(e)}}]})})]}))}))},e.id))})]})),(0,r.jsx)(S.n,{idPrefix:"sbom-table",isTop:!1,paginationProps:U}),(0,r.jsxs)(o.a,{isOpen:D,variant:"medium",onClose:X,children:[(0,r.jsx)(c.r,{title:"Edit labels"}),(0,r.jsx)(u.c,{children:L&&(0,r.jsx)(P.f,{sbom:L,onClose:X})})]}),(0,r.jsx)(_.T,(0,a._)((0,i._)({},(0,k.zK)(Y)),{inProgress:ee,titleIconVariant:"warning",isOpen:!!Y,confirmBtnVariant:d.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>$(null),onClose:()=>$(null),onConfirm:()=>{Y&&z(Y.id)}}))]})}},75725:function(e,t,l){l.d(t,{r:()=>x});var i=l(32909),a=l(42642),r=l(62540),n=l(63696),s=l(74343),o=l(61360),c=l(35048),u=l(32490),d=l(24773),p=l(21999),h=l(93826),m=l(67458),b=l(46173);let x=e=>{let{showFilters:t,showActions:l}=e,x=(0,s.Zp)(),{tableControls:v}=n.useContext(b.L),{propHelpers:{toolbarProps:f,filterToolbarProps:y,paginationToolbarItemProps:_,paginationProps:j}}=v;return(0,r.jsx)(o.M,(0,a._)((0,i._)({},f),{"aria-label":"sbom-toolbar",children:(0,r.jsxs)(c.P,{children:[t&&(0,r.jsx)(p.Us,(0,i._)({},y)),l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.T,{children:(0,r.jsx)(d.$n,{variant:"primary",onClick:()=>x(m.Jh.sbomUpload),children:"Upload SBOM"})}),(0,r.jsx)(u.T,{children:(0,r.jsx)(d.$n,{variant:"secondary",onClick:()=>x(m.Jh.sbomScan),children:"Generate vulnerability report"})})]}),(0,r.jsx)(u.T,(0,a._)((0,i._)({},_),{children:(0,r.jsx)(h.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:j})}))]})}))}},97773:function(e,t,l){l.d(t,{K:()=>o});var i=l(32909),a=l(77184),r=l(96002),n=l(86141),s=l(73470);let o=function(){var e,t,l;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:u,isLoading:d,error:p,refetch:h}=(0,a.I)({queryKey:["licenses",o],queryFn:()=>(0,n.Zy)({client:r.S,query:(0,i._)({},(0,s.kd)(o))}),enabled:!c});return{result:{data:(null==u||null==(e=u.data)?void 0:e.items)||[],total:null!=(l=null==u||null==(t=u.data)?void 0:t.total)?l:0,params:o},isFetching:d,fetchError:p,refetch:h}}}}]);