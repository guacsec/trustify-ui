"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["966"],{37818:function(e,t,r){r.d(t,{u:()=>s});var a=r(24246),l=r(8305),i=r(13754),n=r(39826);let s=e=>e.isFetching?e.isFetchingState||(0,a.jsx)(l.b,{children:(0,a.jsx)(i.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,a.jsx)(n.y,{}):e.children},42573:function(e,t,r){r.d(t,{C:()=>i});var a=r(24246),l=r(70400);let i=e=>{let{error:t}=e;return(0,a.jsxs)(l._,{color:"red",children:[t.status," Error"]})}},49304:function(e,t,r){r.d(t,{u:()=>o});var a=r(24246),l=r(34747),i=r(46770),n=r(25138),s=r(87445),u=r(32947),c=r(57524);let o=e=>{let{severities:t}=e,r=Object.values(t).reduce((e,t)=>e+t,0);return(0,a.jsxs)(l.k,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,a.jsx)(i.B,{"aria-label":"total",style:{minWidth:15,textAlign:s.F2},children:r}),(0,a.jsx)(n.i,{orientation:{default:"vertical"}}),(0,a.jsx)(i.B,{children:(0,a.jsx)(l.k,{children:Object.entries(t).filter(e=>{let[t,r]=e;return r>0}).sort((0,u.A0)(e=>{let[t,r]=e;return t})).reverse().map(e=>{let[t,r]=e;return(0,a.jsx)(i.B,{spacer:{default:"spacerXs"},children:(0,a.jsxs)(l.k,{"aria-label":t,spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,a.jsx)(i.B,{children:(0,a.jsx)(c.o,{value:t,score:null})}),(0,a.jsx)(i.B,{children:r})]})},t)})})})]})}},82413:function(e,t,r){r.d(t,{A:()=>v,I:()=>y});var a=r(79192),l=r(53195),i=r(27378),n=r(7615),s=r(43959);let u=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:(0,a._)({},c),fixed:(0,a._)({},c),not_affected:(0,a._)({},c),known_not_affected:(0,a._)({},c)}},d=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let r,i=e.find(e=>u(e,t));if(i)r=[...e.filter(e=>!u(e,i)),(0,l._)((0,a._)({},i),{relatedPackages:[...i.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};r=[...e.slice(),a]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,i=(0,n.g)(t.vulnerability.average_severity),s=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:(0,l._)((0,a._)({},e.vulnerabilityStatus),{[r]:{total:s.total+1,severities:(0,l._)((0,a._)({},s.severities),{[i]:s.severities[i]+1})}})})},(0,a._)({},o));return{vulnerabilities:t,summary:r}},v=e=>{let{advisories:t,isFetching:r,fetchError:a}=(0,s.KQ)(e);return{data:i.useMemo(()=>d(t||[]),[t]),isFetching:r,fetchError:a}},y=e=>{let{advisories:t,isFetching:r,fetchError:a}=(0,s.uz)(e);return{data:i.useMemo(()=>(null!=t?t:[]).map(e=>d(e||[])),[t]),isFetching:r,fetchError:a}}},66043:function(e,t,r){r.d(t,{_:()=>u});var a=r(24246),l=r(27378),i=r(24502),n=r(15726),s=r(43959);let u=e=>{let{sbom:t,onClose:r}=e,{pushNotification:u}=l.useContext(n.c),[c,o]=l.useState(""),[d,v]=l.useState("");l.useEffect(()=>{let e=setTimeout(()=>{v(c)},400);return()=>clearTimeout(e)},[c]);let{labels:y}=(0,s.i5)(d),{mutate:h,isPending:f}=(0,s.t9)(()=>{u({title:"Labels updated for SBOM ".concat(t.name),variant:"success"}),r()},e=>{u({title:"Error while updating labels for SBOM ".concat(t.name),variant:"danger"})});return(0,a.jsx)(i.M,{title:"Labels of SBOM: ".concat(t.name),value:t.labels,isDisabled:f,onSave:e=>{h({id:t.id,labels:e})},onClose:r,onInputChange:o,options:y})}},43959:function(e,t,r){r.d(t,{Fz:()=>m,KQ:()=>F,Oh:()=>q,i5:()=>b,km:()=>_,p4:()=>g,qi:()=>k,t9:()=>S,uz:()=>x});var a=r(79192),l=r(53195),i=r(70186),n=r(1183),s=r(24038),u=r(68e3),c=r(75503),o=r(16072),d=r(50576),v=r(40371),y=r(95169),h=r(87017),f=r(49988);let p="sboms",b=e=>{let{data:t,isLoading:r,error:a,refetch:l}=(0,n.a)({queryKey:[p,"labels",e],queryFn:()=>(0,v.mh)({client:d.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a,refetch:l}},m=function(){var e,t,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,f.rm)(s),{q:y}=o,h=(0,i._)(o,["q"]),b=(0,f.Rb)(u),{data:m,isLoading:g,error:_,refetch:S}=(0,n.a)({queryKey:[p,s,b],queryFn:()=>(0,v.Wp)({client:d.L,query:(0,l._)((0,a._)({},h),{q:[y,b].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==m||null==(e=m.data)?void 0:e.items)||[],total:null!=(r=null==m||null==(t=m.data)?void 0:t.total)?r:0,params:s},isFetching:g,fetchError:_,refetch:S}},g=e=>{let{data:t,isLoading:r,error:a}=(0,n.a)({queryKey:[p,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,v._Q)({client:d.L,path:{id:e}}),enabled:void 0!==e});return{sbom:null==t?void 0:t.data,isFetching:r,fetchError:a}},_=()=>{let e=(0,u.NL)();return(0,y.V)({parallel:!0,uploadFn:(e,t)=>(0,h.Hb)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[p]})}})},S=(e,t)=>{let r=(0,u.NL)();return(0,c.D)({mutationFn:e=>(0,v.zx)({client:d.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[p]})},onError:t})},q=function(e){var t,r,l;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:s,isLoading:u,error:c,refetch:o}=(0,n.a)({queryKey:[p,"by-package",e,i],queryFn:()=>(0,v.DU)({client:d.L,query:(0,a._)({purl:e},(0,f.rm)(i))})});return{result:{data:(null==s||null==(t=s.data)?void 0:t.items)||[],total:null!=(l=null==s||null==(r=s.data)?void 0:r.total)?l:0,params:i},isFetching:u,fetchError:c,refetch:o}},F=e=>{let{data:t,isLoading:r,error:a}=(0,n.a)({queryKey:[p,e,"advisory"],queryFn:()=>(0,v.NU)({client:d.L,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a}},x=e=>{let t=(0,o.h)({queries:e.map(e=>({queryKey:[p,e,"advisory"],queryFn:()=>(0,v.NU)({client:d.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},k=e=>{let{data:t,isLoading:r,error:a}=(0,n.a)({queryKey:[p,e,"license-ids"],queryFn:()=>(0,v.J4)({client:d.L,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a}}}}]);