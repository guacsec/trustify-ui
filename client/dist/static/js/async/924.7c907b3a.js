"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["924"],{98261:function(e,i,r){r.d(i,{Q:()=>d});var t=r(97517),l=r(62540),n=r(63696),a=r(539),s=r(62634),c=r(1850);let d=e=>{var{children:i=null,className:r="","aria-label":o="Breadcrumb",ouiaId:u,ouiaSafe:h=!0}=e,b=(0,t.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let m=(0,c.iK)(d.displayName,u,h);return(0,l.jsx)("nav",Object.assign({},b,{"aria-label":o,className:(0,s.A)(a.A.breadcrumb,r)},m,{children:(0,l.jsx)("ol",{className:a.A.breadcrumbList,role:"list",children:n.Children.map(i,(e,i)=>(0,n.isValidElement)(e)?(0,n.cloneElement)(e,{showDivider:i>0}):e)})}))};d.displayName="Breadcrumb"},75530:function(e,i,r){r.d(i,{J:()=>c});var t=r(97517),l=r(62540),n=r(21579),a=r(539),s=r(62634);let c=e=>{var{children:i=null,className:r="",to:c,isActive:d=!1,isDropdown:o=!1,showDivider:u,target:h,component:b="a",render:m}=e,p=(0,t.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let x=d?"page":void 0,j=(0,s.A)(a.A.breadcrumbLink,d&&a.A.modifiers.current);return(0,l.jsxs)("li",Object.assign({},p,{className:(0,s.A)(a.A.breadcrumbItem,r),children:[u&&(0,l.jsx)("span",{className:a.A.breadcrumbItemDivider,children:(0,l.jsx)(n.Ay,{})}),"button"===b&&(0,l.jsx)("button",{className:j,"aria-current":x,type:"button",children:i}),o&&(0,l.jsx)("span",{className:(0,s.A)(a.A.breadcrumbDropdown),children:i}),m&&m({className:j,ariaCurrent:x}),c&&!m&&(0,l.jsx)(b,{href:c,target:h,className:j,"aria-current":x,children:i}),!c&&"button"!==b&&!o&&i]}))};c.displayName="BreadcrumbItem"},17327:function(e,i,r){r.d(i,{E:()=>d,Z:()=>u});var t=r(97517),l=r(62540),n=r(63696),a=r(47328),s=r(62634),c=r(1850);let d=(0,n.createContext)({cardId:"",isExpanded:!1,isClickable:!1,isSelectable:!1,isSelected:!1,isClicked:!1,isDisabled:!1}),o=e=>{var{children:i,id:r="",className:n,component:o="div",isCompact:h=!1,isSelectable:b=!1,isClickable:m=!1,isDisabled:p=!1,isSelected:x=!1,isClicked:j=!1,isExpanded:v=!1,isLarge:f=!1,isFullHeight:y=!1,isPlain:g=!1,variant:_="default",ouiaId:A,ouiaSafe:T=!0,innerRef:C}=e,k=(0,t.__rest)(e,["children","id","className","component","isCompact","isSelectable","isClickable","isDisabled","isSelected","isClicked","isExpanded","isLarge","isFullHeight","isPlain","variant","ouiaId","ouiaSafe","innerRef"]);let w=(0,c.iK)(u.displayName,A,T);return h&&f&&(console.warn("Card: Cannot use isCompact with isLarge. Defaulting to isCompact"),f=!1),(0,l.jsx)(d.Provider,{value:{cardId:r,isExpanded:v,isClickable:m,isSelectable:b,isSelected:x,isClicked:j,isDisabled:p},children:(0,l.jsx)(o,Object.assign({ref:C,id:r,className:(0,s.A)(a.A.card,h&&a.A.modifiers.compact,v&&a.A.modifiers.expanded,f&&a.A.modifiers.displayLg,y&&a.A.modifiers.fullHeight,g&&a.A.modifiers.plain,"secondary"===_&&a.A.modifiers.secondary,b&&m?(0,s.A)(a.A.modifiers.selectable,a.A.modifiers.clickable,(x||j)&&a.A.modifiers.current):b?(0,s.A)(a.A.modifiers.selectable,x&&a.A.modifiers.selected):m?(0,s.A)(a.A.modifiers.clickable,j&&a.A.modifiers.current):"",p&&a.A.modifiers.disabled,n)},k,w,{children:i}))})},u=(0,n.forwardRef)((e,i)=>(0,l.jsx)(o,Object.assign({},e,{innerRef:i})));u.displayName="Card"},71603:function(e,i,r){r.d(i,{b:()=>s});var t=r(97517),l=r(62540),n=r(47328),a=r(62634);let s=e=>{var{children:i,className:r,component:s="div",isFilled:c=!0}=e,d=(0,t.__rest)(e,["children","className","component","isFilled"]);return(0,l.jsx)(s,Object.assign({className:(0,a.A)(n.A.cardBody,!c&&n.A.modifiers.noFill,r)},d,{children:i}))};s.displayName="CardBody"},64361:function(e,i,r){r.d(i,{Z:()=>d});var t=r(97517),l=r(62540),n=r(63696),a=r(62634),s=r(47328),c=r(17327);let d=e=>{var{children:i,className:r,component:d="div"}=e,o=(0,t.__rest)(e,["children","className","component"]);let{cardId:u}=(0,n.useContext)(c.E),h=u?`${u}-title`:"";return(0,l.jsx)("div",{className:(0,a.A)(s.A.cardTitle),children:(0,l.jsx)(d,Object.assign({className:(0,a.A)(s.A.cardTitleText,r),id:h||void 0},o,{children:i}))})};d.displayName="CardTitle"},21639:function(e,i,r){r.d(i,{X:()=>s});var t=r(97517),l=r(62540),n=r(77743),a=r(62634);let s=e=>{var{children:i,className:r,icon:s}=e,c=(0,t.__rest)(e,["children","className","icon"]);return(0,l.jsxs)("dt",Object.assign({className:(0,a.A)(n.A.descriptionListTerm,r)},c,{children:[s?(0,l.jsx)("span",{className:(0,a.A)(n.A.descriptionListTermIcon),children:s}):null,(0,l.jsx)("span",{className:(0,a.A)(n.A.descriptionListText),children:i})]}))};s.displayName="DescriptionListTerm"},10410:function(e,i,r){r.d(i,{Ay:()=>t});let t=(0,r(32791).w)({name:"PenIcon",height:512,width:512,svgPath:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z",yOffset:0,xOffset:0,svgClassName:void 0})},89705:function(e,i,r){r.d(i,{T:()=>d});var t=r(62540),l=r(24773),n=r(38927),a=r(80057),s=r(13021),c=r(97346);let d=e=>{let{isOpen:i,title:r,titleIconVariant:d,message:o,confirmBtnLabel:u,cancelBtnLabel:h,inProgress:b,confirmBtnVariant:m,onClose:p,onConfirm:x,onCancel:j}=e,v=(0,t.jsx)(l.$n,{"aria-label":"confirm",variant:m,isDisabled:b,onClick:x,children:u},"confirm"),f=j?(0,t.jsx)(l.$n,{"aria-label":"cancel",variant:l.Ak.link,isDisabled:b,onClick:j,children:h},"cancel"):void 0;return(0,t.jsxs)(n.a,{variant:"small",isOpen:i,onClose:p,"aria-label":"Confirm dialog",children:[(0,t.jsx)(a.r,{title:r,titleIconVariant:d}),(0,t.jsx)(s.c,{children:o}),(0,t.jsx)(c.j,{children:j?(0,t.jsxs)(t.Fragment,{children:[v,f]}):v})]})}},91242:function(e,i,r){r.d(i,{e:()=>f});var t=r(62540),l=r(63696),n=r(38914),a=r(57901),s=r(40360),c=r(42957),d=r(17327),o=r(23546),u=r(69548),h=r(75484),b=r(36284),m=r(24773),p=r(23909),x=r(71284),j=r(84631);let v=e=>{let i=(0,x.m4)(e);return{id:i,name:i}},f=e=>{let{title:i,value:r,isDisabled:f,onSave:y,onClose:g,options:_,onInputChange:A}=e,[T,C]=l.useState(Object.entries(r).map(e=>{let[i,r]=e;return v({key:i,value:r})}));return(0,t.jsxs)(n.B,{hasGutter:!0,children:[(0,t.jsx)(a.a,{children:"Labels help you organize and select resources. Adding labels below will let you query for objects that have similar, overlapping or dissimilar labels."}),(0,t.jsx)(a.a,{children:(0,t.jsx)(s.g,{label:(0,t.jsx)(c.U,{component:"h4",children:i}),children:(0,t.jsx)(d.Z,{children:(0,t.jsx)(o.o,{style:{padding:10,minHeight:10},defaultIsOpen:!0,numLabels:10,children:T.sort((e,i)=>(0,p.AA)(e.name).localeCompare((0,p.AA)(i.name))).map((e,i)=>(0,t.jsx)(u.J,{color:"blue",onClose:()=>{let e=[...T];e.splice(i,1),C(e)},children:(0,p.AA)(e.labelName||e.name)},e.id))})})})}),(0,t.jsx)(a.a,{children:(0,t.jsxs)(h.l,{onSubmit:e=>e.preventDefault(),children:[(0,t.jsx)(j.j,{selections:T,options:_.map(e=>{let{key:i,value:r}=e;return v({key:i,value:r})}),onChange:C,placeholderText:"Add label",searchInputAriaLabel:"labels-select-toggle",onSearchChange:A,onCreateNewOption:e=>({id:e,name:e}),validateNewOption:e=>!!e&&e.trim().length>0&&/^(?!.*\\)(?!\s*\\)(?!\s*=)[^=\\\s][^=\\]*\s*=?\s*[^=\\]+$/.test(e),filterBeforeOnChange:(e,i)=>{let r=(0,x.Cb)((0,p.AA)(i.name));return e.filter(e=>(0,x.Cb)((0,p.AA)(e.name)).key!==r.key)}}),(0,t.jsxs)(b.K,{children:[(0,t.jsx)(m.$n,{type:"button","aria-label":"submit",variant:m.Ak.primary,isDisabled:f,onClick:()=>{y(T.map(e=>(0,x.Cb)((0,p.AA)(e.name))).reduce((e,i)=>{let{key:r,value:t}=i;return e[r]=null!=t?t:"",e},{}))},children:"Save"}),(0,t.jsx)(m.$n,{type:"button","aria-label":"cancel",variant:m.Ak.link,isDisabled:f,onClick:g,children:"Cancel"})]})]})})]})}},12852:function(e,i,r){r.d(i,{g:()=>c});var t=r(62540),l=r(23546),n=r(69548),a=r(41628),s=r(71284);let c=e=>{let{value:i,defaultIsOpen:r,onClick:c}=e;return(0,t.jsx)(l.o,{defaultIsOpen:r,numLabels:5,children:Object.entries(i).sort((e,i)=>{let[r]=e,[t]=i;return t.localeCompare(r)}).map(e=>{let[i,r]=e;return(0,t.jsx)(n.J,{color:"blue",onClick:c?()=>c({key:i,value:r}):void 0,children:(0,t.jsx)(a.P,{content:(0,s.m4)({key:i,value:r})})},i)})})}},24296:function(e,i,r){r.d(i,{a:()=>s});var t=r(62540),l=r(59394),n=r(81595),a=r(40554);let s=e=>e.isFetching?e.isFetchingState||(0,t.jsx)(l.a,{children:(0,t.jsx)(n.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,t.jsx)(a.q,{}):e.children},20311:function(e,i,r){r.d(i,{R:()=>n});var t=r(62540),l=r(63696);let n=e=>{let{children:i}=e,[r,n]=l.useState(!1);return(0,t.jsx)(t.Fragment,{children:i(r,n)})}},64377:function(e,i,r){r.d(i,{j:()=>l});var t=r(62540);let l=e=>{let{vulnerability:i}=e;return(0,t.jsxs)("p",{children:[i.withdrawn&&(0,t.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},99528:function(e,i,r){r.d(i,{m:()=>c});var t=r(22249),l=r(81895),n=r(96002),a=r(86141),s=r(23909);let c=()=>({downloadAdvisory:(e,i)=>{(0,a.Mu)({client:n.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(r=>{(0,t.saveAs)(new Blob([r.data]),i||"".concat(e,".json"))})},downloadSBOM:(e,i)=>{(0,a.K0)({client:n.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(r=>{(0,t.saveAs)(new Blob([r.data]),i||"".concat(e,".json"))})},downloadSBOMLicenses:e=>{(0,l.Z3)(e).then(i=>{var r,l;let n=null,a=null==(l=i.headers)||null==(r=l["content-disposition"])?void 0:r.toString();a&&(n=(0,s.uz)(a)),(0,t.saveAs)(new Blob([i.data]),n||"".concat(e,".tar.gz"))})}})},49325:function(e,i,r){r.d(i,{tc:()=>s});var t=r(32909),l=r(42642),n=r(31550),a=r(73470);let s=e=>{let i=(e=>{var i;let{persistTo:r="state",persistenceKeyPrefix:l}=e,s=null!=(i=e.defaultActiveTab)?i:{tabKey:e.tabKeys[0]},[c,d]=(0,n.u)((0,t._)({isEnabled:!0,defaultValue:s,persistenceKeyPrefix:l},"urlParams"===r?{persistTo:r,keys:["activeTab"],serialize:e=>({activeTab:(null==e?void 0:e.tabKey)||null}),deserialize:e=>e.activeTab?{tabKey:e.activeTab}:null}:"localStorage"===r||"sessionStorage"===r?{persistTo:r,key:"tab"}:(0,a.xG)(r)?{persistTo:"provider",serialize:r.write,deserialize:()=>r.read()}:{persistTo:"state"}));return{activeTab:c,setActiveTab:d}})(e),r=(e=>{let{tabState:i}=e;return{isTabActive:e=>{var r;return e===(null==(r=i.activeTab)?void 0:r.tabKey)},setActiveTab:e=>{i.setActiveTab({tabKey:e})}}})({tabState:i});return(0,l._)((0,t._)({},e),{state:i,derivedState:r,propHelpers:{getTabsProps:()=>{var e;return{activeKey:null==(e=i.activeTab)?void 0:e.tabKey,onSelect:(e,i)=>{r.setActiveTab(i)}}},getTabProps:e=>({eventKey:e,tabContentId:"".concat(e,"-tab-section")}),getTabContentProps:e=>({id:"".concat(e,"-tab-section"),eventKey:e,hidden:!r.isTabActive(e)})}})}},11179:function(e,i,r){r.r(i),r.d(i,{default:()=>ej});var t=r(32909),l=r(42642),n=r(62540),a=r(63696),s=r(74343),c=r(68430),d=r(98261),o=r(75530),u=r(54518),h=r(48281),b=r(28338),m=r(70045),p=r(42957),x=r(69548),j=r(90717),v=r(96526),f=r(52993),y=r(84818),g=r(7261),_=r(40989),A=r(60423),T=r(40111),C=r(93472),k=r(24773),w=r(98259),S=r(52362),E=r(89705),N=r(24296),B=r(4392),F=r(99528),K=r(49325),I=r(99134),D=r(51380),P=r(76072),O=r(97299),L=r(17327),q=r(64361),Z=r(71603),M=r(1020),H=r(24974),J=r(21639),R=r(3939),z=r(38927),W=r(80057),X=r(13021),V=r(10410),Y=r(12852),$=r(23909),G=r(40665);let Q=e=>{var i,r;let{advisory:t}=e,[l,s]=a.useState(!1),c=()=>{s(!1)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(P.x,{hasGutter:!0,children:[(0,n.jsx)(O.E,{md:4,children:(0,n.jsxs)(L.Z,{isFullHeight:!0,children:[(0,n.jsx)(q.Z,{children:"Overview"}),(0,n.jsx)(Z.b,{children:(0,n.jsxs)(M.B,{children:[(0,n.jsxs)(H.W,{children:[(0,n.jsx)(J.X,{children:"Title"}),(0,n.jsx)(R.d,{children:t.title})]}),(0,n.jsxs)(H.W,{children:[(0,n.jsx)(J.X,{children:"Type"}),(0,n.jsx)(R.d,{children:t.labels.type})]}),(0,n.jsxs)(H.W,{children:[(0,n.jsx)(J.X,{children:"Size"}),(0,n.jsx)(R.d,{children:(0,D.A)(t.size)})]}),(0,n.jsxs)(H.W,{children:[(0,n.jsxs)(J.X,{children:["Labels ","",(0,n.jsx)(k.$n,{variant:k.Ak.link,size:"sm",icon:(0,n.jsx)(V.Ay,{}),iconPosition:"end",onClick:()=>s(!0),children:"Edit"})]}),(0,n.jsx)(R.d,{children:(0,n.jsx)(L.Z,{isCompact:!0,children:(0,n.jsx)(Z.b,{children:t.labels&&(0,n.jsx)(Y.g,{defaultIsOpen:!0,value:t.labels})})})})]})]})})]})}),(0,n.jsx)(O.E,{md:4,children:(0,n.jsxs)(L.Z,{isFullHeight:!0,children:[(0,n.jsx)(q.Z,{children:"Publisher"}),(0,n.jsx)(Z.b,{children:(0,n.jsxs)(M.B,{children:[(0,n.jsxs)(H.W,{children:[(0,n.jsx)(J.X,{children:"Name"}),(0,n.jsx)(R.d,{children:null==(i=t.issuer)?void 0:i.name})]}),(0,n.jsxs)(H.W,{children:[(0,n.jsx)(J.X,{children:"Contact details"}),(0,n.jsx)(R.d,{children:null==(r=t.issuer)?void 0:r.website})]})]})})]})}),(0,n.jsx)(O.E,{md:4,children:(0,n.jsxs)(L.Z,{isFullHeight:!0,children:[(0,n.jsx)(q.Z,{children:"Tracking"}),(0,n.jsx)(Z.b,{children:(0,n.jsxs)(M.B,{children:[(0,n.jsxs)(H.W,{children:[(0,n.jsx)(J.X,{children:"ID"}),(0,n.jsx)(R.d,{children:t.identifier})]}),(0,n.jsxs)(H.W,{children:[(0,n.jsx)(J.X,{children:"Initial release date"}),(0,n.jsx)(R.d,{children:(0,$.Yq)(t.published)})]}),(0,n.jsxs)(H.W,{children:[(0,n.jsx)(J.X,{children:"Current release date"}),(0,n.jsx)(R.d,{children:(0,$.Yq)(t.modified)})]})]})})]})})]}),(0,n.jsxs)(z.a,{isOpen:l,variant:"medium",title:"Edit labels",onClose:c,children:[(0,n.jsx)(W.r,{title:"Edit labels"}),(0,n.jsx)(X.c,{children:(0,n.jsx)(G.t,{advisory:t,onClose:c})})]})]})};var U=r(61360),ee=r(35048),ei=r(32490),er=r(26917),et=r(16646),el=r(21758),en=r(40384),ea=r(28516),es=r(78517),ec=r(59771),ed=r(27875),eo=r(45969),eu=r(93826),eh=r(30448),eb=r(20311),em=r(64377),ep=r(73470);let ex=e=>{let{isFetching:i,fetchError:r,vulnerabilities:a}=e,c=(0,ep.vY)({tableName:"vulnerability-table",idProperty:"identifier",items:a,isLoading:i,columnNames:{identifier:"ID",title:"Title",discovery:"Discovery",release:"Release",score:"Score",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.identifier}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:d,numRenderedColumns:o,propHelpers:{toolbarProps:u,paginationToolbarItemProps:h,paginationProps:b,tableProps:m,getThProps:p,getTrProps:x,getTdProps:j},expansionDerivedState:{isCellExpanded:v}}=c;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(U.M,(0,l._)((0,t._)({},u),{"aria-label":"vulnerability toolbar",children:(0,n.jsx)(ee.P,{children:(0,n.jsx)(ei.T,(0,l._)((0,t._)({},h),{children:(0,n.jsx)(eu.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:b})}))})})),(0,n.jsxs)(er.X,(0,l._)((0,t._)({},m),{"aria-label":"vulnerability table",children:[(0,n.jsx)(et.d,{children:(0,n.jsx)(el.Tr,{children:(0,n.jsxs)(eh.Ze,(0,l._)((0,t._)({},c),{children:[(0,n.jsx)(en.Th,(0,t._)({},p({columnKey:"identifier"}))),(0,n.jsx)(en.Th,(0,t._)({},p({columnKey:"title"}))),(0,n.jsx)(en.Th,(0,t._)({},p({columnKey:"discovery"}))),(0,n.jsx)(en.Th,(0,t._)({},p({columnKey:"release"}))),(0,n.jsx)(en.Th,(0,t._)({},p({columnKey:"score"}))),(0,n.jsx)(en.Th,(0,t._)({},p({columnKey:"cwe"})))]}))})}),(0,n.jsx)(eh.nJ,{isLoading:i,isError:!!r,isNoData:0===a.length,numRenderedColumns:o,children:null==d?void 0:d.map((e,i)=>{var r;return(0,n.jsx)(ea.N,{isExpanded:v(e),children:(0,n.jsx)(el.Tr,(0,l._)((0,t._)({},x({item:e})),{children:(0,n.jsxs)(eh.Oi,(0,l._)((0,t._)({},c),{item:e,rowIndex:i,children:[(0,n.jsx)(es.Td,(0,l._)((0,t._)({width:15,modifier:"breakWord"},j({columnKey:"identifier"})),{children:(0,n.jsx)(s.N_,{to:(0,s.tW)(S.Jh.vulnerabilityDetails,{vulnerabilityId:e.identifier}),children:e.identifier})})),(0,n.jsx)(eb.R,{children:(i,r)=>(0,n.jsx)(es.Td,(0,l._)((0,t._)({width:40,modifier:"truncate",onFocus:()=>r(!0),onBlur:()=>r(!1),tabIndex:0},j({columnKey:"title"})),{children:(0,n.jsx)(ec.mA,{focused:i,wrapModifier:"truncate",children:(0,n.jsx)(em.j,{vulnerability:e})})}))}),(0,n.jsx)(es.Td,(0,l._)((0,t._)({width:15},j({columnKey:"discovery"})),{children:(0,$.Yq)(e.discovered)})),(0,n.jsx)(es.Td,(0,l._)((0,t._)({width:10,modifier:"truncate"},j({columnKey:"release"})),{children:(0,$.Yq)(e.released)})),(0,n.jsx)(es.Td,(0,l._)((0,t._)({width:10,modifier:"truncate"},j({columnKey:"score"})),{children:e.severity&&(0,n.jsx)(eo.h,{value:(0,ed.U)(e.severity),score:null!=(r=e.score)?r:null,showLabel:!0,showScore:!0})})),(0,n.jsx)(es.Td,(0,l._)((0,t._)({width:10,modifier:"truncate"},j({columnKey:"cwe"})),{children:e.cwes.join(", ")}))]}))}))},e.identifier)})})]})),(0,n.jsx)(eu.n,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:b})]})},ej=()=>{var e,i;let r=(0,s.Zp)(),{pushNotification:D}=a.useContext(B.K),P=(0,S.Lu)("advisoryId"),{advisory:O,isFetching:L,fetchError:q}=(0,I.vy)(P),[Z,M]=a.useState(!1),H=()=>{M(!Z)},{downloadAdvisory:J}=(0,F.m)(),[R,z]=a.useState(!1),{mutate:W,isPending:X}=(0,I.ni)(e=>{z(!1),D({title:(0,w.PN)(e),variant:"success"}),r("/advisories")},e=>{D({title:(0,w.EU)(e),variant:"danger"})}),{propHelpers:{getTabsProps:V,getTabProps:Y,getTabContentProps:$}}=(0,K.tc)({persistenceKeyPrefix:"ad",persistTo:"urlParams",tabKeys:["info","vulnerabilities"]}),G=a.createRef(),U=a.createRef();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.d8,{type:"breadcrumb",children:(0,n.jsxs)(d.Q,{children:[(0,n.jsx)(o.J,{children:(0,n.jsx)(s.N_,{to:S.Jh.advisories,children:"Advisories"})}),(0,n.jsx)(o.J,{isActive:!0,children:"Advisory details"})]})}),(0,n.jsx)(c.d8,{children:(0,n.jsxs)(u.B,{children:[(0,n.jsx)(h.o,{isFilled:!0,children:(0,n.jsxs)(b.s,{children:[(0,n.jsx)(m.Z,{spacer:{default:"spacerSm"},children:(0,n.jsxs)(p.U,{children:[(0,n.jsx)(p.U,{component:"h1",children:null!=(i=null!=(e=null==O?void 0:O.document_id)?e:P)?i:""}),(0,n.jsx)(p.U,{component:"p",children:"Advisory detail information"})]})}),(0,n.jsx)(m.Z,{children:(null==O?void 0:O.labels.type)&&(0,n.jsx)(x.J,{color:"blue",children:null==O?void 0:O.labels.type})})]})}),(0,n.jsx)(h.o,{children:O&&(0,n.jsx)(j.m,{isOpen:Z,onSelect:()=>M(!1),onOpenChange:e=>M(e),popperProps:{position:"right"},toggle:e=>(0,n.jsx)(v.S3,{ref:e,onClick:H,isExpanded:Z,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,n.jsxs)(f.Q,{children:[(0,n.jsx)(y.t,{onClick:()=>{P&&J(P,(null==O?void 0:O.identifier)?"".concat(null==O?void 0:O.identifier,".json"):"".concat(P,".json"))},children:"Download Advisory"},"advisory"),(0,n.jsx)(g.c,{component:"li"},"separator"),(0,n.jsx)(y.t,{onClick:()=>z(!0),children:"Delete"},"delete")]})})})]})}),(0,n.jsx)(c.d8,{children:(0,n.jsxs)(_.t,(0,l._)((0,t._)({mountOnEnter:!0},V()),{"aria-label":"Tabs that contain the Advisory information",role:"region",children:[(0,n.jsx)(A.o,(0,l._)((0,t._)({},Y("info")),{title:(0,n.jsx)(T.V,{children:"Info"}),tabContentRef:G})),(0,n.jsx)(A.o,(0,l._)((0,t._)({},Y("vulnerabilities")),{title:(0,n.jsx)(T.V,{children:"Vulnerabilities"}),tabContentRef:U}))]}))}),(0,n.jsxs)(c.d8,{children:[(0,n.jsx)(C.J,(0,l._)((0,t._)({},$("info")),{ref:G,"aria-label":"Information of the Advisory",children:(0,n.jsx)(N.a,{isFetching:L,fetchError:q,children:O&&(0,n.jsx)(Q,{advisory:O})})})),(0,n.jsx)(C.J,(0,l._)((0,t._)({},$("vulnerabilities")),{ref:U,"aria-label":"Vulnerabilities within the Advisory",children:(0,n.jsx)(ex,{isFetching:L,fetchError:q,vulnerabilities:(null==O?void 0:O.vulnerabilities)||[]})}))]}),(0,n.jsx)(E.T,(0,l._)((0,t._)({},(0,w.p6)(O)),{inProgress:X,titleIconVariant:"warning",isOpen:R,confirmBtnVariant:k.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>z(!1),onClose:()=>z(!1),onConfirm:()=>{O&&W(O.uuid)}}))]})}},40665:function(e,i,r){r.d(i,{t:()=>c});var t=r(62540),l=r(63696),n=r(91242),a=r(4392),s=r(99134);let c=e=>{let{advisory:i,onClose:r}=e,{pushNotification:c}=l.useContext(a.K),[d,o]=l.useState(""),[u,h]=l.useState(""),{labels:b}=(0,s.eq)(u);l.useEffect(()=>{let e=setTimeout(()=>{h(d)},400);return()=>clearTimeout(e)},[d]);let{mutate:m,isPending:p}=(0,s.uJ)(()=>{c({title:"Labels updated for Advisory ".concat(i.document_id),variant:"success"}),r()},e=>{c({title:"Error while updating labels for Advisory ".concat(i.document_id),variant:"danger"})});return(0,t.jsx)(n.e,{title:"Labels of Advisory: ".concat(i.document_id),value:i.labels,isDisabled:p,onSave:e=>{m({id:i.uuid,labels:e})},onClose:r,onInputChange:o,options:b})}},99134:function(e,i,r){r.d(i,{VH:()=>j,Yu:()=>y,eq:()=>x,ni:()=>f,uJ:()=>g,vy:()=>v});var t=r(32909),l=r(42642),n=r(72610),a=r(77184),s=r(59722),c=r(62603),d=r(90130),o=r(96002),u=r(86141),h=r(81895),b=r(73470),m=r(93531);let p="advisories",x=e=>{let{data:i,isLoading:r,error:t,refetch:l}=(0,a.I)({queryKey:[p,"labels",e],queryFn:()=>(0,u.J)({client:o.S,query:{limit:10,filter_text:e}}),placeholderData:s.rX});return{labels:(null==i?void 0:i.data)||[],isFetching:r,fetchError:t,refetch:l}},j=function(){var e,i,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=(0,b.kd)(s),{q:m}=h,x=(0,n._)(h,["q"]),j=(0,b.Er)(c),{data:v,isLoading:f,error:y,refetch:g}=(0,a.I)({queryKey:[p,s,j],queryFn:()=>(0,u.YM)({client:o.S,query:(0,l._)((0,t._)({},x),{q:[m,j].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==v||null==(e=v.data)?void 0:e.items)||[],total:null!=(r=null==v||null==(i=v.data)?void 0:i.total)?r:0,params:s},isFetching:f,fetchError:y||null,refetch:g}},v=e=>{let{data:i,isLoading:r,error:t}=(0,a.I)({queryKey:[p,e],queryFn:()=>(0,u.ai)({client:o.S,path:{key:e}}),enabled:!!e});return{advisory:null==i?void 0:i.data,isFetching:r,fetchError:t}},f=(e,i)=>{let r=(0,c.jE)();return(0,d.n)({mutationFn:async e=>(await (0,u.vl)({client:o.S,path:{key:e}})).data,onSuccess:async(i,t)=>{e(i,t),await r.invalidateQueries({queryKey:[p]})},onError:async e=>{i(e),await r.invalidateQueries({queryKey:[p]})}})},y=()=>{let e=(0,c.jE)();return(0,m.v)({parallel:!0,uploadFn:(e,i)=>(0,h.hP)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[p]})}})},g=(e,i)=>{let r=(0,c.jE)();return(0,d.n)({mutationFn:e=>(0,u._e)({client:o.S,path:{id:e.id},body:e.labels}),onSuccess:async(i,t)=>{e(),await r.invalidateQueries({queryKey:[p]})},onError:i})}},47328:function(e,i,r){r.d(i,{A:()=>t});let t={button:"pf-v6-c-button",card:"pf-v6-c-card",cardActions:"pf-v6-c-card__actions",cardBody:"pf-v6-c-card__body",cardClickableAction:"pf-v6-c-card__clickable-action",cardExpandableContent:"pf-v6-c-card__expandable-content",cardFooter:"pf-v6-c-card__footer",cardHeader:"pf-v6-c-card__header",cardHeaderMain:"pf-v6-c-card__header-main",cardHeaderToggle:"pf-v6-c-card__header-toggle",cardHeaderToggleIcon:"pf-v6-c-card__header-toggle-icon",cardSelectableActions:"pf-v6-c-card__selectable-actions",cardTitle:"pf-v6-c-card__title",cardTitleText:"pf-v6-c-card__title-text",check:"pf-v6-c-check",checkInput:"pf-v6-c-check__input",checkLabel:"pf-v6-c-check__label",dirRtl:"pf-v6-m-dir-rtl",divider:"pf-v6-c-divider",modifiers:{selectable:"pf-m-selectable",clickable:"pf-m-clickable",current:"pf-m-current",selected:"pf-m-selected",disabled:"pf-m-disabled",compact:"pf-m-compact",displayLg:"pf-m-display-lg",secondary:"pf-m-secondary",plain:"pf-m-plain",expanded:"pf-m-expanded",fullHeight:"pf-m-full-height",toggleRight:"pf-m-toggle-right",wrap:"pf-m-wrap",noOffset:"pf-m-no-offset",inline:"pf-m-inline",noFill:"pf-m-no-fill"},radio:"pf-v6-c-radio",radioInput:"pf-v6-c-radio__input",radioLabel:"pf-v6-c-radio__label"}},51380:function(e,i,r){r.d(i,{A:()=>c});let t=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],l=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],n=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],a=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],s=(e,i,r)=>{let t=e;return"string"==typeof i||Array.isArray(i)?t=e.toLocaleString(i,r):(!0===i||void 0!==r)&&(t=e.toLocaleString(void 0,r)),t};function c(e,i){let r;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let c=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?a:n:i.binary?l:t,d=i.space?" ":"";if(i.signed&&0===e)return` 0${d}${c[0]}`;let o=e<0,u=o?"-":i.signed?"+":"";if(o&&(e=-e),void 0!==i.minimumFractionDigits&&(r={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(r={maximumFractionDigits:i.maximumFractionDigits,...r}),e<1)return u+s(e,i.locale,r)+d+c[0];let h=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),c.length-1);return e/=(i.binary?1024:1e3)**h,r||(e=e.toPrecision(3)),u+s(Number(e),i.locale,r)+d+c[h]}}}]);