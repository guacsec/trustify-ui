"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["619"],{37818:function(e,t,r){r.d(t,{u:()=>n});var i=r(24246),l=r(8305),a=r(13754),s=r(39826);let n=e=>e.isFetching?e.isFetchingState||(0,i.jsx)(l.b,{children:(0,i.jsx)(a.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,i.jsx)(s.y,{}):e.children},42573:function(e,t,r){r.d(t,{C:()=>a});var i=r(24246),l=r(70400);let a=e=>{let{error:t}=e;return(0,i.jsxs)(l._,{color:"red",children:[t.status," Error"]})}},49304:function(e,t,r){r.d(t,{u:()=>d});var i=r(24246),l=r(34747),a=r(46770),s=r(25138),n=r(87445),u=r(32947),o=r(57524);let d=e=>{let{severities:t}=e,r=Object.values(t).reduce((e,t)=>e+t,0);return(0,i.jsxs)(l.k,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,i.jsx)(a.B,{style:{minWidth:15,textAlign:n.F2},children:r}),(0,i.jsx)(s.i,{orientation:{default:"vertical"}}),(0,i.jsx)(a.B,{children:(0,i.jsx)(l.k,{children:Object.entries(t).filter(e=>{let[t,r]=e;return r>0}).sort((0,u.A0)(e=>{let[t,r]=e;return t})).reverse().map(e=>{let[t,r]=e;return(0,i.jsx)(a.B,{spacer:{default:"spacerXs"},children:(0,i.jsxs)(l.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,i.jsx)(a.B,{children:(0,i.jsx)(o.o,{value:t,score:null})}),(0,i.jsx)(a.B,{children:r})]})},t)})})})]})}},82413:function(e,t,r){r.d(t,{A:()=>d,I:()=>c});var i=r(27378),l=r(7615),a=r(43959);let s=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,n={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},u={vulnerabilityStatus:{affected:{...n},fixed:{...n},not_affected:{...n},known_not_affected:{...n}}},o=e=>{let t=e.flatMap(e=>(e.status??[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))).reduce((e,t)=>{let r,i=e.find(e=>s(e,t));if(i)r=[...e.filter(e=>!s(e,i)),{...i,relatedPackages:[...i.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];else{let i={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};r=[...e.slice(),i]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,i=(0,l.g)(t.vulnerability.average_severity),a=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:a.total+1,severities:{...a.severities,[i]:a.severities[i]+1}}}})},{...u});return{vulnerabilities:t,summary:r}},d=e=>{let{advisories:t,isFetching:r,fetchError:l}=(0,a.KQ)(e);return{data:i.useMemo(()=>o(t||[]),[t]),isFetching:r,fetchError:l}},c=e=>{let{advisories:t,isFetching:r,fetchError:l}=(0,a.uz)(e);return{data:i.useMemo(()=>(t??[]).map(e=>o(e||[])),[t]),isFetching:r,fetchError:l}}},66043:function(e,t,r){r.d(t,{_:()=>u});var i=r(24246),l=r(27378),a=r(24502),s=r(15726),n=r(43959);let u=e=>{let{sbom:t,onClose:r}=e,{pushNotification:u}=l.useContext(s.c),[o,d]=l.useState(""),[c,h]=l.useState("");l.useEffect(()=>{let e=setTimeout(()=>{h(o)},400);return()=>clearTimeout(e)},[o]);let{labels:p}=(0,n.i5)(c),{mutate:m,isPending:y}=(0,n.t9)(()=>{u({title:`Labels updated for SBOM ${t.name}`,variant:"success"}),r()},e=>{u({title:`Error while updating labels for SBOM ${t.name}`,variant:"danger"})});return(0,i.jsx)(a.M,{title:`Labels of SBOM: ${t.name}`,value:t.labels,isDisabled:y,onSave:e=>{m({id:t.id,labels:e})},onClose:r,onInputChange:d,options:p})}},47849:function(e,t,r){r.d(t,{F:()=>c,W:()=>d});var i=r(24246),l=r(27378),a=r(74502),s=r(32947),n=r(14629),u=r(49988),o=r(43959);let d=l.createContext({}),c=e=>{let{children:t}=e,[r,c]=l.useState(""),[h,p]=l.useState("");l.useEffect(()=>{let e=setTimeout(()=>{p(r)},400);return()=>clearTimeout(e)},[r]);let{labels:m}=(0,o.i5)(h),y=(0,u.vZ)({tableName:"sbom",persistenceKeyPrefix:a.yq.sboms,persistTo:"urlParams",columnNames:{name:"Name",version:"Version",supplier:"Supplier",labels:"Labels",published:"Created on",packages:"Dependencies",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","published"],isFilterEnabled:!0,filterCategories:[{categoryKey:a.L4,title:"Filter text",placeholderText:"Search",type:n.vA.search},{categoryKey:"published",title:"Created on",type:n.vA.dateRange},{categoryKey:"labels",title:"Label",type:n.vA.autocompleteLabel,placeholderText:"Filter results by label",selectOptions:m.map(e=>{let t=(0,s.W)({key:e.key,value:e.value});return{value:t,label:t}}),onInputValueChange:c}],isExpansionEnabled:!1}),{result:{data:b,total:x},isFetching:f,fetchError:v}=(0,o.Fz)((0,u.QO)({...y,hubSortFieldKeys:{name:"name",published:"published"}}),(y.filterState.filterValues.labels??[]).map(e=>(0,s.nE)(e))),j=(0,u.KC)({...y,idProperty:"id",currentPageItems:b,totalItemCount:x,isLoading:f});return(0,i.jsx)(d.Provider,{value:{totalItemCount:x,isFetching:f,fetchError:v,tableControls:j},children:t})}},68801:function(e,t,r){r.d(t,{H:()=>w});var i=r(24246),l=r(27378),a=r(65783),s=r(79551),n=r(32489),u=r(90519),o=r(4835),d=r(14350),c=r(11165),h=r(89330),p=r(31423),m=r(94154),y=r(88935),b=r(3804),x=r(31336),f=r(73227),v=r(63706),j=r(32947),g=r(73827),S=r(66043),k=r(11797),E=r(37818),F=r(42573),K=r(49304),C=r(82413);let T=e=>{let{sbomId:t}=e,{data:r,isFetching:l,fetchError:a}=(0,C.A)(t);return(0,i.jsx)(E.u,{isFetching:l,fetchError:a,isFetchingState:(0,i.jsx)(k.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,i.jsx)(F.C,{error:e}),children:(0,i.jsx)(K.u,{severities:r.summary.vulnerabilityStatus.affected.severities})})};var q=r(47849);let w=()=>{let{isFetching:e,fetchError:t,totalItemCount:r,tableControls:k}=l.useContext(q.W),[E,F]=l.useState(null),K=null!==E,{numRenderedColumns:C,currentPageItems:w,propHelpers:{paginationProps:L,tableProps:_,getThProps:I,getTrProps:P,getTdProps:O},expansionDerivedState:{isCellExpanded:W},filterState:{filterValues:B,setFilterValues:D}}=k,{downloadSBOM:A,downloadSBOMLicenses:M}=(0,f.i)(),N=()=>{F(null)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.i,{..._,"aria-label":"sbom-table",children:[(0,i.jsx)(d.h,{children:(0,i.jsx)(c.Tr,{children:(0,i.jsxs)(x.qK,{...k,children:[(0,i.jsx)(h.Th,{...I({columnKey:"name"})}),(0,i.jsx)(h.Th,{...I({columnKey:"version"})}),(0,i.jsx)(h.Th,{...I({columnKey:"supplier"})}),(0,i.jsx)(h.Th,{...I({columnKey:"labels"})}),(0,i.jsx)(h.Th,{...I({columnKey:"published"})}),(0,i.jsx)(h.Th,{...I({columnKey:"packages"})}),(0,i.jsx)(h.Th,{...I({columnKey:"vulnerabilities"})})]})})}),(0,i.jsx)(x.hp,{isLoading:e,isError:!!t,isNoData:0===r,numRenderedColumns:C,children:w.map((e,t)=>(0,i.jsx)(p.p,{isExpanded:W(e),children:(0,i.jsx)(c.Tr,{...P({item:e}),children:(0,i.jsxs)(x.Cx,{...k,item:e,rowIndex:t,children:[(0,i.jsx)(m.Td,{width:20,modifier:"breakWord",...O({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t}),children:(0,i.jsx)(a.OL,{to:`/sboms/${e.id}`,children:e.name})}),(0,i.jsx)(m.Td,{width:10,modifier:"truncate",...O({columnKey:"version"}),children:e.described_by.map(e=>e.version).filter(e=>e).join(", ")}),(0,i.jsx)(m.Td,{width:10,modifier:"truncate",...O({columnKey:"supplier"}),children:e.suppliers.join(", ")}),(0,i.jsx)(m.Td,{width:20,modifier:"truncate",...O({columnKey:"labels"}),children:(0,i.jsx)(g.C,{value:e.labels,onClick:e=>{let{key:t,value:r}=e,i=(0,j.W)({key:t,value:r}),l=B.labels;if(!l?.includes(i)){let e=l?[...l,i]:[i];D({...B,labels:e})}}})}),(0,i.jsx)(m.Td,{width:10,modifier:"truncate",...O({columnKey:"published"}),children:(0,v.p6)(e.published)}),(0,i.jsx)(m.Td,{width:10,...O({columnKey:"packages"}),children:e.number_of_packages}),(0,i.jsx)(m.Td,{width:20,...O({columnKey:"vulnerabilities"}),children:(0,i.jsx)(T,{sbomId:e.id})}),(0,i.jsx)(m.Td,{isActionCell:!0,children:(0,i.jsx)(y.k,{items:[{title:"Edit labels",onClick:()=>{F(e)}},{isSeparator:!0},{title:"Download SBOM",onClick:()=>{A(e.id,`${e.name}.json`)}},{title:"Download License Report",onClick:()=>{M(e.id)}}]})})]})})},e.id))})]}),(0,i.jsx)(b.p,{idPrefix:"sbom-table",isTop:!1,paginationProps:L}),(0,i.jsxs)(s.u,{isOpen:K,variant:"medium",onClose:N,children:[(0,i.jsx)(n.x,{title:"Edit labels"}),(0,i.jsx)(u.f,{children:E&&(0,i.jsx)(S._,{sbom:E,onClose:N})})]})]})}},83870:function(e,t,r){r.d(t,{c:()=>c});var i=r(24246),l=r(27378),a=r(70715),s=r(40982),n=r(89226),u=r(14629),o=r(3804),d=r(47849);let c=e=>{let{showFilters:t}=e,{tableControls:r}=l.useContext(d.W),{propHelpers:{toolbarProps:c,filterToolbarProps:h,paginationToolbarItemProps:p,paginationProps:m}}=r;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(a.o,{...c,"aria-label":"sbom-toolbar",children:(0,i.jsxs)(s.c,{children:[t&&(0,i.jsx)(u.Ki,{...h}),(0,i.jsx)(n.E,{...p,children:(0,i.jsx)(o.p,{idPrefix:"sbom-table",isTop:!0,paginationProps:m})})]})})})}},43959:function(e,t,r){r.d(t,{Fz:()=>y,KQ:()=>j,Oh:()=>v,i5:()=>m,km:()=>x,p4:()=>b,qi:()=>S,t9:()=>f,uz:()=>g});var i=r(1183),l=r(24038),a=r(68e3),s=r(75503),n=r(16072),u=r(50576),o=r(40371),d=r(95169),c=r(87017),h=r(49988);let p="sboms",m=e=>{let{data:t,isLoading:r,error:a,refetch:s}=(0,i.a)({queryKey:[p,"labels",e],queryFn:()=>(0,o.mh)({client:u.L,query:{limit:10,filter_text:e}}),placeholderData:l.Wk});return{labels:t?.data||[],isFetching:r,fetchError:a,refetch:s}},y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:l,...a}=(0,h.rm)(e),s=(0,h.Rb)(t),{data:n,isLoading:d,error:c,refetch:m}=(0,i.a)({queryKey:[p,e,s],queryFn:()=>(0,o.Wp)({client:u.L,query:{...a,q:[l,s].filter(e=>e).join("&")}}),enabled:!r});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:e??e},isFetching:d,fetchError:c,refetch:m}},b=e=>{let{data:t,isLoading:r,error:l}=(0,i.a)({queryKey:[p,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,o._Q)({client:u.L,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:r,fetchError:l}},x=()=>{let e=(0,a.NL)();return(0,d.V)({parallel:!0,uploadFn:(e,t)=>(0,c.Hb)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[p]})}})},f=(e,t)=>{let r=(0,a.NL)();return(0,s.D)({mutationFn:e=>(0,o.zx)({client:u.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[p]})},onError:t})},v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:l,error:a,refetch:s}=(0,i.a)({queryKey:[p,"by-package",e,t],queryFn:()=>(0,o.DU)({client:u.L,query:{purl:e,...(0,h.rm)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t??t},isFetching:l,fetchError:a,refetch:s}},j=e=>{let{data:t,isLoading:r,error:l}=(0,i.a)({queryKey:[p,e,"advisory"],queryFn:()=>(0,o.NU)({client:u.L,path:{id:e}})});return{advisories:t?.data||[],isFetching:r,fetchError:l}},g=e=>{let t=(0,n.h)({queries:e.map(e=>({queryKey:[p,e,"advisory"],queryFn:()=>(0,o.NU)({client:u.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return t?.data||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},S=e=>{let{data:t,isLoading:r,error:l}=(0,i.a)({queryKey:[p,e,"license-ids"],queryFn:()=>(0,o.J4)({client:u.L,path:{id:e}})});return{licenseIds:t?.data||[],isFetching:r,fetchError:l}}}}]);