"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["187"],{6348:function(e,t,a){a.d(t,{Q:()=>o});var l=a(24246),r=a(78700),n=a(79551),i=a(32489),s=a(90519),u=a(35072);let o=e=>{let{isOpen:t,title:a,titleIconVariant:o,message:c,confirmBtnLabel:d,cancelBtnLabel:h,inProgress:v,confirmBtnVariant:p,onClose:y,onConfirm:b,onCancel:f}=e,m=(0,l.jsx)(r.zx,{id:"confirm-dialog-button","aria-label":"confirm",variant:p,isDisabled:v,onClick:b,children:d},"confirm"),g=f?(0,l.jsx)(r.zx,{id:"confirm-cancel-button","aria-label":"cancel",variant:r.Wu.link,isDisabled:v,onClick:f,children:h},"cancel"):void 0;return(0,l.jsxs)(n.u,{id:"confirm-dialog",variant:"small",isOpen:t,onClose:y,"aria-label":"Confirm dialog",children:[(0,l.jsx)(i.x,{title:a,titleIconVariant:o}),(0,l.jsx)(s.f,{children:c}),(0,l.jsx)(u.m,{children:f?(0,l.jsxs)(l.Fragment,{children:[m,g]}):m})]})}},24502:function(e,t,a){a.d(t,{M:()=>g});var l=a(24246),r=a(27378),n=a(27317),i=a(93095),s=a(54816),u=a(68802),o=a(31757),c=a(74607),d=a(70400),h=a(51088),v=a(58730),p=a(78700),y=a(63706),b=a(32947),f=a(40165);let m=e=>{let t=(0,b.W)(e);return{id:t,name:t}},g=e=>{let{title:t,value:a,isDisabled:g,onSave:x,onClose:j,options:k,onInputChange:_}=e,[F,S]=r.useState(Object.entries(a).map(e=>{let[t,a]=e;return m({key:t,value:a})}));return(0,l.jsxs)(n.K,{hasGutter:!0,children:[(0,l.jsx)(i.v,{children:"Labels help you organize and select resources. Adding labels below will let you query for objects that have similar, overlapping or dissimilar labels."}),(0,l.jsx)(i.v,{children:(0,l.jsx)(s.c,{label:(0,l.jsx)(u.V,{component:"h4",children:t}),children:(0,l.jsx)(o.Z,{children:(0,l.jsx)(c.e,{style:{padding:10,minHeight:10},defaultIsOpen:!0,numLabels:10,children:F.sort((e,t)=>(0,y.KF)(e.name).localeCompare((0,y.KF)(t.name))).map((e,t)=>(0,l.jsx)(d._,{color:"blue",onClose:()=>{let e=[...F];e.splice(t,1),S(e)},children:(0,y.KF)(e.labelName||e.name)},e.id))})})})}),(0,l.jsx)(i.v,{children:(0,l.jsxs)(h.l,{onSubmit:e=>e.preventDefault(),children:[(0,l.jsx)(f.F,{selections:F,options:k.map(e=>{let{key:t,value:a}=e;return m({key:t,value:a})}),onChange:S,placeholderText:"Add label",searchInputAriaLabel:"labels-select-toggle",onSearchChange:_,onCreateNewOption:e=>({id:e,name:e}),validateNewOption:e=>!!e&&e.trim().length>0&&/^(?!.*\\)(?!\s*\\)(?!\s*=)[^=\\\s][^=\\]*\s*=?\s*[^=\\]+$/.test(e),filterBeforeOnChange:(e,t)=>{let a=(0,b.nE)((0,y.KF)(t.name));return e.filter(e=>(0,b.nE)((0,y.KF)(e.name)).key!==a.key)}}),(0,l.jsxs)(v.W,{children:[(0,l.jsx)(p.zx,{type:"button",id:"submit","aria-label":"submit",variant:p.Wu.primary,isDisabled:g,onClick:()=>{x(F.map(e=>(0,b.nE)((0,y.KF)(e.name))).reduce((e,t)=>{let{key:a,value:l}=t;return e[a]=null!=l?l:"",e},{}))},children:"Save"}),(0,l.jsx)(p.zx,{type:"button",id:"cancel","aria-label":"cancel",variant:p.Wu.link,isDisabled:g,onClick:j,children:"Cancel"})]})]})})]})}},73827:function(e,t,a){a.d(t,{C:()=>u});var l=a(24246),r=a(74607),n=a(70400),i=a(85295),s=a(32947);let u=e=>{let{value:t,defaultIsOpen:a,onClick:u}=e;return(0,l.jsx)(r.e,{defaultIsOpen:a,numLabels:5,children:Object.entries(t).sort((e,t)=>{let[a]=e,[l]=t;return l.localeCompare(a)}).map(e=>{let[t,a]=e;return(0,l.jsx)(n._,{color:"blue",onClick:u?()=>u({key:t,value:a}):void 0,children:(0,l.jsx)(i.k,{content:(0,s.W)({key:t,value:a})})},t)})})}},37818:function(e,t,a){a.d(t,{u:()=>s});var l=a(24246),r=a(8305),n=a(13754),i=a(39826);let s=e=>e.isFetching?e.isFetchingState||(0,l.jsx)(r.b,{children:(0,l.jsx)(n.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,l.jsx)(i.y,{}):e.children},42573:function(e,t,a){a.d(t,{C:()=>n});var l=a(24246),r=a(70400);let n=e=>{let{error:t}=e;return(0,l.jsxs)(r._,{color:"red",children:[t.status," Error"]})}},49304:function(e,t,a){a.d(t,{u:()=>c});var l=a(24246),r=a(34747),n=a(46770),i=a(25138),s=a(87445),u=a(32947),o=a(57524);let c=e=>{let{severities:t}=e,a=Object.values(t).reduce((e,t)=>e+t,0);return(0,l.jsxs)(r.k,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,l.jsx)(n.B,{"aria-label":"total",style:{minWidth:15,textAlign:s.F2},children:a}),(0,l.jsx)(i.i,{orientation:{default:"vertical"}}),(0,l.jsx)(n.B,{children:(0,l.jsx)(r.k,{children:Object.entries(t).filter(e=>{let[t,a]=e;return a>0}).sort((0,u.A0)(e=>{let[t,a]=e;return t})).reverse().map(e=>{let[t,a]=e;return(0,l.jsx)(n.B,{spacer:{default:"spacerXs"},children:(0,l.jsxs)(r.k,{"aria-label":t,spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,l.jsx)(n.B,{children:(0,l.jsx)(o.o,{value:t,score:null})}),(0,l.jsx)(n.B,{children:a})]})},t)})})})]})}},73227:function(e,t,a){a.d(t,{i:()=>u});var l=a(2926),r=a(87017),n=a(50576),i=a(40371),s=a(63706);let u=()=>({downloadAdvisory:(e,t)=>{(0,i.Em)({client:n.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(a=>{(0,l.saveAs)(new Blob([a.data]),t||"".concat(e,".json"))})},downloadSBOM:(e,t)=>{(0,i.XW)({client:n.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(a=>{(0,l.saveAs)(new Blob([a.data]),t||"".concat(e,".json"))})},downloadSBOMLicenses:e=>{(0,r.Co)(e).then(t=>{var a,r;let n=null,i=null==(r=t.headers)||null==(a=r["content-disposition"])?void 0:a.toString();i&&(n=(0,s.lj)(i)),(0,l.saveAs)(new Blob([t.data]),n||"".concat(e,".tar.gz"))})}})},82413:function(e,t,a){a.d(t,{Ap:()=>h,Ie:()=>v,_g:()=>c});var l=a(79192),r=a(53195),n=a(27378),i=a(7615),s=a(43959);let u=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,o={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:(0,l._)({},o),fixed:(0,l._)({},o),not_affected:(0,l._)({},o),known_not_affected:(0,l._)({},o),under_investigation:(0,l._)({},o)}},d=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let a,n=e.find(e=>u(e,t));if(n)a=[...e.filter(e=>!u(e,n)),(0,r._)((0,l._)({},n),{relatedPackages:[...n.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let l={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};a=[...e.slice(),l]}return a},[]),a=t.reduce((e,t)=>{let a=t.vulnerabilityStatus,n=(0,i.g)(t.vulnerability.average_severity),s=e.vulnerabilityStatus[a];return Object.assign(e,{vulnerabilityStatus:(0,r._)((0,l._)({},e.vulnerabilityStatus),{[a]:{total:s.total+1,severities:(0,r._)((0,l._)({},s.severities),{[n]:s.severities[n]+1})}})})},(0,l._)({},c));return{vulnerabilities:t,summary:a}},h=e=>{let{advisories:t,isFetching:a,fetchError:l}=(0,s.KQ)(e);return{data:n.useMemo(()=>d(t||[]),[t]),isFetching:a,fetchError:l}},v=e=>{let{advisories:t,isFetching:a,fetchError:l}=(0,s.uz)(e);return{data:n.useMemo(()=>(null!=t?t:[]).map(e=>d(e||[])),[t]),isFetching:a,fetchError:l}}},66043:function(e,t,a){a.d(t,{_:()=>u});var l=a(24246),r=a(27378),n=a(24502),i=a(15726),s=a(43959);let u=e=>{let{sbom:t,onClose:a}=e,{pushNotification:u}=r.useContext(i.c),[o,c]=r.useState(""),[d,h]=r.useState("");r.useEffect(()=>{let e=setTimeout(()=>{h(o)},400);return()=>clearTimeout(e)},[o]);let{labels:v}=(0,s.i5)(d),{mutate:p,isPending:y}=(0,s.t9)(()=>{u({title:"Labels updated for SBOM ".concat(t.name),variant:"success"}),a()},e=>{u({title:"Error while updating labels for SBOM ".concat(t.name),variant:"danger"})});return(0,l.jsx)(n.M,{title:"Labels of SBOM: ".concat(t.name),value:t.labels,isDisabled:y,onSave:e=>{p({id:t.id,labels:e})},onClose:a,onInputChange:c,options:v})}},43959:function(e,t,a){a.d(t,{Fz:()=>m,KQ:()=>F,Oh:()=>_,i5:()=>f,km:()=>j,p4:()=>g,qi:()=>w,s5:()=>x,t9:()=>k,uz:()=>S});var l=a(79192),r=a(53195),n=a(70186),i=a(1183),s=a(24038),u=a(68e3),o=a(75503),c=a(16072),d=a(50576),h=a(40371),v=a(95169),p=a(87017),y=a(49988);let b="sboms",f=e=>{let{data:t,isLoading:a,error:l,refetch:r}=(0,i.a)({queryKey:[b,"labels",e],queryFn:()=>(0,h.mh)({client:d.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:(null==t?void 0:t.data)||[],isFetching:a,fetchError:l,refetch:r}},m=function(){var e,t,a;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=(0,y.rm)(s),{q:v}=c,p=(0,n._)(c,["q"]),f=(0,y.Rb)(u),{data:m,isLoading:g,error:x,refetch:j}=(0,i.a)({queryKey:[b,s,f],queryFn:()=>(0,h.Wp)({client:d.L,query:(0,r._)((0,l._)({},p),{q:[v,f].filter(e=>e).join("&")})}),enabled:!o});return{result:{data:(null==m||null==(e=m.data)?void 0:e.items)||[],total:null!=(a=null==m||null==(t=m.data)?void 0:t.total)?a:0,params:s},isFetching:g,fetchError:x,refetch:j}},g=e=>{let{data:t,isLoading:a,error:l}=(0,i.a)({queryKey:[b,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,h._Q)({client:d.L,path:{id:e}}),enabled:void 0!==e});return{sbom:null==t?void 0:t.data,isFetching:a,fetchError:l}},x=(e,t)=>{let a=(0,u.NL)();return(0,o.D)({mutationFn:async e=>(await (0,h.WX)({client:d.L,path:{id:e}})).data,onSuccess:async(t,l)=>{e(t,l),await a.invalidateQueries({queryKey:[b]})},onError:async e=>{t(e),await a.invalidateQueries({queryKey:[b]})}})},j=()=>{let e=(0,u.NL)();return(0,v.V)({parallel:!0,uploadFn:(e,t)=>(0,p.Hb)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[b]})}})},k=(e,t)=>{let a=(0,u.NL)();return(0,o.D)({mutationFn:e=>(0,h.zx)({client:d.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await a.invalidateQueries({queryKey:[b]})},onError:t})},_=function(e){var t,a,r;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:s,isLoading:u,error:o,refetch:c}=(0,i.a)({queryKey:[b,"by-package",e,n],queryFn:()=>(0,h.DU)({client:d.L,query:(0,l._)({purl:e},(0,y.rm)(n))})});return{result:{data:(null==s||null==(t=s.data)?void 0:t.items)||[],total:null!=(r=null==s||null==(a=s.data)?void 0:a.total)?r:0,params:n},isFetching:u,fetchError:o,refetch:c}},F=e=>{let{data:t,isLoading:a,error:l}=(0,i.a)({queryKey:[b,e,"advisory"],queryFn:()=>(0,h.NU)({client:d.L,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:a,fetchError:l}},S=e=>{let t=(0,c.h)({queries:e.map(e=>({queryKey:[b,e,"advisory"],queryFn:()=>(0,h.NU)({client:d.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},w=e=>{let{data:t,isLoading:a,error:l}=(0,i.a)({queryKey:[b,e,"license-ids"],queryFn:()=>(0,h.J4)({client:d.L,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:a,fetchError:l}}}}]);