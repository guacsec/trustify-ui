"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["703"],{24296:function(e,i,l){l.d(i,{a:()=>a});var n=l(62540),r=l(59394),t=l(81595),s=l(40554);let a=e=>e.isFetching?e.isFetchingState||(0,n.jsx)(r.a,{children:(0,n.jsx)(t.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,n.jsx)(s.q,{}):e.children},85790:function(e,i,l){l.d(i,{a:()=>t});var n=l(62540),r=l(69548);let t=e=>{let{value:i}=e;return(0,n.jsx)(n.Fragment,{children:Object.entries(i).map(e=>{let[i,l]=e;return(0,n.jsx)(r.J,{isCompact:!0,children:"".concat(i,"=").concat(l)},"".concat(i,"=").concat(l))})})}},65346:function(e,i,l){l.d(i,{Y:()=>a});var n=l(62540),r=l(63696),t=l(88057),s=l(71284);let a=e=>{let{vulnerabilitiesSummary:i}=e,l=r.useMemo(()=>Object.keys(i.severities).map(e=>{let l=i.severities[e],n=s.Kb[e];return{severity:e,count:l,label:n.name,color:n.color.var}}).sort((0,s.Sx)(e=>e.severity)).reverse(),[i]);return(0,n.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,n.jsx)(t.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:"".concat(i.total),subTitle:"Total vulnerabilities",width:350,legendData:l.map(e=>{let{label:i,count:l}=e;return{name:"".concat(i,": ").concat(l)}}),data:l.map(e=>{let{label:i,count:l}=e;return{x:i,y:l}}),labels:e=>{let{datum:i}=e;return"".concat(i.x,": ").concat(i.y)},colorScale:l.map(e=>{let{color:i}=e;return i})})})}},92107:function(e,i,l){l.d(i,{D:()=>t});var n=l(62540),r=l(69548);let t=e=>{let{error:i}=e;return(0,n.jsxs)(r.J,{color:"red",children:[i.status," Error"]})}},20311:function(e,i,l){l.d(i,{R:()=>t});var n=l(62540),r=l(63696);let t=e=>{let{children:i}=e,[l,t]=r.useState(!1);return(0,n.jsx)(n.Fragment,{children:i(l,t)})}},64377:function(e,i,l){l.d(i,{j:()=>r});var n=l(62540);let r=e=>{let{vulnerability:i}=e;return(0,n.jsxs)("p",{children:[i.withdrawn&&(0,n.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},15461:function(e,i,l){l.d(i,{n:()=>o});var n=l(62540),r=l(28338),t=l(70045),s=l(7261),a=l(86099),d=l(71284),c=l(45969);let o=e=>{let{severities:i}=e,l=Object.values(i).reduce((e,i)=>e+i,0);return(0,n.jsxs)(r.s,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,n.jsx)(t.Z,{"aria-label":"total",style:{minWidth:15,textAlign:a.pG},children:l}),(0,n.jsx)(s.c,{orientation:{default:"vertical"}}),(0,n.jsx)(t.Z,{children:(0,n.jsx)(r.s,{children:Object.entries(i).filter(e=>{let[i,l]=e;return l>0}).sort((0,d.Sx)(e=>{let[i,l]=e;return i})).reverse().map(e=>{let[i,l]=e;return(0,n.jsx)(t.Z,{spacer:{default:"spacerXs"},children:(0,n.jsxs)(r.s,{"aria-label":i,spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,n.jsx)(t.Z,{children:(0,n.jsx)(c.h,{value:i,score:null})}),(0,n.jsx)(t.Z,{children:l})]})},i)})})})]})}},77029:function(e,i,l){l.d(i,{l:()=>t});var n=l(62540),r=l(33468);let t=e=>{let{packageId:i,children:l}=e,{pkg:t,isFetching:s,fetchError:a}=(0,r.Si)(i);return(0,n.jsx)(n.Fragment,{children:l(t,s,a)})}},35913:function(e,i,l){l.d(i,{$:()=>x,G:()=>h});var n=l(32909),r=l(42642),t=l(63696),s=l(27875),a=l(33468);let d=(e,i)=>e.vulnerability.identifier===i.vulnerability.identifier&&e.vulnerabilityStatus===i.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:(0,n._)({},c),fixed:(0,n._)({},c),not_affected:(0,n._)({},c),known_not_affected:(0,n._)({},c),under_investigation:(0,n._)({},c)}},u=e=>{let i=e.flatMap(e=>{var i;return(null!=(i=e.status)?i:[]).map(i=>{let l=(0,s.U)(i.average_severity);return{vulnerability:(0,r._)((0,n._)({},i.vulnerability),{average_severity:l,average_score:i.average_score}),vulnerabilityStatus:i.status,advisory:e}})}).reduce((e,i)=>{let l,t=e.find(e=>d(e,i));if(t)l=[...e.filter(e=>!d(e,t)),(0,r._)((0,n._)({},t),{relatedSboms:[...t.relatedSboms,{advisory:i.advisory}]})];else{let n={vulnerability:i.vulnerability,vulnerabilityStatus:i.vulnerabilityStatus,relatedSboms:[{advisory:i.advisory}]};l=[...e.slice(),n]}return l},[]),l=i.reduce((e,i)=>{let l=i.vulnerabilityStatus,t=i.vulnerability.average_severity,s=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,r._)((0,n._)({},e.vulnerabilityStatus),{[l]:{total:s.total+1,severities:(0,r._)((0,n._)({},s.severities),{[t]:s.severities[t]+1})}})})},(0,n._)({},o));return{vulnerabilities:i,summary:l}},h=e=>{let{pkg:i,isFetching:l,fetchError:n}=(0,a.Si)(e);return{data:t.useMemo(()=>u((null==i?void 0:i.advisories)||[]),[i]),isFetching:l,fetchError:n}},x=e=>({data:t.useMemo(()=>u((null==e?void 0:e.advisories)||[]),[e])})},3652:function(e,i,l){l.d(i,{RQ:()=>o,UI:()=>h,nm:()=>x});var n=l(32909),r=l(42642),t=l(63696),s=l(27875),a=l(30111);let d=(e,i)=>e.vulnerability.identifier===i.vulnerability.identifier&&e.vulnerabilityStatus===i.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:(0,n._)({},c),fixed:(0,n._)({},c),not_affected:(0,n._)({},c),known_not_affected:(0,n._)({},c),under_investigation:(0,n._)({},c)}},u=e=>{let i=e.flatMap(e=>{var i;return(null!=(i=e.status)?i:[]).map(i=>({vulnerability:i,vulnerabilityStatus:i.status,advisory:e,packages:i.packages}))}).reduce((e,i)=>{let l,t=e.find(e=>d(e,i));if(t){let s=e.filter(e=>!d(e,t)),a=t.vulnerability.average_score>i.vulnerability.average_score?t:i;l=[...s,(0,r._)((0,n._)({},a),{relatedPackages:[...t.relatedPackages,{advisory:i.advisory,packages:i.packages}]})]}else{let n={vulnerability:i.vulnerability,vulnerabilityStatus:i.vulnerabilityStatus,relatedPackages:[{advisory:i.advisory,packages:i.packages}]};l=[...e.slice(),n]}return l},[]),l=i.reduce((e,i)=>{let l=i.vulnerabilityStatus,t=(0,s.U)(i.vulnerability.average_severity),a=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,r._)((0,n._)({},e.vulnerabilityStatus),{[l]:{total:a.total+1,severities:(0,r._)((0,n._)({},a.severities),{[t]:a.severities[t]+1})}})})},(0,n._)({},o));return{vulnerabilities:i,summary:l}},h=e=>{let{advisories:i,isFetching:l,fetchError:n}=(0,a.DH)(e);return{data:t.useMemo(()=>u(i||[]),[i]),isFetching:l,fetchError:n}},x=e=>{let{advisories:i,isFetching:l,fetchError:n}=(0,a.zY)(e);return{data:t.useMemo(()=>(null!=i?i:[]).map(e=>u(e||[])),[i]),isFetching:l,fetchError:n}}},49325:function(e,i,l){l.d(i,{tc:()=>a});var n=l(32909),r=l(42642),t=l(31550),s=l(73470);let a=e=>{let i=(e=>{var i;let{persistTo:l="state",persistenceKeyPrefix:r}=e,a=null!=(i=e.defaultActiveTab)?i:{tabKey:e.tabKeys[0]},[d,c]=(0,t.u)((0,n._)({isEnabled:!0,defaultValue:a,persistenceKeyPrefix:r},"urlParams"===l?{persistTo:l,keys:["activeTab"],serialize:e=>({activeTab:(null==e?void 0:e.tabKey)||null}),deserialize:e=>e.activeTab?{tabKey:e.activeTab}:null}:"localStorage"===l||"sessionStorage"===l?{persistTo:l,key:"tab"}:(0,s.xG)(l)?{persistTo:"provider",serialize:l.write,deserialize:()=>l.read()}:{persistTo:"state"}));return{activeTab:d,setActiveTab:c}})(e),l=(e=>{let{tabState:i}=e;return{isTabActive:e=>{var l;return e===(null==(l=i.activeTab)?void 0:l.tabKey)},setActiveTab:e=>{i.setActiveTab({tabKey:e})}}})({tabState:i});return(0,r._)((0,n._)({},e),{state:i,derivedState:l,propHelpers:{getTabsProps:()=>{var e;return{activeKey:null==(e=i.activeTab)?void 0:e.tabKey,onSelect:(e,i)=>{l.setActiveTab(i)}}},getTabProps:e=>({eventKey:e,tabContentId:"".concat(e,"-tab-section")}),getTabContentProps:e=>({id:"".concat(e,"-tab-section"),eventKey:e,hidden:!l.isTabActive(e)})}})}},55178:function(e,i,l){l.d(i,{H:()=>c});var n=l(62540),r=l(15461),t=l(35913),s=l(24296),a=l(6160),d=l(92107);let c=e=>{let{pkg:i,isFetching:l,fetchError:c}=e,{data:o}=(0,t.$)(i);return(0,n.jsx)(s.a,{isFetching:l,fetchError:c,isFetchingState:(0,n.jsx)(a.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,n.jsx)(d.D,{error:e}),children:(0,n.jsx)(r.n,{severities:o.summary.vulnerabilityStatus.affected.severities})})}},79832:function(e,i,l){l.r(i),l.d(i,{default:()=>eA});var n=l(32909),r=l(42642),t=l(62540),s=l(63696),a=l(74343),d=l(68430),c=l(98261),o=l(75530),u=l(54518),h=l(48281),x=l(28338),j=l(70045),p=l(42957),m=l(69548),v=l(90717),b=l(96526),f=l(52993),_=l(84818),y=l(7261),g=l(40989),T=l(60423),S=l(40111),k=l(70414),E=l(66542),P=l(93472),w=l(24773),C=l(8210),K=l(98259),O=l(67458),M=l(89705),B=l(24296),F=l(4392),I=l(99528),N=l(49325),W=l(30111),D=l(51380),A=l(76072),L=l(97299),X=l(17327),Z=l(64361),R=l(71603),V=l(1020),J=l(24974),H=l(21639),U=l(3939),q=l(94279),z=l(16172),Y=l(38927),G=l(80057),Q=l(13021),$=l(10410),ee=l(12852),ei=l(23909),el=l(98345);let en=e=>{let{sbom:i}=e,[l,n]=s.useState(!1),r=()=>{n(!1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(A.x,{hasGutter:!0,children:[(0,t.jsx)(L.E,{md:4,children:(0,t.jsxs)(X.Z,{isFullHeight:!0,children:[(0,t.jsx)(Z.Z,{children:"Metadata"}),(0,t.jsx)(R.b,{children:(0,t.jsxs)(V.B,{children:[(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"Name"}),(0,t.jsx)(U.d,{"aria-label":"SBOM's name",children:i.name})]}),(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"Namespace"}),(0,t.jsx)(U.d,{"aria-label":"SBOM's namespace",children:i.document_id})]}),(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"Data License"}),(0,t.jsx)(U.d,{"aria-label":"SBOM's license",children:i.data_licenses.join(", ")})]})]})})]})}),(0,t.jsx)(L.E,{md:4,children:(0,t.jsxs)(X.Z,{isFullHeight:!0,children:[(0,t.jsx)(Z.Z,{children:"Creation"}),(0,t.jsx)(R.b,{children:(0,t.jsxs)(V.B,{children:[(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"Created"}),(0,t.jsx)(U.d,{"aria-label":"SBOM's creation date",children:(0,ei.Yq)(i.published)})]}),(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"Supplier"}),(0,t.jsx)(U.d,{"aria-label":"SBOM's supplier",children:i.suppliers.join(", ")})]}),(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"Author"}),(0,t.jsx)(U.d,{"aria-label":"SBOM's author",children:i.authors.join(", ")})]})]})})]})}),(0,t.jsx)(L.E,{md:4,children:(0,t.jsxs)(X.Z,{isFullHeight:!0,children:[(0,t.jsx)(Z.Z,{children:"Statistics"}),(0,t.jsx)(R.b,{children:(0,t.jsxs)(V.B,{children:[(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"Size"}),(0,t.jsx)(U.d,{children:(0,D.A)(i.size)})]}),(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"Packages"}),(0,t.jsx)(U.d,{children:i.number_of_packages})]}),(0,t.jsxs)(J.W,{children:[(0,t.jsxs)(H.X,{children:["Labels ","",(0,t.jsx)(w.$n,{variant:w.Ak.link,size:"sm",icon:(0,t.jsx)($.Ay,{}),iconPosition:"end",onClick:()=>n(!0),children:"Edit"})]}),(0,t.jsx)(U.d,{children:(0,t.jsx)(X.Z,{isCompact:!0,children:(0,t.jsx)(R.b,{children:i.labels&&(0,t.jsx)(ee.g,{defaultIsOpen:!0,value:i.labels})})})})]})]})})]})}),(0,t.jsx)(L.E,{md:12,children:(0,t.jsxs)(X.Z,{isFullHeight:!0,children:[(0,t.jsx)(Z.Z,{children:"Package"}),(0,t.jsx)(R.b,{children:(0,t.jsxs)(V.B,{children:[(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"Name"}),(0,t.jsx)(U.d,{children:i.name})]}),(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"Version"}),(0,t.jsx)(U.d,{children:i.described_by.map(e=>e.version).join(", ")})]}),(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"External References"}),(0,t.jsx)(U.d,{children:(0,t.jsxs)(q.B8,{children:[i.described_by.flatMap(e=>e.cpe).map(e=>(0,t.jsx)(z.c,{children:e},e)),i.described_by.flatMap(e=>e.purl).map(e=>(0,t.jsx)(z.c,{children:e.purl},e.uuid))]})})]})]})})]})})]}),(0,t.jsxs)(Y.a,{isOpen:l,variant:"medium",onClose:r,children:[(0,t.jsx)(G.r,{title:"Edit labels"}),(0,t.jsx)(Q.c,{children:(0,t.jsx)(el.f,{sbom:i,onClose:r})})]})]})};var er=l(61360),et=l(35048),es=l(32490),ea=l(52526),ed=l(26917),ec=l(16646),eo=l(21758),eu=l(40384),eh=l(28516),ex=l(78517),ej=l(38139),ep=l(21999),em=l(93826),ev=l(30448),eb=l(73470),ef=l(33468),e_=l(55178),ey=l(77029),eg=l(15461);let eT=e=>{let{sbomId:i}=e,{licenseIds:l}=(0,W.bj)(i),s=(0,eb.MM)({tableName:"package-table",columnNames:{name:"Name",version:"Version",vulnerabilities:"Vulnerabilities",licenses:"Licenses",purls:"PURLs",cpes:"CPEs"},isSortEnabled:!0,sortableColumns:["name"],isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:K._G,title:"Filter text",placeholderText:"Search",type:"search"},{categoryKey:"license",title:"License",placeholderText:"Filter results by license",type:"multiselect",operator:"=",logicOperator:"OR",selectOptions:l.map(e=>({value:e.license_id,label:e.license_name}))}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:d,total:c},isFetching:o,fetchError:u}=(0,ef.sl)(i,(0,eb.Ng)((0,r._)((0,n._)({},s),{hubSortFieldKeys:{name:"name"}}))),h=(0,eb.PB)((0,r._)((0,n._)({},s),{idProperty:"id",currentPageItems:d,totalItemCount:c,isLoading:o})),{currentPageItems:x,numRenderedColumns:j,propHelpers:{toolbarProps:p,filterToolbarProps:m,paginationToolbarItemProps:v,paginationProps:b,tableProps:f,getThProps:_,getTrProps:y,getTdProps:g,getExpandedContentTdProps:T},expansionDerivedState:{isCellExpanded:S}}=h;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(er.M,(0,r._)((0,n._)({},p),{"aria-label":"Package toolbar",children:(0,t.jsxs)(et.P,{children:[(0,t.jsx)(ep.Us,(0,n._)({},m)),(0,t.jsx)(es.T,(0,r._)((0,n._)({},v),{children:(0,t.jsx)(em.n,{idPrefix:"package-table",isTop:!0,paginationProps:b})}))]})})),(0,t.jsxs)(ed.X,(0,r._)((0,n._)({},f),{"aria-label":"Package table",children:[(0,t.jsx)(ec.d,{children:(0,t.jsx)(eo.Tr,{children:(0,t.jsxs)(ev.Ze,(0,r._)((0,n._)({},h),{children:[(0,t.jsx)(eu.Th,(0,n._)({},_({columnKey:"name"}))),(0,t.jsx)(eu.Th,(0,n._)({},_({columnKey:"version"}))),(0,t.jsx)(eu.Th,(0,n._)({},_({columnKey:"vulnerabilities"}))),(0,t.jsx)(eu.Th,(0,n._)({},_({columnKey:"licenses"}))),(0,t.jsx)(eu.Th,(0,n._)({},_({columnKey:"purls"}))),(0,t.jsx)(eu.Th,(0,n._)({},_({columnKey:"cpes"})))]}))})}),(0,t.jsx)(ev.nJ,{isLoading:o,isError:!!u,isNoData:0===c,numRenderedColumns:j,children:null==x?void 0:x.map((e,i)=>(0,t.jsxs)(eh.N,{isExpanded:S(e),children:[(0,t.jsx)(eo.Tr,(0,r._)((0,n._)({},y({item:e})),{children:(0,t.jsxs)(ev.Oi,(0,r._)((0,n._)({},h),{item:e,rowIndex:i,children:[(0,t.jsx)(ex.Td,(0,r._)((0,n._)({width:15},g({columnKey:"name"})),{children:[e.name,e.group].filter(Boolean).join("/")})),(0,t.jsx)(ex.Td,(0,r._)((0,n._)({width:15,modifier:"truncate"},g({columnKey:"version"})),{children:null==e?void 0:e.version})),(0,t.jsx)(ex.Td,(0,r._)((0,n._)({width:10,modifier:"breakWord"},g({columnKey:"vulnerabilities"})),{children:e.purl[0]?(0,t.jsx)(ey.l,{packageId:e.purl[0].uuid,children:(e,i,l)=>(0,t.jsx)(e_.H,{pkg:e,isFetching:i,fetchError:l})}):(0,t.jsx)(eg.n,{severities:{critical:0,high:0,medium:0,low:0,none:0,unknown:0}})})),(0,t.jsxs)(ex.Td,(0,r._)((0,n._)({width:20,modifier:"breakWord"},g({columnKey:"licenses",isCompoundExpandToggle:e.licenses.length>0,item:e,rowIndex:i})),{children:[e.licenses.length," Licenses"]})),(0,t.jsx)(ex.Td,(0,r._)((0,n._)({width:20,modifier:"breakWord"},g({columnKey:"purls",isCompoundExpandToggle:e.purl.length>1,item:e,rowIndex:i})),{children:1===e.purl.length?(0,t.jsx)(a.N_,{to:(0,a.tW)(O.Jh.packageDetails,{packageId:e.purl[0].uuid}),children:e.purl[0].purl}):"".concat(e.purl.length," PURLs")})),(0,t.jsxs)(ex.Td,(0,r._)((0,n._)({width:20,modifier:"breakWord"},g({columnKey:"cpes",isCompoundExpandToggle:e.cpe.length>0,item:e,rowIndex:i})),{children:[e.cpe.length," CPEs"]}))]}))})),S(e)?(0,t.jsx)(eo.Tr,{isExpanded:!0,children:(0,t.jsx)(ex.Td,(0,r._)((0,n._)({},T({item:e})),{className:ea.A.pLg,children:(0,t.jsx)(ej.g,{children:(0,t.jsxs)("div",{className:ea.A.ptLg,children:[S(e,"licenses")?(0,t.jsx)(q.B8,{isPlain:!0,children:e.licenses.map(i=>{let l;return(0,t.jsx)(z.c,{children:(l=i.license_name,e.licenses_ref_mapping.reduce((e,i)=>{let{license_id:l,license_name:n}=i;return e.replaceAll(l,n)},"".concat(l)))},"".concat(i.license_name,"-").concat(i.license_type))})}):null,S(e,"purls")?(0,t.jsx)(q.B8,{isPlain:!0,children:e.purl.map(e=>(0,t.jsx)(z.c,{children:(0,t.jsx)(a.N_,{to:(0,a.tW)(O.Jh.packageDetails,{packageId:e.uuid}),children:e.purl})},e.uuid))}):null,S(e,"cpes")?(0,t.jsx)(q.B8,{isPlain:!0,children:e.cpe.map(e=>(0,t.jsx)(z.c,{children:e},e))}):null]})})}))}):null]},e.id))})]})),(0,t.jsx)(em.n,{idPrefix:"package-table",isTop:!1,paginationProps:b})]})};var eS=l(95285),ek=l.n(eS),eE=l(38914),eP=l(57901),ew=l(59771),eC=l(27875),eK=l(85790),eO=l(65346),eM=l(45969),eB=l(20311),eF=l(64377),eI=l(3652),eN=l(21328);let eW=e=>{let{sbomId:i}=e,{sbom:l,isFetching:d,fetchError:c}=(0,W.rj)(i),{data:{vulnerabilities:o,summary:u},isFetching:h,fetchError:x}=(0,eI.UI)(i),j=s.useMemo(()=>o.filter(e=>"affected"===e.vulnerabilityStatus),[o]),p=s.useMemo(()=>j.map(e=>{let i=e.relatedPackages.flatMap(e=>e.packages).reduce((e,i)=>(e.find(e=>e.id===i.id)||e.push(i),e),[]);return(0,r._)((0,n._)({},e),{summary:{totalPackages:i.length,allPackages:i}})}),[j]),m=(0,eN.f)(p,e=>"".concat(e.vulnerability.identifier,"-").concat(e.vulnerabilityStatus)),v=(0,eb.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:m,isLoading:h,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>{var i,l;return{id:e.vulnerability.identifier,cvss:e.vulnerability.average_score,affectedDependencies:e.summary.totalPackages,published:(null==(i=e.vulnerability)?void 0:i.published)?ek()(e.vulnerability.published).valueOf():0,updated:(null==(l=e.vulnerability)?void 0:l.modified)?ek()(e.vulnerability.modified).valueOf():0}},isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:b,numRenderedColumns:f,propHelpers:{toolbarProps:_,paginationToolbarItemProps:y,paginationProps:g,tableProps:T,getThProps:S,getTrProps:k,getTdProps:E,getExpandedContentTdProps:P},expansionDerivedState:{isCellExpanded:w}}=v;return(0,t.jsxs)(eE.B,{hasGutter:!0,children:[(0,t.jsx)(eP.a,{children:(0,t.jsx)(X.Z,{children:(0,t.jsx)(R.b,{children:(0,t.jsx)(B.a,{isFetching:d||h,fetchError:c,children:(0,t.jsxs)(A.x,{hasGutter:!0,children:[(0,t.jsx)(L.E,{md:6,children:(0,t.jsx)(eO.Y,{vulnerabilitiesSummary:u.vulnerabilityStatus.affected})}),(0,t.jsx)(L.E,{md:6,children:(0,t.jsxs)(V.B,{children:[(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"Name"}),(0,t.jsx)(U.d,{children:null==l?void 0:l.name})]}),(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"Version"}),(0,t.jsx)(U.d,{children:null==l?void 0:l.described_by.map(e=>e.version).join(", ")})]}),(0,t.jsxs)(J.W,{children:[(0,t.jsx)(H.X,{children:"Creation date"}),(0,t.jsx)(U.d,{children:(0,ei.Yq)(null==l?void 0:l.published)})]})]})})]})})})})}),(0,t.jsxs)(eP.a,{children:[(0,t.jsx)(er.M,(0,r._)((0,n._)({},_),{children:(0,t.jsx)(et.P,{children:(0,t.jsx)(es.T,(0,r._)((0,n._)({},y),{children:(0,t.jsx)(em.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:g})}))})})),(0,t.jsxs)(ed.X,(0,r._)((0,n._)({},T),{"aria-label":"Vulnerability table",children:[(0,t.jsx)(ec.d,{children:(0,t.jsx)(eo.Tr,{children:(0,t.jsxs)(ev.Ze,(0,r._)((0,n._)({},v),{children:[(0,t.jsx)(eu.Th,(0,n._)({},S({columnKey:"id"}))),(0,t.jsx)(eu.Th,(0,n._)({},S({columnKey:"description"}))),(0,t.jsx)(eu.Th,(0,n._)({},S({columnKey:"cvss"}))),(0,t.jsx)(eu.Th,(0,n._)({},S({columnKey:"affectedDependencies"}))),(0,t.jsx)(eu.Th,(0,n._)({},S({columnKey:"published"}))),(0,t.jsx)(eu.Th,(0,n._)({},S({columnKey:"updated"})))]}))})}),(0,t.jsx)(ev.nJ,{isLoading:h,isError:!!x,isNoData:0===m.length,numRenderedColumns:f,children:null==b?void 0:b.map((e,i)=>{var l,s;return(0,t.jsxs)(eh.N,{isExpanded:w(e),children:[(0,t.jsx)(eo.Tr,(0,r._)((0,n._)({},k({item:e})),{children:(0,t.jsxs)(ev.Oi,(0,r._)((0,n._)({},v),{item:e,rowIndex:i,children:[(0,t.jsx)(ex.Td,(0,r._)((0,n._)({width:15,modifier:"breakWord"},E({columnKey:"id"})),{children:(0,t.jsx)(a.N_,{to:(0,a.tW)(O.Jh.vulnerabilityDetails,{vulnerabilityId:e.vulnerability.identifier}),children:e.vulnerability.identifier})})),(0,t.jsx)(eB.R,{children:(i,l)=>(0,t.jsx)(ex.Td,(0,r._)((0,n._)({width:35,modifier:"truncate",onFocus:()=>l(!0),onBlur:()=>l(!1),tabIndex:0},E({columnKey:"description"})),{children:(0,t.jsx)(ew.mA,{focused:i,wrapModifier:"truncate",children:e.vulnerability&&(0,t.jsx)(eF.j,{vulnerability:e.vulnerability})})}))}),(0,t.jsx)(ex.Td,(0,r._)((0,n._)({width:10},E({columnKey:"cvss"})),{children:(0,t.jsx)(eM.h,{value:(0,eC.U)(e.vulnerability.average_severity),score:e.vulnerability.average_score,showLabel:!0,showScore:!0})})),(0,t.jsx)(ex.Td,(0,r._)((0,n._)({width:15,modifier:"truncate"},E({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:i})),{children:e.summary.totalPackages})),(0,t.jsx)(ex.Td,(0,r._)((0,n._)({width:10,modifier:"truncate"},E({columnKey:"published"})),{children:(0,ei.Yq)(null==(l=e.vulnerability)?void 0:l.published)})),(0,t.jsx)(ex.Td,(0,r._)((0,n._)({width:10,modifier:"truncate"},E({columnKey:"updated"})),{children:(0,ei.Yq)(null==(s=e.vulnerability)?void 0:s.modified)}))]}))})),w(e)?(0,t.jsx)(eo.Tr,{isExpanded:!0,children:(0,t.jsx)(ex.Td,(0,r._)((0,n._)({},P({item:e})),{children:(0,t.jsx)(ej.g,{children:w(e,"affectedDependencies")?(0,t.jsxs)(ed.X,{variant:"compact",children:[(0,t.jsx)(ec.d,{children:(0,t.jsxs)(eo.Tr,{children:[(0,t.jsx)(eu.Th,{children:"Type"}),(0,t.jsx)(eu.Th,{children:"Namespace"}),(0,t.jsx)(eu.Th,{children:"Name"}),(0,t.jsx)(eu.Th,{children:"Version"}),(0,t.jsx)(eu.Th,{children:"Path"}),(0,t.jsx)(eu.Th,{children:"Qualifiers"})]})}),(0,t.jsx)(eh.N,{children:e.summary.allPackages.flatMap(e=>e.name&&0===e.purl.length?[{parentName:e.name}]:e.purl.map(i=>({parentName:e.name,purlSummary:i}))).map((e,i)=>{if(e.purlSummary){let i=(0,ei.fe)(e.purlSummary.purl);return(0,t.jsxs)(eo.Tr,{children:[(0,t.jsx)(ex.Td,{children:null==i?void 0:i.type}),(0,t.jsx)(ex.Td,{children:null==i?void 0:i.namespace}),(0,t.jsx)(ex.Td,{children:(0,t.jsx)(a.N_,{to:(0,a.tW)(O.Jh.packageDetails,{packageId:e.purlSummary.uuid}),children:null==i?void 0:i.name})}),(0,t.jsx)(ex.Td,{children:null==i?void 0:i.version}),(0,t.jsx)(ex.Td,{children:null==i?void 0:i.path}),(0,t.jsx)(ex.Td,{children:(null==i?void 0:i.qualifiers)&&(0,t.jsx)(eK.a,{value:null==i?void 0:i.qualifiers})})]},e.purlSummary.uuid)}return(0,t.jsxs)(eo.Tr,{children:[(0,t.jsx)(ex.Td,{}),(0,t.jsx)(ex.Td,{}),(0,t.jsx)(ex.Td,{children:e.parentName}),(0,t.jsx)(ex.Td,{}),(0,t.jsx)(ex.Td,{}),(0,t.jsx)(ex.Td,{})]},"".concat(e.parentName,"-").concat(i,"-name"))})})]}):null})}))}):null]},e._ui_unique_id)})})]})),(0,t.jsx)(em.n,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:g})]})]})};var eD=l(52673);let eA=()=>{var e,i;let l=(0,a.Zp)(),{pushNotification:D}=s.useContext(F.K),A=(0,O.Lu)("sbomId"),{sbom:L,isFetching:X,fetchError:Z}=(0,W.rj)(A),[R,V]=s.useState(!1),J=()=>{V(!R)},{downloadSBOM:H,downloadSBOMLicenses:U}=(0,I.m)(),[q,z]=s.useState(!1),{mutate:Y,isPending:G}=(0,W.l6)(e=>{z(!1),D({title:(0,K.B7)(e),variant:"success"}),l("/sboms")},e=>{D({title:(0,K.Ut)(e),variant:"danger"})}),{propHelpers:{getTabsProps:Q,getTabProps:$,getTabContentProps:ee}}=(0,N.tc)({persistenceKeyPrefix:"sd",persistTo:"urlParams",tabKeys:["info","packages","vulnerabilities"]}),ei=s.createRef(),el=s.createRef(),er=s.createRef(),et=s.createRef();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eD.T,{title:null==L?void 0:L.name}),(0,t.jsx)(d.d8,{type:"breadcrumb",children:(0,t.jsxs)(c.Q,{children:[(0,t.jsx)(o.J,{children:(0,t.jsx)(a.N_,{to:O.Jh.sboms,children:"SBOMs"})}),(0,t.jsx)(o.J,{isActive:!0,children:"SBOM details"})]})}),(0,t.jsx)(d.d8,{children:(0,t.jsxs)(u.B,{children:[(0,t.jsx)(h.o,{isFilled:!0,children:(0,t.jsxs)(x.s,{children:[(0,t.jsx)(j.Z,{spacer:{default:"spacerSm"},children:(0,t.jsx)(p.U,{children:(0,t.jsx)(p.U,{component:"h1",children:null!=(i=null!=(e=null==L?void 0:L.name)?e:A)?i:""})})}),(0,t.jsx)(j.Z,{children:(null==L?void 0:L.labels.type)&&(0,t.jsx)(m.J,{color:"blue",children:null==L?void 0:L.labels.type})})]})}),(0,t.jsx)(h.o,{children:L&&(0,t.jsx)(v.m,{isOpen:R,onSelect:()=>V(!1),onOpenChange:e=>V(e),popperProps:{position:"right"},toggle:e=>(0,t.jsx)(b.S3,{ref:e,onClick:J,isExpanded:R,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,t.jsxs)(f.Q,{children:[(0,t.jsx)(_.t,{onClick:()=>{A&&H(A,(null==L?void 0:L.name)?"".concat(null==L?void 0:L.name,".json"):"".concat(A,".json"))},children:"Download SBOM"},"sbom"),(0,t.jsx)(_.t,{onClick:()=>{A&&U(A)},children:"Download License Report"},"license"),(0,t.jsx)(y.c,{component:"li"},"separator"),(0,t.jsx)(_.t,{onClick:()=>z(!0),children:"Delete"},"delete")]})})})]})}),(0,t.jsx)(d.d8,{children:(0,t.jsxs)(g.t,(0,r._)((0,n._)({mountOnEnter:!0},Q()),{"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,t.jsx)(T.o,(0,r._)((0,n._)({},$("info")),{title:(0,t.jsx)(S.V,{children:"Info"}),tabContentRef:ei})),(0,t.jsx)(T.o,(0,r._)((0,n._)({},$("packages")),{title:(0,t.jsx)(S.V,{children:"Packages"}),tabContentRef:el})),(0,t.jsx)(T.o,(0,r._)((0,n._)({},$("vulnerabilities")),{title:(0,t.jsx)(S.V,{children:"Vulnerabilities"}),tabContentRef:er,actions:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.o,{ref:et,children:(0,t.jsx)(C.Ay,{})}),(0,t.jsx)(E.A,{triggerRef:et,bodyContent:(0,t.jsx)("div",{children:"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed."})})]})}))]}))}),(0,t.jsxs)(d.d8,{children:[(0,t.jsx)(P.J,(0,r._)((0,n._)({},ee("info")),{ref:ei,"aria-label":"Information of the SBOM",children:(0,t.jsx)(B.a,{isFetching:X,fetchError:Z,children:L&&(0,t.jsx)(en,{sbom:L})})})),(0,t.jsx)(P.J,(0,r._)((0,n._)({},ee("packages")),{ref:el,"aria-label":"Packages within the SBOM",children:A&&(0,t.jsx)(eT,{sbomId:A})})),(0,t.jsx)(P.J,(0,r._)((0,n._)({},ee("vulnerabilities")),{ref:er,"aria-label":"Vulnerabilities within the SBOM",children:A&&(0,t.jsx)(eW,{sbomId:A})}))]}),(0,t.jsx)(M.T,(0,r._)((0,n._)({},(0,K.zK)(L)),{inProgress:G,titleIconVariant:"warning",isOpen:q,confirmBtnVariant:w.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>z(!1),onClose:()=>z(!1),onConfirm:()=>{L&&Y(L.id)}}))]})}},98345:function(e,i,l){l.d(i,{f:()=>d});var n=l(62540),r=l(63696),t=l(91242),s=l(4392),a=l(30111);let d=e=>{let{sbom:i,onClose:l}=e,{pushNotification:d}=r.useContext(s.K),[c,o]=r.useState(""),[u,h]=r.useState("");r.useEffect(()=>{let e=setTimeout(()=>{h(c)},400);return()=>clearTimeout(e)},[c]);let{labels:x}=(0,a._P)(u),{mutate:j,isPending:p}=(0,a.cF)(()=>{d({title:"Labels updated for SBOM ".concat(i.name),variant:"success"}),l()},e=>{d({title:"Error while updating labels for SBOM ".concat(i.name),variant:"danger"})});return(0,n.jsx)(t.e,{title:"Labels of SBOM: ".concat(i.name),value:i.labels,isDisabled:p,onSave:e=>{j({id:i.id,labels:e})},onClose:l,onInputChange:o,options:x})}},21328:function(e,i,l){l.d(i,{f:()=>a});var n=l(32909),r=l(42642),t=l(63696),s=l(98259);let a=(e,i)=>(0,t.useMemo)(()=>e&&0!==e.length?e.map(e=>(0,r._)((0,n._)({},e),{[s.FA]:i(e)})):[],[e,i])}}]);