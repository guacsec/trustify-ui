"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["245"],{32947:function(e,t,r){r.d(t,{A0:()=>g,V4:()=>y,W:()=>x,nE:()=>f});var a=r(91566),l=r(839),n=r(73657),i=r(20644),s=r(89502),o=r(7596),d=r(1811),c=r(24917),u=r(4720),h=r(54178),p=r(37106),v=r(34313);let y={unknown:{name:"Unknown",color:d.P,progressProps:{variant:void 0},icon:a.M$},none:{name:"None",color:c.E,progressProps:{variant:void 0},icon:l.f6},low:{name:"Low",color:u.c,progressProps:{variant:void 0},icon:n._$},medium:{name:"Medium",color:h.L,progressProps:{variant:"warning"},icon:i.zI},high:{name:"High",color:p.H,progressProps:{variant:"danger"},icon:s.E2},critical:{name:"Critical",color:v.J,progressProps:{variant:"danger"},icon:o.ki}},m=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function g(e){return(t,r)=>m(e(t))-m(e(r))}let x=e=>{let{key:t,value:r}=e;return"".concat(r?"".concat(t,"=").concat(r):"".concat(t))},f=e=>{let[t,r]=e.split("=");return{key:t,value:null!=r?r:""}}},7615:function(e,t,r){r.d(t,{g:()=>a});let a=e=>null!=e?e:"unknown"},87017:function(e,t,r){r.d(t,{Co:()=>p,Cu:()=>u,Hb:()=>h});var a=r(79192),l=r(53195),n=r(70233),i=r(74502);r(41947);let s="/api",o="".concat(s,"/v2/advisory"),d="".concat(s,"/v2/sbom"),c=e=>{let t="application/json";return e.name.endsWith(".bz2")&&(t="application/json+bzip2"),t},u=(e,t)=>{let r=e.get(i.TB);return n.Z.post("".concat(o),r,(0,l._)((0,a._)({},t),{headers:{"Content-Type":c(r)}}))},h=(e,t)=>{let r=e.get(i.TB);return n.Z.post("".concat(d),r,(0,l._)((0,a._)({},t),{headers:{"Content-Type":c(r)}}))},p=e=>n.Z.get("".concat(d,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},37818:function(e,t,r){r.d(t,{u:()=>s});var a=r(24246),l=r(8305),n=r(13754),i=r(39826);let s=e=>e.isFetching?e.isFetchingState||(0,a.jsx)(l.b,{children:(0,a.jsx)(n.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,a.jsx)(i.y,{}):e.children},68057:function(e,t,r){r.d(t,{V:()=>s});var a=r(24246),l=r(27378),n=r(63763),i=r(32947);let s=e=>{let{vulnerabilitiesSummary:t}=e,r=l.useMemo(()=>Object.keys(t.severities).map(e=>{let r=t.severities[e],a=i.V4[e];return{severity:e,count:r,label:a.name,color:a.color.value}}).sort((0,i.A0)(e=>e.severity)).reverse(),[t]);return(0,a.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,a.jsx)(n.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:"".concat(t.total),subTitle:"Total vulnerabilities",width:350,legendData:r.map(e=>{let{label:t,count:r}=e;return{name:"".concat(t,": ").concat(r)}}),data:r.map(e=>{let{label:t,count:r}=e;return{x:t,y:r}}),labels:e=>{let{datum:t}=e;return"".concat(t.x,": ").concat(t.y)},colorScale:r.map(e=>{let{color:t}=e;return t})})})}},39826:function(e,t,r){r.d(t,{y:()=>s});var a=r(24246),l=r(10707),n=r(16668),i=r(42160);let s=()=>(0,a.jsx)(l.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:i.ZP,variant:l.IQ.sm,children:(0,a.jsx)(n.B,{children:"There was an error retrieving data. Check your connection and try again."})})},82413:function(e,t,r){r.d(t,{A:()=>h,I:()=>p});var a=r(79192),l=r(53195),n=r(27378),i=r(7615),s=r(43959);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,d={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:(0,a._)({},d),fixed:(0,a._)({},d),not_affected:(0,a._)({},d),known_not_affected:(0,a._)({},d)}},u=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let r,n=e.find(e=>o(e,t));if(n)r=[...e.filter(e=>!o(e,n)),(0,l._)((0,a._)({},n),{relatedPackages:[...n.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};r=[...e.slice(),a]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,n=(0,i.g)(t.vulnerability.average_severity),s=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:(0,l._)((0,a._)({},e.vulnerabilityStatus),{[r]:{total:s.total+1,severities:(0,l._)((0,a._)({},s.severities),{[n]:s.severities[n]+1})}})})},(0,a._)({},c));return{vulnerabilities:t,summary:r}},h=e=>{let{advisories:t,isFetching:r,fetchError:a}=(0,s.KQ)(e);return{data:n.useMemo(()=>u(t||[]),[t]),isFetching:r,fetchError:a}},p=e=>{let{advisories:t,isFetching:r,fetchError:a}=(0,s.uz)(e);return{data:n.useMemo(()=>(null!=t?t:[]).map(e=>u(e||[])),[t]),isFetching:r,fetchError:a}}},95169:function(e,t,r){r.d(t,{V:()=>u});var a=r(79192),l=r(53195),n=r(27378),i=r(74502),s=r(70233);let o="cancelled",d=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),c=(e,t)=>{switch(t.type){case"queueUpload":return(0,l._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,l._)((0,a._)({},e.uploads.get(t.payload.file)||d()),{status:"queued",cancelFn:t.payload.cancelFn}))});case"updateUploadProgress":return(0,l._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,l._)((0,a._)({},e.uploads.get(t.payload.file)||d()),{progress:t.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,l._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,l._)((0,a._)({},e.uploads.get(t.payload.file)||d()),{status:"complete",response:t.payload.response}))});case"finishUploadWithError":var r;return(0,l._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,l._)((0,a._)({},e.uploads.get(t.payload.file)||d()),{status:"complete",error:t.payload.error,wasCancelled:(null==(r=t.payload.error)?void 0:r.message)===o}))});case"removeUpload":{let r=new Map(e.uploads);return r.delete(t.payload.file),(0,l._)((0,a._)({},e),{uploads:r})}default:throw Error()}},u=e=>{let{parallel:t,uploadFn:r,onSuccess:a,onError:l}=e,[d,u]=n.useReducer(c,{uploads:new Map});return{uploads:d.uploads,handleUpload:e=>{let n=[];for(let t=0;t<e.length;t++){let r=e[t],d=new FormData;d.set(i.TB,r);let c=s.Z.CancelToken.source(),h={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var t;let a=null!=(t=e.total)?t:1;u({type:"updateUploadProgress",payload:{file:r,progress:Math.round(e.loaded/a*100)}})},cancelToken:c.token};u({type:"queueUpload",payload:{file:r,cancelFn:c}});let p={formData:d,config:h,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:r,response:e}}),a&&a(e,r)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:r,error:e}}),e.message!==o&&l&&l(e,r)}};n.push(p)}if(t)for(let e of n)r(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else n.reduce(async(e,t)=>(await e,r(t.formData,t.config).then(t.thenFn).catch(t.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var t,r;null==(r=d.uploads.get(e))||null==(t=r.cancelFn)||t.cancel(o)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},21629:function(e,t,r){r.r(t),r.d(t,{default:()=>ey});var a=r(24246),l=r(45043),n=r(27317),i=r(93095),s=r(14935),o=r(46403),d=r(65783),c=r(74485),u=r(76228),h=r(57518),p=r(24216),v=r(13864),y=r(78531),m=r(44870),g=r(93591),x=r(31757),f=r(87069),j=r(51527),b=r(87727),F=r(3498),_=r(68802),w=r(10707),k=r(16668),S=r(30329),q=r(50689),E=r(67761),P=r(81391),C=r(32947),M=r(37818),L=r(82413),B=r(17598),O=r(43959),T=r(9839),K=r(63706);let U=[{severity:"critical"},{severity:"high"},{severity:"medium"},{severity:"low"},{severity:"none"},{severity:"unknown"}],D=()=>{var e,t,r,l,D,V;let I=(0,s.s0)(),{result:{data:N,total:W},isFetching:A,fetchError:Q}=(0,O.Fz)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),{data:z,isFetching:G,fetchError:Z}=(0,L.I)(N.map(e=>e.id)),H=z.map(e=>e.summary.vulnerabilityStatus.affected.total).every(e=>0===e),R=(e,t)=>"".concat(" ".repeat(t+1)).concat(e.name),{result:{data:$,total:Y},isFetching:J,fetchError:X}=(0,B.N7)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}});return(0,a.jsxs)(x.Z,{children:[(0,a.jsx)(f.l,{children:"Dashboard"}),(0,a.jsx)(j.e,{children:(0,a.jsxs)(b.r,{children:[(0,a.jsx)(F.P,{md:6,children:(0,a.jsx)(M.u,{isFetching:A||G,fetchError:Q||Z.some(e=>!!e),children:(0,a.jsxs)(n.K,{hasGutter:!0,children:[(0,a.jsx)(i.v,{children:(0,a.jsx)(_.V,{children:"Below is a summary of Vulnerability status for the last 10 ingested SBOMs. To view the details, click on an SBOM name. You can also select up to 4 SBOMs to watch."})}),(0,a.jsx)(i.v,{children:N.length>0?(0,a.jsx)("div",{style:{height:320},children:(0,a.jsxs)(c.k,{ariaDesc:"SBOM summary status",domainPadding:{x:[30,25]},legendData:U.map(e=>({name:C.V4[e.severity].name})),legendPosition:"bottom-left",height:375,name:"sbom-summary-status",padding:{bottom:75,left:330,right:50,top:50},themeColor:u.n.multiOrdered,width:700,legendComponent:(0,a.jsx)(h.Q,{y:10,x:200,colorScale:U.map(e=>C.V4[e.severity].color.value)}),children:[(0,a.jsx)(p.C,{label:"Products",axisLabelComponent:(0,a.jsx)(v.D,{dx:0,x:15,y:140}),tickLabelComponent:(0,a.jsx)(v.D,{className:"pf-v6-c-button pf-m-link pf-m-inline",style:[{fill:"#0066cc"}],events:{onClick:e=>{let t=e.target.innerHTML,r=N.find((e,r)=>R(e,r)===t);r&&I((0,o.Gn)(T.nB.sbomDetails,{sbomId:r.id}))}}})}),(0,a.jsx)(p.C,{dependentAxis:!0,showGrid:!0,tickValues:H?[1,2,3,4,5,6,7,8,9,10]:void 0,label:"Vulnerabilities by Severity",fixLabelOverlap:!0}),(0,a.jsx)(y.K,{horizontal:!0,colorScale:U.map(e=>C.V4[e.severity].color.value),children:U.map(e=>{let t=C.V4[e.severity];return(0,a.jsx)(m.B,{labelComponent:(0,a.jsx)(g.h,{constrainToVisibleArea:!0}),data:z.map((r,a)=>{let{summary:{vulnerabilityStatus:{affected:l}}}=r,n=N[a],i=e.severity,s=l.severities[i];return{x:R(n,a),y:s,label:"".concat(t.name,": ").concat(s)}})},e.severity)})})]})}):(0,a.jsx)(w.ub,{headingLevel:"h4",titleText:"There is nothing here yet",variant:w.IQ.xs,children:(0,a.jsx)(k.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to see your overview."})})})]})})}),(0,a.jsx)(F.P,{md:6,children:(0,a.jsx)(M.u,{isFetching:J||A,fetchError:X||Q,children:(0,a.jsxs)(b.r,{hasGutter:!0,children:[(0,a.jsx)(F.P,{md:6,children:(0,a.jsx)(S.o,{children:(0,a.jsxs)(q.g,{children:[(0,a.jsx)(E.M,{children:"Last SBOM ingested"}),(0,a.jsx)(P.b,{children:(0,a.jsxs)(n.K,{children:[(0,a.jsx)(i.v,{children:(0,K.o0)(null==N||null==(e=N[0])?void 0:e.ingested)}),(0,a.jsx)(i.v,{children:(null==N?void 0:N[0])&&(0,a.jsx)(d.rU,{to:(0,o.Gn)(T.nB.sbomDetails,{sbomId:null==N||null==(t=N[0])?void 0:t.id}),children:null==N||null==(r=N[0])?void 0:r.name})})]})})]})})}),(0,a.jsx)(F.P,{md:6,children:(0,a.jsx)(S.o,{children:(0,a.jsxs)(q.g,{children:[(0,a.jsx)(E.M,{children:"Total SBOMs"}),(0,a.jsx)(P.b,{children:W})]})})}),(0,a.jsx)(F.P,{md:6,children:(0,a.jsx)(S.o,{children:(0,a.jsxs)(q.g,{children:[(0,a.jsx)(E.M,{children:"Last Advisory ingested"}),(0,a.jsx)(P.b,{children:(0,a.jsxs)(n.K,{children:[(0,a.jsx)(i.v,{children:(0,K.o0)(null==$||null==(l=$[0])?void 0:l.ingested)}),(0,a.jsx)(i.v,{children:(null==$?void 0:$[0])&&(0,a.jsx)(d.rU,{to:(0,o.Gn)(T.nB.advisoryDetails,{advisoryId:null==$||null==(D=$[0])?void 0:D.uuid}),children:null==$||null==(V=$[0])?void 0:V.document_id})})]})})]})})}),(0,a.jsx)(F.P,{md:6,children:(0,a.jsx)(S.o,{children:(0,a.jsxs)(q.g,{children:[(0,a.jsx)(E.M,{children:"Total Advisories"}),(0,a.jsx)(P.b,{children:Y})]})})})]})})})]})})]})};var V=r(27378),I=r(8305),N=r(13754),W=r(79192),A=r(53195),Q=r(15726),z=r(1183),G=r(68e3),Z=r(75503),H=r(50576),R=r(40371);let $="watched-sboms",Y="dashboard",J=V.createContext({}),X=e=>{let{children:t}=e,{pushNotification:r}=V.useContext(Q.c),{sboms:l,isFetching:n,fetchError:i}=(()=>{let{data:e,isLoading:t,error:r}=(0,z.a)({queryKey:[Y,$],queryFn:async()=>{try{return(await (0,R.JM)({client:H.L,path:{key:$}})).data}catch(e){if(404===e.status)return{sbom1Id:null,sbom2Id:null,sbom3Id:null,sbom4Id:null}}}});return{sboms:e,isFetching:t,fetchError:r}})(),{mutate:s}=((e,t)=>{let r=(0,G.NL)();return(0,Z.D)({mutationFn:e=>(0,R.yu)({client:H.L,path:{key:$},body:e}),onSuccess:async(t,a)=>{e(),await r.invalidateQueries({queryKey:[Y,$]})},onError:t})})(()=>{},e=>{r({title:"Error while updating the user preferences",variant:"danger"})});return(0,a.jsx)(J.Provider,{value:{sboms:l,isFetching:n,fetchError:i,patch:(e,t)=>{s((0,A._)((0,W._)({},l),{[e]:t}))}},children:t})};var ee=r(46039),et=r(18037),er=r(24620),ea=r(9426),el=r(32050),en=r(99589),ei=r(78700),es=r(32623),eo=r(42364),ed=r(29765),ec=r(21843),eu=r(68057);let eh=e=>{let{sbomId:t}=e,{data:r,isFetching:l,fetchError:n}=(0,L.A)(t);return(0,a.jsx)(M.u,{isFetching:l,fetchError:n,children:(0,a.jsx)(eu.V,{vulnerabilitiesSummary:r.summary.vulnerabilityStatus.affected})})},ep=e=>{let{fieldName:t,sbomId:r}=e,{patch:l}=V.useContext(J),s=V.useRef(null),[c,u]=V.useState(""),[h,p]=V.useState("");V.useEffect(()=>{let e=setTimeout(()=>{p(c)},500);return()=>clearTimeout(e)},[c]);let[v,y]=V.useState(!1),{sbom:m,isFetching:g,fetchError:b}=(0,O.p4)(null!=r?r:void 0),{result:{data:F}}=(0,O.Fz)({filters:[{field:"",operator:"~",value:h}],page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),_=()=>{y(!1)},S=()=>{y(!v)},q=()=>{v?c||_():y(!0)},E=(e,t)=>{u(t)},P=()=>{var e;u(""),null==s||null==(e=s.current)||e.focus()};return(0,a.jsxs)(x.Z,{isFullHeight:!0,children:[(0,a.jsxs)(M.u,{isFetching:g,fetchError:b,children:[m&&(0,a.jsx)(f.l,{className:ec.Z.textBreakWord,children:null==m?void 0:m.name}),(0,a.jsx)(j.e,{children:r?(0,a.jsxs)(n.K,{children:[(0,a.jsx)(i.v,{isFilled:!0,children:(0,a.jsx)(eh,{sbomId:r})}),(0,a.jsx)(i.v,{children:(0,a.jsx)(d.rU,{to:(0,o.Gn)(T.nB.sbomDetails,{sbomId:r}),children:"View Details"})})]}):(0,a.jsx)(w.ub,{headingLevel:"h4",titleText:"There is nothing here yet",variant:w.IQ.xs,children:(0,a.jsx)(k.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to change the SBOMs you would like to track."})})})]}),(0,a.jsx)(ee.e,{children:(0,a.jsx)(et.P,{shouldFocusFirstItemOnOpen:!1,isOpen:v,onSelect:(e,r)=>{r&&l(t,r),_()},onOpenChange:e=>{e||_()},toggle:e=>(0,a.jsx)(er.O_,{ref:e,variant:"typeahead",onClick:S,isExpanded:v,isFullWidth:!0,children:(0,a.jsxs)(ea.W,{isPlain:!0,children:[(0,a.jsx)(el.v,{autoComplete:"off",value:c,onClick:q,onChange:E,innerRef:s,isExpanded:v,placeholder:"Select a new SBOM to watch"}),(0,a.jsx)(en.t,(0,A._)((0,W._)({},c?{}:{style:{display:"none"}}),{children:(0,a.jsx)(ei.zx,{icon:(0,a.jsx)(ed.ZP,{"aria-hidden":!0}),variant:"plain",onClick:P,"aria-label":"Clear input value"})}))]})}),children:(0,a.jsx)(es.E,{children:F.map(e=>(0,a.jsx)(eo.$,{value:e.id,children:e.name},e.id))})})})]})},ev=()=>{let{sboms:e,isFetching:t,fetchError:r}=V.useContext(J);return(0,a.jsx)(M.u,{isFetching:t,fetchError:r,isFetchingState:(0,a.jsx)(b.r,{hasGutter:!0,children:Array.from([,,,,].keys()).map(e=>(0,a.jsx)(F.P,{md:3,children:(0,a.jsx)(x.Z,{children:(0,a.jsx)(j.e,{children:(0,a.jsx)(I.b,{children:(0,a.jsx)(N.$,{})})})})},e))}),children:(0,a.jsx)(b.r,{hasGutter:!0,children:e&&Object.entries(e).map(e=>{let[t,r]=e;return(0,a.jsx)(F.P,{md:3,children:(0,a.jsx)(ep,{fieldName:t,sbomId:r})},"".concat(t,":").concat(r))})})})},ey=()=>(0,a.jsx)(l.NP,{hasBodyWrapper:!1,children:(0,a.jsxs)(n.K,{hasGutter:!0,children:[(0,a.jsx)(i.v,{children:(0,a.jsx)(D,{})}),(0,a.jsx)(i.v,{children:(0,a.jsx)(X,{children:(0,a.jsx)(ev,{})})})]})})},17598:function(e,t,r){r.d(t,{N7:()=>g,VY:()=>m,gw:()=>x,sj:()=>j,tG:()=>f});var a=r(79192),l=r(53195),n=r(70186),i=r(1183),s=r(24038),o=r(68e3),d=r(75503),c=r(50576),u=r(40371),h=r(87017),p=r(49988),v=r(95169);let y="advisories",m=e=>{let{data:t,isLoading:r,error:a,refetch:l}=(0,i.a)({queryKey:[y,"labels",e],queryFn:()=>(0,u.sf)({client:c.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a,refetch:l}},g=function(){var e,t,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=(0,p.rm)(s),{q:v}=h,m=(0,n._)(h,["q"]),g=(0,p.Rb)(o),{data:x,isLoading:f,error:j,refetch:b}=(0,i.a)({queryKey:[y,s,g],queryFn:()=>(0,u.A1)({client:c.L,query:(0,l._)((0,a._)({},m),{q:[v,g].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==x||null==(e=x.data)?void 0:e.items)||[],total:null!=(r=null==x||null==(t=x.data)?void 0:t.total)?r:0,params:s},isFetching:f,fetchError:j||null,refetch:b}},x=e=>{let{data:t,isLoading:r,error:a}=(0,i.a)({queryKey:[y,e],queryFn:()=>(0,u.pB)({client:c.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==t?void 0:t.data,isFetching:r,fetchError:a}},f=()=>{let e=(0,o.NL)();return(0,v.V)({parallel:!0,uploadFn:(e,t)=>(0,h.Cu)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[y]})}})},j=(e,t)=>{let r=(0,o.NL)();return(0,d.D)({mutationFn:e=>(0,u.m5)({client:c.L,path:{id:e.id},body:e.labels}),onSuccess:async(t,a)=>{e(),await r.invalidateQueries({queryKey:[y]})},onError:t})}},43959:function(e,t,r){r.d(t,{Fz:()=>x,KQ:()=>_,Oh:()=>F,i5:()=>g,km:()=>j,p4:()=>f,qi:()=>k,t9:()=>b,uz:()=>w});var a=r(79192),l=r(53195),n=r(70186),i=r(1183),s=r(24038),o=r(68e3),d=r(75503),c=r(16072),u=r(50576),h=r(40371),p=r(95169),v=r(87017),y=r(49988);let m="sboms",g=e=>{let{data:t,isLoading:r,error:a,refetch:l}=(0,i.a)({queryKey:[m,"labels",e],queryFn:()=>(0,h.mh)({client:u.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a,refetch:l}},x=function(){var e,t,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=(0,y.rm)(s),{q:p}=c,v=(0,n._)(c,["q"]),g=(0,y.Rb)(o),{data:x,isLoading:f,error:j,refetch:b}=(0,i.a)({queryKey:[m,s,g],queryFn:()=>(0,h.Wp)({client:u.L,query:(0,l._)((0,a._)({},v),{q:[p,g].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==x||null==(e=x.data)?void 0:e.items)||[],total:null!=(r=null==x||null==(t=x.data)?void 0:t.total)?r:0,params:s},isFetching:f,fetchError:j,refetch:b}},f=e=>{let{data:t,isLoading:r,error:a}=(0,i.a)({queryKey:[m,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,h._Q)({client:u.L,path:{id:e}}),enabled:void 0!==e});return{sbom:null==t?void 0:t.data,isFetching:r,fetchError:a}},j=()=>{let e=(0,o.NL)();return(0,p.V)({parallel:!0,uploadFn:(e,t)=>(0,v.Hb)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},b=(e,t)=>{let r=(0,o.NL)();return(0,d.D)({mutationFn:e=>(0,h.zx)({client:u.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[m]})},onError:t})},F=function(e){var t,r,l;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:s,isLoading:o,error:d,refetch:c}=(0,i.a)({queryKey:[m,"by-package",e,n],queryFn:()=>(0,h.DU)({client:u.L,query:(0,a._)({purl:e},(0,y.rm)(n))})});return{result:{data:(null==s||null==(t=s.data)?void 0:t.items)||[],total:null!=(l=null==s||null==(r=s.data)?void 0:r.total)?l:0,params:n},isFetching:o,fetchError:d,refetch:c}},_=e=>{let{data:t,isLoading:r,error:a}=(0,i.a)({queryKey:[m,e,"advisory"],queryFn:()=>(0,h.NU)({client:u.L,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a}},w=e=>{let t=(0,c.h)({queries:e.map(e=>({queryKey:[m,e,"advisory"],queryFn:()=>(0,h.NU)({client:u.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},k=e=>{let{data:t,isLoading:r,error:a}=(0,i.a)({queryKey:[m,e,"license-ids"],queryFn:()=>(0,h.J4)({client:u.L,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a}}}}]);