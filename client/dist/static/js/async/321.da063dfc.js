(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["321"],{97339:function(e,i,n){"use strict";n.d(i,{a:()=>c});var t=n(59390),r=n(24246),s=n(27378),l=n(90633),a=n(15508),d=n(53315);let c=e=>{var{children:i=null,className:n="","aria-label":o="Breadcrumb",ouiaId:u,ouiaSafe:h=!0}=e,x=(0,t.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let m=(0,d.S$)(c.displayName,u,h);return(0,r.jsx)("nav",Object.assign({},x,{"aria-label":o,className:(0,a.i)(l.Z.breadcrumb,n)},m,{children:(0,r.jsx)("ol",{className:l.Z.breadcrumbList,role:"list",children:s.Children.map(i,(e,i)=>(0,s.isValidElement)(e)?(0,s.cloneElement)(e,{showDivider:i>0}):e)})}))};c.displayName="Breadcrumb"},18091:function(e,i,n){"use strict";n.d(i,{g:()=>d});var t=n(59390),r=n(24246),s=n(91985),l=n(90633),a=n(15508);let d=e=>{var{children:i=null,className:n="",to:d,isActive:c=!1,isDropdown:o=!1,showDivider:u,target:h,component:x="a",render:m}=e,j=(0,t.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let p=c?"page":void 0,b=(0,a.i)(l.Z.breadcrumbLink,c&&l.Z.modifiers.current);return(0,r.jsxs)("li",Object.assign({},j,{className:(0,a.i)(l.Z.breadcrumbItem,n),children:[u&&(0,r.jsx)("span",{className:l.Z.breadcrumbItemDivider,children:(0,r.jsx)(s.ZP,{})}),"button"===x&&(0,r.jsx)("button",{className:b,"aria-current":p,type:"button",children:i}),o&&(0,r.jsx)("span",{className:(0,a.i)(l.Z.breadcrumbDropdown),children:i}),m&&m({className:b,ariaCurrent:p}),d&&!m&&(0,r.jsx)(x,{href:d,target:h,className:b,"aria-current":p,children:i}),!d&&"button"!==x&&!o&&i]}))};d.displayName="BreadcrumbItem"},81211:function(e,i,n){"use strict";n.d(i,{aV:()=>h});var t,r,s,l,a,d=n(59390),c=n(24246),o=n(40269),u=n(15508);(t=s||(s={})).number="1",t.lowercaseLetter="a",t.uppercaseLetter="A",t.lowercaseRomanNumber="i",t.uppercaseRomanNumber="I",(l||(l={})).inline="inline",(r=a||(a={})).ol="ol",r.ul="ul";let h=e=>{var{className:i="",children:n=null,variant:t=null,isBordered:r=!1,isPlain:l=!1,iconSize:h="default",type:x=s.number,ref:m=null,component:j=a.ul}=e,p=(0,d.__rest)(e,["className","children","variant","isBordered","isPlain","iconSize","type","ref","component"]);return j===a.ol?(0,c.jsx)("ol",Object.assign({ref:m,type:x},l&&{role:"list"},p,{className:(0,u.i)(o.Z.list,t&&o.Z.modifiers[t],r&&o.Z.modifiers.bordered,l&&o.Z.modifiers.plain,h&&"large"===h&&o.Z.modifiers.iconLg,i),children:n})):(0,c.jsx)("ul",Object.assign({ref:m},l&&{role:"list"},p,{className:(0,u.i)(o.Z.list,t&&o.Z.modifiers[t],r&&o.Z.modifiers.bordered,l&&o.Z.modifiers.plain,h&&"large"===h&&o.Z.modifiers.iconLg,i),children:n}))};h.displayName="List"},45882:function(e,i,n){"use strict";n.d(i,{H:()=>a});var t=n(59390),r=n(24246),s=n(40269),l=n(15508);let a=e=>{var{icon:i=null,children:n=null}=e,a=(0,t.__rest)(e,["icon","children"]);return(0,r.jsxs)("li",Object.assign({className:(0,l.i)(i&&s.Z.listItem)},a,{children:[i&&(0,r.jsx)("span",{className:(0,l.i)(s.Z.listItemIcon),children:i}),(0,r.jsx)("span",{className:i&&(0,l.i)(`${s.Z.list}__item-text`),children:n})]}))};a.displayName="ListItem"},35676:function(e,i,n){"use strict";n.d(i,{ZP:()=>t});let t=(0,n(24329).I)({name:"ShieldAltIcon",height:512,width:512,svgPath:"M466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256.1 446.3l-.1-381 175.9 73.3c-3.3 151.4-82.1 261.1-175.8 307.7z",yOffset:0,xOffset:0})},67447:function(e,i,n){"use strict";n.d(i,{G:()=>a});var t=n(59390),r=n(24246),s=n(15508),l=n(39157);let a=e=>{var{children:i=null}=e,n=(0,t.__rest)(e,["children"]);return(0,r.jsx)("div",Object.assign({},n,{className:(0,s.i)(l.Z.tableExpandableRowContent),children:i}))};a.displayName="ExpandableRowContent"},2926:function(e,i,n){var t;t=function(){"use strict";function i(e,i,n){var t=new XMLHttpRequest;t.open("GET",e),t.responseType="blob",t.onload=function(){a(t.response,i,n)},t.onerror=function(){console.error("could not download file")},t.send()}function t(e){var i=new XMLHttpRequest;i.open("HEAD",e,!1);try{i.send()}catch(e){}return 200<=i.status&&299>=i.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(i)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,l=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,n,l){var a=s.URL||s.webkitURL,d=document.createElement("a");d.download=n=n||e.name||"download",d.rel="noopener","string"==typeof e?(d.href=e,d.origin===location.origin?r(d):t(d.href)?i(e,n,l):r(d,d.target="_blank")):(d.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(d.href)},4e4),setTimeout(function(){r(d)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,s){if(n=n||e.name||"download","string"!=typeof e){var l;navigator.msSaveOrOpenBlob((void 0===(l=s)?l={autoBom:!1}:"object"!=typeof l&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e),n)}else if(t(e))i(e,n,s);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){r(a)})}}:function(e,n,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return i(e,n,t);var a="application/octet-stream"===e.type,d=/constructor/i.test(s.HTMLElement)||s.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||a&&d||l)&&"undefined"!=typeof FileReader){var o=new FileReader;o.onloadend=function(){var e=o.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},o.readAsDataURL(e)}else{var u=s.URL||s.webkitURL,h=u.createObjectURL(e);r?r.location=h:location.href=h,r=null,setTimeout(function(){u.revokeObjectURL(h)},4e4)}});s.saveAs=a.saveAs=a,e.exports=a},"function"==typeof define&&define.amd?define([],t):t()},69876:function(e,i,n){"use strict";n.d(i,{D:()=>s});var t=n(24246),r=n(70400);let s=e=>{let{value:i}=e;return(0,t.jsx)(t.Fragment,{children:Object.entries(i).map(e=>{let[i,n]=e;return(0,t.jsx)(r._,{isCompact:!0,children:`${i}=${n}`},`${i}=${n}`)})})}},68057:function(e,i,n){"use strict";n.d(i,{V:()=>a});var t=n(24246),r=n(27378),s=n(63763),l=n(32947);let a=e=>{let{vulnerabilitiesSummary:i}=e,n=r.useMemo(()=>Object.keys(i.severities).map(e=>{let n=i.severities[e],t=l.V4[e];return{severity:e,count:n,label:t.name,color:t.color.value}}).sort((0,l.A0)(e=>e.severity)).reverse(),[i]);return(0,t.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,t.jsx)(s.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${i.total}`,subTitle:"Total vulnerabilities",width:350,legendData:n.map(e=>{let{label:i,count:n}=e;return{name:`${i}: ${n}`}}),data:n.map(e=>{let{label:i,count:n}=e;return{x:i,y:n}}),labels:e=>{let{datum:i}=e;return`${i.x}: ${i.y}`},colorScale:n.map(e=>{let{color:i}=e;return i})})})}},57524:function(e,i,n){"use strict";n.d(i,{o:()=>c});var t=n(24246),r=n(34747),s=n(46770),l=n(2499),a=n(35676),d=n(32947);let c=e=>{let{value:i,score:n,showScore:c,showLabel:o}=e,u=d.V4[i],h=u.name;return(0,t.jsxs)(r.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,t.jsx)(s.B,{children:o?(0,t.jsx)(a.ZP,{color:u.color.value}):(0,t.jsx)(l.u,{content:h,children:(0,t.jsx)(a.ZP,{color:u.color.value})})}),o&&(0,t.jsx)(s.B,{children:h}),c&&null!==n&&(0,t.jsxs)(s.B,{children:["(",Math.round(10*n)/10,")"]})]})}},3804:function(e,i,n){"use strict";n.d(i,{p:()=>s});var t=n(24246),r=n(27230);let s=e=>{let{paginationProps:i,isTop:n,isCompact:s=!1,idPrefix:l=""}=e;return(0,t.jsx)(r.t,{id:`${l?`${l}-`:""}pagination-${n?"top":"bottom"}`,variant:n?r.a.top:r.a.bottom,isCompact:s,...i,widgetId:"pagination-id"})}},31336:function(e,i,n){"use strict";n.d(i,{hp:()=>j,qK:()=>b,Cx:()=>f});var t=n(24246),r=n(8305),s=n(13754),l=n(31423),a=n(11165),d=n(94154),c=n(39826),o=n(10707),u=n(16668),h=n(22119);let x=e=>{let{title:i,description:n}=e;return(0,t.jsx)(o.ub,{titleText:i,headingLevel:"h4",icon:h.ZP,variant:o.IQ.sm,children:n&&(0,t.jsx)(u.B,{children:n})})},m=()=>(0,t.jsx)(x,{title:"No data available",description:"No data available to be shown here."}),j=e=>{let{numRenderedColumns:i,isLoading:n=!1,isError:o=!1,isNoData:u=!1,errorEmptyState:h=null,noDataEmptyState:x=null,children:j}=e;return(0,t.jsx)(t.Fragment,{children:n?(0,t.jsx)(l.p,{children:(0,t.jsx)(a.Tr,{children:(0,t.jsx)(d.Td,{colSpan:i,children:(0,t.jsx)(r.b,{children:(0,t.jsx)(s.$,{size:"xl"})})})})}):o?(0,t.jsx)(l.p,{"aria-label":"Table error",children:(0,t.jsx)(a.Tr,{children:(0,t.jsx)(d.Td,{colSpan:i,children:(0,t.jsx)(r.b,{children:h||(0,t.jsx)(c.y,{})})})})}):u?(0,t.jsx)(l.p,{"aria-label":"Table error",children:(0,t.jsx)(a.Tr,{children:(0,t.jsx)(d.Td,{colSpan:i,children:(0,t.jsx)(r.b,{children:x||(0,t.jsx)(m,{})})})})}):j})};var p=n(89330);let b=e=>{let{numColumnsBeforeData:i,numColumnsAfterData:n,children:r}=e;return(0,t.jsxs)(t.Fragment,{children:[Array(i).fill(null).map((e,i)=>(0,t.jsx)(p.Th,{screenReaderText:`before-data-${i}`},i)),r,Array(n).fill(null).map((e,i)=>(0,t.jsx)(p.Th,{screenReaderText:`after-data-${i}`},i))]})},f=e=>{let{isExpansionEnabled:i=!1,expandableVariant:n,isSelectionEnabled:r=!1,propHelpers:{getSingleExpandButtonTdProps:s,getSelectCheckboxTdProps:l},item:a,rowIndex:c,children:o}=e;return(0,t.jsxs)(t.Fragment,{children:[i&&"single"===n?(0,t.jsx)(d.Td,{...s({item:a,rowIndex:c})}):null,r?(0,t.jsx)(d.Td,{...l({item:a,rowIndex:c})}):null,o]})}},3586:function(e,i,n){"use strict";n.d(i,{j:()=>s});var t=n(24246),r=n(27378);let s=e=>{let{children:i}=e,[n,s]=r.useState(!1);return(0,t.jsx)(t.Fragment,{children:i(n,s)})}},24200:function(e,i,n){"use strict";n.d(i,{G:()=>r});var t=n(24246);let r=e=>{let{vulnerability:i}=e;return(0,t.jsxs)("p",{children:[i.withdrawn&&(0,t.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},73227:function(e,i,n){"use strict";n.d(i,{useDownload:()=>d});var t=n(2926),r=n(87017),s=n(50576),l=n(40371),a=n(63706);let d=()=>({downloadAdvisory:(e,i)=>{(0,l.Em)({client:s.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(n=>{(0,t.saveAs)(new Blob([n.data]),i||`${e}.json`)})},downloadSBOM:(e,i)=>{(0,l.XW)({client:s.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(n=>{(0,t.saveAs)(new Blob([n.data]),i||`${e}.json`)})},downloadSBOMLicenses:e=>{(0,r.Co)(e).then(i=>{let n=null,r=i.headers?.["content-disposition"]?.toString();r&&(n=(0,a.lj)(r)),(0,t.saveAs)(new Blob([i.data]),n||`${e}.tar.gz`)})}})},41362:function(e,i,n){"use strict";n.r(i),n.d(i,{default:()=>eS});var t=n(24246),r=n(27378),s=n(65783),l=n(45043),a=n(97339),d=n(18091),c=n(11192),o=n(32591),u=n(34747),h=n(46770),x=n(68802),m=n(70400),j=n(32939),p=n(24620),b=n(37961),f=n(69265),g=n(4075),v=n(27090),y=n(75165),T=n(31762),w=n(99),S=n(24787),B=n(12621),M=n(9839),P=n(37818),E=n(73227),k=n(43959),F=n(65872),N=n(87727),O=n(3498),_=n(31757),I=n(87069),Z=n(51527),L=n(30329),C=n(50689),K=n(67761),D=n(81391),$=n(81211),A=n(45882),R=n(63706);let V=e=>{let{sbom:i}=e;return(0,t.jsxs)(N.r,{hasGutter:!0,children:[(0,t.jsx)(O.P,{md:4,children:(0,t.jsxs)(_.Z,{isFullHeight:!0,children:[(0,t.jsx)(I.l,{children:"Metadata"}),(0,t.jsx)(Z.e,{children:(0,t.jsxs)(L.o,{children:[(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"Name"}),(0,t.jsx)(D.b,{"aria-label":"SBOM's name",children:i.name})]}),(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"Namespace"}),(0,t.jsx)(D.b,{"aria-label":"SBOM's namespace",children:i.document_id})]}),(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"Data License"}),(0,t.jsx)(D.b,{"aria-label":"SBOM's license",children:i.data_licenses.join(", ")})]})]})})]})}),(0,t.jsx)(O.P,{md:4,children:(0,t.jsxs)(_.Z,{isFullHeight:!0,children:[(0,t.jsx)(I.l,{children:"Creation"}),(0,t.jsx)(Z.e,{children:(0,t.jsxs)(L.o,{children:[(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"Created"}),(0,t.jsx)(D.b,{"aria-label":"SBOM's creation date",children:(0,R.p6)(i.published)})]}),(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"Creator"}),(0,t.jsx)(D.b,{"aria-label":"SBOM's creator",children:i.suppliers})]})]})})]})}),(0,t.jsx)(O.P,{md:4,children:(0,t.jsxs)(_.Z,{isFullHeight:!0,children:[(0,t.jsx)(I.l,{children:"Statistics"}),(0,t.jsx)(Z.e,{children:(0,t.jsxs)(L.o,{children:[(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"Size"}),(0,t.jsx)(D.b,{children:(0,F.Z)(i.size)})]}),(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"Packages"}),(0,t.jsx)(D.b,{children:i.number_of_packages})]})]})})]})}),(0,t.jsx)(O.P,{md:12,children:(0,t.jsxs)(_.Z,{isFullHeight:!0,children:[(0,t.jsx)(I.l,{children:"Package"}),(0,t.jsx)(Z.e,{children:(0,t.jsxs)(L.o,{children:[(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"Name"}),(0,t.jsx)(D.b,{children:i.name})]}),(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"Version"}),(0,t.jsx)(D.b,{children:i.described_by.map(e=>e.version).join(", ")})]}),(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"External References"}),(0,t.jsx)(D.b,{children:(0,t.jsxs)($.aV,{children:[i.described_by.flatMap(e=>e.cpe).map(e=>(0,t.jsx)(A.H,{children:e},e)),(0,t.jsx)(A.H,{children:i.described_by.flatMap(e=>e.purl).map(e=>e.purl)})]})})]})]})})]})})]})};var q=n(70715),H=n(40982),U=n(89226),G=n(62997),z=n(4835),X=n(14350),Q=n(11165),W=n(89330),Y=n(31423),J=n(94154),ee=n(67447),ei=n(74502),en=n(72603),et=n(3804),er=n(31336),es=n(47169),el=n(22048),ea=n(59015);let ed=e=>{let{sbomId:i}=e,n=(0,es.vZ)({tableName:"package-table",columnNames:{name:"Name",version:"Version"},isSortEnabled:!0,sortableColumns:["name"],isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:ei.L4,title:"Filter text",placeholderText:"Search",type:en.vA.search}],isExpansionEnabled:!0,expandableVariant:"single"}),{result:{data:r,total:l},isFetching:a,fetchError:d}=(0,ea.useFetchPackagesBySbomId)(i,(0,es.QO)({...n,hubSortFieldKeys:{name:"name"}})),c=(0,es.KC)({...n,idProperty:"id",currentPageItems:r,totalItemCount:l,isLoading:a,selectionState:(0,el.U)({items:r,isEqual:(e,i)=>e.id===i.id})}),{currentPageItems:o,numRenderedColumns:u,propHelpers:{toolbarProps:h,filterToolbarProps:x,paginationToolbarItemProps:m,paginationProps:j,tableProps:p,getThProps:b,getTrProps:f,getTdProps:g,getExpandedContentTdProps:v},expansionDerivedState:{isCellExpanded:y}}=c;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(q.o,{...h,children:(0,t.jsxs)(H.c,{children:[(0,t.jsx)(en.Ki,{showFiltersSideBySide:!0,...x}),(0,t.jsx)(U.E,{...m,children:(0,t.jsx)(et.p,{idPrefix:"package-table",isTop:!0,paginationProps:j})})]})}),(0,t.jsxs)(z.i,{...p,"aria-label":"Package table",children:[(0,t.jsx)(X.h,{children:(0,t.jsx)(Q.Tr,{children:(0,t.jsxs)(er.qK,{...c,children:[(0,t.jsx)(W.Th,{...b({columnKey:"name"})}),(0,t.jsx)(W.Th,{...b({columnKey:"version"})})]})})}),(0,t.jsx)(er.hp,{isLoading:a,isError:!!d,isNoData:0===l,numRenderedColumns:u,children:o?.map((e,i)=>(0,t.jsxs)(Y.p,{children:[(0,t.jsx)(Q.Tr,{...f({item:e}),children:(0,t.jsxs)(er.Cx,{...c,item:e,rowIndex:i,children:[(0,t.jsx)(J.Td,{width:80,...g({columnKey:"name"}),children:[e.name,e.group].filter(Boolean).join("/")}),(0,t.jsx)(J.Td,{width:20,modifier:"truncate",...g({columnKey:"version"}),children:e?.version})]})}),y(e)?(0,t.jsxs)(Q.Tr,{isExpanded:!0,children:[(0,t.jsx)(J.Td,{}),(0,t.jsx)(J.Td,{...v({item:e}),className:G.Z.pyLg,children:(0,t.jsx)(ee.G,{children:(0,t.jsx)(L.o,{children:(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"External identifier"}),(0,t.jsx)(D.b,{children:(0,t.jsxs)($.aV,{children:[e.purl.map(e=>(0,t.jsx)(A.H,{children:(0,t.jsx)(s.rU,{to:`/packages/${e.uuid}`,children:e.purl})},e.uuid)),e.cpe.map(e=>(0,t.jsx)(A.H,{children:e},e))]})})]})})})})]}):null]},e.id))})]}),(0,t.jsx)(et.p,{idPrefix:"package-table",isTop:!1,paginationProps:j})]})};var ec=n(27693),eo=n.n(ec),eu=n(27317),eh=n(93095),ex=n(9905),em=n(32947),ej=n(7615),ep=n(69876),eb=n(68057),ef=n(57524),eg=n(3586),ev=n(24200),ey=n(82413),eT=n(41135);let ew=e=>{let{sbomId:i}=e,{sbom:n,isFetching:l,fetchError:a}=(0,k.useFetchSBOMById)(i),{data:{vulnerabilities:d,summary:c},isFetching:o,fetchError:u}=(0,ey.useVulnerabilitiesOfSbom)(i),h=r.useMemo(()=>d.filter(e=>"affected"===e.vulnerabilityStatus),[d]),x=r.useMemo(()=>h.map(e=>{let i=e.relatedPackages.flatMap(e=>e.packages).reduce((e,i)=>(e.find(e=>e.id===i.id)||e.push(i),e),[]);return{...e,summary:{totalPackages:i.length,allPackages:i}}}),[h]),m=(0,eT.T)(x,e=>`${e.vulnerability.identifier}-${e.vulnerabilityStatus}`),j=(0,es.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:m,isLoading:o,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>({id:e.vulnerability.identifier,cvss:(0,em.XE)(e.vulnerability.average_severity),affectedDependencies:e.summary.totalPackages,published:e.vulnerability?.published?eo()(e.vulnerability.published).valueOf():0,updated:e.vulnerability?.modified?eo()(e.vulnerability.modified).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:p,numRenderedColumns:b,propHelpers:{toolbarProps:f,paginationToolbarItemProps:g,paginationProps:v,tableProps:y,getThProps:T,getTrProps:w,getTdProps:S,getExpandedContentTdProps:B},expansionDerivedState:{isCellExpanded:M}}=j;return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(eu.K,{hasGutter:!0,children:[(0,t.jsx)(eh.v,{children:(0,t.jsx)(_.Z,{children:(0,t.jsx)(Z.e,{children:(0,t.jsx)(P.u,{isFetching:l||o,fetchError:a,children:(0,t.jsxs)(N.r,{hasGutter:!0,children:[(0,t.jsx)(O.P,{md:6,children:(0,t.jsx)(eb.V,{vulnerabilitiesSummary:c.vulnerabilityStatus.affected})}),(0,t.jsx)(O.P,{md:6,children:(0,t.jsxs)(L.o,{children:[(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"Name"}),(0,t.jsx)(D.b,{children:n?.name})]}),(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"Version"}),(0,t.jsx)(D.b,{children:n?.described_by.map(e=>e.version).join(", ")})]}),(0,t.jsxs)(C.g,{children:[(0,t.jsx)(K.M,{children:"Creation date"}),(0,t.jsx)(D.b,{children:(0,R.p6)(n?.published)})]})]})})]})})})})}),(0,t.jsxs)(eh.v,{children:[(0,t.jsx)(q.o,{...f,children:(0,t.jsx)(H.c,{children:(0,t.jsx)(U.E,{...g,children:(0,t.jsx)(et.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:v})})})}),(0,t.jsxs)(z.i,{...y,"aria-label":"Vulnerability table",children:[(0,t.jsx)(X.h,{children:(0,t.jsx)(Q.Tr,{children:(0,t.jsxs)(er.qK,{...j,children:[(0,t.jsx)(W.Th,{...T({columnKey:"id"})}),(0,t.jsx)(W.Th,{...T({columnKey:"description"})}),(0,t.jsx)(W.Th,{...T({columnKey:"cvss"})}),(0,t.jsx)(W.Th,{...T({columnKey:"affectedDependencies"})}),(0,t.jsx)(W.Th,{...T({columnKey:"published"})}),(0,t.jsx)(W.Th,{...T({columnKey:"updated"})})]})})}),(0,t.jsx)(er.hp,{isLoading:o,isError:!!u,isNoData:0===m.length,numRenderedColumns:b,children:p?.map((e,i)=>(0,t.jsxs)(Y.p,{isExpanded:M(e),children:[(0,t.jsx)(Q.Tr,{...w({item:e}),children:(0,t.jsxs)(er.Cx,{...j,item:e,rowIndex:i,children:[(0,t.jsx)(J.Td,{width:15,modifier:"breakWord",...S({columnKey:"id"}),children:(0,t.jsx)(s.rU,{to:`/vulnerabilities/${e.vulnerability.identifier}`,children:e.vulnerability.identifier})}),(0,t.jsx)(eg.j,{children:(i,n)=>(0,t.jsx)(J.Td,{width:35,modifier:"truncate",onFocus:()=>n(!0),onBlur:()=>n(!1),tabIndex:0,...S({columnKey:"description"}),children:(0,t.jsx)(ex.cE,{focused:i,wrapModifier:"truncate",children:e.vulnerability&&(0,t.jsx)(ev.G,{vulnerability:e.vulnerability})})})}),(0,t.jsx)(J.Td,{width:10,...S({columnKey:"cvss"}),children:(0,t.jsx)(ef.o,{value:(0,ej.g)(e.vulnerability.average_severity),score:e.vulnerability.average_score,showLabel:!0,showScore:!0})}),(0,t.jsx)(J.Td,{width:15,modifier:"truncate",...S({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:i}),children:e.summary.totalPackages}),(0,t.jsx)(J.Td,{width:10,modifier:"truncate",...S({columnKey:"published"}),children:(0,R.p6)(e.vulnerability?.published)}),(0,t.jsx)(J.Td,{width:10,modifier:"truncate",...S({columnKey:"updated"}),children:(0,R.p6)(e.vulnerability?.modified)})]})}),M(e)?(0,t.jsx)(Q.Tr,{isExpanded:!0,children:(0,t.jsx)(J.Td,{...B({item:e}),children:(0,t.jsx)(ee.G,{children:M(e,"affectedDependencies")?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(z.i,{variant:"compact",children:[(0,t.jsx)(X.h,{children:(0,t.jsxs)(Q.Tr,{children:[(0,t.jsx)(W.Th,{children:"Type"}),(0,t.jsx)(W.Th,{children:"Namespace"}),(0,t.jsx)(W.Th,{children:"Name"}),(0,t.jsx)(W.Th,{children:"Version"}),(0,t.jsx)(W.Th,{children:"Path"}),(0,t.jsx)(W.Th,{children:"Qualifiers"})]})}),(0,t.jsx)(Y.p,{children:e.summary.allPackages.flatMap(e=>e.name&&0===e.purl.length?[{parentName:e.name}]:e.purl.map(i=>({parentName:e.name,purlSummary:i}))).map((e,i)=>{if(e.purlSummary){let i=(0,R.qX)(e.purlSummary.purl);return(0,t.jsxs)(Q.Tr,{children:[(0,t.jsx)(J.Td,{children:i?.type}),(0,t.jsx)(J.Td,{children:i?.namespace}),(0,t.jsx)(J.Td,{children:(0,t.jsx)(s.rU,{to:`/packages/${e.purlSummary.uuid}`,children:i?.name})}),(0,t.jsx)(J.Td,{children:i?.version}),(0,t.jsx)(J.Td,{children:i?.path}),(0,t.jsx)(J.Td,{children:i?.qualifiers&&(0,t.jsx)(ep.D,{value:i?.qualifiers})})]},e.purlSummary.uuid)}return(0,t.jsxs)(Q.Tr,{children:[(0,t.jsx)(J.Td,{}),(0,t.jsx)(J.Td,{}),(0,t.jsx)(J.Td,{children:e.parentName}),(0,t.jsx)(J.Td,{}),(0,t.jsx)(J.Td,{}),(0,t.jsx)(J.Td,{})]},`${e.parentName}-${i}-name`)})})]})}):null})})}):null]},e._ui_unique_id))})]}),(0,t.jsx)(et.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:v})]})]})})},eS=()=>{let e=(0,M.ZX)(M.Uo.SBOM_ID),{sbom:i,isFetching:n,fetchError:F}=(0,k.useFetchSBOMById)(e),{downloadSBOM:N,downloadSBOMLicenses:O}=(0,E.useDownload)(),[_,I]=r.useState(!1),[Z,L]=r.useState(0),C=r.createRef(),K=r.createRef(),D=r.createRef(),$=r.createRef(),A=()=>{I(!_)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.NP,{type:"breadcrumb",children:(0,t.jsxs)(a.a,{children:[(0,t.jsx)(d.g,{children:(0,t.jsx)(s.rU,{to:"/sboms",children:"SBOMs"})}),(0,t.jsx)(d.g,{isActive:!0,children:"SBOM details"})]})}),(0,t.jsx)(l.NP,{children:(0,t.jsxs)(c.P,{children:[(0,t.jsx)(o.J,{isFilled:!0,children:(0,t.jsxs)(u.k,{children:[(0,t.jsx)(h.B,{spacer:{default:"spacerSm"},children:(0,t.jsx)(x.V,{children:(0,t.jsx)(x.V,{component:"h1",children:i?.name??e??""})})}),(0,t.jsx)(h.B,{children:i?.labels.type&&(0,t.jsx)(m._,{color:"blue",children:i?.labels.type})})]})}),(0,t.jsx)(o.J,{children:i&&(0,t.jsx)(j.L,{isOpen:_,onSelect:()=>I(!1),onOpenChange:e=>I(e),popperProps:{position:"right"},toggle:e=>(0,t.jsx)(p.O_,{ref:e,onClick:A,isExpanded:_,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,t.jsxs)(b.s,{children:[(0,t.jsx)(f.h,{onClick:()=>{e&&N(e,i?.name?`${i?.name}.json`:`${e}.json`)},children:"Download SBOM"},"sbom"),(0,t.jsx)(f.h,{onClick:()=>{e&&O(e)},children:"Download License Report"},"license")]})})})]})}),(0,t.jsx)(l.NP,{children:(0,t.jsxs)(g.m,{mountOnEnter:!0,activeKey:Z,onSelect:(e,i)=>{L(i)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,t.jsx)(v.O,{eventKey:0,title:(0,t.jsx)(y.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:C}),(0,t.jsx)(v.O,{eventKey:1,title:(0,t.jsx)(y.T,{children:"Packages"}),tabContentId:"refTabPackagesSection",tabContentRef:K}),(0,t.jsx)(v.O,{eventKey:2,title:(0,t.jsx)(y.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:D,actions:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.b,{ref:$,children:(0,t.jsx)(B.ZP,{})}),(0,t.jsx)(w.J,{triggerRef:$,bodyContent:(0,t.jsx)("div",{children:"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed."})})]})})]})}),(0,t.jsxs)(l.NP,{children:[(0,t.jsx)(S.I,{eventKey:0,id:"refTabInfoSection",ref:C,"aria-label":"Information of the SBOM",children:(0,t.jsx)(P.u,{isFetching:n,fetchError:F,children:i&&(0,t.jsx)(V,{sbom:i})})}),(0,t.jsx)(S.I,{eventKey:1,id:"refTabPackagesSection",ref:K,"aria-label":"Packages within the SBOM",hidden:!0,children:e&&(0,t.jsx)(ed,{sbomId:e})}),(0,t.jsx)(S.I,{eventKey:2,id:"refVulnerabilitiesSection",ref:D,"aria-label":"Vulnerabilities within the SBOM",hidden:!0,children:e&&(0,t.jsx)(ew,{sbomId:e})})]})]})}},59015:function(e,i,n){"use strict";n.d(i,{useFetchPackageById:()=>c,useFetchPackages:()=>d,useFetchPackagesBySbomId:()=>o});var t=n(1183),r=n(50576),s=n(40371),l=n(47169);let a="packages",d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:n,isLoading:d,error:c,refetch:o}=(0,t.useQuery)({queryKey:[a,e],queryFn:()=>(0,s.tj)({client:r.L,query:{...(0,l.rm)(e)}}),enabled:!i});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:e},isFetching:d,fetchError:c,refetch:o}},c=e=>{let{data:i,isLoading:n,error:l}=(0,t.useQuery)({queryKey:[a,e],queryFn:()=>(0,s.BK)({client:r.L,path:{key:e}})});return{pkg:i?.data,isFetching:n,fetchError:l}},o=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:n,isLoading:d,error:c,refetch:o}=(0,t.useQuery)({queryKey:[a,"by-sbom",e,i],queryFn:()=>(0,s.Pg)({client:r.L,path:{id:e},query:{...(0,l.rm)(i)}})});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:i},isFetching:d,fetchError:c,refetch:o}}},41135:function(e,i,n){"use strict";n.d(i,{T:()=>s});var t=n(27378),r=n(74502);let s=(e,i)=>(0,t.useMemo)(()=>e&&0!==e.length?e.map(e=>({...e,[r.nM]:i(e)})):[],[e,i])},40269:function(e,i,n){"use strict";n.d(i,{Z:()=>t});let t={list:"pf-v6-c-list",listItem:"pf-v6-c-list__item",listItemIcon:"pf-v6-c-list__item-icon",modifiers:{iconLg:"pf-m-icon-lg",plain:"pf-m-plain",inline:"pf-m-inline",bordered:"pf-m-bordered"}}},65872:function(e,i,n){"use strict";n.d(i,{Z:()=>d});let t=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],r=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],s=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],l=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],a=(e,i,n)=>{let t=e;return"string"==typeof i||Array.isArray(i)?t=e.toLocaleString(i,n):(!0===i||void 0!==n)&&(t=e.toLocaleString(void 0,n)),t};function d(e,i){let n;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let d=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?l:s:i.binary?r:t,c=i.space?" ":"";if(i.signed&&0===e)return` 0${c}${d[0]}`;let o=e<0,u=o?"-":i.signed?"+":"";if(o&&(e=-e),void 0!==i.minimumFractionDigits&&(n={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(n={maximumFractionDigits:i.maximumFractionDigits,...n}),e<1)return u+a(e,i.locale,n)+c+d[0];let h=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),d.length-1);return e/=(i.binary?1024:1e3)**h,n||(e=e.toPrecision(3)),u+a(Number(e),i.locale,n)+c+d[h]}}}]);