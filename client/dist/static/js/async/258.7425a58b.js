"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["258"],{28986:function(e,t,i){i.d(t,{G:()=>l});var r=i(24246);let l=e=>{let{vulnerability:t}=e;return(0,r.jsxs)("p",{children:[t.withdrawn&&(0,r.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})}},60767:function(e,t,i){i.d(t,{i:()=>o});var r=i(2926),l=i(54774),s=i(22285),n=i(54227),a=i(62126);let o=()=>({downloadAdvisory:(e,t)=>{(0,n.Em)({client:s.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(i=>{(0,r.saveAs)(new Blob([i.data]),t||`${e}.json`)})},downloadSBOM:(e,t)=>{(0,n.XW)({client:s.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(i=>{(0,r.saveAs)(new Blob([i.data]),t||`${e}.json`)})},downloadSBOMLicenses:e=>{(0,l.Co)(e).then(t=>{let i=null,l=t.headers?.["content-disposition"]?.toString();l&&(i=(0,a.lj)(l)),(0,r.saveAs)(new Blob([t.data]),i||`${e}.tar.gz`)})}})},11458:function(e,t,i){i.d(t,{s:()=>o});var r=i(27378),l=i(20711);let s=(e,t)=>e.sbom.id===t.sbom.id&&e.sbomStatus===t.sbomStatus,n={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0}},a=e=>{let t=e.flatMap(e=>(e.sboms??[]).flatMap(t=>Object.entries(t.purl_statuses||{}).map(i=>{let[r,l]=i;return{sbom:{...t},sbomStatus:r,advisory:e,packages:l}})).reduce((e,t)=>{let i;let r=e.find(e=>s(e,t));if(r)i=[...e.filter(e=>!s(e,r)),{...r,relatedPackages:[...r.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];else{let r={sbom:t.sbom,sbomStatus:t.sbomStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};i=[...e.slice(),r]}return i},[])),i=t.reduce((e,t)=>{let i=t.sbomStatus;return Object.assign(e,{total:e.total+1,sbomStatus:{...e.sbomStatus,[i]:e.sbomStatus[i]+1}})},{...n});return{sboms:t,summary:i}},o=e=>{let{vulnerability:t,isFetching:i,fetchError:s}=(0,l.p6)(e);return{data:r.useMemo(()=>a(t?.advisories||[]),[t]),isFetching:i,fetchError:s}}},82682:function(e,t,i){i.d(t,{F:()=>u,P:()=>c});var r=i(24246),l=i(27378),s=i(44072),n=i(55096),a=i(94426),o=i(9771),d=i(60787);let c=l.createContext({}),u=e=>{let{children:t}=e,i=(0,a.vZ)({tableName:"advisory",persistenceKeyPrefix:s.yq.advisories,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Title",severity:"Aggregated Severity",modified:"Revision",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","severity","modified"],initialSort:{columnKey:"modified",direction:"desc"},isFilterEnabled:!0,filterCategories:[{categoryKey:s.L4,title:"Filter text",placeholderText:"Search",type:n.vA.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:n.vA.multiselect,selectOptions:[{value:"null",label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"modified",title:"Revision",type:n.vA.dateRange}],isExpansionEnabled:!1}),{result:{data:l,total:u},isFetching:h,fetchError:p}=(0,d.N7)((0,a.QO)({...i,hubSortFieldKeys:{identifier:"identifier",severity:"average_score",modified:"modified"}})),x=(0,a.KC)({...i,idProperty:"identifier",currentPageItems:l,totalItemCount:u,isLoading:h,selectionState:(0,o.U)({items:l,isEqual:(e,t)=>e.identifier===t.identifier})});return(0,r.jsx)(c.Provider,{value:{totalItemCount:u,isFetching:h,fetchError:p,tableControls:x},children:t})}},68595:function(e,t,i){i.d(t,{H:()=>g});var r=i(24246),l=i(27378),s=i(65783),n=i(4835),a=i(14350),o=i(11165),d=i(67918),c=i(31423),u=i(94154),h=i(88935),p=i(42835),x=i(37024),y=i(60767),m=i(3175),v=i(83330),b=i(62126),j=i(86602),f=i(82682);let g=()=>{let{isFetching:e,fetchError:t,totalItemCount:i,tableControls:g}=l.useContext(f.P),{numRenderedColumns:C,currentPageItems:S,propHelpers:{paginationProps:T,tableProps:K,getThProps:w,getTrProps:k,getTdProps:F},expansionDerivedState:{isCellExpanded:P}}=g,{downloadAdvisory:E}=(0,y.i)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.i,{...K,"aria-label":"advisory-table",children:[(0,r.jsx)(a.h,{children:(0,r.jsx)(o.Tr,{children:(0,r.jsxs)(x.qK,{...g,children:[(0,r.jsx)(d.Th,{...w({columnKey:"identifier"})}),(0,r.jsx)(d.Th,{...w({columnKey:"title"})}),(0,r.jsx)(d.Th,{...w({columnKey:"severity"})}),(0,r.jsx)(d.Th,{...w({columnKey:"modified"})}),(0,r.jsx)(d.Th,{...w({columnKey:"vulnerabilities"})})]})})}),(0,r.jsx)(x.hp,{isLoading:e,isError:!!t,isNoData:0===i,numRenderedColumns:C,children:S.map((e,t)=>{let i=e.vulnerabilities.reduce((e,t)=>{let i=(0,j.g)(t.severity);return Object.assign(e,{[i]:e[i]+1})},{critical:0,high:0,medium:0,low:0,none:0,unknown:0});return(0,r.jsx)(c.p,{isExpanded:P(e),children:(0,r.jsx)(o.Tr,{...k({item:e}),children:(0,r.jsxs)(x.Cx,{...g,item:e,rowIndex:t,children:[(0,r.jsx)(u.Td,{width:15,...F({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t}),children:(0,r.jsx)(s.OL,{to:`/advisories/${e.uuid}`,children:e.document_id})}),(0,r.jsx)(u.Td,{width:40,modifier:"truncate",...F({columnKey:"title"}),children:e.title}),(0,r.jsx)(u.Td,{width:15,modifier:"truncate",...F({columnKey:"severity"}),children:e.average_severity&&(0,r.jsx)(m.o,{value:e.average_severity,score:e.average_score,showLabel:!0,showScore:!0})}),(0,r.jsx)(u.Td,{width:10,...F({columnKey:"modified"}),children:(0,b.p6)(e.modified)}),(0,r.jsx)(u.Td,{width:20,...F({columnKey:"vulnerabilities"}),children:(0,r.jsx)(v.u,{severities:i})}),(0,r.jsx)(u.Td,{isActionCell:!0,children:(0,r.jsx)(h.k,{items:[{title:"Download",onClick:()=>{E(e.uuid,`${e.identifier}.json`)}}]})})]})})},e.identifier)})})]}),(0,r.jsx)(p.p,{idPrefix:"advisory-table",isTop:!1,isCompact:!0,paginationProps:T})]})}},68340:function(e,t,i){i.d(t,{F:()=>u,W:()=>c});var r=i(24246),l=i(27378),s=i(44072),n=i(55096),a=i(94426),o=i(9771),d=i(99915);let c=l.createContext({}),u=e=>{let{children:t}=e,i=(0,a.vZ)({tableName:"sbom",persistenceKeyPrefix:s.yq.sboms,persistTo:"urlParams",columnNames:{name:"Name",version:"Version",supplier:"Supplier",published:"Created on",packages:"Dependencies",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","published"],isFilterEnabled:!0,filterCategories:[{categoryKey:s.L4,title:"Filter text",placeholderText:"Search",type:n.vA.search},{categoryKey:"published",title:"Created on",type:n.vA.dateRange}],isExpansionEnabled:!1}),{result:{data:l,total:u},isFetching:h,fetchError:p}=(0,d.Fz)((0,a.QO)({...i,hubSortFieldKeys:{name:"name",published:"published"}})),x=(0,a.KC)({...i,idProperty:"id",currentPageItems:l,totalItemCount:u,isLoading:h,selectionState:(0,o.U)({items:l,isEqual:(e,t)=>e.id===t.id})});return(0,r.jsx)(c.Provider,{value:{totalItemCount:u,isFetching:h,fetchError:p,tableControls:x},children:t})}},36713:function(e,t,i){i.d(t,{H:()=>T});var r=i(24246),l=i(27378),s=i(65783),n=i(4835),a=i(14350),o=i(11165),d=i(67918),c=i(31423),u=i(94154),h=i(88935),p=i(42835),x=i(37024),y=i(60767),m=i(62126),v=i(11797),b=i(6364),j=i(35843),f=i(83330),g=i(74889);let C=e=>{let{sbomId:t}=e,{data:i,isFetching:l,fetchError:s}=(0,g.A)(t);return(0,r.jsx)(j.u,{isFetching:l,fetchError:s,isFetchingState:(0,r.jsx)(v.O,{screenreaderText:"Loading contents"}),fetchErrorState:(0,r.jsx)(b._,{color:"red",children:"Error"}),children:(0,r.jsx)(f.u,{severities:i.summary.vulnerabilityStatus.affected.severities})})};var S=i(68340);let T=()=>{let{isFetching:e,fetchError:t,totalItemCount:i,tableControls:v}=l.useContext(S.W),{numRenderedColumns:b,currentPageItems:j,propHelpers:{paginationProps:f,tableProps:g,getThProps:T,getTrProps:K,getTdProps:w},expansionDerivedState:{isCellExpanded:k}}=v,{downloadSBOM:F,downloadSBOMLicenses:P}=(0,y.i)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.i,{...g,"aria-label":"sbom-table",children:[(0,r.jsx)(a.h,{children:(0,r.jsx)(o.Tr,{children:(0,r.jsxs)(x.qK,{...v,children:[(0,r.jsx)(d.Th,{...T({columnKey:"name"})}),(0,r.jsx)(d.Th,{...T({columnKey:"version"})}),(0,r.jsx)(d.Th,{...T({columnKey:"supplier"})}),(0,r.jsx)(d.Th,{...T({columnKey:"published"})}),(0,r.jsx)(d.Th,{...T({columnKey:"packages"})}),(0,r.jsx)(d.Th,{...T({columnKey:"vulnerabilities"})})]})})}),(0,r.jsx)(x.hp,{isLoading:e,isError:!!t,isNoData:0===i,numRenderedColumns:b,children:j.map((e,t)=>(0,r.jsx)(c.p,{isExpanded:k(e),children:(0,r.jsx)(o.Tr,{...K({item:e}),children:(0,r.jsxs)(x.Cx,{...v,item:e,rowIndex:t,children:[(0,r.jsx)(u.Td,{width:25,...w({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t}),children:(0,r.jsx)(s.OL,{to:`/sboms/${e.id}`,children:e.name})}),(0,r.jsx)(u.Td,{width:15,modifier:"truncate",...w({columnKey:"version"}),children:e.described_by.map(e=>e.version).filter(e=>e).join(", ")}),(0,r.jsx)(u.Td,{width:20,modifier:"truncate",...w({columnKey:"supplier"}),children:e.authors.join(", ")}),(0,r.jsx)(u.Td,{width:10,...w({columnKey:"published"}),children:(0,m.p6)(e.published)}),(0,r.jsx)(u.Td,{width:10,...w({columnKey:"packages"}),children:e.number_of_packages}),(0,r.jsx)(u.Td,{width:20,...w({columnKey:"vulnerabilities"}),children:(0,r.jsx)(C,{sbomId:e.id})}),(0,r.jsx)(u.Td,{isActionCell:!0,children:(0,r.jsx)(h.k,{items:[{title:"Download SBOM",onClick:()=>{F(e.id,`${e.name}.json`)}},{title:"Download License Report",onClick:()=>{P(e.id)}}]})})]})})},e.id))})]}),(0,r.jsx)(p.p,{idPrefix:"sbom-table",isTop:!1,isCompact:!0,paginationProps:f})]})}},14391:function(e,t,i){i.r(t),i.d(t,{default:()=>eb});var r,l=i(24246),s=i(27378),n=i(45043),a=i(27308),o=i(40982),d=i(75070),c=i(25236),u=i(25645),h=i(27763),p=i(44072),x=i(65783),y=i(38175),m=i(6364),v=i(62588),b=i(3594),j=i(106),f=i(13754),g=i(14582),C=i(19364),S=i(23662),T=i(68340),K=i(60787),w=i(71008),k=i(99915),F=i(20711);let P=e=>(0,l.jsx)(x.rU,{to:e.navLink,style:{textDecoration:"none"},children:(0,l.jsxs)(y.s,{itemId:e.id,description:e.description,children:[e.title," ",(0,l.jsx)(m._,{color:e.typeColor,children:e.type})]})},e.id),E=e=>{let{onChangeSearch:t}=e,{tableControls:i}=s.useContext(T.W),r=i.filterState.filterValues[p.L4]?.[0]||"",[n,a]=s.useState(r),[o,d]=s.useState(!1),[c,u]=(0,S.nj)(n,500);s.useEffect(()=>{u(n)},[u,n]);let{isFetching:h,list:x}=function(e,t){let i={filters:[{field:p.L4,operator:"~",value:e}],page:{pageNumber:1,itemsPerPage:5}},{isFetching:r,result:{data:l}}=(0,K.N7)({...i},t),{isFetching:s,result:{data:n}}=(0,w.fF)({...i},t),{isFetching:a,result:{data:o}}=(0,k.Fz)({...i},t),{isFetching:d,result:{data:c}}=(0,F.fd)({...i},t),u=l.map(e=>({id:`advisory-${e.uuid}`,title:e.document_id,description:e.title?.substring(0,75),navLink:`/advisories/${e.uuid}`,type:"Advisory",typeColor:"blue"})),h=n.map(e=>({id:`package-${e.uuid}`,title:e.purl,navLink:`/packages/${e.uuid}`,type:"Package",typeColor:"cyan"})),x=o.map(e=>({id:`sbom-${e.id}`,title:e.name,description:e.authors.join(", "),navLink:`/sboms/${e.id}`,type:"SBOM",typeColor:"purple"})),y=c.map(e=>({id:`vulnerability-${e.identifier}`,title:e.identifier,description:e.description?.substring(0,75),navLink:`/vulnerabilities/${e.identifier}`,type:"Vulnerability",typeColor:"orange"})),m=e.toLowerCase();return{isFetching:r||s||a||d,list:[...y,...x,...u,...h].sort((e,t)=>e.title?.includes(m)?-1:t.title?.includes(m)?1:(e.description||"").toLowerCase().indexOf(m)-(t.description||"").toLowerCase().indexOf(m))}}(c,!o),[m,E]=s.useState(!1),L=s.useRef(null),O=s.useRef(null),A=e=>{""!==e&&L&&L.current&&L.current.contains(document.activeElement)?E(!0):E(!1),a(e),d(!0)};s.useEffect(()=>{let e=e=>{if(m&&L.current&&L.current===e.target){if("Escape"===e.key)E(!1),L.current.focus();else if("ArrowDown"===e.key||"ArrowUp"===e.key){let t=O.current?.querySelector("li > button:not(:disabled)");t&&t?.focus(),e.preventDefault()}else("Tab"===e.key||"Enter"===e.key||"Space"===e.key)&&(E(!1),("Enter"===e.key||"Space"===e.key)&&e.preventDefault())}else m&&O.current?.contains(e.target)&&"Tab"===e.key&&(e.preventDefault(),E(!1),L.current?.focus())},t=e=>{m&&O&&O.current&&!O.current.contains(e.target)&&E(!1)};return window.addEventListener("keydown",e),window.addEventListener("click",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("click",t)}},[m]);let D=(0,l.jsx)(v.v,{ref:O,style:{maxWidth:"450px",maxHeight:"450px",overflow:"scroll",overflowX:"hidden",overflowY:"auto"},children:(0,l.jsx)(b.D,{children:(0,l.jsx)(j.q,{children:h?(0,l.jsx)(y.s,{itemId:"loading",children:(0,l.jsx)(f.$,{size:"sm"})}):x.map(P)})})}),R=(0,l.jsx)(g.M,{placeholder:"Search for an SBOM, Package, or Vulnerability",value:n,onChange:(e,t)=>A(t),onClear:()=>{a("")},onSearch:()=>{t(n)},onKeyDown:e=>{if(e.key&&"Enter"!==e.key)return},ref:L,id:"autocomplete-search"});return(0,l.jsx)(C.r,{trigger:R,triggerRef:L,popper:D,popperRef:O,isVisible:m&&x.length>0||h,enableFlip:!1,appendTo:()=>document.querySelector("#autocomplete-search")})};var L=i(82682),O=i(69694),A=i(91835);function D(e,t){return{Component:e,props:t}}let R=(r=[D(T.F,{}),D(O.u,{}),D(A.W,{}),D(L.F,{})],e=>{let{children:t}=e,i=(0,l.jsx)(l.Fragment,{children:t});return r.reduceRight((e,t)=>{let{Component:i,props:r={}}=t;return(0,l.jsx)(i,{...r,children:e},e.key)},i)});var _=i(99),q=i(11192),V=i(32591),I=i(31757),$=i(51527),M=i(4075),N=i(27090),H=i(75165),B=i(84780),W=i(31762),Y=i(12621),G=i(27317),U=i(93095),z=i(50201),Z=i(55096),Q=i(70919);let J=e=>{let{category:t,filterValue:i,setFilterValue:r}=e,[n,a]=s.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);s.useEffect(()=>{a(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]);let o=Array.isArray(n)?n:Object.values(n).flat(),d=e=>{if(e&&"No results"!==e){let t;r(i?.includes(e)?i.filter(t=>t!==e):i?[...i,e]:[e])}};return(0,l.jsx)(l.Fragment,{children:o.map((e,r)=>{let{label:s,value:n}=e;return(0,l.jsx)(Q.X,{id:`checkbox-${r}-${t.categoryKey}`,isLabelWrapped:!0,label:s,isChecked:i?.includes(n),onChange:()=>{d(n)}},s)})})};var X=i(51088),ee=i(54816),et=i(77152),ei=i(61244),er=i(85189);let el=e=>{let{filterValue:t,setFilterValue:i,isDisabled:r=!1}=e,[n,a]=(0,s.useState)(),[o,d]=(0,s.useState)();return s.useEffect(()=>{if(t?.[0]){let[e,i]=(0,er.bG)(t?.[0]);a(e.toDate()),d(i.toDate())}else a(void 0),d(void 0)},[t]),(0,l.jsxs)(X.l,{children:[(0,l.jsx)(ee.c,{role:"group",isInline:!0,label:"From",children:(0,l.jsx)(et.M,{value:n?(0,er.xR)(n):"",dateFormat:er.xR,dateParse:er.Hy,onChange:(e,t)=>{(0,er.pq)(t)&&(a((0,er.Hy)(t)),d(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:r})}),(0,l.jsx)(ee.c,{role:"group",isInline:!0,label:"To",children:(0,l.jsx)(et.M,{value:o?(0,er.xR)(o):"",onChange:(e,t)=>{if((0,er.pq)(t)){let e=(0,er.Hy)(t);d(e);let r=(0,er.bP)(n,e);r&&i([r])}},isDisabled:r||!(0,ei.q)(n),dateFormat:er.xR,dateParse:er.Hy,invalidFormatText:"",rangeStart:n,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})})]})};var es=i(97656);let en=e=>{let{category:t,filterValue:i,setFilterValue:r,isDisabled:s=!1}=e,n=e=>t.selectOptions.find(t=>{let{value:i}=t;return i===e}),a=e=>{r(n(e)?[e]:null)};return(0,l.jsx)(l.Fragment,{children:t.selectOptions.map((e,t)=>{let{label:r,value:n}=e,o=i?.includes(n)||!1;return(0,l.jsx)(es.Y,{isDisabled:s,id:`radio-${t}`,name:"radio",isLabelWrapped:!0,label:r,isChecked:o,onChange:()=>{a(n)}},r)})})};var ea=i(56081),eo=i(34091),ed=i(9767);let ec=e=>{let{category:t,filterValue:i,setFilterValue:r,isNumeric:n,isDisabled:a=!1}=e,[o,d]=s.useState(i?.[0]||"");s.useEffect(()=>{d(i?.[0]||"")},[i]);let c=()=>{let e=o.trim();r(e?[e.replace(/\s+/g," ")]:[])},u=`${t.categoryKey}-input`;return(0,l.jsxs)(ea.B,{children:[(0,l.jsx)(eo.oi,{name:u,id:"search-input",type:n?"number":"search",onChange:(e,t)=>d(t),"aria-label":`${t.title} filter`,value:o,placeholder:t.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||c()},isDisabled:a}),(0,l.jsx)(z.zx,{variant:z.Wu.control,id:"search-button","aria-label":"search button for search input",onClick:c,isDisabled:a,children:(0,l.jsx)(ed.ZP,{})})]})},eu=e=>{let{category:t,...i}=e;return t.type===Z.vA.select?(0,l.jsx)(en,{category:t,...i}):t.type===Z.vA.search||t.type===Z.vA.numsearch?(0,l.jsx)(ec,{category:t,isNumeric:t.type===Z.vA.numsearch,...i}):t.type===Z.vA.multiselect?(0,l.jsx)(J,{category:t,...i}):t.type===Z.vA.dateRange?(0,l.jsx)(el,{category:t,...i}):null},eh=e=>{let{filterCategories:t,filterValues:i,setFilterValues:r,isDisabled:s=!1,omitFilterCategoryKeys:n=[]}=e,a=(e,t)=>r({...i,[e.categoryKey]:t});return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(G.K,{hasGutter:!0,children:[(0,l.jsx)(U.v,{children:(0,l.jsx)(z.zx,{variant:"link",isInline:!0,onClick:()=>{let e=t.filter(e=>void 0===n.find(t=>t===e.categoryKey)).reduce((e,t)=>Object.assign(e,{[t.categoryKey]:void 0}),{});r({...i,...e})},children:"Clear all filters"})}),t.filter(e=>void 0===n.find(t=>t===e.categoryKey)).map(e=>(0,l.jsx)(U.v,{children:(0,l.jsxs)(G.K,{hasGutter:!0,children:[(0,l.jsx)(U.v,{children:(0,l.jsx)(c.D,{children:(0,l.jsx)(u.x,{component:"h4",children:e.title})})}),(0,l.jsx)(U.v,{children:(0,l.jsx)(eu,{category:e,filterValue:i[e.categoryKey],setFilterValue:t=>a(e,t),isDisabled:s,isSidebar:!0})})]})},e.categoryKey))]})})};var ep=i(68595),ex=i(94681),ey=i(36713),em=i(29212);let ev=e=>{let{filterPanelProps:t,sbomTable:i,sbomTotalCount:r,packageTable:n,packageTotalCount:a,vulnerabilityTable:o,vulnerabilityTotalCount:d,advisoryTable:c,advisoryTotalCount:u}=e,[h,p]=s.useState(0),{sbomFilterPanelProps:x,packageFilterPanelProps:y,vulnerabilityFilterPanelProps:m,advisoryFilterPanelProps:v}=t,b=s.createRef();return(0,l.jsxs)(q.P,{hasGutter:!0,children:[(0,l.jsx)(V.J,{children:(0,l.jsx)(I.Z,{isFullHeight:!0,children:(0,l.jsx)($.e,{style:{width:241},children:0===h?(0,l.jsx)(eh,{omitFilterCategoryKeys:[""],...x}):1===h?(0,l.jsx)(eh,{omitFilterCategoryKeys:[""],...y}):2===h?(0,l.jsx)(eh,{omitFilterCategoryKeys:[""],...m}):3===h?(0,l.jsx)(eh,{omitFilterCategoryKeys:[""],...v}):null})})}),(0,l.jsx)(V.J,{isFilled:!0,children:(0,l.jsxs)(M.m,{mountOnEnter:!0,isBox:!0,activeKey:h,onSelect:(e,t)=>{p(t)},"aria-label":"Tabs",role:"region",children:[(0,l.jsx)(N.O,{eventKey:0,title:(0,l.jsxs)(H.T,{children:["SBOMs","  ",(0,l.jsx)(B.C,{screenReaderText:"Search Result Count",children:r})]}),actions:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(W.b,{"aria-label":"SBOM help popover",ref:b,children:(0,l.jsx)(Y.ZP,{})}),(0,l.jsx)(_.J,{bodyContent:(0,l.jsx)("div",{children:"Software Bill of Materials for Products and Containers."}),position:"right",triggerRef:b})]}),children:i??(0,l.jsx)(ey.H,{})}),(0,l.jsx)(N.O,{eventKey:1,title:(0,l.jsxs)(H.T,{children:["Packages","  ",(0,l.jsx)(B.C,{screenReaderText:"Search Result Count",children:a})]}),children:n??(0,l.jsx)(ex.L,{})}),(0,l.jsx)(N.O,{eventKey:2,title:(0,l.jsxs)(H.T,{children:["Vulnerabilities","  ",(0,l.jsx)(B.C,{screenReaderText:"Search Result Count",children:d})]}),children:o??(0,l.jsx)(em.u,{})}),(0,l.jsx)(N.O,{eventKey:3,title:(0,l.jsxs)(H.T,{children:["Advisories","  ",(0,l.jsx)(B.C,{screenReaderText:"Advisory Result Count",children:u})]}),children:c??(0,l.jsx)(ep.H,{})})]})})]})},eb=e=>{let{searchBodyOverride:t}=e;return(0,l.jsx)(R,{children:(0,l.jsx)(ej,{searchBodyOverride:t})})},ej=e=>{let{searchBodyOverride:t}=e,{tableControls:i}=s.useContext(T.W),{tableControls:r}=s.useContext(O.a),{tableControls:x}=s.useContext(A.P),{tableControls:y}=s.useContext(L.P),{totalItemCount:m,tableControls:{propHelpers:{filterPanelProps:v}}}=s.useContext(T.W),{totalItemCount:b,tableControls:{propHelpers:{filterPanelProps:j}}}=s.useContext(O.a),{totalItemCount:f,tableControls:{propHelpers:{filterPanelProps:g}}}=s.useContext(A.P),{totalItemCount:C,tableControls:{propHelpers:{filterPanelProps:S}}}=s.useContext(L.P),K=(0,l.jsx)(ev,{filterPanelProps:{advisoryFilterPanelProps:S,packageFilterPanelProps:j,sbomFilterPanelProps:v,vulnerabilityFilterPanelProps:g},packageTotalCount:b,sbomTotalCount:m,vulnerabilityTotalCount:f,advisoryTotalCount:C});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.NP,{variant:n.Dk.light,children:(0,l.jsx)(a.o,{isStatic:!0,children:(0,l.jsxs)(o.c,{children:[(0,l.jsx)(d.k,{align:{default:"alignLeft"},children:(0,l.jsx)(c.D,{children:(0,l.jsx)(u.x,{component:"h1",children:"Search Results"})})}),(0,l.jsx)(d.k,{variant:"icon-button-group",align:{default:"alignRight"},children:(0,l.jsx)(d.k,{visibility:{default:"hidden",lg:"visible"},children:(0,l.jsx)(h.E,{widths:{default:"500px"},children:(0,l.jsx)(E,{onChangeSearch:e=>{void 0!==e&&(i.filterState.setFilterValues({...i.filterState.filterValues,[p.L4]:[e]}),r.filterState.setFilterValues({...r.filterState.filterValues,[p.L4]:[e]}),x.filterState.setFilterValues({...x.filterState.filterValues,[p.L4]:[e]}),y.filterState.setFilterValues({...y.filterState.filterValues,[p.L4]:[e]}))}})})})})]})})}),(0,l.jsx)(n.NP,{children:t||K})]})}},91835:function(e,t,i){i.d(t,{P:()=>c,W:()=>u});var r=i(24246),l=i(27378),s=i(44072),n=i(55096),a=i(94426),o=i(9771),d=i(20711);let c=l.createContext({}),u=e=>{let{children:t}=e,i=(0,a.vZ)({tableName:"vulnerability",persistenceKeyPrefix:s.yq.vulnerabilities,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Description",severity:"CVSS",published:"Date published",sboms:"Impacted SBOMs"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["published","severity"],initialSort:{columnKey:"published",direction:"desc"},isFilterEnabled:!0,filterCategories:[{categoryKey:s.L4,title:"Filter text",placeholderText:"Search",type:n.vA.search},{categoryKey:"average_severity",title:"CVSS",placeholderText:"CVSS",type:n.vA.multiselect,selectOptions:[{value:"null",label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"published",title:"Created on",type:n.vA.dateRange}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:l,total:u},isFetching:h,fetchError:p}=(0,d.fd)((0,a.QO)({...i,hubSortFieldKeys:{severity:"average_severity",published:"published"}})),x=(0,a.KC)({...i,idProperty:"identifier",currentPageItems:l,totalItemCount:u,isLoading:h,selectionState:(0,o.U)({items:l,isEqual:(e,t)=>e.identifier===t.identifier})});return(0,r.jsx)(c.Provider,{value:{totalItemCount:u,isFetching:h,fetchError:p,tableControls:x},children:t})}},29212:function(e,t,i){i.d(t,{u:()=>T});var r=i(24246),l=i(27378),s=i(65783),n=i(4835),a=i(14350),o=i(11165),d=i(67918),c=i(31423),u=i(94154),h=i(86602),p=i(3175),x=i(42835),y=i(37024),m=i(28986),v=i(62126),b=i(11797),j=i(6364),f=i(35843),g=i(11458);let C=e=>{let{vulnerabilityId:t}=e,{data:i,isFetching:l,fetchError:s}=(0,g.s)(t);return(0,r.jsx)(f.u,{isFetching:l,fetchError:s,isFetchingState:(0,r.jsx)(b.O,{screenreaderText:"Loading contents"}),fetchErrorState:(0,r.jsx)(j._,{color:"red",children:"Error"}),children:i.summary.sbomStatus.affected})};var S=i(91835);let T=()=>{let{isFetching:e,fetchError:t,totalItemCount:i,tableControls:b}=l.useContext(S.P),{numRenderedColumns:j,currentPageItems:f,propHelpers:{paginationProps:g,tableProps:T,getThProps:K,getTrProps:w,getTdProps:k}}=b;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.i,{...T,"aria-label":"Vulnerability table",children:[(0,r.jsx)(a.h,{children:(0,r.jsx)(o.Tr,{children:(0,r.jsxs)(y.qK,{...b,children:[(0,r.jsx)(d.Th,{...K({columnKey:"identifier"})}),(0,r.jsx)(d.Th,{...K({columnKey:"title"})}),(0,r.jsx)(d.Th,{...K({columnKey:"severity"})}),(0,r.jsx)(d.Th,{...K({columnKey:"published"})}),(0,r.jsx)(d.Th,{...K({columnKey:"sboms"})})]})})}),(0,r.jsx)(y.hp,{isLoading:e,isError:!!t,isNoData:0===i,numRenderedColumns:j,children:f.map((e,t)=>(0,r.jsx)(c.p,{children:(0,r.jsx)(o.Tr,{...w({item:e}),children:(0,r.jsxs)(y.Cx,{...b,item:e,rowIndex:t,children:[(0,r.jsx)(u.Td,{width:15,...k({columnKey:"identifier",item:e,rowIndex:t}),children:(0,r.jsx)(s.OL,{to:`/vulnerabilities/${e.identifier}`,children:e.identifier})}),(0,r.jsx)(u.Td,{width:45,modifier:"truncate",...k({columnKey:"title"}),children:(0,r.jsx)(m.G,{vulnerability:e})}),(0,r.jsx)(u.Td,{width:10,...k({columnKey:"severity"}),children:(0,r.jsx)(p.o,{value:(0,h.g)(e.average_severity),score:e.average_score,showLabel:!0,showScore:!0})}),(0,r.jsx)(u.Td,{width:10,...k({columnKey:"published"}),children:(0,v.p6)(e.published)}),(0,r.jsx)(u.Td,{width:10,...k({columnKey:"sboms",item:e,rowIndex:t}),children:(0,r.jsx)(C,{vulnerabilityId:e.identifier})})]})})},e.identifier))})]}),(0,r.jsx)(x.p,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:g})]})}},60787:function(e,t,i){i.d(t,{N7:()=>u,gw:()=>h,tG:()=>p});var r=i(1183),l=i(68e3),s=i(22285),n=i(54227),a=i(54774),o=i(94426),d=i(22100);let c="advisories",u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:i,isLoading:l,error:a,refetch:d}=(0,r.a)({queryKey:[c,e],queryFn:()=>(0,n.A1)({client:s.L,query:{...(0,o.rm)(e)}}),enabled:!t});return{result:{data:i?.data?.items||[],total:i?.data?.total??0,params:e??e},isFetching:l,fetchError:a||null,refetch:d}},h=e=>{let{data:t,isLoading:i,error:l}=(0,r.a)({queryKey:[c,e],queryFn:()=>(0,n.pB)({client:s.L,path:{key:e}}),enabled:void 0!==e});return{advisory:t?.data,isFetching:i,fetchError:l}},p=()=>{let e=(0,l.NL)();return(0,d.V)({parallel:!0,uploadFn:(e,t)=>(0,a.Cu)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[c]})}})}},20711:function(e,t,i){i.d(t,{fd:()=>o,p6:()=>d});var r=i(1183),l=i(22285),s=i(54227),n=i(94426);let a="vulnerabilities",o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:i,isLoading:o,error:d,refetch:c}=(0,r.a)({queryKey:[a,e],queryFn:()=>(0,s.b5)({client:l.L,query:{...(0,n.rm)(e)}}),enabled:!t});return{result:{data:i?.data?.items||[],total:i?.data?.total??0,params:e},isFetching:o,fetchError:d,refetch:c}},d=e=>{let{data:t,isLoading:i,error:n}=(0,r.a)({queryKey:[a,e],queryFn:()=>(0,s.OG)({client:l.L,path:{id:e}})});return{vulnerability:t?.data,isFetching:i,fetchError:n}}}}]);