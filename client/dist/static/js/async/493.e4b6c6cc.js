"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["493"],{24296:function(e,t,l){l.d(t,{a:()=>r});var n=l(62540),i=l(59394),a=l(81595),s=l(40554);let r=e=>e.isFetching?e.isFetchingState||(0,n.jsx)(i.a,{children:(0,n.jsx)(a.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,n.jsx)(s.q,{}):e.children},92107:function(e,t,l){l.d(t,{D:()=>a});var n=l(62540),i=l(69548);let a=e=>{let{error:t}=e;return(0,n.jsxs)(i.J,{color:"red",children:[t.status," Error"]})}},15461:function(e,t,l){l.d(t,{n:()=>u});var n=l(62540),i=l(28338),a=l(70045),s=l(7261),r=l(86099),o=l(71284),c=l(45969);let u=e=>{let{severities:t}=e,l=Object.values(t).reduce((e,t)=>e+t,0);return(0,n.jsxs)(i.s,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,n.jsx)(a.Z,{"aria-label":"total",style:{minWidth:15,textAlign:r.pG},children:l}),(0,n.jsx)(s.c,{orientation:{default:"vertical"}}),(0,n.jsx)(a.Z,{children:(0,n.jsx)(i.s,{children:Object.entries(t).filter(e=>{let[t,l]=e;return l>0}).sort((0,o.Sx)(e=>{let[t,l]=e;return t})).reverse().map(e=>{let[t,l]=e;return(0,n.jsx)(a.Z,{spacer:{default:"spacerXs"},children:(0,n.jsxs)(i.s,{"aria-label":t,spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,n.jsx)(a.Z,{children:(0,n.jsx)(c.h,{value:t,score:null})}),(0,n.jsx)(a.Z,{children:l})]})},t)})})})]})}},3652:function(e,t,l){l.d(t,{RQ:()=>u,UI:()=>h,nm:()=>p});var n=l(32909),i=l(42642),a=l(63696),s=l(27875),r=l(30111);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},u={vulnerabilityStatus:{affected:(0,n._)({},c),fixed:(0,n._)({},c),not_affected:(0,n._)({},c),known_not_affected:(0,n._)({},c),under_investigation:(0,n._)({},c)}},d=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let l,a=e.find(e=>o(e,t));if(a){let s=e.filter(e=>!o(e,a)),r=a.vulnerability.average_score>t.vulnerability.average_score?a:t;l=[...s,(0,i._)((0,n._)({},r),{relatedPackages:[...a.relatedPackages,{advisory:t.advisory,packages:t.packages}]})]}else{let n={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};l=[...e.slice(),n]}return l},[]),l=t.reduce((e,t)=>{let l=t.vulnerabilityStatus,a=(0,s.U)(t.vulnerability.average_severity),r=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,i._)((0,n._)({},e.vulnerabilityStatus),{[l]:{total:r.total+1,severities:(0,i._)((0,n._)({},r.severities),{[a]:r.severities[a]+1})}})})},(0,n._)({},u));return{vulnerabilities:t,summary:l}},h=e=>{let{advisories:t,isFetching:l,fetchError:n}=(0,r.DH)(e);return{data:a.useMemo(()=>d(t||[]),[t]),isFetching:l,fetchError:n}},p=e=>{let{advisories:t,isFetching:l,fetchError:n}=(0,r.zY)(e);return{data:a.useMemo(()=>(null!=t?t:[]).map(e=>d(e||[])),[t]),isFetching:l,fetchError:n}}},98345:function(e,t,l){l.d(t,{f:()=>o});var n=l(62540),i=l(63696),a=l(91242),s=l(4392),r=l(30111);let o=e=>{let{sbom:t,onClose:l}=e,{pushNotification:o}=i.useContext(s.K),[c,u]=i.useState(""),[d,h]=i.useState("");i.useEffect(()=>{let e=setTimeout(()=>{h(c)},400);return()=>clearTimeout(e)},[c]);let{labels:p}=(0,r._P)(d),{mutate:m,isPending:b}=(0,r.cF)(()=>{o({title:"Labels updated for SBOM ".concat(t.name),variant:"success"}),l()},e=>{o({title:"Error while updating labels for SBOM ".concat(t.name),variant:"danger"})});return(0,n.jsx)(a.e,{title:"Labels of SBOM: ".concat(t.name),value:t.labels,isDisabled:b,onSave:e=>{m({id:t.id,labels:e})},onClose:l,onInputChange:u,options:p})}},57184:function(e,t,l){l.d(t,{L:()=>m,c:()=>b});var n=l(32909),i=l(42642),a=l(62540),s=l(63696),r=l(27800),o=l(98259),c=l(71284);function u(e,t,l){return 0===l.length?[]:t.filter(t=>l.some(l=>e(t,l)))}l(21999);var d=l(73470),h=l(97773),p=l(30111);let m=s.createContext({}),b=e=>{var t;let{isBulkSelectionEnabled:l,children:b}=e,[x,v]=s.useState(""),[f]=(0,r.Q3)(x,400),{labels:g}=(0,p._P)(f),[j,y]=s.useState(""),[_]=(0,r.Q3)(j,400),{result:{data:S}}=(0,h.K)({filters:[{field:o._G,operator:"~",value:_}],sort:{field:"license",direction:"asc"},page:{pageNumber:1,itemsPerPage:10}}),k=(0,d.MM)({tableName:"sbom",persistenceKeyPrefix:o.rt.sboms,persistTo:"urlParams",columnNames:{name:"Name",version:"Version",supplier:"Supplier",labels:"Labels",published:"Created on",packages:"Dependencies",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","published"],isFilterEnabled:!0,filterCategories:[{categoryKey:o._G,title:"Filter text",placeholderText:"Search",type:"search"},{categoryKey:"published",title:"Created on",type:"dateRange"},{categoryKey:"labels",title:"Label",type:"autocompleteLabel",placeholderText:"Filter results by label",selectOptions:g.map(e=>{let t=(0,c.m4)({key:e.key,value:e.value});return{value:t,label:t}}),onInputValueChange:v},{categoryKey:"license",title:"License",type:"asyncMultiselect",placeholderText:"Filter results by license",selectOptions:S.map(e=>({value:e.license,label:e.license})),onInputValueChange:y}],isExpansionEnabled:!1,isSelectionEnabled:l}),{result:{data:C,total:T},isFetching:E,fetchError:I}=(0,p.i$)((0,d.Ng)((0,i._)((0,n._)({},k),{hubSortFieldKeys:{name:"name",published:"published"}})),(null!=(t=k.filterState.filterValues.labels)?t:[]).map(e=>(0,c.Cb)(e))),K=(0,d.PB)((0,i._)((0,n._)({},k),{idProperty:"id",currentPageItems:C,totalItemCount:T,isLoading:E})),P=(e=>{var t;let{isEqual:l=(e,t)=>e===t,items:n,filteredItems:i,currentPageItems:a,initialSelected:r}=e,o=null!=(t=null!=n?n:i)?t:a,{selectedItems:c,areAllSelected:d,isItemSelected:h,selectItems:p,selectOnly:m,selectAll:b}=(e=>{let{items:t,initialSelected:l=[],isEqual:n=(e,t)=>e===t}=e,[i,a]=s.useState(u(n,t,l)),r=s.useCallback(e=>i.some(t=>n(e,t)),[n,i]),o=s.useCallback((e,l)=>{let s=u(n,t,e),r=i.filter(e=>!s.some(t=>n(e,t)));l?a([...r,...s]):a(r)},[n,t,i]),c=s.useCallback(e=>{a(u(n,t,e))},[n,t]),d=s.useCallback(function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return a(e?t:[])},[t]),h=s.useMemo(()=>i.length===t.length&&i.every(e=>t.some(t=>n(e,t))),[i,t,n]);return{selectedItems:s.useMemo(()=>0===i.length?[]:h?t:t.filter(r),[h,r,t,i]),isItemSelected:r,areAllSelected:h,selectItems:o,selectOnly:c,selectAll:d}})({items:o,isEqual:l,initialSelected:r}),x={areAllSelected:d,itemCounts:{selected:c.length,page:a.length,filtered:i?i.length:void 0,totalItems:o.length},onSelectNone:()=>b(!1),onSelectCurrentPage:()=>m(a),onSelectAllFiltered:i?()=>m(i):void 0,onSelectAll:n?()=>b(!0):void 0};return{selectedItems:c,propHelpers:{toolbarBulkSelectorProps:x,getSelectCheckboxTdProps:e=>{let{item:t,rowIndex:l}=e;return{select:{rowIndex:l,onSelect:(e,l)=>{p([t],l)},isSelected:h(t)}}}}}})({isEqual:(e,t)=>e.id===t.id,filteredItems:K.filteredItems,currentPageItems:K.currentPageItems});return(0,a.jsx)(m.Provider,{value:{totalItemCount:T,isFetching:E,fetchError:I,tableControls:K,bulkSelection:{isEnabled:!!l,controls:P}},children:b})}},74466:function(e,t,l){l.d(t,{Y:()=>N});var n=l(32909),i=l(42642),a=l(62540),s=l(63696),r=l(74343),o=l(38927),c=l(80057),u=l(13021),d=l(24773),h=l(26917),p=l(16646),m=l(21758),b=l(40384),x=l(28516),v=l(78517),f=l(62101),g=l(71284),j=l(89705),y=l(12852),_=l(4392),S=l(93826),k=l(30448),C=l(98259),T=l(99528),E=l(30111),I=l(67458),K=l(23909),P=l(98345),w=l(6160),F=l(24296),L=l(92107),M=l(15461),O=l(3652);let D=e=>{let{sbomId:t}=e,{data:l,isFetching:n,fetchError:i}=(0,O.UI)(t);return(0,a.jsx)(F.a,{isFetching:n,fetchError:i,isFetchingState:(0,a.jsx)(w.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,a.jsx)(L.D,{error:e}),children:(0,a.jsx)(M.n,{severities:l.summary.vulnerabilityStatus.affected.severities})})};var B=l(57184);let N=()=>{let{pushNotification:e}=s.useContext(_.K),{isFetching:t,fetchError:l,totalItemCount:w,tableControls:F,bulkSelection:{isEnabled:L,controls:M}}=s.useContext(B.L),[O,N]=s.useState(null),Z=null!==O,{numRenderedColumns:U,currentPageItems:V,propHelpers:{paginationProps:q,tableProps:H,getThProps:A,getTrProps:G,getTdProps:J},expansionDerivedState:{isCellExpanded:W},filterState:{filterValues:Q,setFilterValues:R}}=F,{selectedItems:X,propHelpers:{getSelectCheckboxTdProps:Y}}=M,{downloadSBOM:$,downloadSBOMLicenses:z}=(0,T.m)(),ee=()=>{N(null)},[et,el]=s.useState(null),{mutate:en,isPending:ei}=(0,E.l6)(t=>{el(null),e({title:(0,C.B7)(t),variant:"success"})},t=>{e({title:(0,C.Ut)(t),variant:"danger"})});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.X,(0,i._)((0,n._)({},H),{"aria-label":"sbom-table",children:[(0,a.jsx)(p.d,{children:(0,a.jsx)(m.Tr,{children:(0,a.jsxs)(k.Ze,(0,i._)((0,n._)({},F),{children:[(0,a.jsx)(b.Th,(0,n._)({},A({columnKey:"name"}))),(0,a.jsx)(b.Th,(0,n._)({},A({columnKey:"version"}))),(0,a.jsx)(b.Th,(0,n._)({},A({columnKey:"supplier"}))),(0,a.jsx)(b.Th,(0,n._)({},A({columnKey:"labels"}))),(0,a.jsx)(b.Th,(0,n._)({},A({columnKey:"published"}))),(0,a.jsx)(b.Th,(0,n._)({},A({columnKey:"packages"}))),(0,a.jsx)(b.Th,(0,n._)({},A({columnKey:"vulnerabilities"})))]}))})}),(0,a.jsx)(k.nJ,{isLoading:t,isError:!!l,isNoData:0===w,numRenderedColumns:U,children:V.map((e,t)=>(0,a.jsx)(x.N,{isExpanded:W(e),children:(0,a.jsx)(m.Tr,(0,i._)((0,n._)({},G({item:e})),{children:(0,a.jsxs)(k.Oi,(0,i._)((0,n._)({},F),{getSelectCheckboxTdProps:L?Y:void 0,item:e,rowIndex:t,children:[(0,a.jsx)(v.Td,(0,i._)((0,n._)({width:20,modifier:"breakWord"},J({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t})),{children:(0,a.jsx)(r.k2,{to:(0,r.tW)(I.Jh.sbomDetails,{sbomId:e.id}),children:e.name})})),(0,a.jsx)(v.Td,(0,i._)((0,n._)({width:10,modifier:"truncate"},J({columnKey:"version"})),{children:e.described_by.map(e=>e.version).filter(e=>e).join(", ")})),(0,a.jsx)(v.Td,(0,i._)((0,n._)({width:10,modifier:"truncate"},J({columnKey:"supplier"})),{children:e.suppliers.join(", ")})),(0,a.jsx)(v.Td,(0,i._)((0,n._)({width:20,modifier:"truncate"},J({columnKey:"labels"})),{children:(0,a.jsx)(y.g,{value:e.labels,onClick:e=>{let{key:t,value:l}=e,a=(0,g.m4)({key:t,value:l}),s=Q.labels;if(!(null==s?void 0:s.includes(a))){let e=s?[...s,a]:[a];R((0,i._)((0,n._)({},Q),{labels:e}))}}})})),(0,a.jsx)(v.Td,(0,i._)((0,n._)({width:10,modifier:"truncate"},J({columnKey:"published"})),{children:(0,K.Yq)(e.published)})),(0,a.jsx)(v.Td,(0,i._)((0,n._)({width:10},J({columnKey:"packages"})),{children:e.number_of_packages})),(0,a.jsx)(v.Td,(0,i._)((0,n._)({width:20},J({columnKey:"vulnerabilities"})),{children:(0,a.jsx)(D,{sbomId:e.id})})),(0,a.jsx)(v.Td,{isActionCell:!0,children:(0,a.jsx)(f.G,{items:[{title:"Edit labels",onClick:()=>{N(e)}},{isSeparator:!0},{title:"Download SBOM",onClick:()=>{$(e.id,"".concat(e.name,".json"))}},{title:"Download License Report",onClick:()=>{z(e.id)}},{isSeparator:!0},{title:"Delete",onClick:()=>{el(e)}}]})})]}))}))},e.id))})]})),(0,a.jsx)(S.n,{idPrefix:"sbom-table",isTop:!1,paginationProps:q}),(0,a.jsxs)(o.a,{isOpen:Z,variant:"medium",onClose:ee,children:[(0,a.jsx)(c.r,{title:"Edit labels"}),(0,a.jsx)(u.c,{children:O&&(0,a.jsx)(P.f,{sbom:O,onClose:ee})})]}),(0,a.jsx)(j.T,(0,i._)((0,n._)({},(0,C.zK)(et)),{inProgress:ei,titleIconVariant:"warning",isOpen:!!et,confirmBtnVariant:d.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>el(null),onClose:()=>el(null),onConfirm:()=>{et&&en(et.id)}}))]})}},92426:function(e,t,l){l.d(t,{r:()=>_});var n=l(32909),i=l(42642),a=l(62540),s=l(63696),r=l(74343),o=l(61360),c=l(35048),u=l(32490),d=l(24773),h=l(21999),p=l(93826),m=l(84818),b=l(90717),x=l(96526),v=l(17200),f=l(52993);let g=e=>{let{areAllSelected:t,itemCounts:{totalItems:l,filtered:n,page:i,selected:r},onSelectNone:o,onSelectCurrentPage:c,onSelectAllFiltered:d,onSelectAll:h}=e,[p,g]=(0,s.useState)(!1),j=e=>()=>{e(),g(!1)},y=(0,s.useMemo)(()=>!!t&&l>0||0!==r&&null,[t,l,r]),_=[(0,a.jsx)(m.t,{onClick:j(o),"data-action":"none",component:"button",children:"Select none (0 items)"},"select-none"),(0,a.jsxs)(m.t,{onClick:j(c),"data-action":"page",component:"button",children:["Select page (",i," items)"]},"select-page"),void 0!==d&&(0,a.jsxs)(m.t,{onClick:j(d),"data-action":"all",component:"button",children:["Select all filtered (",n," items)"]},"select-all-filtered"),void 0!==h&&(0,a.jsxs)(m.t,{onClick:j(h),"data-action":"all",component:"button",children:["Select all (",l,")"]},"select-all")].filter(Boolean);return(0,a.jsx)(u.T,{children:(0,a.jsx)(b.m,{isOpen:p,onOpenChange:e=>g(e),toggle:e=>(0,a.jsx)(x.S3,{isDisabled:0===l,ref:e,onClick:()=>g(!p),splitButtonItems:[(0,a.jsx)(v.l,{id:"bulk-selected-items-checkbox","aria-label":"Select page",onChange:e=>{e?c():o()},isChecked:y,children:0===r?"":"Selected ".concat(r)},"bulk-select-checkbox")]}),children:(0,a.jsx)(f.Q,{children:_})})})};var j=l(67458),y=l(57184);let _=e=>{let{showFilters:t,showActions:l}=e,m=(0,r.Zp)(),{tableControls:b,bulkSelection:{isEnabled:x,controls:v}}=s.useContext(y.L),{propHelpers:{toolbarProps:f,filterToolbarProps:_,paginationToolbarItemProps:S,paginationProps:k}}=b,{propHelpers:{toolbarBulkSelectorProps:C}}=v;return(0,a.jsx)(o.M,(0,i._)((0,n._)({},f),{"aria-label":"sbom-toolbar",children:(0,a.jsxs)(c.P,{children:[x&&(0,a.jsx)(g,(0,n._)({},C)),t&&(0,a.jsx)(h.Us,(0,n._)({},_)),l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.T,{children:(0,a.jsx)(d.$n,{variant:"primary",onClick:()=>m(j.Jh.sbomUpload),children:"Upload SBOM"})}),(0,a.jsx)(u.T,{children:(0,a.jsx)(d.$n,{variant:"secondary",onClick:()=>m(j.Jh.sbomScan),children:"Generate vulnerability report"})})]}),(0,a.jsx)(u.T,(0,i._)((0,n._)({},S),{children:(0,a.jsx)(p.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:k})}))]})}))}},97773:function(e,t,l){l.d(t,{K:()=>o});var n=l(32909),i=l(77184),a=l(96002),s=l(86141),r=l(73470);let o=function(){var e,t,l;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:u,isLoading:d,error:h,refetch:p}=(0,i.I)({queryKey:["licenses",o],queryFn:()=>(0,s.Zy)({client:a.S,query:(0,n._)({},(0,r.kd)(o))}),enabled:!c});return{result:{data:(null==u||null==(e=u.data)?void 0:e.items)||[],total:null!=(l=null==u||null==(t=u.data)?void 0:t.total)?l:0,params:o},isFetching:d,fetchError:h,refetch:p}}}}]);