"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["255"],{25769:function(e,i,n){n.d(i,{D:()=>s});var r=n(24246),l=n(6364);let s=e=>{let{value:i}=e;return(0,r.jsx)(r.Fragment,{children:Object.entries(i).map(e=>{let[i,n]=e;return(0,r.jsx)(l._,{isCompact:!0,children:`${i}=${n}`},`${i}=${n}`)})})}},99196:function(e,i,n){n.d(i,{V:()=>t});var r=n(24246),l=n(27378),s=n(73474),a=n(18142);let t=e=>{let{vulnerabilitiesSummary:i}=e,n=l.useMemo(()=>Object.keys(i.severities).map(e=>{let n=i.severities[e],r=a.V4[e];return{severity:e,count:n,label:r.name,color:r.color.value}}).sort((0,a.A0)(e=>e.severity)),[i]);return(0,r.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,r.jsx)(s.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${i.total}`,subTitle:"Total vulnerabilities",width:350,legendData:n.map(e=>{let{label:i,count:n}=e;return{name:`${i}: ${n}`}}),data:n.map(e=>{let{label:i,count:n}=e;return{x:i,y:n}}),labels:e=>{let{datum:i}=e;return`${i.x}: ${i.y}`},colorScale:n.map(e=>{let{color:i}=e;return i})})})}},3175:function(e,i,n){n.d(i,{o:()=>c});var r=n(24246),l=n(34747),s=n(46770),a=n(2499),t=n(35676),d=n(18142);let c=e=>{let{value:i,score:n,showScore:c,showLabel:h}=e,o=d.V4[i],x=o.name;return(0,r.jsxs)(l.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,r.jsx)(s.B,{children:h?(0,r.jsx)(t.ZP,{color:o.color.value}):(0,r.jsx)(a.u,{content:x,children:(0,r.jsx)(t.ZP,{color:o.color.value})})}),h&&(0,r.jsx)(s.B,{children:x}),c&&null!==n&&(0,r.jsxs)(s.B,{children:["(",n,")"]})]})}},42835:function(e,i,n){n.d(i,{p:()=>s});var r=n(24246),l=n(40583);let s=e=>{let{paginationProps:i,isTop:n,isCompact:s=!1,idPrefix:a=""}=e;return(0,r.jsx)(l.t,{id:`${a?`${a}-`:""}pagination-${n?"top":"bottom"}`,variant:n?l.a.top:l.a.bottom,isCompact:s,...i,widgetId:"pagination-id"})}},37024:function(e,i,n){n.d(i,{hp:()=>b,qK:()=>g,Cx:()=>y});var r=n(24246),l=n(8305),s=n(13754),a=n(31423),t=n(11165),d=n(94154),c=n(48336),h=n(96582),o=n(610),x=n(68940),j=n(16668),u=n(22119);let p=e=>{let{title:i,description:n}=e;return(0,r.jsxs)(h.u,{variant:h.I.sm,children:[(0,r.jsx)(o.k,{icon:u.ZP}),(0,r.jsx)(x.D,{headingLevel:"h2",size:"lg",children:i}),n&&(0,r.jsx)(j.B,{children:n})]})},m=()=>(0,r.jsx)(p,{title:"No data available",description:"No data available to be shown here."}),b=e=>{let{numRenderedColumns:i,isLoading:n=!1,isError:h=!1,isNoData:o=!1,errorEmptyState:x=null,noDataEmptyState:j=null,children:u}=e;return(0,r.jsx)(r.Fragment,{children:n?(0,r.jsx)(a.p,{children:(0,r.jsx)(t.Tr,{children:(0,r.jsx)(d.Td,{colSpan:i,children:(0,r.jsx)(l.b,{children:(0,r.jsx)(s.$,{size:"xl"})})})})}):h?(0,r.jsx)(a.p,{"aria-label":"Table error",children:(0,r.jsx)(t.Tr,{children:(0,r.jsx)(d.Td,{colSpan:i,children:(0,r.jsx)(l.b,{children:x||(0,r.jsx)(c.y,{})})})})}):o?(0,r.jsx)(a.p,{"aria-label":"Table error",children:(0,r.jsx)(t.Tr,{children:(0,r.jsx)(d.Td,{colSpan:i,children:(0,r.jsx)(l.b,{children:j||(0,r.jsx)(m,{})})})})}):u})};var f=n(67918);let g=e=>{let{numColumnsBeforeData:i,numColumnsAfterData:n,children:l}=e;return(0,r.jsxs)(r.Fragment,{children:[Array(i).fill(null).map((e,i)=>(0,r.jsx)(f.Th,{screenReaderText:`before-data-${i}`},i)),l,Array(n).fill(null).map((e,i)=>(0,r.jsx)(f.Th,{screenReaderText:`after-data-${i}`},i))]})},y=e=>{let{isExpansionEnabled:i=!1,expandableVariant:n,isSelectionEnabled:l=!1,propHelpers:{getSingleExpandButtonTdProps:s,getSelectCheckboxTdProps:a},item:t,rowIndex:c,children:h}=e;return(0,r.jsxs)(r.Fragment,{children:[i&&"single"===n?(0,r.jsx)(d.Td,{...s({item:t,rowIndex:c})}):null,l?(0,r.jsx)(d.Td,{...a({item:t,rowIndex:c})}):null,h]})}},6703:function(e,i,n){n.d(i,{j:()=>s});var r=n(24246),l=n(27378);let s=e=>{let{children:i}=e,[n,s]=l.useState(!1);return(0,r.jsx)(r.Fragment,{children:i(n,s)})}},28986:function(e,i,n){n.d(i,{G:()=>l});var r=n(24246);let l=e=>{let{vulnerability:i}=e;return(0,r.jsxs)("p",{children:[i.withdrawn&&(0,r.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},60767:function(e,i,n){n.d(i,{i:()=>d});var r=n(2926),l=n(54774),s=n(22285),a=n(54227),t=n(62126);let d=()=>({downloadAdvisory:(e,i)=>{(0,a.Em)({client:s.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(n=>{(0,r.saveAs)(new Blob([n.data]),i||`${e}.json`)})},downloadSBOM:(e,i)=>{(0,a.XW)({client:s.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(n=>{(0,r.saveAs)(new Blob([n.data]),i||`${e}.json`)})},downloadSBOMLicenses:e=>{(0,l.Co)(e).then(i=>{let n=null,l=i.headers?.["content-disposition"]?.toString();l&&(n=(0,t.lj)(l)),(0,r.saveAs)(new Blob([i.data]),n||`${e}.tar.gz`)})}})},9280:function(e,i,n){n.r(i),n.d(i,{default:()=>eS});var r=n(24246),l=n(27378),s=n(45043),a=n(11192),t=n(32591),d=n(34747),c=n(46770),h=n(25236),o=n(25645),x=n(6364),j=n(32939),u=n(24620),p=n(37961),m=n(69265),b=n(4075),f=n(27090),g=n(75165),y=n(31762),v=n(99),T=n(24787),S=n(12621),P=n(6643),M=n(35843),k=n(60767),w=n(99915),K=n(65872),C=n(87727),F=n(3498),E=n(31757),B=n(87069),O=n(51527),$=n(74481),_=n(50689),I=n(67761),D=n(81391),N=n(81211),q=n(45882),V=n(62126);let A=e=>{let{sbom:i}=e;return(0,r.jsxs)(C.r,{hasGutter:!0,children:[(0,r.jsx)(F.P,{md:4,children:(0,r.jsxs)(E.Z,{isFullHeight:!0,children:[(0,r.jsx)(B.l,{children:"Metadata"}),(0,r.jsx)(O.e,{children:(0,r.jsxs)($.o,{children:[(0,r.jsxs)(_.g,{children:[(0,r.jsx)(I.M,{children:"Name"}),(0,r.jsx)(D.b,{"aria-label":"SBOM's name",children:i.name})]}),(0,r.jsxs)(_.g,{children:[(0,r.jsx)(I.M,{children:"Namespace"}),(0,r.jsx)(D.b,{"aria-label":"SBOM's namespace",children:i.document_id})]}),(0,r.jsxs)(_.g,{children:[(0,r.jsx)(I.M,{children:"Data License"}),(0,r.jsx)(D.b,{"aria-label":"SBOM's license",children:i.data_licenses.join(", ")})]})]})})]})}),(0,r.jsx)(F.P,{md:4,children:(0,r.jsxs)(E.Z,{isFullHeight:!0,children:[(0,r.jsx)(B.l,{children:"Creation"}),(0,r.jsx)(O.e,{children:(0,r.jsxs)($.o,{children:[(0,r.jsxs)(_.g,{children:[(0,r.jsx)(I.M,{children:"Created"}),(0,r.jsx)(D.b,{"aria-label":"SBOM's creation date",children:(0,V.p6)(i.published)})]}),(0,r.jsxs)(_.g,{children:[(0,r.jsx)(I.M,{children:"Creator"}),(0,r.jsx)(D.b,{"aria-label":"SBOM's creator",children:i.authors})]})]})})]})}),(0,r.jsx)(F.P,{md:4,children:(0,r.jsxs)(E.Z,{isFullHeight:!0,children:[(0,r.jsx)(B.l,{children:"Statistics"}),(0,r.jsx)(O.e,{children:(0,r.jsxs)($.o,{children:[(0,r.jsxs)(_.g,{children:[(0,r.jsx)(I.M,{children:"Size"}),(0,r.jsx)(D.b,{children:(0,K.Z)(i.size)})]}),(0,r.jsxs)(_.g,{children:[(0,r.jsx)(I.M,{children:"Packages"}),(0,r.jsx)(D.b,{children:i.number_of_packages})]})]})})]})}),(0,r.jsx)(F.P,{md:12,children:(0,r.jsxs)(E.Z,{isFullHeight:!0,children:[(0,r.jsx)(B.l,{children:"Package"}),(0,r.jsx)(O.e,{children:(0,r.jsxs)($.o,{children:[(0,r.jsxs)(_.g,{children:[(0,r.jsx)(I.M,{children:"Name"}),(0,r.jsx)(D.b,{children:i.name})]}),(0,r.jsxs)(_.g,{children:[(0,r.jsx)(I.M,{children:"Version"}),(0,r.jsx)(D.b,{children:i.described_by.map(e=>e.version).join(", ")})]}),(0,r.jsxs)(_.g,{children:[(0,r.jsx)(I.M,{children:"External References"}),(0,r.jsx)(D.b,{children:(0,r.jsxs)(N.aV,{children:[i.described_by.flatMap(e=>e.cpe).map(e=>(0,r.jsx)(q.H,{children:e},e)),(0,r.jsx)(q.H,{children:i.described_by.flatMap(e=>e.purl).map(e=>e.purl)})]})})]})]})})]})})]})};var L=n(65783),R=n(27308),Z=n(40982),H=n(27763),G=n(62997),z=n(4835),U=n(14350),X=n(11165),J=n(67918),Q=n(31423),W=n(94154),Y=n(67447),ee=n(44072),ei=n(55096),en=n(42835),er=n(37024),el=n(94426),es=n(9771),ea=n(71008);let et=e=>{let{sbomId:i}=e,n=(0,el.vZ)({tableName:"package-table",columnNames:{name:"Name",version:"Version"},isSortEnabled:!0,sortableColumns:["name"],isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:ee.L4,title:"Filter text",placeholderText:"Search",type:ei.vA.search}],isExpansionEnabled:!0,expandableVariant:"single"}),{result:{data:l,total:s},isFetching:a,fetchError:t}=(0,ea.D4)(i,(0,el.QO)({...n,hubSortFieldKeys:{name:"name"}})),d=(0,el.KC)({...n,idProperty:"id",currentPageItems:l,totalItemCount:s,isLoading:a,selectionState:(0,es.U)({items:l,isEqual:(e,i)=>e.id===i.id})}),{currentPageItems:c,numRenderedColumns:h,propHelpers:{toolbarProps:o,filterToolbarProps:x,paginationToolbarItemProps:j,paginationProps:u,tableProps:p,getThProps:m,getTrProps:b,getTdProps:f,getExpandedContentTdProps:g},expansionDerivedState:{isCellExpanded:y}}=d;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R.o,{...o,children:(0,r.jsxs)(Z.c,{children:[(0,r.jsx)(ei.Ki,{showFiltersSideBySide:!0,...x}),(0,r.jsx)(H.E,{...j,children:(0,r.jsx)(en.p,{idPrefix:"package-table",isTop:!0,paginationProps:u})})]})}),(0,r.jsxs)(z.i,{...p,"aria-label":"Package table",children:[(0,r.jsx)(U.h,{children:(0,r.jsx)(X.Tr,{children:(0,r.jsxs)(er.qK,{...d,children:[(0,r.jsx)(J.Th,{...m({columnKey:"name"})}),(0,r.jsx)(J.Th,{...m({columnKey:"version"})})]})})}),(0,r.jsx)(er.hp,{isLoading:a,isError:!!t,isNoData:0===s,numRenderedColumns:h,children:c?.map((e,i)=>r.jsxs(Q.p,{children:[r.jsx(X.Tr,{...b({item:e}),children:r.jsxs(er.Cx,{...d,item:e,rowIndex:i,children:[r.jsx(W.Td,{width:80,...f({columnKey:"name"}),children:[e.name,e.group].filter(Boolean).join("/")}),r.jsx(W.Td,{width:20,modifier:"truncate",...f({columnKey:"version"}),children:e.decomposedPurl?.version}),r.jsx(W.Td,{width:50,...f({columnKey:"qualifiers"}),children:e.decomposedPurl?.qualifiers&&r.jsx(PackageQualifiers,{value:e.decomposedPurl?.qualifiers})})]})}),y(e)?r.jsxs(X.Tr,{isExpanded:!0,children:[r.jsx(W.Td,{}),r.jsx(W.Td,{...g({item:e}),className:G.Z.pyLg,children:r.jsx(Y.G,{children:r.jsx($.o,{children:r.jsxs(_.g,{children:[r.jsx(I.M,{children:"External identifier"}),r.jsx(D.b,{children:r.jsx(N.aV,{children:e.purl.map(e=>r.jsx(q.H,{children:r.jsx(L.rU,{to:`/packages/${e.uuid}`,children:e.purl})},e.uuid))})})]})})})})]}):null]},e.id))})]}),(0,r.jsx)(en.p,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:u})]})};var ed=n(27693),ec=n.n(ed),eh=n(27317),eo=n(93095),ex=n(9905),ej=n(18142),eu=n(86602),ep=n(25769),em=n(99196),eb=n(3175),ef=n(6703),eg=n(28986),ey=n(74889),ev=n(3946);let eT=e=>{let{sbomId:i}=e,{sbom:n,isFetching:s,fetchError:a}=(0,w.p4)(i),{data:{vulnerabilities:t,summary:d},isFetching:c,fetchError:h}=(0,ey.A)(i),o=l.useMemo(()=>t.filter(e=>"affected"===e.vulnerabilityStatus),[t]),x=l.useMemo(()=>o.map(e=>{let i=e.relatedPackages.flatMap(e=>e.packages).reduce((e,i)=>(e.find(e=>e.id===i.id)||e.push(i),e),[]);return{...e,summary:{totalPackages:i.length,allPackages:i}}}),[o]),j=(0,ev.T)(x,e=>`${e.vulnerability.identifier}-${e.vulnerabilityStatus}`),u=(0,el.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:j,isLoading:c,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>({id:e.vulnerability.identifier,cvss:(0,ej.XE)(e.vulnerability.average_severity),affectedDependencies:e.summary.totalPackages,published:e.vulnerability?.published?ec()(e.vulnerability.published).valueOf():0,updated:e.vulnerability?.modified?ec()(e.vulnerability.modified).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:p,numRenderedColumns:m,propHelpers:{toolbarProps:b,paginationToolbarItemProps:f,paginationProps:g,tableProps:y,getThProps:v,getTrProps:T,getTdProps:S,getExpandedContentTdProps:P},expansionDerivedState:{isCellExpanded:k}}=u;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(eh.K,{hasGutter:!0,children:[(0,r.jsx)(eo.v,{children:(0,r.jsx)(E.Z,{children:(0,r.jsx)(O.e,{children:(0,r.jsx)(M.u,{isFetching:s||c,fetchError:a,children:(0,r.jsxs)(C.r,{hasGutter:!0,children:[(0,r.jsx)(F.P,{md:6,children:(0,r.jsx)(em.V,{vulnerabilitiesSummary:d.vulnerabilityStatus.affected})}),(0,r.jsx)(F.P,{md:6,children:(0,r.jsxs)($.o,{children:[(0,r.jsxs)(_.g,{children:[(0,r.jsx)(I.M,{children:"Name"}),(0,r.jsx)(D.b,{children:n?.name})]}),(0,r.jsxs)(_.g,{children:[(0,r.jsx)(I.M,{children:"Version"}),(0,r.jsx)(D.b,{children:n?.described_by.map(e=>e.version).join(", ")})]}),(0,r.jsxs)(_.g,{children:[(0,r.jsx)(I.M,{children:"Creation date"}),(0,r.jsx)(D.b,{children:(0,V.p6)(n?.published)})]})]})})]})})})})}),(0,r.jsxs)(eo.v,{children:[(0,r.jsx)(R.o,{...b,children:(0,r.jsx)(Z.c,{children:(0,r.jsx)(H.E,{...f,children:(0,r.jsx)(en.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:g})})})}),(0,r.jsxs)(z.i,{...y,"aria-label":"Vulnerability table",children:[(0,r.jsx)(U.h,{children:(0,r.jsx)(X.Tr,{children:(0,r.jsxs)(er.qK,{...u,children:[(0,r.jsx)(J.Th,{...v({columnKey:"id"})}),(0,r.jsx)(J.Th,{...v({columnKey:"description"})}),(0,r.jsx)(J.Th,{...v({columnKey:"cvss"})}),(0,r.jsx)(J.Th,{...v({columnKey:"affectedDependencies"})}),(0,r.jsx)(J.Th,{...v({columnKey:"published"})}),(0,r.jsx)(J.Th,{...v({columnKey:"updated"})})]})})}),(0,r.jsx)(er.hp,{isLoading:c,isError:!!h,isNoData:0===j.length,numRenderedColumns:m,children:p?.map((e,i)=>r.jsxs(Q.p,{isExpanded:k(e),children:[r.jsx(X.Tr,{...T({item:e}),children:r.jsxs(er.Cx,{...u,item:e,rowIndex:i,children:[r.jsx(W.Td,{width:15,...S({columnKey:"id"}),children:r.jsx(L.rU,{to:`/vulnerabilities/${e.vulnerability.identifier}`,children:e.vulnerability.identifier})}),r.jsx(ef.j,{children:(i,n)=>r.jsx(W.Td,{width:35,modifier:"truncate",onFocus:()=>n(!0),onBlur:()=>n(!1),tabIndex:0,...S({columnKey:"description"}),children:r.jsx(ex.cE,{focused:i,wrapModifier:"truncate",children:e.vulnerability&&r.jsx(eg.G,{vulnerability:e.vulnerability})})})}),r.jsx(W.Td,{width:10,...S({columnKey:"cvss"}),children:r.jsx(eb.o,{value:eu.g(e.vulnerability.average_severity),score:e.vulnerability.average_score,showLabel:!0,showScore:!0})}),r.jsx(W.Td,{width:15,modifier:"truncate",...S({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:i}),children:e.summary.totalPackages}),r.jsx(W.Td,{width:10,modifier:"truncate",...S({columnKey:"published"}),children:V.p6(e.vulnerability?.published)}),r.jsx(W.Td,{width:10,modifier:"truncate",...S({columnKey:"updated"}),children:V.p6(e.vulnerability?.modified)})]})}),k(e)?r.jsx(X.Tr,{isExpanded:!0,children:r.jsx(W.Td,{...P({item:e}),children:r.jsx(Y.G,{children:k(e,"affectedDependencies")?r.jsx(r.Fragment,{children:r.jsxs(z.i,{variant:"compact",children:[r.jsx(U.h,{children:r.jsxs(X.Tr,{children:[r.jsx(J.Th,{children:"Type"}),r.jsx(J.Th,{children:"Namespace"}),r.jsx(J.Th,{children:"Name"}),r.jsx(J.Th,{children:"Version"}),r.jsx(J.Th,{children:"Path"}),r.jsx(J.Th,{children:"Qualifiers"})]})}),r.jsx(Q.p,{children:e.summary.allPackages.flatMap(e=>e.name&&0===e.purl.length?[{parentName:e.name}]:e.purl.map(i=>({parentName:e.name,purlSummary:i}))).map((e,i)=>{if(e.purlSummary){let i=V.qX(e.purlSummary.purl);return r.jsxs(X.Tr,{children:[r.jsx(W.Td,{children:i?.type}),r.jsx(W.Td,{children:i?.namespace}),r.jsx(W.Td,{children:r.jsx(L.rU,{to:`/packages/${e.purlSummary.uuid}`,children:i?.name})}),r.jsx(W.Td,{children:i?.version}),r.jsx(W.Td,{children:i?.path}),r.jsx(W.Td,{children:i?.qualifiers&&r.jsx(ep.D,{value:i?.qualifiers})})]},e.purlSummary.uuid)}return r.jsxs(X.Tr,{children:[r.jsx(W.Td,{}),r.jsx(W.Td,{}),r.jsx(W.Td,{children:e.parentName}),r.jsx(W.Td,{}),r.jsx(W.Td,{}),r.jsx(W.Td,{})]},`${e.parentName}-${i}-name`)})})]})}):null})})}):null]},e._ui_unique_id))})]}),(0,r.jsx)(en.p,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:g})]})]})})},eS=()=>{let e=(0,P.ZX)(P.Uo.SBOM_ID),{sbom:i,isFetching:n,fetchError:K}=(0,w.p4)(e),{downloadSBOM:C,downloadSBOMLicenses:F}=(0,k.i)(),[E,B]=l.useState(!1),[O,$]=l.useState(0),_=l.createRef(),I=l.createRef(),D=l.createRef(),N=l.createRef(),q=()=>{B(!E)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.NP,{variant:"light",children:(0,r.jsxs)(a.P,{children:[(0,r.jsx)(t.J,{isFilled:!0,children:(0,r.jsxs)(d.k,{children:[(0,r.jsx)(c.B,{spacer:{default:"spacerSm"},children:(0,r.jsx)(h.D,{children:(0,r.jsx)(o.x,{component:"h1",children:i?.name??e??""})})}),(0,r.jsx)(c.B,{children:i?.labels.type&&(0,r.jsx)(x._,{color:"blue",children:i?.labels.type})})]})}),(0,r.jsx)(t.J,{children:(0,r.jsx)(j.L,{isOpen:E,onSelect:()=>B(!1),onOpenChange:e=>B(e),popperProps:{position:"right"},toggle:e=>(0,r.jsx)(u.O,{ref:e,onClick:q,isExpanded:E,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,r.jsxs)(p.s,{children:[(0,r.jsx)(m.h,{onClick:()=>{e&&C(e,i?.name?`${i?.name}.json`:`${e}.json`)},children:"Download SBOM"},"sbom"),(0,r.jsx)(m.h,{onClick:()=>{e&&F(e)},children:"Download License Report"},"license")]})})})]})}),(0,r.jsx)(s.NP,{type:"nav",children:(0,r.jsxs)(b.m,{mountOnEnter:!0,activeKey:O,onSelect:(e,i)=>{$(i)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,r.jsx)(f.O,{eventKey:0,title:(0,r.jsx)(g.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:_}),(0,r.jsx)(f.O,{eventKey:1,title:(0,r.jsx)(g.T,{children:"Packages"}),tabContentId:"refTabPackagesSection",tabContentRef:I}),(0,r.jsx)(f.O,{eventKey:2,title:(0,r.jsx)(g.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:D,actions:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.b,{ref:N,children:(0,r.jsx)(S.ZP,{})}),(0,r.jsx)(v.J,{triggerRef:N,bodyContent:(0,r.jsx)("div",{children:"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed."})})]})})]})}),(0,r.jsxs)(s.NP,{children:[(0,r.jsx)(T.I,{eventKey:0,id:"refTabInfoSection",ref:_,"aria-label":"Information of the SBOM",children:(0,r.jsx)(M.u,{isFetching:n,fetchError:K,children:i&&(0,r.jsx)(A,{sbom:i})})}),(0,r.jsx)(T.I,{eventKey:1,id:"refTabPackagesSection",ref:I,"aria-label":"Packages within the SBOM",hidden:!0,children:e&&(0,r.jsx)(et,{sbomId:e})}),(0,r.jsx)(T.I,{eventKey:2,id:"refVulnerabilitiesSection",ref:D,"aria-label":"Vulnerabilities within the SBOM",hidden:!0,children:e&&(0,r.jsx)(eT,{sbomId:e})})]})]})}},71008:function(e,i,n){n.d(i,{D4:()=>h,ZA:()=>c,fF:()=>d});var r=n(1183),l=n(22285),s=n(54227),a=n(94426);let t="packages",d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:n,isLoading:d,error:c,refetch:h}=(0,r.a)({queryKey:[t,e],queryFn:()=>(0,s.tj)({client:l.L,query:{...(0,a.rm)(e)}}),enabled:!i});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:e},isFetching:d,fetchError:c,refetch:h}},c=e=>{let{data:i,isLoading:n,error:a}=(0,r.a)({queryKey:[t,e],queryFn:()=>(0,s.BK)({client:l.L,path:{key:e}})});return{pkg:i?.data,isFetching:n,fetchError:a}},h=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:n,isLoading:d,error:c,refetch:h}=(0,r.a)({queryKey:[t,"by-sbom",e,i],queryFn:()=>(0,s.Pg)({client:l.L,path:{id:e},query:{...(0,a.rm)(i)}})});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:i},isFetching:d,fetchError:c,refetch:h}}},3946:function(e,i,n){n.d(i,{T:()=>s});var r=n(27378),l=n(44072);let s=(e,i)=>(0,r.useMemo)(()=>e&&0!==e.length?e.map(e=>({...e,[l.nM]:i(e)})):[],[e,i])}}]);