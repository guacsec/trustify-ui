"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["83"],{67447:function(e,t,r){r.d(t,{G:()=>a});var i=r(59390),l=r(24246),s=r(15508),n=r(39157);let a=e=>{var{children:t=null,hasNoBackground:r}=e,a=(0,i.__rest)(e,["children","hasNoBackground"]);return(0,l.jsx)("div",Object.assign({},a,{className:(0,s.i)(n.Z.tableExpandableRowContent,r&&n.Z.modifiers.noBackground),children:t}))};a.displayName="ExpandableRowContent"},69876:function(e,t,r){r.d(t,{D:()=>s});var i=r(24246),l=r(70400);let s=e=>{let{value:t}=e;return(0,i.jsx)(i.Fragment,{children:Object.entries(t).map(e=>{let[t,r]=e;return(0,i.jsx)(l._,{isCompact:!0,children:"".concat(t,"=").concat(r)},"".concat(t,"=").concat(r))})})}},3586:function(e,t,r){r.d(t,{j:()=>s});var i=r(24246),l=r(27378);let s=e=>{let{children:t}=e,[r,s]=l.useState(!1);return(0,i.jsx)(i.Fragment,{children:t(r,s)})}},24200:function(e,t,r){r.d(t,{G:()=>l});var i=r(24246);let l=e=>{let{vulnerability:t}=e;return(0,i.jsxs)("p",{children:[t.withdrawn&&(0,i.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})}},43006:function(e,t,r){r.d(t,{S:()=>n});var i=r(24246),l=r(70400),s=r(32947);let n=e=>{var t;let{value:r}=e,n=null!=(t=s.X6[r])?t:{name:r,color:void 0};return(0,i.jsx)(l._,{color:n.color,children:n.name})}},82413:function(e,t,r){r.d(t,{Ap:()=>h,Ie:()=>v,_g:()=>u});var i=r(79192),l=r(53195),s=r(27378),n=r(7615),a=r(43959);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,d={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},u={vulnerabilityStatus:{affected:(0,i._)({},d),fixed:(0,i._)({},d),not_affected:(0,i._)({},d),known_not_affected:(0,i._)({},d),under_investigation:(0,i._)({},d)}},c=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let r,s=e.find(e=>o(e,t));if(s)r=[...e.filter(e=>!o(e,s)),(0,l._)((0,i._)({},s),{relatedPackages:[...s.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let i={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};r=[...e.slice(),i]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,s=(0,n.g)(t.vulnerability.average_severity),a=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:(0,l._)((0,i._)({},e.vulnerabilityStatus),{[r]:{total:a.total+1,severities:(0,l._)((0,i._)({},a.severities),{[s]:a.severities[s]+1})}})})},(0,i._)({},u));return{vulnerabilities:t,summary:r}},h=e=>{let{advisories:t,isFetching:r,fetchError:i}=(0,a.KQ)(e);return{data:s.useMemo(()=>c(t||[]),[t]),isFetching:r,fetchError:i}},v=e=>{let{advisories:t,isFetching:r,fetchError:i}=(0,a.uz)(e);return{data:s.useMemo(()=>(null!=t?t:[]).map(e=>c(e||[])),[t]),isFetching:r,fetchError:i}}},64733:function(e,t,r){r.r(t),r.d(t,{default:()=>ek});var i=r(24246),l=r(27378),s=r(6501),n=r(2926),a=r(45043),o=r(97339),d=r(18091),u=r(68802),c=r(11192),h=r(32591),v=r(32939),p=r(24620),y=r(37961),f=r(69265),b=r(10707),m=r(16668),x=r(59390),j=r(15508),g=r(32954);let _=e=>{var{children:t,className:r}=e,l=(0,x.__rest)(e,["children","className"]);return(0,i.jsx)("div",Object.assign({className:(0,j.i)(g.Z.emptyStateFooter,r)},l,{children:t}))};_.displayName="EmptyStateFooter";let S=e=>{var{children:t,className:r}=e,l=(0,x.__rest)(e,["children","className"]);return(0,i.jsx)("div",Object.assign({className:(0,j.i)(g.Z.emptyStateActions,r)},l,{children:t}))};S.displayName="EmptyStateActions";var T=r(78700),w=r(79551),k=r(32489),O=r(90519),E=r(35072),q=r(30528);let C=(0,r(24329).I)({name:"DownloadIcon",height:512,width:512,svgPath:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",yOffset:0,xOffset:0,svgClassName:void 0});var F=r(42160),A=r(1353),K=r(68e3),P=r(87017),R=r(95169),z=r(27031),L=r(51851),M=r(21714),V=r(75481),I=r(81211),N=r(45882),Q=r(416);let B=e=>{let{uploads:t,handleUpload:r,handleRemoveUpload:s,handleCancelUpload:n}=e,{rejectedFiles:a,setRejectedFiles:o,handleFileDrop:d,handleDropRejected:u,removeFiles:c}=(e=>{let{uploads:t,handleUpload:r,handleRemoveUpload:i}=e,[s,n]=l.useState(!1),[a,o]=l.useState("inProgress"),[d,u]=l.useState([]);return!s&&t.size>0&&n(!0),l.useEffect(()=>{let e=Array.from(t.values());e.some(e=>"inProgress"===e.status)?o("inProgress"):e.every(e=>"complete"===e.status)?o("success"):o("danger")},[t]),{showStatus:s,status:a,rejectedFiles:d,setRejectedFiles:u,handleFileDrop:(e,t)=>{r(t)},handleDropRejected:e=>{u(e)},successFileCount:Array.from(t.values()).filter(e=>e.response).length,removeFiles:e=>{for(let t of e)i(t)}}})({uploads:t,handleUpload:r,handleRemoveUpload:s});return(0,i.jsxs)(L.o,{onFileDrop:d,dropzoneProps:{accept:{"application/xml":[".json",".bz2"]},onDropRejected:u,useFsAccessApi:!1,multiple:!1,disabled:t.size>0},children:[0===t.size?(0,i.jsx)(M.Y,{titleIcon:(0,i.jsx)(Q.ZP,{}),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2",browseButtonText:"Browse Files"}):Array.from(t.entries()).map((e,t)=>{let[r,l]=e;if(l.error){var s,a,o;return l.wasCancelled?(0,i.jsxs)(b.ub,{status:"danger",headingLevel:"h4",titleText:"Upload cancelled",icon:F.ZP,variant:b.IQ.sm,children:[(0,i.jsx)(m.B,{children:"The file could not be analyzed. The operation was cancelled."}),(0,i.jsx)(_,{children:(0,i.jsx)(S,{children:(0,i.jsx)(T.zx,{variant:"primary",onClick:()=>c([r]),children:"Try another file"})})})]},"".concat(r.name,"-").concat(t,"-cancelled")):(console.log(l.error),(0,i.jsxs)(b.ub,{status:"danger",headingLevel:"h4",titleText:"Error ".concat(null!=(o=l.error.status)?o:l.error.code,": Upload failed"),icon:F.ZP,variant:b.IQ.sm,children:[(0,i.jsxs)(m.B,{children:["The file could not be analyzed. The file might be corrupted or an unsupported format.",(null==(s=l.error.response)?void 0:s.data.message)&&(0,i.jsx)(V.L,{toggleText:"Show details",children:null==(a=l.error.response)?void 0:a.data.message})]}),(0,i.jsx)(_,{children:(0,i.jsx)(S,{children:(0,i.jsx)(T.zx,{variant:"primary",onClick:()=>c([r]),children:"Try another file"})})})]},"".concat(r.name,"-").concat(t,"-error")))}return(0,i.jsxs)(b.ub,{headingLevel:"h4",titleText:"Uploading SBOM ".concat(l.progress,"%"),icon:A.ZP,variant:b.IQ.sm,children:[(0,i.jsx)(m.B,{children:"Securely uploading your SBOM for analysis. The file will not be saved."}),(0,i.jsx)(_,{children:(0,i.jsx)(S,{children:(0,i.jsx)(T.zx,{variant:"link",onClick:()=>n(r),children:"Cancel upload"})})})]},"".concat(r.name,"-").concat(t,"-progress"))}),(0,i.jsxs)(w.u,{isOpen:a.length>0,"aria-label":"rejected files",onClose:()=>o([]),variant:"small",children:[(0,i.jsx)(k.x,{title:"Rejected files",titleIconVariant:"warning"}),(0,i.jsx)(O.f,{children:(0,i.jsx)(I.aV,{children:a.map(e=>(0,i.jsx)(N.H,{children:e.file.name},e.file.name))})})]})]})};var D=r(79192),U=r(53195),Z=r(27693),H=r.n(Z),G=r(70715),J=r(40982),W=r(89226),X=r(74607),$=r(34747),Y=r(46770),ee=r(4835),et=r(14350),er=r(11165),ei=r(89330),el=r(31423),es=r(94154),en=r(9905),ea=r(67447),eo=r(14629),ed=r(69876),eu=r(57524),ec=r(3804),eh=r(31336),ev=r(3586),ep=r(24200),ey=r(43006),ef=r(49988),eb=r(41135),em=r(63706);let ex=e=>{var t;return null!=(t=e.labels.importer)?t:"Unknown"},ej=e=>{let t=e.replace(/"/g,'""');return/[",\r\n]/.test(t)&&(t='"'.concat(t,'"')),t},eg=e=>{let{vulnerabilities:t,isFetching:r,fetchError:n}=e,a=l.useMemo(()=>t.flatMap(e=>Array.from(e.advisories.values())).reduce((e,t)=>{let r=ex(t.advisory);return e.add(r),e},new Set),[t]),o=(0,eb.T)(t,e=>"".concat(e.vulnerability.identifier,"-").concat(e.status)),d=(0,ef.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:o,isLoading:r,columnNames:{vulnerabilityId:"Vulnerability ID",description:"Description",severity:"Severity",status:"Status",affectedPackages:"Affected packages",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["vulnerabilityId","affectedPackages","published","updated"],getSortValues:e=>{var t,r;return{vulnerabilityId:e.vulnerability.identifier,affectedPackages:e.purls.size,published:(null==(t=e.vulnerability)?void 0:t.published)?H()(e.vulnerability.published).valueOf():0,updated:(null==(r=e.vulnerability)?void 0:r.modified)?H()(e.vulnerability.modified).valueOf():0}},isFilterEnabled:!0,filterCategories:[{categoryKey:"vulnerabilityId",title:"Vulnerability ID",type:eo.vA.search,placeholderText:"Search by Vulnerability ID",getItemValue:e=>e.vulnerability.identifier},{categoryKey:"importer",title:"Importer",type:eo.vA.multiselect,placeholderText:"Importer",selectOptions:Array.from(a).map(e=>({value:e,label:e})),matcher:(e,t)=>!!Array.from(t.advisories.values()).map(e=>{let{advisory:t}=e;return ex(t)}).find(t=>t===e)},{categoryKey:"status",title:"Status",type:eo.vA.multiselect,placeholderText:"Status",selectOptions:[{value:"affected",label:"Affected"},{value:"under_investigation",label:"Under investigation"},{value:"known_not_affected",label:"Known not affected"},{value:"not_affected",label:"Not affected"},{value:"fixed",label:"Fixed"}],matcher:(e,t)=>e===t.status},{categoryKey:"severity",title:"Severity",placeholderText:"Severity",type:eo.vA.multiselect,selectOptions:[{value:"null",label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],matcher:(e,t)=>!!Array.from(t.advisories.values()).map(e=>{let{opinionatedExtendedSeverity:t}=e;return t}).find(t=>t===e)}],initialFilterValues:{status:["affected"]},isPaginationEnabled:!0,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:u,numRenderedColumns:c,propHelpers:{toolbarProps:h,paginationToolbarItemProps:v,paginationProps:p,tableProps:y,filterToolbarProps:f,getThProps:b,getTrProps:m,getTdProps:x,getExpandedContentTdProps:j},expansionDerivedState:{isCellExpanded:g},filterState:{filterValues:_}}=d;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(G.o,(0,U._)((0,D._)({},h),{children:(0,i.jsxs)(J.c,{children:[(0,i.jsx)(eo.Ki,(0,D._)({},f)),(0,i.jsx)(W.E,(0,U._)((0,D._)({},v),{children:(0,i.jsx)(ec.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:p})}))]})})),(0,i.jsxs)(ee.i,(0,U._)((0,D._)({},y),{"aria-label":"Vulnerability table",children:[(0,i.jsx)(et.h,{children:(0,i.jsx)(er.Tr,{children:(0,i.jsxs)(eh.qK,(0,U._)((0,D._)({},d),{children:[(0,i.jsx)(ei.Th,(0,D._)({},b({columnKey:"vulnerabilityId"}))),(0,i.jsx)(ei.Th,(0,D._)({},b({columnKey:"description"}))),(0,i.jsx)(ei.Th,(0,D._)({},b({columnKey:"severity"}))),(0,i.jsx)(ei.Th,(0,D._)({},b({columnKey:"status"}))),(0,i.jsx)(ei.Th,(0,D._)({},b({columnKey:"affectedPackages"}))),(0,i.jsx)(ei.Th,(0,U._)((0,D._)({},b({columnKey:"published"})),{info:{tooltip:"The date when information about this vulnerability was first made available."}})),(0,i.jsx)(ei.Th,(0,U._)((0,D._)({},b({columnKey:"updated"})),{info:{tooltip:"The date when information about this vulnerability was most recently revised."}}))]}))})}),(0,i.jsx)(eh.hp,{isLoading:r,isError:!!n,isNoData:0===o.length,numRenderedColumns:c,children:null==u?void 0:u.map((e,t)=>{var r,l;return(0,i.jsxs)(el.p,{isExpanded:g(e),children:[(0,i.jsx)(er.Tr,(0,U._)((0,D._)({},m({item:e})),{children:(0,i.jsxs)(eh.Cx,(0,U._)((0,D._)({},d),{item:e,rowIndex:t,children:[(0,i.jsx)(es.Td,(0,U._)((0,D._)({width:15,modifier:"breakWord"},x({columnKey:"vulnerabilityId"})),{children:(0,i.jsx)(s.rU,{to:(0,s.Gn)(z.nB.vulnerabilityDetails,{vulnerabilityId:e.vulnerability.identifier}),children:e.vulnerability.identifier})})),(0,i.jsx)(ev.j,{children:(t,r)=>(0,i.jsx)(es.Td,(0,U._)((0,D._)({width:25,modifier:"truncate",onFocus:()=>r(!0),onBlur:()=>r(!1),tabIndex:0},x({columnKey:"description"})),{children:(0,i.jsx)(en.cE,{focused:t,wrapModifier:"truncate",children:e.vulnerability&&(0,i.jsx)(ep.G,{vulnerability:e.vulnerability})})}))}),(0,i.jsx)(es.Td,(0,U._)((0,D._)({width:20,modifier:"breakWord"},x({columnKey:"severity"})),{children:(0,i.jsx)(X.e,{isVertical:!0,children:Array.from(e.advisories.entries()).filter(e=>{let[t,r]=e;return!_.importer||0===_.importer.length||-1!==_.importer.findIndex(e=>e===ex(r.advisory))}).map(e=>{var t,r;let[l,s]=e;return(0,i.jsxs)($.k,{children:[(0,i.jsx)(Y.B,{spacer:{default:"spacerNone"},children:(0,i.jsx)(eu.o,{value:s.opinionatedExtendedSeverity,score:null!=(r=null==(t=s.opinionatedScore)?void 0:t.value)?r:null,showLabel:!0,showScore:!0})}),(0,i.jsxs)(Y.B,{children:[":"," ",ex(s.advisory)]})]},l)})})})),(0,i.jsx)(es.Td,(0,U._)((0,D._)({width:10,modifier:"truncate"},x({columnKey:"status"})),{children:(0,i.jsx)(ey.S,{value:e.status})})),(0,i.jsx)(es.Td,(0,U._)((0,D._)({width:10,modifier:"truncate"},x({columnKey:"affectedPackages",isCompoundExpandToggle:!0,item:e,rowIndex:t})),{children:e.purls.size})),(0,i.jsx)(es.Td,(0,U._)((0,D._)({width:10,modifier:"truncate"},x({columnKey:"published"})),{children:(0,em.p6)(null==(r=e.vulnerability)?void 0:r.published)})),(0,i.jsx)(es.Td,(0,U._)((0,D._)({width:10,modifier:"truncate"},x({columnKey:"updated"})),{children:(0,em.p6)(null==(l=e.vulnerability)?void 0:l.modified)}))]}))})),g(e)?(0,i.jsx)(er.Tr,{isExpanded:!0,children:(0,i.jsx)(es.Td,(0,U._)((0,D._)({},j({item:e})),{children:(0,i.jsxs)(ea.G,{children:[g(e,"severity")?(0,i.jsx)(I.aV,{isPlain:!0,children:Array.from(e.advisories.values()).map(e=>(0,i.jsx)(N.H,{children:e.advisory.identifier},"".concat(e.advisory.identifier)))}):null,g(e,"affectedPackages")?(0,i.jsxs)(ee.i,{variant:"compact",children:[(0,i.jsx)(et.h,{children:(0,i.jsxs)(er.Tr,{children:[(0,i.jsx)(ei.Th,{children:"Type"}),(0,i.jsx)(ei.Th,{children:"Namespace"}),(0,i.jsx)(ei.Th,{children:"Name"}),(0,i.jsx)(ei.Th,{children:"Version"}),(0,i.jsx)(ei.Th,{children:"Path"}),(0,i.jsx)(ei.Th,{children:"Qualifiers"})]})}),(0,i.jsx)(el.p,{children:Array.from(e.purls.values()).map(e=>{let t=(0,em.qX)(e);return t?(0,i.jsxs)(er.Tr,{children:[(0,i.jsx)(es.Td,{children:null==t?void 0:t.type}),(0,i.jsx)(es.Td,{children:null==t?void 0:t.namespace}),(0,i.jsx)(es.Td,{children:null==t?void 0:t.name}),(0,i.jsx)(es.Td,{children:null==t?void 0:t.version}),(0,i.jsx)(es.Td,{children:null==t?void 0:t.path}),(0,i.jsx)(es.Td,{children:(null==t?void 0:t.qualifiers)&&(0,i.jsx)(ed.D,{value:null==t?void 0:t.qualifiers})})]},e):(0,i.jsx)(er.Tr,{children:(0,i.jsx)(es.Td,{colSpan:6,children:e})},e)})})]}):null]})}))}):null]},e._ui_unique_id)})})]})),(0,i.jsx)(ec.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:p})]})};var e_=r(32947),eS=r(7615),eT=r(82413),ew=r(52030);let ek=()=>{let[e,t]=(0,l.useState)(!1),r=()=>{t(!e)},[x,j]=(0,l.useState)(null),{uploads:g,handleUpload:L,handleCancelUpload:M,handleRemoveUpload:V}=(e=>{let t=(0,K.NL)();return(0,R.V)({parallel:!0,uploadFn:(e,t)=>(0,P.y)(e,t),onSuccess:async(r,i)=>{e(r.data,i),await t.invalidateQueries({queryKey:["sbom-analysis"]})}})})((e,t)=>{j(e)}),I=l.useCallback(e=>{let{currentLocation:t,nextLocation:r}=e;return null!==x&&t.pathname!==r.pathname},[x]),N=(0,s._Z)(I),{data:{vulnerabilities:Q},isFetching:Z,fetchError:H}=(e=>{let{analysisResponse:t,isFetching:r,fetchError:i}=(0,ew.DK)(e);return{data:l.useMemo(()=>{if(r||i||0===Object.keys(t).length)return{summary:(0,D._)({},eT._g),vulnerabilities:[]};let e=Object.entries(t).flatMap(e=>{let[t,r]=e;return r.details.flatMap(e=>Object.entries(e.status).flatMap(r=>{let[i,l]=r;return l.map(r=>({purl:t,vulnerability:e,status:i,advisory:r,scores:r.scores}))}))}).reduce((e,t)=>{let r,i=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.status===t.status,l=e.find(e=>i(e,t));if(l){var s,n,a,o;let d=e.filter(e=>!i(e,l)),u=(0,e_.dn)(t.scores),c=(0,eS.g)(null==u?void 0:u.severity),h=new Map(l.advisories);h.set(t.advisory.identifier,{advisory:t.advisory,scores:t.scores,opinionatedScore:u,opinionatedExtendedSeverity:c});let v=new Set(l.purls);v.add(t.purl);let p=null,y=null;if((null==(s=l.opinionatedAvisory.score)?void 0:s.type)!==(null==u?void 0:u.type)){let e=[{advisory:l.opinionatedAvisory.advisory,score:l.opinionatedAvisory.score},{advisory:t.advisory,score:u}].sort((0,e_.Bn)(e=>{var t,r;return null!=(r=null==(t=e.score)?void 0:t.type)?r:null}))[0];p=e.advisory,y=e.score}else{let{advisory:e,score:r}=(null!=(a=null==u?void 0:u.value)?a:0)>(null!=(o=null==(n=l.opinionatedAvisory.score)?void 0:n.value)?o:0)?{score:u,advisory:t.advisory}:{score:l.opinionatedAvisory.score,advisory:l.opinionatedAvisory.advisory};p=e,y=r}let f=(0,eS.g)(null==y?void 0:y.severity);r=[...d,{vulnerability:l.vulnerability,status:l.status,advisories:h,purls:v,opinionatedAvisory:{advisory:p,score:y,extendedSeverity:f}}]}else{let i=(0,e_.dn)(t.scores),l=(0,eS.g)(null==i?void 0:i.severity),s=new Map;s.set(t.advisory.identifier,{advisory:t.advisory,scores:t.scores,opinionatedExtendedSeverity:l,opinionatedScore:i});let n=new Set;n.add(t.purl);let a={vulnerability:t.vulnerability,status:t.status,advisories:s,purls:n,opinionatedAvisory:{advisory:t.advisory,score:i,extendedSeverity:l}};r=[...e.slice(),a]}return r},[]),l=e.reduce((e,t)=>{let r=t.status,i=t.opinionatedAvisory.extendedSeverity,l=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:(0,U._)((0,D._)({},e.vulnerabilityStatus),{[r]:{total:l.total+1,severities:(0,U._)((0,D._)({},l.severities),{[i]:l.severities[i]+1})}})})},(0,D._)({},eT._g));return{vulnerabilities:e,summary:l}},[t,r,i]),analysisResponse:t,isFetching:r,fetchError:i}})((0,l.useMemo)(()=>{var e;return Object.entries(null!=(e=null==x?void 0:x.packages)?e:{}).flatMap(e=>{let[t,{purls:r}]=e;return r})},[x])),G=async()=>{let e=new Blob(["VulnerabilityID, Description, Severity, Severity score, Advisory, Status, Affected package, Published, Updated\n"+Q.flatMap(e=>{let{advisories:t,purls:r,vulnerability:i,status:l}=e;return Array.from(t.values()).flatMap(e=>{let{opinionatedExtendedSeverity:t,opinionatedScore:s,advisory:n}=e;return Array.from(r).map(e=>{var r,a,o,d;return{vulnerabilityId:ej(i.identifier),description:ej(null!=(r=i.description)?r:""),severity:ej(t),severityScore:null!=(a=null==s?void 0:s.value)?a:"",advisory:ex(n),status:ej(l),affectedPackage:ej(e),published:ej(null!=(o=(0,em.p6)(i.published))?o:""),updated:ej(null!=(d=(0,em.p6)(i.modified))?d:"")}})})}).map(e=>Object.values(e).join(",")).join("\n")],{type:"text/csv;charset=utf-8"});(0,n.saveAs)(e,"data.csv")},J=()=>{for(let e of g.keys())V(e);j(null)},W=null===x||Z||H||0===Q.length;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.NP,{type:"breadcrumb",children:(0,i.jsxs)(o.a,{children:[(0,i.jsx)(d.g,{children:(0,i.jsx)(s.rU,{to:z.nB.sboms,children:"SBOMs"})}),W?(0,i.jsx)(d.g,{isActive:!0,children:"Generate vulnerability report"}):(0,i.jsx)(d.g,{isActive:!0,children:"Vulnerability report"})]})}),(0,i.jsx)(a.NP,{children:W?(0,i.jsxs)(u.V,{children:[(0,i.jsx)(u.V,{component:"h1",children:"Generate vulnerability report"}),(0,i.jsx)(u.V,{component:"p",children:"Select an SBOM file to generate a temporary vulnerability report. The file and report will not be saved."})]}):(0,i.jsxs)(c.P,{children:[(0,i.jsx)(h.J,{isFilled:!0,children:(0,i.jsxs)(u.V,{children:[(0,i.jsx)(u.V,{component:"h1",children:"Vulnerability report"}),(0,i.jsx)(u.V,{component:"p",children:"This is a temporary vulnerability report."})]})}),(0,i.jsx)(h.J,{children:(0,i.jsxs)(v.L,{isOpen:e,onSelect:()=>t(!1),onOpenChange:e=>t(e),popperProps:{position:"right"},toggle:t=>(0,i.jsx)(p.O_,{ref:t,onClick:r,isExpanded:e,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:[(0,i.jsx)(y.s,{children:(0,i.jsx)(f.h,{onClick:J,children:"Generate new report"},"scan-another")}),(0,i.jsx)(y.s,{children:(0,i.jsx)(f.h,{onClick:G,children:"Download CSV"},"download-report")})]})})]})}),(0,i.jsx)(a.NP,{children:null===x?(0,i.jsx)(B,{uploads:g,handleUpload:L,handleRemoveUpload:V,handleCancelUpload:M}):Z?(0,i.jsxs)(b.ub,{titleText:"Generating SBOM report",headingLevel:"h4",icon:A.ZP,children:[(0,i.jsx)(m.B,{children:"Analyzing your SBOM for security vulnerabilities, license issues and dependency details."}),(0,i.jsx)(_,{children:(0,i.jsx)(S,{children:(0,i.jsx)(T.zx,{variant:"link",onClick:J,children:"Cancel scan"})})})]}):H?(0,i.jsxs)(b.ub,{status:"danger",headingLevel:"h4",titleText:"Scan failed",icon:F.ZP,variant:b.IQ.sm,children:[(0,i.jsx)(m.B,{children:"The file could not be analyzed. The file might be corrupted or an unsupported format."}),(0,i.jsx)(_,{children:(0,i.jsx)(S,{children:(0,i.jsx)(T.zx,{variant:"primary",onClick:J,children:"Try another file"})})})]}):0===Q.length?(0,i.jsxs)(b.ub,{status:"success",headingLevel:"h4",titleText:"No vulnerabilities found",icon:q.ZP,variant:b.IQ.sm,children:[(0,i.jsxs)(m.B,{children:["The ",Array.from(g.keys()).map(e=>e.name)," was successfully analyzed and found no vulnerabilities to report."]}),(0,i.jsx)(_,{children:(0,i.jsx)(S,{children:(0,i.jsx)(T.zx,{variant:"primary",onClick:J,children:"Try another file"})})})]}):(0,i.jsx)(eg,{vulnerabilities:Q,isFetching:Z,fetchError:H})}),(0,i.jsxs)(w.u,{variant:"small",isOpen:"blocked"===N.state,onClose:()=>"blocked"===N.state&&N.reset(),children:[(0,i.jsx)(k.x,{title:"Leave Vulnerability report?"}),(0,i.jsx)(O.f,{children:"This report is not saved and will be unavailable after leaving this page. To save the report, download it."}),(0,i.jsxs)(E.m,{children:[(0,i.jsx)(T.zx,{variant:"primary",icon:(0,i.jsx)(C,{}),onClick:async()=>{await G(),"blocked"===N.state&&N.proceed()},children:"Download and leave"}),(0,i.jsx)(T.zx,{variant:"secondary",onClick:async()=>{"blocked"===N.state&&N.proceed()},children:"Leave without downloading"}),(0,i.jsx)(T.zx,{variant:"link",onClick:()=>{"blocked"===N.state&&N.reset()},children:"Cancel"},"cancel")]})]})]})}},43959:function(e,t,r){r.d(t,{Fz:()=>m,KQ:()=>T,Oh:()=>S,i5:()=>b,km:()=>g,p4:()=>x,qi:()=>k,s5:()=>j,t9:()=>_,uz:()=>w});var i=r(79192),l=r(53195),s=r(70186),n=r(1183),a=r(24038),o=r(68e3),d=r(75503),u=r(16072),c=r(50576),h=r(40371),v=r(95169),p=r(87017),y=r(49988);let f="sboms",b=e=>{let{data:t,isLoading:r,error:i,refetch:l}=(0,n.a)({queryKey:[f,"labels",e],queryFn:()=>(0,h.mh)({client:c.L,query:{limit:10,filter_text:e}}),placeholderData:a.Wk});return{labels:(null==t?void 0:t.data)||[],isFetching:r,fetchError:i,refetch:l}},m=function(){var e,t,r;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,y.rm)(a),{q:v}=u,p=(0,s._)(u,["q"]),b=(0,y.Rb)(o),{data:m,isLoading:x,error:j,refetch:g}=(0,n.a)({queryKey:[f,a,b],queryFn:()=>(0,h.Wp)({client:c.L,query:(0,l._)((0,i._)({},p),{q:[v,b].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==m||null==(e=m.data)?void 0:e.items)||[],total:null!=(r=null==m||null==(t=m.data)?void 0:t.total)?r:0,params:a},isFetching:x,fetchError:j,refetch:g}},x=e=>{let{data:t,isLoading:r,error:i}=(0,n.a)({queryKey:[f,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,h._Q)({client:c.L,path:{id:e}}),enabled:void 0!==e});return{sbom:null==t?void 0:t.data,isFetching:r,fetchError:i}},j=(e,t)=>{let r=(0,o.NL)();return(0,d.D)({mutationFn:async e=>(await (0,h.WX)({client:c.L,path:{id:e}})).data,onSuccess:async(t,i)=>{e(t,i),await r.invalidateQueries({queryKey:[f]})},onError:async e=>{t(e),await r.invalidateQueries({queryKey:[f]})}})},g=()=>{let e=(0,o.NL)();return(0,v.V)({parallel:!0,uploadFn:(e,t)=>(0,p.Hb)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[f]})}})},_=(e,t)=>{let r=(0,o.NL)();return(0,d.D)({mutationFn:e=>(0,h.zx)({client:c.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[f]})},onError:t})},S=function(e){var t,r,l;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:a,isLoading:o,error:d,refetch:u}=(0,n.a)({queryKey:[f,"by-package",e,s],queryFn:()=>(0,h.DU)({client:c.L,query:(0,i._)({purl:e},(0,y.rm)(s))})});return{result:{data:(null==a||null==(t=a.data)?void 0:t.items)||[],total:null!=(l=null==a||null==(r=a.data)?void 0:r.total)?l:0,params:s},isFetching:o,fetchError:d,refetch:u}},T=e=>{let{data:t,isLoading:r,error:i}=(0,n.a)({queryKey:[f,e,"advisory"],queryFn:()=>(0,h.NU)({client:c.L,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:r,fetchError:i}},w=e=>{let t=(0,u.h)({queries:e.map(e=>({queryKey:[f,e,"advisory"],queryFn:()=>(0,h.NU)({client:c.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},k=e=>{let{data:t,isLoading:r,error:i}=(0,n.a)({queryKey:[f,e,"license-ids"],queryFn:()=>(0,h.J4)({client:c.L,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:r,fetchError:i}}},52030:function(e,t,r){r.d(t,{DK:()=>c,fd:()=>u,p6:()=>h});var i=r(79192),l=r(1183),s=r(16072),n=r(50576),a=r(40371),o=r(49988);let d="vulnerabilities",u=function(){var e,t,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:c,isLoading:h,error:v,refetch:p}=(0,l.a)({queryKey:[d,s],queryFn:()=>(0,a.b5)({client:n.L,query:(0,i._)({},(0,o.rm)(s))}),enabled:!u});return{result:{data:(null==c||null==(e=c.data)?void 0:e.items)||[],total:null!=(r=null==c||null==(t=c.data)?void 0:t.total)?r:0,params:s},isFetching:h,fetchError:v,refetch:p}},c=e=>{var t;let r={ids:e.reduce((e,t,r)=>(r%100==0?e.push([t]):e[e.length-1].push(t),e),[]),dataResolver:async e=>(await (0,a.BJ)({client:n.L,body:{purls:e}})).data},i=(0,s.h)({queries:r.ids.map(e=>({queryKey:[d,e],queryFn:()=>r.dataResolver(e),retry:!1}))}),l=i.some(e=>{let{isLoading:t}=e;return t}),o=i.find(e=>{let{error:t}=e;return!!t}),u={};if(!l)for(let e of i.map(e=>{var t;return null!=(t=null==e?void 0:e.data)?t:{}}))for(let[t,r]of Object.entries(e))u[t]=r;return{analysisResponse:u,isFetching:l,fetchError:null!=(t=null==o?void 0:o.error)?t:void 0}},h=e=>{let{data:t,isLoading:r,error:i}=(0,l.a)({queryKey:[d,e],queryFn:()=>(0,a.OG)({client:n.L,path:{id:e}})});return{vulnerability:null==t?void 0:t.data,isFetching:r,fetchError:i}}},41135:function(e,t,r){r.d(t,{T:()=>a});var i=r(79192),l=r(53195),s=r(27378),n=r(74502);let a=(e,t)=>(0,s.useMemo)(()=>e&&0!==e.length?e.map(e=>(0,l._)((0,i._)({},e),{[n.nM]:t(e)})):[],[e,t])},16072:function(e,t,r){r.d(t,{h:()=>y});var i=r(27378),l=r(83484),s=r(7246),n=r(82418),a=r(24038);function o(e,t){let r=new Set(t);return e.filter(e=>!r.has(e))}var d=class extends n.l{#e;#t;#r;#i;#l;#s;#n;#a;#o=[];constructor(e,t,r){super(),this.#e=e,this.#i=r,this.#r=[],this.#l=[],this.#t=[],this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.#l.forEach(e=>{e.subscribe(t=>{this.#d(e,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#l.forEach(e=>{e.destroy()})}setQueries(e,t){this.#r=e,this.#i=t,l.Vr.batch(()=>{let e=this.#l,t=this.#u(this.#r);this.#o=t,t.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions));let r=t.map(e=>e.observer),i=r.map(e=>e.getCurrentResult()),l=r.some((t,r)=>t!==e[r]);(e.length!==r.length||l)&&(this.#l=r,this.#t=i,this.hasListeners()&&(o(e,r).forEach(e=>{e.destroy()}),o(r,e).forEach(e=>{e.subscribe(t=>{this.#d(e,t)})}),this.#c()))})}getCurrentResult(){return this.#t}getQueries(){return this.#l.map(e=>e.getCurrentQuery())}getObservers(){return this.#l}getOptimisticResult(e,t){let r=this.#u(e),i=r.map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions));return[i,e=>this.#h(e??i,t),()=>this.#v(i,r)]}#v(e,t){return t.map((r,i)=>{let l=e[i];return r.defaultedQueryOptions.notifyOnChangeProps?l:r.observer.trackResult(l,e=>{t.forEach(t=>{t.observer.trackProp(e)})})})}#h(e,t){return t?(this.#s&&this.#t===this.#a&&t===this.#n||(this.#n=t,this.#a=this.#t,this.#s=(0,a.Q$)(this.#s,t(e))),this.#s):e}#u(e){let t=new Map(this.#l.map(e=>[e.options.queryHash,e])),r=[];return e.forEach(e=>{let i=this.#e.defaultQueryOptions(e),l=t.get(i.queryHash);l?r.push({defaultedQueryOptions:i,observer:l}):r.push({defaultedQueryOptions:i,observer:new s.z(this.#e,i)})}),r}#d(e,t){let r=this.#l.indexOf(e);-1!==r&&(this.#t=function(e,t,r){let i=e.slice(0);return i[t]=r,i}(this.#t,r,t),this.#c())}#c(){if(this.hasListeners()){let e=this.#s,t=this.#v(this.#t,this.#o);e!==this.#h(t,this.#i?.combine)&&l.Vr.batch(()=>{this.listeners.forEach(e=>{e(this.#t)})})}}},u=r(68e3),c=r(12675),h=r(73687),v=r(80484),p=r(76720);function y({queries:e,...t},r){let n=(0,u.NL)(r),o=(0,c.S)(),y=(0,h._)(),f=i.useMemo(()=>e.map(e=>{let t=n.defaultQueryOptions(e);return t._optimisticResults=o?"isRestoring":"optimistic",t}),[e,n,o]);f.forEach(e=>{(0,p.A8)(e),(0,v.pf)(e,y)}),(0,v.JN)(y);let[b]=i.useState(()=>new d(n,f,t)),[m,x,j]=b.getOptimisticResult(f,t.combine),g=!o&&!1!==t.subscribed;i.useSyncExternalStore(i.useCallback(e=>g?b.subscribe(l.Vr.batchCalls(e)):a.ZT,[b,g]),()=>b.getCurrentResult(),()=>b.getCurrentResult()),i.useEffect(()=>{b.setQueries(f,t)},[f,t,b]);let _=m.some((e,t)=>(0,p.SB)(f[t],e))?m.flatMap((e,t)=>{let r=f[t];if(r){let t=new s.z(n,r);if((0,p.SB)(r,e))return(0,p.j8)(r,t,y);(0,p.Z$)(e,o)&&(0,p.j8)(r,t,y)}return[]}):[];if(_.length>0)throw Promise.all(_);let S=m.find((e,t)=>{let r=f[t];return r&&(0,v.KJ)({result:e,errorResetBoundary:y,throwOnError:r.throwOnError,query:n.getQueryCache().get(r.queryHash),suspense:r.suspense})});if(S?.error)throw S.error;return x(j())}}}]);