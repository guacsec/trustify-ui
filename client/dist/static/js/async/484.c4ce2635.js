"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["484"],{87017:function(e,a,r){r.d(a,{Co:()=>h,Cu:()=>u,Hb:()=>p});var t=r(79192),l=r(53195),n=r(70233),s=r(74502);r(41947);let o="/api",i="".concat(o,"/v2/advisory"),d="".concat(o,"/v2/sbom"),c=e=>{let a="application/json";return e.name.endsWith(".bz2")&&(a="application/json+bzip2"),a},u=(e,a)=>{let r=e.get(s.TB);return n.Z.post("".concat(i),r,(0,l._)((0,t._)({},a),{headers:{"Content-Type":c(r)}}))},p=(e,a)=>{let r=e.get(s.TB);return n.Z.post("".concat(d),r,(0,l._)((0,t._)({},a),{headers:{"Content-Type":c(r)}}))},h=e=>n.Z.get("".concat(d,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},95169:function(e,a,r){r.d(a,{V:()=>u});var t=r(79192),l=r(53195),n=r(27378),s=r(74502),o=r(70233);let i="cancelled",d=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),c=(e,a)=>{switch(a.type){case"queueUpload":return(0,l._)((0,t._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,l._)((0,t._)({},e.uploads.get(a.payload.file)||d()),{status:"queued",cancelFn:a.payload.cancelFn}))});case"updateUploadProgress":return(0,l._)((0,t._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,l._)((0,t._)({},e.uploads.get(a.payload.file)||d()),{progress:a.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,l._)((0,t._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,l._)((0,t._)({},e.uploads.get(a.payload.file)||d()),{status:"complete",response:a.payload.response}))});case"finishUploadWithError":var r;return(0,l._)((0,t._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,l._)((0,t._)({},e.uploads.get(a.payload.file)||d()),{status:"complete",error:a.payload.error,wasCancelled:(null==(r=a.payload.error)?void 0:r.message)===i}))});case"removeUpload":{let r=new Map(e.uploads);return r.delete(a.payload.file),(0,l._)((0,t._)({},e),{uploads:r})}default:throw Error()}},u=e=>{let{parallel:a,uploadFn:r,onSuccess:t,onError:l}=e,[d,u]=n.useReducer(c,{uploads:new Map});return{uploads:d.uploads,handleUpload:e=>{let n=[];for(let a=0;a<e.length;a++){let r=e[a],d=new FormData;d.set(s.TB,r);let c=o.Z.CancelToken.source(),p={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var a;let t=null!=(a=e.total)?a:1;u({type:"updateUploadProgress",payload:{file:r,progress:Math.round(e.loaded/t*100)}})},cancelToken:c.token};u({type:"queueUpload",payload:{file:r,cancelFn:c}});let h={formData:d,config:p,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:r,response:e}}),t&&t(e,r)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:r,error:e}}),e.message!==i&&l&&l(e,r)}};n.push(h)}if(a)for(let e of n)r(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else n.reduce(async(e,a)=>(await e,r(a.formData,a.config).then(a.thenFn).catch(a.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var a,r;null==(r=d.uploads.get(e))||null==(a=r.cancelFn)||a.cancel(i)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},34473:function(e,a,r){r.r(a),r.d(a,{default:()=>T});var t=r(24246),l=r(27378),n=r(45043),s=r(68802),o=r(31757),i=r(51527),d=r(2075),c=r(27090),u=r(75165),p=r(31762),h=r(99),y=r(24787),v=r(90359),f=r(12621),g=r(17598),m=r(43959),x=r(51851),j=r(21714),F=r(40270),q=r(23056),_=r(91057),b=r(84335),U=r(13754),w=r(79551),E=r(32489),L=r(90519),P=r(81211),C=r(45882),S=r(22621),K=r(416);let R=e=>{let{uploads:a,handleUpload:r,handleRemoveUpload:n,extractSuccessMessage:s,extractErrorMessage:o}=e,[i,d]=l.useState(!1),[c,u]=l.useState("inProgress"),[p,h]=l.useState([]);!i&&a.size>0&&d(!0),l.useEffect(()=>{let e=Array.from(a.values());e.some(e=>"inProgress"===e.status)?u("inProgress"):e.every(e=>"complete"===e.status)?u("success"):u("danger")},[a]);let y=Array.from(a.values()).filter(e=>e.response).length;return(0,t.jsxs)(x.o,{onFileDrop:(e,a)=>{r(a)},dropzoneProps:{accept:{"application/xml":[".json",".bz2"]},onDropRejected:e=>{h(e)},useFsAccessApi:!1},children:[(0,t.jsx)(j.Y,{titleIcon:(0,t.jsx)(K.ZP,{}),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2"}),i&&(0,t.jsx)(F.M,{statusToggleText:"".concat(y," of ").concat(a.size," files uploaded"),statusToggleIcon:c,children:Array.from(a.entries()).map((e,a)=>{let[r,l]=e;return(0,t.jsx)(q.B,{customFileHandler:()=>{},fileIcon:(0,t.jsx)(S.ZP,{}),file:r,onClearClick:()=>(e=>{for(let a of e)n(a)})([r]),progressValue:l.progress,progressVariant:l.error?"danger":l.response?"success":void 0,progressHelperText:l.error?(0,t.jsx)(_.p,{isLiveRegion:!0,children:(0,t.jsx)(b.u,{variant:"error",children:o(l.error)})}):100!==l.progress||l.response?l.response?(0,t.jsx)(_.p,{isLiveRegion:!0,children:(0,t.jsx)(b.u,{variant:"default",children:s(l.response)})}):void 0:(0,t.jsx)(_.p,{isLiveRegion:!0,children:(0,t.jsxs)(b.u,{variant:"warning",children:[(0,t.jsx)(U.$,{isInline:!0}),"File uploaded. Waiting for the server to process it."]})})},"".concat(r.name,"-").concat(a))})}),(0,t.jsxs)(w.u,{isOpen:p.length>0,"aria-label":"unsupported file upload attempted",onClose:()=>h([]),variant:"small",children:[(0,t.jsx)(E.x,{title:"Unsupported files",titleIconVariant:"warning"}),(0,t.jsx)(L.f,{children:(0,t.jsx)(P.aV,{children:p.map(e=>(0,t.jsx)(C.H,{children:e.file.name},e.file.name))})})]})]})},T=()=>{let{uploads:e,handleUpload:a,handleRemoveUpload:r}=(0,m.km)(),{uploads:x,handleUpload:j,handleRemoveUpload:F}=(0,g.tG)(),q=l.createRef(),_=l.createRef();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.NP,{hasBodyWrapper:!1,children:(0,t.jsx)(s.V,{children:(0,t.jsx)(s.V,{component:"h1",children:"Upload"})})}),(0,t.jsx)(n.NP,{hasBodyWrapper:!1,children:(0,t.jsx)(o.Z,{children:(0,t.jsx)(i.e,{children:(0,t.jsxs)(d.m,{defaultActiveKey:0,children:[(0,t.jsx)(c.O,{eventKey:0,title:(0,t.jsx)(u.T,{children:"SBOM"}),actions:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.b,{ref:q,children:(0,t.jsx)(f.ZP,{})}),(0,t.jsx)(h.J,{bodyContent:(0,t.jsx)("div",{children:"Upload a Software Bill of Materials (SBOM) document. We accept CycloneDX versions 1.3, 1.4, 1.5 and 1.6, and System Package Data Exchange (SPDX) versions 2.2, and 2.3."}),triggerRef:q})]}),children:(0,t.jsx)(y.I,{id:"upload-sbom-tab-content",children:(0,t.jsx)(v.H,{hasPadding:!0,children:(0,t.jsx)(R,{uploads:e,handleUpload:a,handleRemoveUpload:r,extractSuccessMessage:e=>"".concat(e.data.document_id," uploaded"),extractErrorMessage:e=>{var a;return(null==(a=e.response)?void 0:a.data)?e.message:"Error while uploading file"}})})})}),(0,t.jsx)(c.O,{eventKey:1,title:(0,t.jsx)(u.T,{children:"Advisory"}),actions:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.b,{ref:_,children:(0,t.jsx)(f.ZP,{})}),(0,t.jsx)(h.J,{bodyContent:(0,t.jsx)("div",{children:"Upload a CSAF, CVE, or OSV Advisory."}),triggerRef:_})]}),children:(0,t.jsx)(y.I,{id:"upload-advisory-tab-content",children:(0,t.jsx)(v.H,{hasPadding:!0,children:(0,t.jsx)(R,{uploads:x,handleUpload:j,handleRemoveUpload:F,extractSuccessMessage:e=>"".concat(e.data.document_id," uploaded"),extractErrorMessage:e=>{var a;return(null==(a=e.response)?void 0:a.data)?e.message:"Error while uploading file"}})})})})]})})})})]})}},17598:function(e,a,r){r.d(a,{N7:()=>g,VY:()=>f,gw:()=>m,sj:()=>j,tG:()=>x});var t=r(79192),l=r(53195),n=r(70186),s=r(1183),o=r(24038),i=r(68e3),d=r(75503),c=r(50576),u=r(40371),p=r(87017),h=r(49988),y=r(95169);let v="advisories",f=e=>{let{data:a,isLoading:r,error:t,refetch:l}=(0,s.a)({queryKey:[v,"labels",e],queryFn:()=>(0,u.sf)({client:c.L,query:{limit:10,filter_text:e}}),placeholderData:o.Wk});return{labels:(null==a?void 0:a.data)||[],isFetching:r,fetchError:t,refetch:l}},g=function(){var e,a,r;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],p=(0,h.rm)(o),{q:y}=p,f=(0,n._)(p,["q"]),g=(0,h.Rb)(i),{data:m,isLoading:x,error:j,refetch:F}=(0,s.a)({queryKey:[v,o,g],queryFn:()=>(0,u.A1)({client:c.L,query:(0,l._)((0,t._)({},f),{q:[y,g].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==m||null==(e=m.data)?void 0:e.items)||[],total:null!=(r=null==m||null==(a=m.data)?void 0:a.total)?r:0,params:o},isFetching:x,fetchError:j||null,refetch:F}},m=e=>{let{data:a,isLoading:r,error:t}=(0,s.a)({queryKey:[v,e],queryFn:()=>(0,u.pB)({client:c.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==a?void 0:a.data,isFetching:r,fetchError:t}},x=()=>{let e=(0,i.NL)();return(0,y.V)({parallel:!0,uploadFn:(e,a)=>(0,p.Cu)(e,a),onSuccess:async()=>{await e.invalidateQueries({queryKey:[v]})}})},j=(e,a)=>{let r=(0,i.NL)();return(0,d.D)({mutationFn:e=>(0,u.m5)({client:c.L,path:{id:e.id},body:e.labels}),onSuccess:async(a,t)=>{e(),await r.invalidateQueries({queryKey:[v]})},onError:a})}},43959:function(e,a,r){r.d(a,{Fz:()=>m,KQ:()=>_,Oh:()=>q,i5:()=>g,km:()=>j,p4:()=>x,qi:()=>U,t9:()=>F,uz:()=>b});var t=r(79192),l=r(53195),n=r(70186),s=r(1183),o=r(24038),i=r(68e3),d=r(75503),c=r(16072),u=r(50576),p=r(40371),h=r(95169),y=r(87017),v=r(49988);let f="sboms",g=e=>{let{data:a,isLoading:r,error:t,refetch:l}=(0,s.a)({queryKey:[f,"labels",e],queryFn:()=>(0,p.mh)({client:u.L,query:{limit:10,filter_text:e}}),placeholderData:o.Wk});return{labels:(null==a?void 0:a.data)||[],isFetching:r,fetchError:t,refetch:l}},m=function(){var e,a,r;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=(0,v.rm)(o),{q:h}=c,y=(0,n._)(c,["q"]),g=(0,v.Rb)(i),{data:m,isLoading:x,error:j,refetch:F}=(0,s.a)({queryKey:[f,o,g],queryFn:()=>(0,p.Wp)({client:u.L,query:(0,l._)((0,t._)({},y),{q:[h,g].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==m||null==(e=m.data)?void 0:e.items)||[],total:null!=(r=null==m||null==(a=m.data)?void 0:a.total)?r:0,params:o},isFetching:x,fetchError:j,refetch:F}},x=e=>{let{data:a,isLoading:r,error:t}=(0,s.a)({queryKey:[f,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,p._Q)({client:u.L,path:{id:e}}),enabled:void 0!==e});return{sbom:null==a?void 0:a.data,isFetching:r,fetchError:t}},j=()=>{let e=(0,i.NL)();return(0,h.V)({parallel:!0,uploadFn:(e,a)=>(0,y.Hb)(e,a),onSuccess:async()=>{await e.invalidateQueries({queryKey:[f]})}})},F=(e,a)=>{let r=(0,i.NL)();return(0,d.D)({mutationFn:e=>(0,p.zx)({client:u.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[f]})},onError:a})},q=function(e){var a,r,l;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:o,isLoading:i,error:d,refetch:c}=(0,s.a)({queryKey:[f,"by-package",e,n],queryFn:()=>(0,p.DU)({client:u.L,query:(0,t._)({purl:e},(0,v.rm)(n))})});return{result:{data:(null==o||null==(a=o.data)?void 0:a.items)||[],total:null!=(l=null==o||null==(r=o.data)?void 0:r.total)?l:0,params:n},isFetching:i,fetchError:d,refetch:c}},_=e=>{let{data:a,isLoading:r,error:t}=(0,s.a)({queryKey:[f,e,"advisory"],queryFn:()=>(0,p.NU)({client:u.L,path:{id:e}})});return{advisories:(null==a?void 0:a.data)||[],isFetching:r,fetchError:t}},b=e=>{let a=(0,c.h)({queries:e.map(e=>({queryKey:[f,e,"advisory"],queryFn:()=>(0,p.NU)({client:u.L,path:{id:e}})}))});return{advisories:a.map(e=>{let{data:a}=e;return(null==a?void 0:a.data)||[]}),isFetching:a.some(e=>{let{isLoading:a}=e;return a}),fetchError:a.map(e=>{let{error:a}=e;return a})}},U=e=>{let{data:a,isLoading:r,error:t}=(0,s.a)({queryKey:[f,e,"license-ids"],queryFn:()=>(0,p.J4)({client:u.L,path:{id:e}})});return{licenseIds:(null==a?void 0:a.data)||[],isFetching:r,fetchError:t}}}}]);