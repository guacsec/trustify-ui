"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["597"],{97339:function(e,i,l){l.d(i,{a:()=>c});var n=l(59390),r=l(24246),t=l(27378),s=l(90633),a=l(15508),d=l(53315);let c=e=>{var{children:i=null,className:l="","aria-label":o="Breadcrumb",ouiaId:u,ouiaSafe:h=!0}=e,m=(0,n.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let x=(0,d.S$)(c.displayName,u,h);return(0,r.jsx)("nav",Object.assign({},m,{"aria-label":o,className:(0,a.i)(s.Z.breadcrumb,l)},x,{children:(0,r.jsx)("ol",{className:s.Z.breadcrumbList,role:"list",children:t.Children.map(i,(e,i)=>(0,t.isValidElement)(e)?(0,t.cloneElement)(e,{showDivider:i>0}):e)})}))};c.displayName="Breadcrumb"},18091:function(e,i,l){l.d(i,{g:()=>d});var n=l(59390),r=l(24246),t=l(91985),s=l(90633),a=l(15508);let d=e=>{var{children:i=null,className:l="",to:d,isActive:c=!1,isDropdown:o=!1,showDivider:u,target:h,component:m="a",render:x}=e,p=(0,n.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let j=c?"page":void 0,b=(0,a.i)(s.Z.breadcrumbLink,c&&s.Z.modifiers.current);return(0,r.jsxs)("li",Object.assign({},p,{className:(0,a.i)(s.Z.breadcrumbItem,l),children:[u&&(0,r.jsx)("span",{className:s.Z.breadcrumbItemDivider,children:(0,r.jsx)(t.ZP,{})}),"button"===m&&(0,r.jsx)("button",{className:b,"aria-current":j,type:"button",children:i}),o&&(0,r.jsx)("span",{className:(0,a.i)(s.Z.breadcrumbDropdown),children:i}),x&&x({className:b,ariaCurrent:j}),d&&!x&&(0,r.jsx)(m,{href:d,target:h,className:b,"aria-current":j,children:i}),!d&&"button"!==m&&!o&&i]}))};d.displayName="BreadcrumbItem"},81211:function(e,i,l){l.d(i,{aV:()=>h});var n,r,t,s,a,d=l(59390),c=l(24246),o=l(40269),u=l(15508);(n=t||(t={})).number="1",n.lowercaseLetter="a",n.uppercaseLetter="A",n.lowercaseRomanNumber="i",n.uppercaseRomanNumber="I",(s||(s={})).inline="inline",(r=a||(a={})).ol="ol",r.ul="ul";let h=e=>{var{className:i="",children:l=null,variant:n=null,isBordered:r=!1,isPlain:s=!1,iconSize:h="default",type:m=t.number,ref:x=null,component:p=a.ul,"aria-label":j}=e,b=(0,d.__rest)(e,["className","children","variant","isBordered","isPlain","iconSize","type","ref","component","aria-label"]);return p===a.ol?(0,c.jsx)("ol",Object.assign({ref:x,type:m,"aria-label":j},s&&{role:"list"},b,{className:(0,u.i)(o.Z.list,n&&o.Z.modifiers[n],r&&o.Z.modifiers.bordered,s&&o.Z.modifiers.plain,h&&"large"===h&&o.Z.modifiers.iconLg,i),children:l})):(0,c.jsx)("ul",Object.assign({ref:x,"aria-label":j},s&&{role:"list"},b,{className:(0,u.i)(o.Z.list,n&&o.Z.modifiers[n],r&&o.Z.modifiers.bordered,s&&o.Z.modifiers.plain,h&&"large"===h&&o.Z.modifiers.iconLg,i),children:l}))};h.displayName="List"},45882:function(e,i,l){l.d(i,{H:()=>a});var n=l(59390),r=l(24246),t=l(40269),s=l(15508);let a=e=>{var{className:i,children:l=null,icon:a=null}=e,d=(0,n.__rest)(e,["className","children","icon"]);return(0,r.jsxs)("li",Object.assign({className:(0,s.i)(a&&t.Z.listItem,i)},d,{children:[a&&(0,r.jsx)("span",{className:(0,s.i)(t.Z.listItemIcon),children:a}),(0,r.jsx)("span",{className:a&&(0,s.i)(`${t.Z.list}__item-text`),children:l})]}))};a.displayName="ListItem"},11797:function(e,i,l){l.d(i,{O:()=>a});var n=l(59390),r=l(24246);let t={circle:"pf-m-circle",square:"pf-m-square",widthSm:"pf-m-width-sm",widthMd:"pf-m-width-md",widthLg:"pf-m-width-lg",width_25:"pf-m-width-25",width_33:"pf-m-width-33",width_50:"pf-m-width-50",width_66:"pf-m-width-66",width_75:"pf-m-width-75",heightSm:"pf-m-height-sm",heightMd:"pf-m-height-md",heightLg:"pf-m-height-lg",height_25:"pf-m-height-25",height_33:"pf-m-height-33",height_50:"pf-m-height-50",height_66:"pf-m-height-66",height_75:"pf-m-height-75",height_100:"pf-m-height-100",text_4xl:"pf-m-text-4xl",text_3xl:"pf-m-text-3xl",text_2xl:"pf-m-text-2xl",textXl:"pf-m-text-xl",textLg:"pf-m-text-lg",textMd:"pf-m-text-md",textSm:"pf-m-text-sm"};var s=l(15508);let a=e=>{var{className:i,width:l,height:a,fontSize:d,shape:c,screenreaderText:o}=e,u=(0,n.__rest)(e,["className","width","height","fontSize","shape","screenreaderText"]);let h=d?Object.values(t).find(e=>e===`pf-m-text-${d}`):void 0;return(0,r.jsx)("div",Object.assign({},u,{className:(0,s.i)("pf-v6-c-skeleton",d&&h,"circle"===c&&t.circle,"square"===c&&t.square,i)},(l||a)&&{style:Object.assign({"--pf-v6-c-skeleton--Width":l||void 0,"--pf-v6-c-skeleton--Height":a||void 0},u.style)},{children:(0,r.jsx)("span",{className:"pf-v6-screen-reader",children:o})}))};a.displayName="Skeleton"},26235:function(e,i,l){l.d(i,{ZP:()=>n});let n=(0,l(24329).I)({name:"PenIcon",height:512,width:512,svgPath:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z",yOffset:0,xOffset:0,svgClassName:void 0})},67447:function(e,i,l){l.d(i,{G:()=>a});var n=l(59390),r=l(24246),t=l(15508),s=l(39157);let a=e=>{var{children:i=null,hasNoBackground:l}=e,a=(0,n.__rest)(e,["children","hasNoBackground"]);return(0,r.jsx)("div",Object.assign({},a,{className:(0,t.i)(s.Z.tableExpandableRowContent,l&&s.Z.modifiers.noBackground),children:i}))};a.displayName="ExpandableRowContent"},69876:function(e,i,l){l.d(i,{D:()=>t});var n=l(24246),r=l(70400);let t=e=>{let{value:i}=e;return(0,n.jsx)(n.Fragment,{children:Object.entries(i).map(e=>{let[i,l]=e;return(0,n.jsx)(r._,{isCompact:!0,children:"".concat(i,"=").concat(l)},"".concat(i,"=").concat(l))})})}},68057:function(e,i,l){l.d(i,{V:()=>a});var n=l(24246),r=l(27378),t=l(63763),s=l(32947);let a=e=>{let{vulnerabilitiesSummary:i}=e,l=r.useMemo(()=>Object.keys(i.severities).map(e=>{let l=i.severities[e],n=s.V4[e];return{severity:e,count:l,label:n.name,color:n.color.value}}).sort((0,s.A0)(e=>e.severity)).reverse(),[i]);return(0,n.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,n.jsx)(t.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:"".concat(i.total),subTitle:"Total vulnerabilities",width:350,legendData:l.map(e=>{let{label:i,count:l}=e;return{name:"".concat(i,": ").concat(l)}}),data:l.map(e=>{let{label:i,count:l}=e;return{x:i,y:l}}),labels:e=>{let{datum:i}=e;return"".concat(i.x,": ").concat(i.y)},colorScale:l.map(e=>{let{color:i}=e;return i})})})}},3586:function(e,i,l){l.d(i,{j:()=>t});var n=l(24246),r=l(27378);let t=e=>{let{children:i}=e,[l,t]=r.useState(!1);return(0,n.jsx)(n.Fragment,{children:i(l,t)})}},24200:function(e,i,l){l.d(i,{G:()=>r});var n=l(24246);let r=e=>{let{vulnerability:i}=e;return(0,n.jsxs)("p",{children:[i.withdrawn&&(0,n.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},31373:function(e,i,l){l.d(i,{H:()=>u});var n=l(79192),r=l(53195),t=l(27378),s=l(7615),a=l(59015);let d=(e,i)=>e.vulnerability.identifier===i.vulnerability.identifier&&e.vulnerabilityStatus===i.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:(0,n._)({},c),fixed:(0,n._)({},c),not_affected:(0,n._)({},c),known_not_affected:(0,n._)({},c)}},u=e=>{let{pkg:i,isFetching:l,fetchError:c}=(0,a.ZA)(e);return{data:t.useMemo(()=>(e=>{let i=e.flatMap(e=>{var i;return(null!=(i=e.status)?i:[]).map(i=>{let l=(0,s.g)(i.average_severity);return{vulnerability:(0,r._)((0,n._)({},i.vulnerability),{average_severity:l,average_score:i.average_score}),vulnerabilityStatus:i.status,advisory:e}})}).reduce((e,i)=>{let l,t=e.find(e=>d(e,i));if(t)l=[...e.filter(e=>!d(e,t)),(0,r._)((0,n._)({},t),{relatedSboms:[...t.relatedSboms,{advisory:i.advisory}]})];else{let n={vulnerability:i.vulnerability,vulnerabilityStatus:i.vulnerabilityStatus,relatedSboms:[{advisory:i.advisory}]};l=[...e.slice(),n]}return l},[]),l=i.reduce((e,i)=>{let l=i.vulnerabilityStatus,t=i.vulnerability.average_severity,s=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,r._)((0,n._)({},e.vulnerabilityStatus),{[l]:{total:s.total+1,severities:(0,r._)((0,n._)({},s.severities),{[t]:s.severities[t]+1})}})})},(0,n._)({},o));return{vulnerabilities:i,summary:l}})((null==i?void 0:i.advisories)||[]),[i]),isFetching:l,fetchError:c}}},96308:function(e,i,l){l.d(i,{n:()=>c});var n=l(24246),r=l(11797),t=l(37818),s=l(42573),a=l(49304),d=l(31373);let c=e=>{let{packageId:i}=e,{data:l,isFetching:c,fetchError:o}=(0,d.H)(i);return(0,n.jsx)(t.u,{isFetching:c,fetchError:o,isFetchingState:(0,n.jsx)(r.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,n.jsx)(s.C,{error:e}),children:(0,n.jsx)(a.u,{severities:l.summary.vulnerabilityStatus.affected.severities})})}},41362:function(e,i,l){l.r(i),l.d(i,{default:()=>eZ});var n=l(24246),r=l(27378),t=l(65783),s=l(45043),a=l(97339),d=l(18091),c=l(11192),o=l(32591),u=l(34747),h=l(46770),m=l(68802),x=l(70400),p=l(32939),j=l(24620),b=l(37961),f=l(69265),v=l(2075),g=l(27090),_=l(75165),y=l(31762),T=l(99),S=l(24787),P=l(12621),w=l(9839),N=l(37818),k=l(73227),M=l(43959),E=l(65872),B=l(87727),O=l(3498),C=l(31757),Z=l(87069),K=l(51527),F=l(30329),I=l(50689),D=l(67761),L=l(81391),V=l(78700),q=l(81211),R=l(45882),A=l(79551),G=l(32489),H=l(90519),z=l(26235),U=l(73827),W=l(63706),$=l(66043);let Y=e=>{let{sbom:i}=e,[l,t]=r.useState(!1),s=()=>{t(!1)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(B.r,{hasGutter:!0,children:[(0,n.jsx)(O.P,{md:4,children:(0,n.jsxs)(C.Z,{isFullHeight:!0,children:[(0,n.jsx)(Z.l,{children:"Metadata"}),(0,n.jsx)(K.e,{children:(0,n.jsxs)(F.o,{children:[(0,n.jsxs)(I.g,{children:[(0,n.jsx)(D.M,{children:"Name"}),(0,n.jsx)(L.b,{"aria-label":"SBOM's name",children:i.name})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsx)(D.M,{children:"Namespace"}),(0,n.jsx)(L.b,{"aria-label":"SBOM's namespace",children:i.document_id})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsx)(D.M,{children:"Data License"}),(0,n.jsx)(L.b,{"aria-label":"SBOM's license",children:i.data_licenses.join(", ")})]})]})})]})}),(0,n.jsx)(O.P,{md:4,children:(0,n.jsxs)(C.Z,{isFullHeight:!0,children:[(0,n.jsx)(Z.l,{children:"Creation"}),(0,n.jsx)(K.e,{children:(0,n.jsxs)(F.o,{children:[(0,n.jsxs)(I.g,{children:[(0,n.jsx)(D.M,{children:"Created"}),(0,n.jsx)(L.b,{"aria-label":"SBOM's creation date",children:(0,W.p6)(i.published)})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsx)(D.M,{children:"Creator"}),(0,n.jsx)(L.b,{"aria-label":"SBOM's creator",children:i.suppliers})]})]})})]})}),(0,n.jsx)(O.P,{md:4,children:(0,n.jsxs)(C.Z,{isFullHeight:!0,children:[(0,n.jsx)(Z.l,{children:"Statistics"}),(0,n.jsx)(K.e,{children:(0,n.jsxs)(F.o,{children:[(0,n.jsxs)(I.g,{children:[(0,n.jsx)(D.M,{children:"Size"}),(0,n.jsx)(L.b,{children:(0,E.Z)(i.size)})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsx)(D.M,{children:"Packages"}),(0,n.jsx)(L.b,{children:i.number_of_packages})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsxs)(D.M,{children:["Labels ","",(0,n.jsx)(V.zx,{variant:V.Wu.link,size:"sm",icon:(0,n.jsx)(z.ZP,{}),iconPosition:"end",onClick:()=>t(!0),children:"Edit"})]}),(0,n.jsx)(L.b,{children:(0,n.jsx)(C.Z,{isCompact:!0,children:(0,n.jsx)(K.e,{children:i.labels&&(0,n.jsx)(U.C,{defaultIsOpen:!0,value:i.labels})})})})]})]})})]})}),(0,n.jsx)(O.P,{md:12,children:(0,n.jsxs)(C.Z,{isFullHeight:!0,children:[(0,n.jsx)(Z.l,{children:"Package"}),(0,n.jsx)(K.e,{children:(0,n.jsxs)(F.o,{children:[(0,n.jsxs)(I.g,{children:[(0,n.jsx)(D.M,{children:"Name"}),(0,n.jsx)(L.b,{children:i.name})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsx)(D.M,{children:"Version"}),(0,n.jsx)(L.b,{children:i.described_by.map(e=>e.version).join(", ")})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsx)(D.M,{children:"External References"}),(0,n.jsx)(L.b,{children:(0,n.jsxs)(q.aV,{children:[i.described_by.flatMap(e=>e.cpe).map(e=>(0,n.jsx)(R.H,{children:e},e)),i.described_by.flatMap(e=>e.purl).map(e=>(0,n.jsx)(R.H,{children:e.purl},e.uuid))]})})]})]})})]})})]}),(0,n.jsxs)(A.u,{isOpen:l,variant:"medium",onClose:s,children:[(0,n.jsx)(G.x,{title:"Edit labels"}),(0,n.jsx)(H.f,{children:(0,n.jsx)($._,{sbom:i,onClose:s})})]})]})};var J=l(79192),X=l(53195),Q=l(46403),ee=l(70715),ei=l(40982),el=l(89226),en=l(62997),er=l(4835),et=l(14350),es=l(11165),ea=l(89330),ed=l(31423),ec=l(94154),eo=l(67447),eu=l(14629),eh=l(3804),em=l(31336),ex=l(74502),ep=l(49988),ej=l(59015),eb=l(96308);let ef=(e,i)=>i.reduce((e,i)=>{let{license_id:l,license_name:n}=i;return e.replaceAll(l,n)},"".concat(e)),ev=e=>{let{sbomId:i}=e,{licenseIds:l}=(0,M.qi)(i),r=(0,ep.vZ)({tableName:"package-table",columnNames:{name:"Name",version:"Version",vulnerabilities:"Vulnerabilities",licenses:"Licenses",purls:"PURLs",cpes:"CPEs"},isSortEnabled:!0,sortableColumns:["name"],isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:ex.L4,title:"Filter text",placeholderText:"Search",type:eu.vA.search},{categoryKey:"license",title:"License",placeholderText:"Filter results by license",type:eu.vA.multiselect,operator:"~",logicOperator:"OR",selectOptions:l.map(e=>({value:e.license_id,label:e.license_name}))}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:s,total:a},isFetching:d,fetchError:c}=(0,ej.D4)(i,(0,ep.QO)((0,X._)((0,J._)({},r),{hubSortFieldKeys:{name:"name"}}))),o=(0,ep.KC)((0,X._)((0,J._)({},r),{idProperty:"id",currentPageItems:s,totalItemCount:a,isLoading:d})),{currentPageItems:u,numRenderedColumns:h,propHelpers:{toolbarProps:m,filterToolbarProps:p,paginationToolbarItemProps:j,paginationProps:b,tableProps:f,getThProps:v,getTrProps:g,getTdProps:_,getExpandedContentTdProps:y},expansionDerivedState:{isCellExpanded:T}}=o;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ee.o,(0,X._)((0,J._)({},m),{"aria-label":"Package toolbar",children:(0,n.jsxs)(ei.c,{children:[(0,n.jsx)(eu.Ki,(0,J._)({},p)),(0,n.jsx)(el.E,(0,X._)((0,J._)({},j),{children:(0,n.jsx)(eh.p,{idPrefix:"package-table",isTop:!0,paginationProps:b})}))]})})),(0,n.jsxs)(er.i,(0,X._)((0,J._)({},f),{"aria-label":"Package table",children:[(0,n.jsx)(et.h,{children:(0,n.jsx)(es.Tr,{children:(0,n.jsxs)(em.qK,(0,X._)((0,J._)({},o),{children:[(0,n.jsx)(ea.Th,(0,J._)({},v({columnKey:"name"}))),(0,n.jsx)(ea.Th,(0,J._)({},v({columnKey:"version"}))),(0,n.jsx)(ea.Th,(0,J._)({},v({columnKey:"vulnerabilities"}))),(0,n.jsx)(ea.Th,(0,J._)({},v({columnKey:"licenses"}))),(0,n.jsx)(ea.Th,(0,J._)({},v({columnKey:"purls"}))),(0,n.jsx)(ea.Th,(0,J._)({},v({columnKey:"cpes"})))]}))})}),(0,n.jsx)(em.hp,{isLoading:d,isError:!!c,isNoData:0===a,numRenderedColumns:h,children:null==u?void 0:u.map((e,i)=>(0,n.jsxs)(ed.p,{isExpanded:T(e),children:[(0,n.jsx)(es.Tr,(0,X._)((0,J._)({},g({item:e})),{children:(0,n.jsxs)(em.Cx,(0,X._)((0,J._)({},o),{item:e,rowIndex:i,children:[(0,n.jsx)(ec.Td,(0,X._)((0,J._)({width:15},_({columnKey:"name"})),{children:[e.name,e.group].filter(Boolean).join("/")})),(0,n.jsx)(ec.Td,(0,X._)((0,J._)({width:15,modifier:"truncate"},_({columnKey:"version"})),{children:null==e?void 0:e.version})),(0,n.jsx)(ec.Td,(0,X._)((0,J._)({width:10,modifier:"breakWord"},_({columnKey:"vulnerabilities"})),{children:e.purl[0]&&(0,n.jsx)(eb.n,{packageId:e.purl[0].uuid})})),(0,n.jsx)(ec.Td,(0,X._)((0,J._)({width:20,modifier:"breakWord"},_({columnKey:"licenses",isCompoundExpandToggle:e.licenses.length>1,item:e,rowIndex:i})),{children:1===e.licenses.length?ef(e.licenses[0].license_name,e.licenses_ref_mapping):"".concat(e.licenses.length," Licenses")})),(0,n.jsx)(ec.Td,(0,X._)((0,J._)({width:20,modifier:"breakWord"},_({columnKey:"purls",isCompoundExpandToggle:e.purl.length>1,item:e,rowIndex:i})),{children:1===e.purl.length?(0,n.jsx)(t.rU,{to:(0,Q.Gn)(w.nB.packageDetails,{packageId:e.purl[0].uuid}),children:e.purl[0].purl}):"".concat(e.purl.length," PURLs")})),(0,n.jsxs)(ec.Td,(0,X._)((0,J._)({width:20,modifier:"breakWord"},_({columnKey:"cpes",isCompoundExpandToggle:e.cpe.length>0,item:e,rowIndex:i})),{children:[e.cpe.length," CPEs"]}))]}))})),T(e)?(0,n.jsx)(es.Tr,{isExpanded:!0,children:(0,n.jsx)(ec.Td,(0,X._)((0,J._)({},y({item:e})),{className:en.Z.pLg,children:(0,n.jsx)(eo.G,{children:(0,n.jsxs)("div",{className:en.Z.ptLg,children:[T(e,"licenses")?(0,n.jsx)(q.aV,{isPlain:!0,children:e.licenses.map(i=>(0,n.jsxs)(R.H,{children:[ef(i.license_name,e.licenses_ref_mapping)," ",(0,n.jsx)(x._,{isCompact:!0,children:i.license_type})]},"".concat(i.license_name,"-").concat(i.license_type)))}):null,T(e,"purls")?(0,n.jsx)(q.aV,{isPlain:!0,children:e.purl.map(e=>(0,n.jsx)(R.H,{children:(0,n.jsx)(t.rU,{to:(0,Q.Gn)(w.nB.packageDetails,{packageId:e.uuid}),children:e.purl})},e.uuid))}):null,T(e,"cpes")?(0,n.jsx)(q.aV,{isPlain:!0,children:e.cpe.map(e=>(0,n.jsx)(R.H,{children:e},e))}):null]})})}))}):null]},e.id))})]})),(0,n.jsx)(eh.p,{idPrefix:"package-table",isTop:!1,paginationProps:b})]})};var eg=l(27693),e_=l.n(eg),ey=l(27317),eT=l(93095),eS=l(9905),eP=l(7615),ew=l(69876),eN=l(68057),ek=l(57524),eM=l(3586),eE=l(24200),eB=l(82413),eO=l(41135);let eC=e=>{let{sbomId:i}=e,{sbom:l,isFetching:s,fetchError:a}=(0,M.p4)(i),{data:{vulnerabilities:d,summary:c},isFetching:o,fetchError:u}=(0,eB.A)(i),h=r.useMemo(()=>d.filter(e=>"affected"===e.vulnerabilityStatus),[d]),m=r.useMemo(()=>h.map(e=>{let i=e.relatedPackages.flatMap(e=>e.packages).reduce((e,i)=>(e.find(e=>e.id===i.id)||e.push(i),e),[]);return(0,X._)((0,J._)({},e),{summary:{totalPackages:i.length,allPackages:i}})}),[h]),x=(0,eO.T)(m,e=>"".concat(e.vulnerability.identifier,"-").concat(e.vulnerabilityStatus)),p=(0,ep.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:x,isLoading:o,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>{var i,l;return{id:e.vulnerability.identifier,cvss:e.vulnerability.average_score,affectedDependencies:e.summary.totalPackages,published:(null==(i=e.vulnerability)?void 0:i.published)?e_()(e.vulnerability.published).valueOf():0,updated:(null==(l=e.vulnerability)?void 0:l.modified)?e_()(e.vulnerability.modified).valueOf():0}},isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:j,numRenderedColumns:b,propHelpers:{toolbarProps:f,paginationToolbarItemProps:v,paginationProps:g,tableProps:_,getThProps:y,getTrProps:T,getTdProps:S,getExpandedContentTdProps:P},expansionDerivedState:{isCellExpanded:k}}=p;return(0,n.jsxs)(ey.K,{hasGutter:!0,children:[(0,n.jsx)(eT.v,{children:(0,n.jsx)(C.Z,{children:(0,n.jsx)(K.e,{children:(0,n.jsx)(N.u,{isFetching:s||o,fetchError:a,children:(0,n.jsxs)(B.r,{hasGutter:!0,children:[(0,n.jsx)(O.P,{md:6,children:(0,n.jsx)(eN.V,{vulnerabilitiesSummary:c.vulnerabilityStatus.affected})}),(0,n.jsx)(O.P,{md:6,children:(0,n.jsxs)(F.o,{children:[(0,n.jsxs)(I.g,{children:[(0,n.jsx)(D.M,{children:"Name"}),(0,n.jsx)(L.b,{children:null==l?void 0:l.name})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsx)(D.M,{children:"Version"}),(0,n.jsx)(L.b,{children:null==l?void 0:l.described_by.map(e=>e.version).join(", ")})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsx)(D.M,{children:"Creation date"}),(0,n.jsx)(L.b,{children:(0,W.p6)(null==l?void 0:l.published)})]})]})})]})})})})}),(0,n.jsxs)(eT.v,{children:[(0,n.jsx)(ee.o,(0,X._)((0,J._)({},f),{children:(0,n.jsx)(ei.c,{children:(0,n.jsx)(el.E,(0,X._)((0,J._)({},v),{children:(0,n.jsx)(eh.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:g})}))})})),(0,n.jsxs)(er.i,(0,X._)((0,J._)({},_),{"aria-label":"Vulnerability table",children:[(0,n.jsx)(et.h,{children:(0,n.jsx)(es.Tr,{children:(0,n.jsxs)(em.qK,(0,X._)((0,J._)({},p),{children:[(0,n.jsx)(ea.Th,(0,J._)({},y({columnKey:"id"}))),(0,n.jsx)(ea.Th,(0,J._)({},y({columnKey:"description"}))),(0,n.jsx)(ea.Th,(0,J._)({},y({columnKey:"cvss"}))),(0,n.jsx)(ea.Th,(0,J._)({},y({columnKey:"affectedDependencies"}))),(0,n.jsx)(ea.Th,(0,J._)({},y({columnKey:"published"}))),(0,n.jsx)(ea.Th,(0,J._)({},y({columnKey:"updated"})))]}))})}),(0,n.jsx)(em.hp,{isLoading:o,isError:!!u,isNoData:0===x.length,numRenderedColumns:b,children:null==j?void 0:j.map((e,i)=>{var l,r;return(0,n.jsxs)(ed.p,{isExpanded:k(e),children:[(0,n.jsx)(es.Tr,(0,X._)((0,J._)({},T({item:e})),{children:(0,n.jsxs)(em.Cx,(0,X._)((0,J._)({},p),{item:e,rowIndex:i,children:[(0,n.jsx)(ec.Td,(0,X._)((0,J._)({width:15,modifier:"breakWord"},S({columnKey:"id"})),{children:(0,n.jsx)(t.rU,{to:(0,Q.Gn)(w.nB.vulnerabilityDetails,{vulnerabilityId:e.vulnerability.identifier}),children:e.vulnerability.identifier})})),(0,n.jsx)(eM.j,{children:(i,l)=>(0,n.jsx)(ec.Td,(0,X._)((0,J._)({width:35,modifier:"truncate",onFocus:()=>l(!0),onBlur:()=>l(!1),tabIndex:0},S({columnKey:"description"})),{children:(0,n.jsx)(eS.cE,{focused:i,wrapModifier:"truncate",children:e.vulnerability&&(0,n.jsx)(eE.G,{vulnerability:e.vulnerability})})}))}),(0,n.jsx)(ec.Td,(0,X._)((0,J._)({width:10},S({columnKey:"cvss"})),{children:(0,n.jsx)(ek.o,{value:(0,eP.g)(e.vulnerability.average_severity),score:e.vulnerability.average_score,showLabel:!0,showScore:!0})})),(0,n.jsx)(ec.Td,(0,X._)((0,J._)({width:15,modifier:"truncate"},S({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:i})),{children:e.summary.totalPackages})),(0,n.jsx)(ec.Td,(0,X._)((0,J._)({width:10,modifier:"truncate"},S({columnKey:"published"})),{children:(0,W.p6)(null==(l=e.vulnerability)?void 0:l.published)})),(0,n.jsx)(ec.Td,(0,X._)((0,J._)({width:10,modifier:"truncate"},S({columnKey:"updated"})),{children:(0,W.p6)(null==(r=e.vulnerability)?void 0:r.modified)}))]}))})),k(e)?(0,n.jsx)(es.Tr,{isExpanded:!0,children:(0,n.jsx)(ec.Td,(0,X._)((0,J._)({},P({item:e})),{children:(0,n.jsx)(eo.G,{children:k(e,"affectedDependencies")?(0,n.jsxs)(er.i,{variant:"compact",children:[(0,n.jsx)(et.h,{children:(0,n.jsxs)(es.Tr,{children:[(0,n.jsx)(ea.Th,{children:"Type"}),(0,n.jsx)(ea.Th,{children:"Namespace"}),(0,n.jsx)(ea.Th,{children:"Name"}),(0,n.jsx)(ea.Th,{children:"Version"}),(0,n.jsx)(ea.Th,{children:"Path"}),(0,n.jsx)(ea.Th,{children:"Qualifiers"})]})}),(0,n.jsx)(ed.p,{children:e.summary.allPackages.flatMap(e=>e.name&&0===e.purl.length?[{parentName:e.name}]:e.purl.map(i=>({parentName:e.name,purlSummary:i}))).map((e,i)=>{if(e.purlSummary){let i=(0,W.qX)(e.purlSummary.purl);return(0,n.jsxs)(es.Tr,{children:[(0,n.jsx)(ec.Td,{children:null==i?void 0:i.type}),(0,n.jsx)(ec.Td,{children:null==i?void 0:i.namespace}),(0,n.jsx)(ec.Td,{children:(0,n.jsx)(t.rU,{to:(0,Q.Gn)(w.nB.packageDetails,{packageId:e.purlSummary.uuid}),children:null==i?void 0:i.name})}),(0,n.jsx)(ec.Td,{children:null==i?void 0:i.version}),(0,n.jsx)(ec.Td,{children:null==i?void 0:i.path}),(0,n.jsx)(ec.Td,{children:(null==i?void 0:i.qualifiers)&&(0,n.jsx)(ew.D,{value:null==i?void 0:i.qualifiers})})]},e.purlSummary.uuid)}return(0,n.jsxs)(es.Tr,{children:[(0,n.jsx)(ec.Td,{}),(0,n.jsx)(ec.Td,{}),(0,n.jsx)(ec.Td,{children:e.parentName}),(0,n.jsx)(ec.Td,{}),(0,n.jsx)(ec.Td,{}),(0,n.jsx)(ec.Td,{})]},"".concat(e.parentName,"-").concat(i,"-name"))})})]}):null})}))}):null]},e._ui_unique_id)})})]})),(0,n.jsx)(eh.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:g})]})]})},eZ=()=>{var e,i;let l=(0,w.ZX)(w.Uo.SBOM_ID),{sbom:E,isFetching:B,fetchError:O}=(0,M.p4)(l),{downloadSBOM:C,downloadSBOMLicenses:Z}=(0,k.i)(),[K,F]=r.useState(!1),[I,D]=r.useState(0),L=r.createRef(),V=r.createRef(),q=r.createRef(),R=r.createRef(),A=()=>{F(!K)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.NP,{type:"breadcrumb",children:(0,n.jsxs)(a.a,{children:[(0,n.jsx)(d.g,{children:(0,n.jsx)(t.rU,{to:w.nB.sboms,children:"SBOMs"})}),(0,n.jsx)(d.g,{isActive:!0,children:"SBOM details"})]})}),(0,n.jsx)(s.NP,{children:(0,n.jsxs)(c.P,{children:[(0,n.jsx)(o.J,{isFilled:!0,children:(0,n.jsxs)(u.k,{children:[(0,n.jsx)(h.B,{spacer:{default:"spacerSm"},children:(0,n.jsx)(m.V,{children:(0,n.jsx)(m.V,{component:"h1",children:null!=(i=null!=(e=null==E?void 0:E.name)?e:l)?i:""})})}),(0,n.jsx)(h.B,{children:(null==E?void 0:E.labels.type)&&(0,n.jsx)(x._,{color:"blue",children:null==E?void 0:E.labels.type})})]})}),(0,n.jsx)(o.J,{children:E&&(0,n.jsx)(p.L,{isOpen:K,onSelect:()=>F(!1),onOpenChange:e=>F(e),popperProps:{position:"right"},toggle:e=>(0,n.jsx)(j.O_,{ref:e,onClick:A,isExpanded:K,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,n.jsxs)(b.s,{children:[(0,n.jsx)(f.h,{onClick:()=>{l&&C(l,(null==E?void 0:E.name)?"".concat(null==E?void 0:E.name,".json"):"".concat(l,".json"))},children:"Download SBOM"},"sbom"),(0,n.jsx)(f.h,{onClick:()=>{l&&Z(l)},children:"Download License Report"},"license")]})})})]})}),(0,n.jsx)(s.NP,{children:(0,n.jsxs)(v.m,{mountOnEnter:!0,activeKey:I,onSelect:(e,i)=>{D(i)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,n.jsx)(g.O,{eventKey:0,title:(0,n.jsx)(_.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:L}),(0,n.jsx)(g.O,{eventKey:1,title:(0,n.jsx)(_.T,{children:"Packages"}),tabContentId:"refTabPackagesSection",tabContentRef:V}),(0,n.jsx)(g.O,{eventKey:2,title:(0,n.jsx)(_.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:q,actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.b,{ref:R,children:(0,n.jsx)(P.ZP,{})}),(0,n.jsx)(T.J,{triggerRef:R,bodyContent:(0,n.jsx)("div",{children:"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed."})})]})})]})}),(0,n.jsxs)(s.NP,{children:[(0,n.jsx)(S.I,{eventKey:0,id:"refTabInfoSection",ref:L,"aria-label":"Information of the SBOM",children:(0,n.jsx)(N.u,{isFetching:B,fetchError:O,children:E&&(0,n.jsx)(Y,{sbom:E})})}),(0,n.jsx)(S.I,{eventKey:1,id:"refTabPackagesSection",ref:V,"aria-label":"Packages within the SBOM",hidden:!0,children:l&&(0,n.jsx)(ev,{sbomId:l})}),(0,n.jsx)(S.I,{eventKey:2,id:"refVulnerabilitiesSection",ref:q,"aria-label":"Vulnerabilities within the SBOM",hidden:!0,children:l&&(0,n.jsx)(eC,{sbomId:l})})]})]})}},59015:function(e,i,l){l.d(i,{D4:()=>u,ZA:()=>o,fF:()=>c});var n=l(79192),r=l(1183),t=l(50576),s=l(40371),a=l(49988);let d="packages",c=function(){var e,i,l;let c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:u,isLoading:h,error:m,refetch:x}=(0,r.a)({queryKey:[d,c],queryFn:()=>(0,s.tj)({client:t.L,query:(0,n._)({},(0,a.rm)(c))}),enabled:!o});return{result:{data:(null==u||null==(e=u.data)?void 0:e.items)||[],total:null!=(l=null==u||null==(i=u.data)?void 0:i.total)?l:0,params:c},isFetching:h,fetchError:m,refetch:x}},o=e=>{let{data:i,isLoading:l,error:n}=(0,r.a)({queryKey:[d,e],queryFn:()=>(0,s.BK)({client:t.L,path:{key:e}})});return{pkg:null==i?void 0:i.data,isFetching:l,fetchError:n}},u=function(e){var i,l,c;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:u,isLoading:h,error:m,refetch:x}=(0,r.a)({queryKey:[d,"by-sbom",e,o],queryFn:()=>(0,s.Pg)({client:t.L,path:{id:e},query:(0,n._)({},(0,a.rm)(o))})});return{result:{data:(null==u||null==(i=u.data)?void 0:i.items)||[],total:null!=(c=null==u||null==(l=u.data)?void 0:l.total)?c:0,params:o},isFetching:h,fetchError:m,refetch:x}}},41135:function(e,i,l){l.d(i,{T:()=>a});var n=l(79192),r=l(53195),t=l(27378),s=l(74502);let a=(e,i)=>(0,t.useMemo)(()=>e&&0!==e.length?e.map(e=>(0,r._)((0,n._)({},e),{[s.nM]:i(e)})):[],[e,i])},40269:function(e,i,l){l.d(i,{Z:()=>n});let n={list:"pf-v6-c-list",listItem:"pf-v6-c-list__item",listItemIcon:"pf-v6-c-list__item-icon",modifiers:{iconLg:"pf-m-icon-lg",plain:"pf-m-plain",inline:"pf-m-inline",bordered:"pf-m-bordered"}}},65872:function(e,i,l){l.d(i,{Z:()=>d});let n=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],r=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],t=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],s=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],a=(e,i,l)=>{let n=e;return"string"==typeof i||Array.isArray(i)?n=e.toLocaleString(i,l):(!0===i||void 0!==l)&&(n=e.toLocaleString(void 0,l)),n};function d(e,i){let l;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let d=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?s:t:i.binary?r:n,c=i.space?" ":"";if(i.signed&&0===e)return` 0${c}${d[0]}`;let o=e<0,u=o?"-":i.signed?"+":"";if(o&&(e=-e),void 0!==i.minimumFractionDigits&&(l={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(l={maximumFractionDigits:i.maximumFractionDigits,...l}),e<1)return u+a(e,i.locale,l)+c+d[0];let h=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),d.length-1);return e/=(i.binary?1024:1e3)**h,l||(e=e.toPrecision(3)),u+a(Number(e),i.locale,l)+c+d[h]}}}]);