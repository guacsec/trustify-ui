"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["150"],{97339:function(e,i,r){r.d(i,{a:()=>c});var n=r(59390),l=r(24246),t=r(27378),s=r(90633),a=r(15508),d=r(53315);let c=e=>{var{children:i=null,className:r="","aria-label":o="Breadcrumb",ouiaId:h,ouiaSafe:u=!0}=e,x=(0,n.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let j=(0,d.S$)(c.displayName,h,u);return(0,l.jsx)("nav",Object.assign({},x,{"aria-label":o,className:(0,a.i)(s.Z.breadcrumb,r)},j,{children:(0,l.jsx)("ol",{className:s.Z.breadcrumbList,role:"list",children:t.Children.map(i,(e,i)=>(0,t.isValidElement)(e)?(0,t.cloneElement)(e,{showDivider:i>0}):e)})}))};c.displayName="Breadcrumb"},18091:function(e,i,r){r.d(i,{g:()=>d});var n=r(59390),l=r(24246),t=r(91985),s=r(90633),a=r(15508);let d=e=>{var{children:i=null,className:r="",to:d,isActive:c=!1,isDropdown:o=!1,showDivider:h,target:u,component:x="a",render:j}=e,m=(0,n.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let b=c?"page":void 0,v=(0,a.i)(s.Z.breadcrumbLink,c&&s.Z.modifiers.current);return(0,l.jsxs)("li",Object.assign({},m,{className:(0,a.i)(s.Z.breadcrumbItem,r),children:[h&&(0,l.jsx)("span",{className:s.Z.breadcrumbItemDivider,children:(0,l.jsx)(t.ZP,{})}),"button"===x&&(0,l.jsx)("button",{className:v,"aria-current":b,type:"button",children:i}),o&&(0,l.jsx)("span",{className:(0,a.i)(s.Z.breadcrumbDropdown),children:i}),j&&j({className:v,ariaCurrent:b}),d&&!j&&(0,l.jsx)(x,{href:d,target:u,className:v,"aria-current":b,children:i}),!d&&"button"!==x&&!o&&i]}))};d.displayName="BreadcrumbItem"},51527:function(e,i,r){r.d(i,{e:()=>a});var n=r(59390),l=r(24246),t=r(24416),s=r(15508);let a=e=>{var{children:i,className:r,component:a="div",isFilled:d=!0}=e,c=(0,n.__rest)(e,["children","className","component","isFilled"]);return(0,l.jsx)(a,Object.assign({className:(0,s.i)(t.Z.cardBody,!d&&t.Z.modifiers.noFill,r)},c,{children:i}))};a.displayName="CardBody"},87069:function(e,i,r){r.d(i,{l:()=>c});var n=r(59390),l=r(24246),t=r(27378),s=r(15508),a=r(24416),d=r(31757);let c=e=>{var{children:i,className:r,component:c="div"}=e,o=(0,n.__rest)(e,["children","className","component"]);let{cardId:h}=(0,t.useContext)(d.H),u=h?`${h}-title`:"";return(0,l.jsx)("div",{className:(0,s.i)(a.Z.cardTitle),children:(0,l.jsx)(c,Object.assign({className:(0,s.i)(a.Z.cardTitleText,r),id:u||void 0},o,{children:i}))})};c.displayName="CardTitle"},67761:function(e,i,r){r.d(i,{M:()=>a});var n=r(59390),l=r(24246),t=r(38436),s=r(15508);let a=e=>{var{children:i,className:r,icon:a}=e,d=(0,n.__rest)(e,["children","className","icon"]);return(0,l.jsxs)("dt",Object.assign({className:(0,s.i)(t.Z.descriptionListTerm,r)},d,{children:[a?(0,l.jsx)("span",{className:(0,s.i)(t.Z.descriptionListTermIcon),children:a}):null,(0,l.jsx)("span",{className:(0,s.i)(t.Z.descriptionListText),children:i})]}))};a.displayName="DescriptionListTerm"},26235:function(e,i,r){r.d(i,{ZP:()=>n});let n=(0,r(24329).I)({name:"PenIcon",height:512,width:512,svgPath:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z",yOffset:0,xOffset:0,svgClassName:void 0})},37818:function(e,i,r){r.d(i,{u:()=>a});var n=r(24246),l=r(8305),t=r(13754),s=r(39826);let a=e=>e.isFetching?e.isFetchingState||(0,n.jsx)(l.b,{children:(0,n.jsx)(t.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,n.jsx)(s.y,{}):e.children},3586:function(e,i,r){r.d(i,{j:()=>t});var n=r(24246),l=r(27378);let t=e=>{let{children:i}=e,[r,t]=l.useState(!1);return(0,n.jsx)(n.Fragment,{children:i(r,t)})}},24200:function(e,i,r){r.d(i,{G:()=>l});var n=r(24246);let l=e=>{let{vulnerability:i}=e;return(0,n.jsxs)("p",{children:[i.withdrawn&&(0,n.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},2588:function(e,i,r){r.r(i),r.d(i,{default:()=>eo});var n=r(24246),l=r(27378),t=r(65783),s=r(45043),a=r(97339),d=r(18091),c=r(11192),o=r(32591),h=r(34747),u=r(46770),x=r(68802),j=r(70400),m=r(78700),b=r(2075),v=r(27090),f=r(75165),y=r(24787);let p=(0,r(24329).I)({name:"DownloadIcon",height:512,width:512,svgPath:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",yOffset:0,xOffset:0,svgClassName:void 0});var g=r(9839),_=r(37818),N=r(73227),T=r(17598),w=r(65872),E=r(87727),B=r(3498),C=r(31757),F=r(87069),S=r(51527),Z=r(30329),I=r(50689),P=r(67761),D=r(81391),M=r(79551),K=r(32489),L=r(90519),O=r(26235),k=r(73827),q=r(63706),V=r(15167);let A=e=>{var i,r;let{advisory:t}=e,[s,a]=l.useState(!1),d=()=>{a(!1)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(E.r,{hasGutter:!0,children:[(0,n.jsx)(B.P,{md:4,children:(0,n.jsxs)(C.Z,{isFullHeight:!0,children:[(0,n.jsx)(F.l,{children:"Overview"}),(0,n.jsx)(S.e,{children:(0,n.jsxs)(Z.o,{children:[(0,n.jsxs)(I.g,{children:[(0,n.jsx)(P.M,{children:"Title"}),(0,n.jsx)(D.b,{children:t.title})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsx)(P.M,{children:"Type"}),(0,n.jsx)(D.b,{children:t.labels.type})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsx)(P.M,{children:"Size"}),(0,n.jsx)(D.b,{children:(0,w.Z)(t.size)})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsxs)(P.M,{children:["Labels ","",(0,n.jsx)(m.zx,{variant:m.Wu.link,size:"sm",icon:(0,n.jsx)(O.ZP,{}),iconPosition:"end",onClick:()=>a(!0),children:"Edit"})]}),(0,n.jsx)(D.b,{children:(0,n.jsx)(C.Z,{isCompact:!0,children:(0,n.jsx)(S.e,{children:t.labels&&(0,n.jsx)(k.C,{defaultIsOpen:!0,value:t.labels})})})})]})]})})]})}),(0,n.jsx)(B.P,{md:4,children:(0,n.jsxs)(C.Z,{isFullHeight:!0,children:[(0,n.jsx)(F.l,{children:"Publisher"}),(0,n.jsx)(S.e,{children:(0,n.jsxs)(Z.o,{children:[(0,n.jsxs)(I.g,{children:[(0,n.jsx)(P.M,{children:"Name"}),(0,n.jsx)(D.b,{children:null==(i=t.issuer)?void 0:i.name})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsx)(P.M,{children:"Contact details"}),(0,n.jsx)(D.b,{children:null==(r=t.issuer)?void 0:r.website})]})]})})]})}),(0,n.jsx)(B.P,{md:4,children:(0,n.jsxs)(C.Z,{isFullHeight:!0,children:[(0,n.jsx)(F.l,{children:"Tracking"}),(0,n.jsx)(S.e,{children:(0,n.jsxs)(Z.o,{children:[(0,n.jsxs)(I.g,{children:[(0,n.jsx)(P.M,{children:"ID"}),(0,n.jsx)(D.b,{children:t.identifier})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsx)(P.M,{children:"Initial release date"}),(0,n.jsx)(D.b,{children:(0,q.p6)(t.published)})]}),(0,n.jsxs)(I.g,{children:[(0,n.jsx)(P.M,{children:"Current release date"}),(0,n.jsx)(D.b,{children:(0,q.p6)(t.modified)})]})]})})]})})]}),(0,n.jsxs)(M.u,{isOpen:s,variant:"medium",title:"Edit labels",onClose:d,children:[(0,n.jsx)(K.x,{title:"Edit labels"}),(0,n.jsx)(L.f,{children:(0,n.jsx)(V.q,{advisory:t,onClose:d})})]})]})};var z=r(79192),G=r(53195),R=r(46403),H=r(70715),Y=r(40982),$=r(89226),W=r(4835),U=r(14350),J=r(11165),Q=r(89330),X=r(31423),ee=r(94154),ei=r(9905),er=r(7615),en=r(57524),el=r(3804),et=r(31336),es=r(3586),ea=r(24200),ed=r(49988);let ec=e=>{let{isFetching:i,fetchError:r,vulnerabilities:l}=e,s=(0,ed.sz)({tableName:"vulnerability-table",idProperty:"identifier",items:l,isLoading:i,columnNames:{identifier:"ID",title:"Title",discovery:"Discovery",release:"Release",score:"Score",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.identifier}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:a,numRenderedColumns:d,propHelpers:{toolbarProps:c,paginationToolbarItemProps:o,paginationProps:h,tableProps:u,getThProps:x,getTrProps:j,getTdProps:m},expansionDerivedState:{isCellExpanded:b}}=s;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(H.o,(0,G._)((0,z._)({},c),{"aria-label":"vulnerability toolbar",children:(0,n.jsx)(Y.c,{children:(0,n.jsx)($.E,(0,G._)((0,z._)({},o),{children:(0,n.jsx)(el.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:h})}))})})),(0,n.jsxs)(W.i,(0,G._)((0,z._)({},u),{"aria-label":"vulnerability table",children:[(0,n.jsx)(U.h,{children:(0,n.jsx)(J.Tr,{children:(0,n.jsxs)(et.qK,(0,G._)((0,z._)({},s),{children:[(0,n.jsx)(Q.Th,(0,z._)({},x({columnKey:"identifier"}))),(0,n.jsx)(Q.Th,(0,z._)({},x({columnKey:"title"}))),(0,n.jsx)(Q.Th,(0,z._)({},x({columnKey:"discovery"}))),(0,n.jsx)(Q.Th,(0,z._)({},x({columnKey:"release"}))),(0,n.jsx)(Q.Th,(0,z._)({},x({columnKey:"score"}))),(0,n.jsx)(Q.Th,(0,z._)({},x({columnKey:"cwe"})))]}))})}),(0,n.jsx)(et.hp,{isLoading:i,isError:!!r,isNoData:0===l.length,numRenderedColumns:d,children:null==a?void 0:a.map((e,i)=>{var r;return(0,n.jsx)(X.p,{isExpanded:b(e),children:(0,n.jsx)(J.Tr,(0,G._)((0,z._)({},j({item:e})),{children:(0,n.jsxs)(et.Cx,(0,G._)((0,z._)({},s),{item:e,rowIndex:i,children:[(0,n.jsx)(ee.Td,(0,G._)((0,z._)({width:15,modifier:"breakWord"},m({columnKey:"identifier"})),{children:(0,n.jsx)(t.rU,{to:(0,R.Gn)(g.nB.vulnerabilityDetails,{vulnerabilityId:e.identifier}),children:e.identifier})})),(0,n.jsx)(es.j,{children:(i,r)=>(0,n.jsx)(ee.Td,(0,G._)((0,z._)({width:40,modifier:"truncate",onFocus:()=>r(!0),onBlur:()=>r(!1),tabIndex:0},m({columnKey:"title"})),{children:(0,n.jsx)(ei.cE,{focused:i,wrapModifier:"truncate",children:(0,n.jsx)(ea.G,{vulnerability:e})})}))}),(0,n.jsx)(ee.Td,(0,G._)((0,z._)({width:15},m({columnKey:"discovery"})),{children:(0,q.p6)(e.discovered)})),(0,n.jsx)(ee.Td,(0,G._)((0,z._)({width:10,modifier:"truncate"},m({columnKey:"release"})),{children:(0,q.p6)(e.released)})),(0,n.jsx)(ee.Td,(0,G._)((0,z._)({width:10,modifier:"truncate"},m({columnKey:"score"})),{children:e.severity&&(0,n.jsx)(en.o,{value:(0,er.g)(e.severity),score:null!=(r=e.score)?r:null,showLabel:!0,showScore:!0})})),(0,n.jsx)(ee.Td,(0,G._)((0,z._)({width:10,modifier:"truncate"},m({columnKey:"cwe"})),{children:e.cwes.join(", ")}))]}))}))},e.identifier)})})]})),(0,n.jsx)(el.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:h})]})},eo=()=>{var e,i;let[r,w]=l.useState(0),E=l.createRef(),B=l.createRef(),C=(0,g.ZX)(g.Uo.ADVISORY_ID),{advisory:F,isFetching:S,fetchError:Z}=(0,T.gw)(C),{downloadAdvisory:I}=(0,N.i)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.NP,{type:"breadcrumb",children:(0,n.jsxs)(a.a,{children:[(0,n.jsx)(d.g,{children:(0,n.jsx)(t.rU,{to:g.nB.advisories,children:"Advisories"})}),(0,n.jsx)(d.g,{isActive:!0,children:"Advisory details"})]})}),(0,n.jsx)(s.NP,{children:(0,n.jsxs)(c.P,{children:[(0,n.jsx)(o.J,{isFilled:!0,children:(0,n.jsxs)(h.k,{children:[(0,n.jsx)(u.B,{spacer:{default:"spacerSm"},children:(0,n.jsxs)(x.V,{children:[(0,n.jsx)(x.V,{component:"h1",children:null!=(i=null!=(e=null==F?void 0:F.document_id)?e:C)?i:""}),(0,n.jsx)(x.V,{component:"p",children:"Advisory detail information"})]})}),(0,n.jsx)(u.B,{children:(null==F?void 0:F.labels.type)&&(0,n.jsx)(j._,{color:"blue",children:null==F?void 0:F.labels.type})})]})}),(0,n.jsx)(o.J,{children:!S&&(0,n.jsx)(m.zx,{variant:"secondary",icon:(0,n.jsx)(p,{}),onClick:()=>{C&&I(C,(null==F?void 0:F.identifier)?"".concat(null==F?void 0:F.identifier,".json"):"".concat(C,".json"))},children:"Download"})})]})}),(0,n.jsx)(s.NP,{children:(0,n.jsxs)(b.m,{mountOnEnter:!0,activeKey:r,onSelect:(e,i)=>{w(i)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,n.jsx)(v.O,{eventKey:0,title:(0,n.jsx)(f.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:E}),(0,n.jsx)(v.O,{eventKey:1,title:(0,n.jsx)(f.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:B})]})}),(0,n.jsxs)(s.NP,{children:[(0,n.jsx)(y.I,{eventKey:0,id:"refTabInfoSection",ref:E,"aria-label":"Information of the Advisory",children:(0,n.jsx)(_.u,{isFetching:S,fetchError:Z,children:F&&(0,n.jsx)(A,{advisory:F})})}),(0,n.jsx)(y.I,{eventKey:1,id:"refVulnerabilitiesSection",ref:B,"aria-label":"Vulnerabilities within the SBOM",hidden:!0,children:(0,n.jsx)(ec,{isFetching:S,fetchError:Z,vulnerabilities:(null==F?void 0:F.vulnerabilities)||[]})})]})]})}},15167:function(e,i,r){r.d(i,{q:()=>d});var n=r(24246),l=r(27378),t=r(24502),s=r(15726),a=r(17598);let d=e=>{let{advisory:i,onClose:r}=e,{pushNotification:d}=l.useContext(s.c),[c,o]=l.useState(""),[h,u]=l.useState(""),{labels:x}=(0,a.VY)(h);l.useEffect(()=>{let e=setTimeout(()=>{u(c)},400);return()=>clearTimeout(e)},[c]);let{mutate:j,isPending:m}=(0,a.sj)(()=>{d({title:"Labels updated for Advisory ".concat(i.document_id),variant:"success"}),r()},e=>{d({title:"Error while updating labels for Advisory ".concat(i.document_id),variant:"danger"})});return(0,n.jsx)(t.M,{title:"Labels of Advisory: ".concat(i.document_id),value:i.labels,isDisabled:m,onSave:e=>{j({id:i.uuid,labels:e})},onClose:r,onInputChange:o,options:x})}},17598:function(e,i,r){r.d(i,{N7:()=>v,VY:()=>b,gw:()=>f,sj:()=>p,tG:()=>y});var n=r(79192),l=r(53195),t=r(70186),s=r(1183),a=r(24038),d=r(68e3),c=r(75503),o=r(50576),h=r(40371),u=r(87017),x=r(49988),j=r(95169);let m="advisories",b=e=>{let{data:i,isLoading:r,error:n,refetch:l}=(0,s.a)({queryKey:[m,"labels",e],queryFn:()=>(0,h.sf)({client:o.L,query:{limit:10,filter_text:e}}),placeholderData:a.Wk});return{labels:(null==i?void 0:i.data)||[],isFetching:r,fetchError:n,refetch:l}},v=function(){var e,i,r;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,x.rm)(a),{q:j}=u,b=(0,t._)(u,["q"]),v=(0,x.Rb)(d),{data:f,isLoading:y,error:p,refetch:g}=(0,s.a)({queryKey:[m,a,v],queryFn:()=>(0,h.A1)({client:o.L,query:(0,l._)((0,n._)({},b),{q:[j,v].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==f||null==(e=f.data)?void 0:e.items)||[],total:null!=(r=null==f||null==(i=f.data)?void 0:i.total)?r:0,params:a},isFetching:y,fetchError:p||null,refetch:g}},f=e=>{let{data:i,isLoading:r,error:n}=(0,s.a)({queryKey:[m,e],queryFn:()=>(0,h.pB)({client:o.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==i?void 0:i.data,isFetching:r,fetchError:n}},y=()=>{let e=(0,d.NL)();return(0,j.V)({parallel:!0,uploadFn:(e,i)=>(0,u.Cu)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},p=(e,i)=>{let r=(0,d.NL)();return(0,c.D)({mutationFn:e=>(0,h.m5)({client:o.L,path:{id:e.id},body:e.labels}),onSuccess:async(i,n)=>{e(),await r.invalidateQueries({queryKey:[m]})},onError:i})}},65872:function(e,i,r){r.d(i,{Z:()=>d});let n=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],l=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],t=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],s=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],a=(e,i,r)=>{let n=e;return"string"==typeof i||Array.isArray(i)?n=e.toLocaleString(i,r):(!0===i||void 0!==r)&&(n=e.toLocaleString(void 0,r)),n};function d(e,i){let r;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let d=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?s:t:i.binary?l:n,c=i.space?" ":"";if(i.signed&&0===e)return` 0${c}${d[0]}`;let o=e<0,h=o?"-":i.signed?"+":"";if(o&&(e=-e),void 0!==i.minimumFractionDigits&&(r={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(r={maximumFractionDigits:i.maximumFractionDigits,...r}),e<1)return h+a(e,i.locale,r)+c+d[0];let u=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),d.length-1);return e/=(i.binary?1024:1e3)**u,r||(e=e.toPrecision(3)),h+a(Number(e),i.locale,r)+c+d[u]}}}]);