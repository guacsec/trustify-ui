"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["104"],{24296:function(e,i,n){n.d(i,{a:()=>d});var s=n(62540),r=n(59394),l=n(81595),t=n(40554);let d=e=>e.isFetching?e.isFetchingState||(0,s.jsx)(r.a,{children:(0,s.jsx)(l.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,s.jsx)(t.q,{}):e.children},20311:function(e,i,n){n.d(i,{R:()=>l});var s=n(62540),r=n(63696);let l=e=>{let{children:i}=e,[n,l]=r.useState(!1);return(0,s.jsx)(s.Fragment,{children:i(n,l)})}},64377:function(e,i,n){n.d(i,{j:()=>r});var s=n(62540);let r=e=>{let{vulnerability:i}=e;return(0,s.jsxs)("p",{children:[i.withdrawn&&(0,s.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},49325:function(e,i,n){n.d(i,{tc:()=>d});var s=n(32909),r=n(42642),l=n(31550),t=n(73470);let d=e=>{let i=(e=>{var i;let{persistTo:n="state",persistenceKeyPrefix:r}=e,d=null!=(i=e.defaultActiveTab)?i:{tabKey:e.tabKeys[0]},[a,c]=(0,l.u)((0,s._)({isEnabled:!0,defaultValue:d,persistenceKeyPrefix:r},"urlParams"===n?{persistTo:n,keys:["activeTab"],serialize:e=>({activeTab:(null==e?void 0:e.tabKey)||null}),deserialize:e=>e.activeTab?{tabKey:e.activeTab}:null}:"localStorage"===n||"sessionStorage"===n?{persistTo:n,key:"tab"}:(0,t.xG)(n)?{persistTo:"provider",serialize:n.write,deserialize:()=>n.read()}:{persistTo:"state"}));return{activeTab:a,setActiveTab:c}})(e),n=(e=>{let{tabState:i}=e;return{isTabActive:e=>{var n;return e===(null==(n=i.activeTab)?void 0:n.tabKey)},setActiveTab:e=>{i.setActiveTab({tabKey:e})}}})({tabState:i});return(0,r._)((0,s._)({},e),{state:i,derivedState:n,propHelpers:{getTabsProps:()=>{var e;return{activeKey:null==(e=i.activeTab)?void 0:e.tabKey,onSelect:(e,i)=>{n.setActiveTab(i)}}},getTabProps:e=>({eventKey:e,tabContentId:"".concat(e,"-tab-section")}),getTabContentProps:e=>({id:"".concat(e,"-tab-section"),eventKey:e,hidden:!n.isTabActive(e)})}})}},11179:function(e,i,n){n.r(i),n.d(i,{default:()=>em});var s=n(32909),r=n(42642),l=n(62540),t=n(63696),d=n(74343),a=n(68430),c=n(98261),o=n(75530),h=n(54518),u=n(48281),x=n(28338),j=n(70045),v=n(42957),b=n(69548),f=n(90717),m=n(96526),p=n(52993),y=n(84818),_=n(7261),T=n(40989),g=n(60423),C=n(40111),w=n(93472),E=n(24773),K=n(98259),A=n(67458),S=n(89705),P=n(24296),k=n(4392),F=n(99528),I=n(49325),W=n(99134),D=n(51380),Z=n(76072),X=n(97299),B=n(17327),J=n(64361),L=n(71603),O=n(1020),R=n(24974),N=n(21639),V=n(3939),z=n(38927),q=n(80057),H=n(13021),U=n(10410),Y=n(12852),G=n(23909),M=n(40665);let Q=e=>{var i,n;let{advisory:s}=e,[r,d]=t.useState(!1),a=()=>{d(!1)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(Z.x,{hasGutter:!0,children:[(0,l.jsx)(X.E,{md:4,children:(0,l.jsxs)(B.Z,{isFullHeight:!0,children:[(0,l.jsx)(J.Z,{children:"Overview"}),(0,l.jsx)(L.b,{children:(0,l.jsxs)(O.B,{children:[(0,l.jsxs)(R.W,{children:[(0,l.jsx)(N.X,{children:"Title"}),(0,l.jsx)(V.d,{children:s.title})]}),(0,l.jsxs)(R.W,{children:[(0,l.jsx)(N.X,{children:"Type"}),(0,l.jsx)(V.d,{children:s.labels.type})]}),(0,l.jsxs)(R.W,{children:[(0,l.jsx)(N.X,{children:"Size"}),(0,l.jsx)(V.d,{children:(0,D.A)(s.size)})]}),(0,l.jsxs)(R.W,{children:[(0,l.jsxs)(N.X,{children:["Labels ","",(0,l.jsx)(E.$n,{variant:E.Ak.link,size:"sm",icon:(0,l.jsx)(U.Ay,{}),iconPosition:"end",onClick:()=>d(!0),children:"Edit"})]}),(0,l.jsx)(V.d,{children:(0,l.jsx)(B.Z,{isCompact:!0,children:(0,l.jsx)(L.b,{children:s.labels&&(0,l.jsx)(Y.g,{defaultIsOpen:!0,value:s.labels})})})})]})]})})]})}),(0,l.jsx)(X.E,{md:4,children:(0,l.jsxs)(B.Z,{isFullHeight:!0,children:[(0,l.jsx)(J.Z,{children:"Publisher"}),(0,l.jsx)(L.b,{children:(0,l.jsxs)(O.B,{children:[(0,l.jsxs)(R.W,{children:[(0,l.jsx)(N.X,{children:"Name"}),(0,l.jsx)(V.d,{children:null==(i=s.issuer)?void 0:i.name})]}),(0,l.jsxs)(R.W,{children:[(0,l.jsx)(N.X,{children:"Contact details"}),(0,l.jsx)(V.d,{children:null==(n=s.issuer)?void 0:n.website})]})]})})]})}),(0,l.jsx)(X.E,{md:4,children:(0,l.jsxs)(B.Z,{isFullHeight:!0,children:[(0,l.jsx)(J.Z,{children:"Tracking"}),(0,l.jsx)(L.b,{children:(0,l.jsxs)(O.B,{children:[(0,l.jsxs)(R.W,{children:[(0,l.jsx)(N.X,{children:"ID"}),(0,l.jsx)(V.d,{children:s.identifier})]}),(0,l.jsxs)(R.W,{children:[(0,l.jsx)(N.X,{children:"Initial release date"}),(0,l.jsx)(V.d,{children:(0,G.Yq)(s.published)})]}),(0,l.jsxs)(R.W,{children:[(0,l.jsx)(N.X,{children:"Current release date"}),(0,l.jsx)(V.d,{children:(0,G.Yq)(s.modified)})]})]})})]})})]}),(0,l.jsxs)(z.a,{isOpen:r,variant:"medium",title:"Edit labels",onClose:a,children:[(0,l.jsx)(q.r,{title:"Edit labels"}),(0,l.jsx)(H.c,{children:(0,l.jsx)(M.t,{advisory:s,onClose:a})})]})]})};var $=n(61360),ee=n(35048),ei=n(32490),en=n(26917),es=n(16646),er=n(21758),el=n(40384),et=n(28516),ed=n(78517),ea=n(59771),ec=n(27875),eo=n(45969),eh=n(93826),eu=n(30448),ex=n(20311),ej=n(64377),ev=n(73470);let eb=e=>{let{isFetching:i,fetchError:n,vulnerabilities:t}=e,a=(0,ev.vY)({tableName:"vulnerability-table",idProperty:"identifier",items:t,isLoading:i,columnNames:{identifier:"ID",title:"Title",discovery:"Discovery",release:"Release",score:"Score",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.identifier}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:c,numRenderedColumns:o,propHelpers:{toolbarProps:h,paginationToolbarItemProps:u,paginationProps:x,tableProps:j,getThProps:v,getTrProps:b,getTdProps:f},expansionDerivedState:{isCellExpanded:m}}=a;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)($.M,(0,r._)((0,s._)({},h),{"aria-label":"vulnerability toolbar",children:(0,l.jsx)(ee.P,{children:(0,l.jsx)(ei.T,(0,r._)((0,s._)({},u),{children:(0,l.jsx)(eh.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:x})}))})})),(0,l.jsxs)(en.X,(0,r._)((0,s._)({},j),{"aria-label":"vulnerability table",children:[(0,l.jsx)(es.d,{children:(0,l.jsx)(er.Tr,{children:(0,l.jsxs)(eu.Ze,(0,r._)((0,s._)({},a),{children:[(0,l.jsx)(el.Th,(0,s._)({},v({columnKey:"identifier"}))),(0,l.jsx)(el.Th,(0,s._)({},v({columnKey:"title"}))),(0,l.jsx)(el.Th,(0,s._)({},v({columnKey:"discovery"}))),(0,l.jsx)(el.Th,(0,s._)({},v({columnKey:"release"}))),(0,l.jsx)(el.Th,(0,s._)({},v({columnKey:"score"}))),(0,l.jsx)(el.Th,(0,s._)({},v({columnKey:"cwe"})))]}))})}),(0,l.jsx)(eu.nJ,{isLoading:i,isError:!!n,isNoData:0===t.length,numRenderedColumns:o,children:null==c?void 0:c.map((e,i)=>{var n;return(0,l.jsx)(et.N,{isExpanded:m(e),children:(0,l.jsx)(er.Tr,(0,r._)((0,s._)({},b({item:e})),{children:(0,l.jsxs)(eu.Oi,(0,r._)((0,s._)({},a),{item:e,rowIndex:i,children:[(0,l.jsx)(ed.Td,(0,r._)((0,s._)({width:15,modifier:"breakWord"},f({columnKey:"identifier"})),{children:(0,l.jsx)(d.N_,{to:(0,d.tW)(A.Jh.vulnerabilityDetails,{vulnerabilityId:e.identifier}),children:e.identifier})})),(0,l.jsx)(ex.R,{children:(i,n)=>(0,l.jsx)(ed.Td,(0,r._)((0,s._)({width:40,modifier:"truncate",onFocus:()=>n(!0),onBlur:()=>n(!1),tabIndex:0},f({columnKey:"title"})),{children:(0,l.jsx)(ea.mA,{focused:i,wrapModifier:"truncate",children:(0,l.jsx)(ej.j,{vulnerability:e})})}))}),(0,l.jsx)(ed.Td,(0,r._)((0,s._)({width:15},f({columnKey:"discovery"})),{children:(0,G.Yq)(e.discovered)})),(0,l.jsx)(ed.Td,(0,r._)((0,s._)({width:10,modifier:"truncate"},f({columnKey:"release"})),{children:(0,G.Yq)(e.released)})),(0,l.jsx)(ed.Td,(0,r._)((0,s._)({width:10,modifier:"truncate"},f({columnKey:"score"})),{children:e.severity&&(0,l.jsx)(eo.h,{value:(0,ec.U)(e.severity),score:null!=(n=e.score)?n:null,showLabel:!0,showScore:!0})})),(0,l.jsx)(ed.Td,(0,r._)((0,s._)({width:10,modifier:"truncate"},f({columnKey:"cwe"})),{children:e.cwes.join(", ")}))]}))}))},e.identifier)})})]})),(0,l.jsx)(eh.n,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:x})]})};var ef=n(52673);let em=()=>{var e,i;let n=(0,d.Zp)(),{pushNotification:D}=t.useContext(k.K),Z=(0,A.Lu)("advisoryId"),{advisory:X,isFetching:B,fetchError:J}=(0,W.vy)(Z),[L,O]=t.useState(!1),R=()=>{O(!L)},{downloadAdvisory:N}=(0,F.m)(),[V,z]=t.useState(!1),{mutate:q,isPending:H}=(0,W.ni)(e=>{z(!1),D({title:(0,K.PN)(e),variant:"success"}),n("/advisories")},e=>{D({title:(0,K.EU)(e),variant:"danger"})}),{propHelpers:{getTabsProps:U,getTabProps:Y,getTabContentProps:G}}=(0,I.tc)({persistenceKeyPrefix:"ad",persistTo:"urlParams",tabKeys:["info","vulnerabilities"]}),M=t.createRef(),$=t.createRef();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ef.T,{title:null==X?void 0:X.document_id}),(0,l.jsx)(a.d8,{type:"breadcrumb",children:(0,l.jsxs)(c.Q,{children:[(0,l.jsx)(o.J,{children:(0,l.jsx)(d.N_,{to:A.Jh.advisories,children:"Advisories"})}),(0,l.jsx)(o.J,{isActive:!0,children:"Advisory details"})]})}),(0,l.jsx)(a.d8,{children:(0,l.jsxs)(h.B,{children:[(0,l.jsx)(u.o,{isFilled:!0,children:(0,l.jsxs)(x.s,{children:[(0,l.jsx)(j.Z,{spacer:{default:"spacerSm"},children:(0,l.jsxs)(v.U,{children:[(0,l.jsx)(v.U,{component:"h1",children:null!=(i=null!=(e=null==X?void 0:X.document_id)?e:Z)?i:""}),(0,l.jsx)(v.U,{component:"p",children:"Advisory detail information"})]})}),(0,l.jsx)(j.Z,{children:(null==X?void 0:X.labels.type)&&(0,l.jsx)(b.J,{color:"blue",children:null==X?void 0:X.labels.type})})]})}),(0,l.jsx)(u.o,{children:X&&(0,l.jsx)(f.m,{isOpen:L,onSelect:()=>O(!1),onOpenChange:e=>O(e),popperProps:{position:"right"},toggle:e=>(0,l.jsx)(m.S3,{ref:e,onClick:R,isExpanded:L,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,l.jsxs)(p.Q,{children:[(0,l.jsx)(y.t,{onClick:()=>{Z&&N(Z,(null==X?void 0:X.identifier)?"".concat(null==X?void 0:X.identifier,".json"):"".concat(Z,".json"))},children:"Download Advisory"},"advisory"),(0,l.jsx)(_.c,{component:"li"},"separator"),(0,l.jsx)(y.t,{onClick:()=>z(!0),children:"Delete"},"delete")]})})})]})}),(0,l.jsx)(a.d8,{children:(0,l.jsxs)(T.t,(0,r._)((0,s._)({mountOnEnter:!0},U()),{"aria-label":"Tabs that contain the Advisory information",role:"region",children:[(0,l.jsx)(g.o,(0,r._)((0,s._)({},Y("info")),{title:(0,l.jsx)(C.V,{children:"Info"}),tabContentRef:M})),(0,l.jsx)(g.o,(0,r._)((0,s._)({},Y("vulnerabilities")),{title:(0,l.jsx)(C.V,{children:"Vulnerabilities"}),tabContentRef:$}))]}))}),(0,l.jsxs)(a.d8,{children:[(0,l.jsx)(w.J,(0,r._)((0,s._)({},G("info")),{ref:M,"aria-label":"Information of the Advisory",children:(0,l.jsx)(P.a,{isFetching:B,fetchError:J,children:X&&(0,l.jsx)(Q,{advisory:X})})})),(0,l.jsx)(w.J,(0,r._)((0,s._)({},G("vulnerabilities")),{ref:$,"aria-label":"Vulnerabilities within the Advisory",children:(0,l.jsx)(eb,{isFetching:B,fetchError:J,vulnerabilities:(null==X?void 0:X.vulnerabilities)||[]})}))]}),(0,l.jsx)(S.T,(0,r._)((0,s._)({},(0,K.p6)(X)),{inProgress:H,titleIconVariant:"warning",isOpen:V,confirmBtnVariant:E.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>z(!1),onClose:()=>z(!1),onConfirm:()=>{X&&q(X.uuid)}}))]})}},40665:function(e,i,n){n.d(i,{t:()=>a});var s=n(62540),r=n(63696),l=n(91242),t=n(4392),d=n(99134);let a=e=>{let{advisory:i,onClose:n}=e,{pushNotification:a}=r.useContext(t.K),[c,o]=r.useState(""),[h,u]=r.useState(""),{labels:x}=(0,d.eq)(h);r.useEffect(()=>{let e=setTimeout(()=>{u(c)},400);return()=>clearTimeout(e)},[c]);let{mutate:j,isPending:v}=(0,d.uJ)(()=>{a({title:"Labels updated for Advisory ".concat(i.document_id),variant:"success"}),n()},e=>{a({title:"Error while updating labels for Advisory ".concat(i.document_id),variant:"danger"})});return(0,s.jsx)(l.e,{title:"Labels of Advisory: ".concat(i.document_id),value:i.labels,isDisabled:v,onSave:e=>{j({id:i.uuid,labels:e})},onClose:n,onInputChange:o,options:x})}}}]);