"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["12"],{71284:function(e,t,r){r.d(t,{Cb:()=>f,Kb:()=>m,Sx:()=>y,hs:()=>S,m4:()=>p,pJ:()=>j,xh:()=>k});var n=r(88741),i=r(99111),a=r(22134),l=r(57822),s=r(32635),c=r(1734),o=r(84249),d=r(95283),u=r(52040),h=r(44240),x=r(43967),v=r(36808);let m={unknown:{name:"Unknown",color:o.o,progressProps:{variant:void 0},icon:n.ZP},none:{name:"None",color:d.q,progressProps:{variant:void 0},icon:i.VQ},low:{name:"Low",color:u.b,progressProps:{variant:void 0},icon:a.g8},medium:{name:"Medium",color:h.B,progressProps:{variant:"warning"},icon:l.Yc},high:{name:"High",color:x.e,progressProps:{variant:"danger"},icon:s.Fc},critical:{name:"Critical",color:v.d,progressProps:{variant:"danger"},icon:c.id}},j={fixed:{name:"Fixed",color:"blue"},not_affected:{name:"Not affected",color:"green"},known_not_affected:{name:"Known not affected",color:"green"},under_investigation:{name:"Under investigation",color:"yellow"},affected:{name:"Affected",color:"red"}},g=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function y(e){return(t,r)=>g(e(t))-g(e(r))}let p=e=>{let{key:t,value:r}=e;return"".concat(r?"".concat(t,"=").concat(r):"".concat(t))},f=e=>{let[t,r]=e.split("=");return{key:t,value:null!=r?r:""}},b=e=>{if(!e)return 0;switch(e){case"3.1":return 1;case"3.0":return 2;case"4.0":return 3;case"2.0":return 4;default:return 0}};function S(e){return(t,r)=>b(e(t))-b(e(r))}let k=e=>0===e.length?null:[...e].sort(S(e=>e.type))[0]},27875:function(e,t,r){r.d(t,{U:()=>n});let n=e=>null!=e?e:"unknown"},52673:function(e,t,r){r.d(t,{T:()=>a});var n=r(62540),i=r(71873);let a=e=>{let{title:t}=e,r=(0,i.A)().application.title,a=t?"".concat(t," | ").concat(r):r;return(0,n.jsx)("title",{children:a})}},24296:function(e,t,r){r.d(t,{a:()=>s});var n=r(62540),i=r(59394),a=r(81595),l=r(40554);let s=e=>e.isFetching?e.isFetchingState||(0,n.jsx)(i.a,{children:(0,n.jsx)(a.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,n.jsx)(l.q,{}):e.children},65346:function(e,t,r){r.d(t,{Y:()=>s});var n=r(62540),i=r(63696),a=r(88057),l=r(71284);let s=e=>{let{vulnerabilitiesSummary:t}=e,r=i.useMemo(()=>Object.keys(t.severities).map(e=>{let r=t.severities[e],n=l.Kb[e];return{severity:e,count:r,label:n.name,color:n.color.var}}).sort((0,l.Sx)(e=>e.severity)).reverse(),[t]);return(0,n.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,n.jsx)(a.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:"".concat(t.total),subTitle:"Total vulnerabilities",width:350,legendData:r.map(e=>{let{label:t,count:r}=e;return{name:"".concat(t,": ").concat(r)}}),data:r.map(e=>{let{label:t,count:r}=e;return{x:t,y:r}}),labels:e=>{let{datum:t}=e;return"".concat(t.x,": ").concat(t.y)},colorScale:r.map(e=>{let{color:t}=e;return t})})})}},40554:function(e,t,r){r.d(t,{q:()=>s});var n=r(62540),i=r(48655),a=r(92411),l=r(60087);let s=()=>(0,n.jsx)(i.pp,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:l.Ay,variant:i.s$.sm,children:(0,n.jsx)(a.h,{children:"There was an error retrieving data. Check your connection and try again."})})},3652:function(e,t,r){r.d(t,{RQ:()=>d,UI:()=>h,nm:()=>x});var n=r(32909),i=r(42642),a=r(63696),l=r(27875),s=r(30111);let c=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,o={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},d={vulnerabilityStatus:{affected:(0,n._)({},o),fixed:(0,n._)({},o),not_affected:(0,n._)({},o),known_not_affected:(0,n._)({},o),under_investigation:(0,n._)({},o)}},u=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let r,a=e.find(e=>c(e,t));if(a){let l=e.filter(e=>!c(e,a)),s=a.vulnerability.average_score>t.vulnerability.average_score?a:t;r=[...l,(0,i._)((0,n._)({},s),{relatedPackages:[...a.relatedPackages,{advisory:t.advisory,packages:t.packages}]})]}else{let n={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};r=[...e.slice(),n]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,a=(0,l.U)(t.vulnerability.average_severity),s=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:(0,i._)((0,n._)({},e.vulnerabilityStatus),{[r]:{total:s.total+1,severities:(0,i._)((0,n._)({},s.severities),{[a]:s.severities[a]+1})}})})},(0,n._)({},d));return{vulnerabilities:t,summary:r}},h=e=>{let{advisories:t,isFetching:r,fetchError:n}=(0,s.DH)(e);return{data:a.useMemo(()=>u(t||[]),[t]),isFetching:r,fetchError:n}},x=e=>{let{advisories:t,isFetching:r,fetchError:n}=(0,s.zY)(e);return{data:a.useMemo(()=>(null!=t?t:[]).map(e=>u(e||[])),[t]),isFetching:r,fetchError:n}}},44503:function(e,t,r){r.r(t),r.d(t,{default:()=>ev});var n=r(62540),i=r(68430),a=r(38914),l=r(57901),s=r(74343),c=r(57887),o=r(95409),d=r(5088),u=r(35204),h=r(79266),x=r(61316),v=r(40135),m=r(41890),j=r(17327),g=r(64361),y=r(71603),p=r(76072),f=r(97299),b=r(42957),S=r(48655),k=r(92411),w=r(1020),_=r(24974),E=r(21639),B=r(3939),F=r(71284),O=r(24296),C=r(3652),P=r(99134),M=r(30111),T=r(67458),I=r(23909);let A=[{severity:"critical"},{severity:"high"},{severity:"medium"},{severity:"low"},{severity:"none"},{severity:"unknown"}],N=()=>{var e,t,r,i,N,W;let D=(0,s.Zp)(),{result:{data:L,total:K},isFetching:U,fetchError:V}=(0,M.i$)(void 0,{page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),{data:Y,isFetching:Z,fetchError:q}=(0,C.nm)(L.map(e=>e.id)),G=Y.map(e=>e.summary.vulnerabilityStatus.affected.total).every(e=>0===e),H=(e,t)=>"".concat(" ".repeat(t+1)).concat(e.name),{result:{data:$,total:J},isFetching:Q,fetchError:R}=(0,P.VH)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}});return(0,n.jsxs)(j.Z,{children:[(0,n.jsx)(g.Z,{children:"Dashboard"}),(0,n.jsx)(y.b,{children:(0,n.jsxs)(p.x,{children:[(0,n.jsx)(f.E,{md:6,children:(0,n.jsx)(O.a,{isFetching:U||Z,fetchError:V||q.find(e=>!!e),children:(0,n.jsxs)(a.B,{hasGutter:!0,children:[(0,n.jsx)(l.a,{children:(0,n.jsx)(b.U,{children:"Below is a summary of Vulnerability status for the last 10 ingested SBOMs. To view the details, click on an SBOM name. You can also select up to 4 SBOMs to watch."})}),(0,n.jsx)(l.a,{children:L.length>0?(0,n.jsx)("div",{style:{height:320},children:(0,n.jsxs)(c.t,{ariaDesc:"SBOM summary status",domainPadding:{x:[30,25]},legendData:A.map(e=>({name:F.Kb[e.severity].name})),legendPosition:"bottom-left",height:375,name:"sbom-summary-status",padding:{bottom:75,left:330,right:50,top:50},themeColor:o.L.multiOrdered,width:700,legendComponent:(0,n.jsx)(d._,{y:10,x:200,colorScale:A.map(e=>F.Kb[e.severity].color.var)}),children:[(0,n.jsx)(u.c,{label:"Products",axisLabelComponent:(0,n.jsx)(h.j,{dx:0,x:15,y:140}),tickLabelComponent:(0,n.jsx)(h.j,{className:"pf-v6-c-button pf-m-link pf-m-inline",style:[{fill:"#0066cc"}],events:{onClick:e=>{let t=e.target.innerHTML,r=L.find((e,r)=>H(e,r)===t);r&&D((0,s.tW)(T.Jh.sbomDetails,{sbomId:r.id}))}}})}),(0,n.jsx)(u.c,{dependentAxis:!0,showGrid:!0,tickValues:G?[1,2,3,4,5,6,7,8,9,10]:void 0,label:"Vulnerabilities by Severity",fixLabelOverlap:!0}),(0,n.jsx)(x.R,{horizontal:!0,colorScale:A.map(e=>F.Kb[e.severity].color.var),children:A.map(e=>{let t=F.Kb[e.severity];return(0,n.jsx)(v._,{labelComponent:(0,n.jsx)(m.I,{constrainToVisibleArea:!0}),data:Y.map((r,n)=>{let{summary:{vulnerabilityStatus:{affected:i}}}=r,a=L[n],l=e.severity,s=i.severities[l];return{x:H(a,n),y:s,label:"".concat(t.name,": ").concat(s)}})},e.severity)})})]})}):(0,n.jsx)(S.pp,{headingLevel:"h4",titleText:"There is nothing here yet",variant:S.s$.xs,children:(0,n.jsx)(k.h,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to see your overview."})})})]})})}),(0,n.jsx)(f.E,{md:6,children:(0,n.jsx)(O.a,{isFetching:Q||U,fetchError:R||V,children:(0,n.jsxs)(p.x,{hasGutter:!0,children:[(0,n.jsx)(f.E,{md:6,children:(0,n.jsx)(w.B,{children:(0,n.jsxs)(_.W,{children:[(0,n.jsx)(E.X,{children:"Last SBOM ingested"}),(0,n.jsx)(B.d,{children:(0,n.jsxs)(a.B,{children:[(0,n.jsx)(l.a,{children:(0,I.r6)(null==L||null==(e=L[0])?void 0:e.ingested)}),(0,n.jsx)(l.a,{children:(null==L?void 0:L[0])&&(0,n.jsx)(s.N_,{to:(0,s.tW)(T.Jh.sbomDetails,{sbomId:null==L||null==(t=L[0])?void 0:t.id}),children:null==L||null==(r=L[0])?void 0:r.name})})]})})]})})}),(0,n.jsx)(f.E,{md:6,children:(0,n.jsx)(w.B,{children:(0,n.jsxs)(_.W,{children:[(0,n.jsx)(E.X,{children:"Total SBOMs"}),(0,n.jsx)(B.d,{children:K})]})})}),(0,n.jsx)(f.E,{md:6,children:(0,n.jsx)(w.B,{children:(0,n.jsxs)(_.W,{children:[(0,n.jsx)(E.X,{children:"Last Advisory ingested"}),(0,n.jsx)(B.d,{children:(0,n.jsxs)(a.B,{children:[(0,n.jsx)(l.a,{children:(0,I.r6)(null==$||null==(i=$[0])?void 0:i.ingested)}),(0,n.jsx)(l.a,{children:(null==$?void 0:$[0])&&(0,n.jsx)(s.N_,{to:(0,s.tW)(T.Jh.advisoryDetails,{advisoryId:null==$||null==(N=$[0])?void 0:N.uuid}),children:null==$||null==(W=$[0])?void 0:W.document_id})})]})})]})})}),(0,n.jsx)(f.E,{md:6,children:(0,n.jsx)(w.B,{children:(0,n.jsxs)(_.W,{children:[(0,n.jsx)(E.X,{children:"Total Advisories"}),(0,n.jsx)(B.d,{children:J})]})})})]})})})]})})]})};var W=r(63696),D=r(59394),L=r(81595),K=r(32909),U=r(42642),V=r(4392),Y=r(77184),Z=r(62603),q=r(90130),G=r(96002),H=r(86141);let $="watched-sboms",J="dashboard",Q=W.createContext({}),R=e=>{var t,r;let i,{children:a}=e,{pushNotification:l}=W.useContext(V.K),[s,c]=W.useState(new Set),{sboms:o,isFetching:d,fetchError:u}=(()=>{let{data:e,isLoading:t,error:r}=(0,Y.I)({queryKey:[J,$],queryFn:async()=>{try{return(await (0,H.oE)({client:G.S,path:{key:$}})).data}catch(e){if(404===e.status)return{sbom1Id:null,sbom2Id:null,sbom3Id:null,sbom4Id:null}}}});return{sboms:e,isFetching:t,fetchError:r}})(),{mutate:h}=(t=()=>{},r=e=>{l({title:"Error while updating the user preferences",variant:"danger"})},i=(0,Z.jE)(),(0,q.n)({mutationFn:e=>(0,H.A2)({client:G.S,path:{key:$},body:e}),onSuccess:async(e,r)=>{t(),await i.invalidateQueries({queryKey:[J,$]})},onError:r})),x=W.useCallback((e,t)=>{c(t=>{let r=new Set(t);return r.add(e),r}),h((0,U._)((0,K._)({},o),{[e]:t}),{onSettled:()=>{c(t=>{let r=new Set(t);return r.delete(e),r})}})},[o,h]);return(0,n.jsx)(Q.Provider,{value:{sboms:o,isFetching:d,fetchError:u,patch:x,mutatingKeys:s},children:a})};var X=r(63392),z=r(22431),ee=r(96526),et=r(81643),er=r(95354),en=r(35743),ei=r(24773),ea=r(93831),el=r(77570),es=r(53025),ec=r(26997),eo=r(65346);let ed=e=>{let{sbomId:t}=e,{data:r,isFetching:i,fetchError:a}=(0,C.UI)(t);return(0,n.jsx)(O.a,{isFetching:i,fetchError:a,children:(0,n.jsx)(eo.Y,{vulnerabilitiesSummary:r.summary.vulnerabilityStatus.affected})})},eu=e=>{let{fieldName:t,sbomId:r}=e,{patch:i,mutatingKeys:c}=W.useContext(Q),o=W.useRef(null),[d,u]=W.useState(""),[h,x]=W.useState("");W.useEffect(()=>{let e=setTimeout(()=>{x(d)},500);return()=>clearTimeout(e)},[d]);let[v,m]=W.useState(!1),{sbom:p,isFetching:f,fetchError:b}=(0,M.rj)(null!=r?r:void 0,void 0,1),w=W.useMemo(()=>{var e;return(null==b||null==(e=b.response)?void 0:e.status)===404},[b]),_=c.has(t);W.useEffect(()=>{w&&i(t,null)},[t,w,i]);let{result:{data:E}}=(0,M.i$)(void 0,{filters:[{field:"",operator:"~",value:h}],page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),B=()=>{m(!1)},F=()=>{m(!v)},C=()=>{v?d||B():m(!0)},P=(e,t)=>{u(t)},I=()=>{var e;u(""),null==o||null==(e=o.current)||e.focus()};return(0,n.jsxs)(j.Z,{isFullHeight:!0,children:[(0,n.jsxs)(O.a,{isFetching:f||w||_,fetchError:b,children:[p&&(0,n.jsx)(g.Z,{className:ec.A.textBreakWord,children:null==p?void 0:p.name}),(0,n.jsx)(y.b,{children:r?(0,n.jsxs)(a.B,{children:[(0,n.jsx)(l.a,{isFilled:!0,children:(0,n.jsx)(ed,{sbomId:r})}),(0,n.jsx)(l.a,{children:(0,n.jsx)(s.N_,{to:(0,s.tW)(T.Jh.sbomDetails,{sbomId:r}),children:"View Details"})})]}):(0,n.jsx)(S.pp,{headingLevel:"h4",titleText:"There is nothing here yet",variant:S.s$.xs,children:(0,n.jsx)(k.h,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to change the SBOMs you would like to track."})})})]}),(0,n.jsx)(X.w,{children:(0,n.jsx)(z.l,{shouldFocusFirstItemOnOpen:!1,isOpen:v,onSelect:(e,r)=>{r&&i(t,r),B()},onOpenChange:e=>{e||B()},toggle:e=>(0,n.jsx)(ee.S3,{ref:e,variant:"typeahead",onClick:F,isExpanded:v,isFullWidth:!0,children:(0,n.jsxs)(et.f,{isPlain:!0,children:[(0,n.jsx)(er.Q,{autoComplete:"off",value:d,onClick:C,onChange:P,innerRef:o,isExpanded:v,placeholder:"Select a new SBOM to watch"}),(0,n.jsx)(en.N,(0,U._)((0,K._)({},d?{}:{style:{display:"none"}}),{children:(0,n.jsx)(ei.$n,{icon:(0,n.jsx)(es.Ay,{"aria-hidden":!0}),variant:"plain",onClick:I,"aria-label":"Clear input value"})}))]})}),children:(0,n.jsx)(ea.B,{children:E.map(e=>(0,n.jsx)(el.O,{value:e.id,children:e.name},e.id))})})})]})},eh=()=>{let{sboms:e,isFetching:t,fetchError:r}=W.useContext(Q);return(0,n.jsx)(O.a,{isFetching:t,fetchError:r,isFetchingState:(0,n.jsx)(p.x,{hasGutter:!0,children:Array.from([,,,,].keys()).map(e=>(0,n.jsx)(f.E,{md:3,children:(0,n.jsx)(j.Z,{children:(0,n.jsx)(y.b,{children:(0,n.jsx)(D.a,{children:(0,n.jsx)(L.y,{})})})})},e))}),children:(0,n.jsx)(p.x,{hasGutter:!0,children:e&&Object.entries(e).map(e=>{let[t,r]=e;return(0,n.jsx)(f.E,{md:3,children:(0,n.jsx)(eu,{fieldName:t,sbomId:r})},"".concat(t,":").concat(r))})})})};var ex=r(52673);let ev=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ex.T,{title:"Dashboard"}),(0,n.jsx)(i.d8,{hasBodyWrapper:!1,children:(0,n.jsxs)(a.B,{hasGutter:!0,children:[(0,n.jsx)(l.a,{children:(0,n.jsx)(N,{})}),(0,n.jsx)(l.a,{children:(0,n.jsx)(R,{children:(0,n.jsx)(eh,{})})})]})})]})}}]);