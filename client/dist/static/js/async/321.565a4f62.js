"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["321"],{97339:function(e,i,t){t.d(i,{a:()=>c});var r=t(59390),s=t(24246),l=t(27378),n=t(90633),a=t(15508),d=t(53315);let c=e=>{var{children:i=null,className:t="","aria-label":u="Breadcrumb",ouiaId:o,ouiaSafe:h=!0}=e,m=(0,r.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let x=(0,d.S$)(c.displayName,o,h);return(0,s.jsx)("nav",Object.assign({},m,{"aria-label":u,className:(0,a.i)(n.Z.breadcrumb,t)},x,{children:(0,s.jsx)("ol",{className:n.Z.breadcrumbList,role:"list",children:l.Children.map(i,(e,i)=>(0,l.isValidElement)(e)?(0,l.cloneElement)(e,{showDivider:i>0}):e)})}))};c.displayName="Breadcrumb"},18091:function(e,i,t){t.d(i,{g:()=>d});var r=t(59390),s=t(24246),l=t(91985),n=t(90633),a=t(15508);let d=e=>{var{children:i=null,className:t="",to:d,isActive:c=!1,isDropdown:u=!1,showDivider:o,target:h,component:m="a",render:x}=e,p=(0,r.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let b=c?"page":void 0,j=(0,a.i)(n.Z.breadcrumbLink,c&&n.Z.modifiers.current);return(0,s.jsxs)("li",Object.assign({},p,{className:(0,a.i)(n.Z.breadcrumbItem,t),children:[o&&(0,s.jsx)("span",{className:n.Z.breadcrumbItemDivider,children:(0,s.jsx)(l.ZP,{})}),"button"===m&&(0,s.jsx)("button",{className:j,"aria-current":b,type:"button",children:i}),u&&(0,s.jsx)("span",{className:(0,a.i)(n.Z.breadcrumbDropdown),children:i}),x&&x({className:j,ariaCurrent:b}),d&&!x&&(0,s.jsx)(m,{href:d,target:h,className:j,"aria-current":b,children:i}),!d&&"button"!==m&&!u&&i]}))};d.displayName="BreadcrumbItem"},81211:function(e,i,t){t.d(i,{aV:()=>h});var r,s,l,n,a,d=t(59390),c=t(24246),u=t(40269),o=t(15508);(r=l||(l={})).number="1",r.lowercaseLetter="a",r.uppercaseLetter="A",r.lowercaseRomanNumber="i",r.uppercaseRomanNumber="I",(n||(n={})).inline="inline",(s=a||(a={})).ol="ol",s.ul="ul";let h=e=>{var{className:i="",children:t=null,variant:r=null,isBordered:s=!1,isPlain:n=!1,iconSize:h="default",type:m=l.number,ref:x=null,component:p=a.ul}=e,b=(0,d.__rest)(e,["className","children","variant","isBordered","isPlain","iconSize","type","ref","component"]);return p===a.ol?(0,c.jsx)("ol",Object.assign({ref:x,type:m},n&&{role:"list"},b,{className:(0,o.i)(u.Z.list,r&&u.Z.modifiers[r],s&&u.Z.modifiers.bordered,n&&u.Z.modifiers.plain,h&&"large"===h&&u.Z.modifiers.iconLg,i),children:t})):(0,c.jsx)("ul",Object.assign({ref:x},n&&{role:"list"},b,{className:(0,o.i)(u.Z.list,r&&u.Z.modifiers[r],s&&u.Z.modifiers.bordered,n&&u.Z.modifiers.plain,h&&"large"===h&&u.Z.modifiers.iconLg,i),children:t}))};h.displayName="List"},45882:function(e,i,t){t.d(i,{H:()=>a});var r=t(59390),s=t(24246),l=t(40269),n=t(15508);let a=e=>{var{icon:i=null,children:t=null}=e,a=(0,r.__rest)(e,["icon","children"]);return(0,s.jsxs)("li",Object.assign({className:(0,n.i)(i&&l.Z.listItem)},a,{children:[i&&(0,s.jsx)("span",{className:(0,n.i)(l.Z.listItemIcon),children:i}),(0,s.jsx)("span",{className:i&&(0,n.i)(`${l.Z.list}__item-text`),children:t})]}))};a.displayName="ListItem"},11797:function(e,i,t){t.d(i,{O:()=>c});var r=t(59390),s=t(24246);let l={modifiers:{circle:"pf-m-circle",square:"pf-m-square",widthSm:"pf-m-width-sm",widthMd:"pf-m-width-md",widthLg:"pf-m-width-lg",width_25:"pf-m-width-25",width_33:"pf-m-width-33",width_50:"pf-m-width-50",width_66:"pf-m-width-66",width_75:"pf-m-width-75",heightSm:"pf-m-height-sm",heightMd:"pf-m-height-md",heightLg:"pf-m-height-lg",height_25:"pf-m-height-25",height_33:"pf-m-height-33",height_50:"pf-m-height-50",height_66:"pf-m-height-66",height_75:"pf-m-height-75",height_100:"pf-m-height-100",text_4xl:"pf-m-text-4xl",text_3xl:"pf-m-text-3xl",text_2xl:"pf-m-text-2xl",textXl:"pf-m-text-xl",textLg:"pf-m-text-lg",textMd:"pf-m-text-md",textSm:"pf-m-text-sm"},skeleton:"pf-v6-c-skeleton"};var n=t(15508);let a={name:"--pf-v6-c-skeleton--Height"},d={name:"--pf-v6-c-skeleton--Width"},c=e=>{var{className:i,width:t,height:c,fontSize:u,shape:o,screenreaderText:h}=e,m=(0,r.__rest)(e,["className","width","height","fontSize","shape","screenreaderText"]);let x=u?Object.values(l.modifiers).find(e=>e===`pf-m-text-${u}`):void 0;return(0,s.jsx)("div",Object.assign({},m,{className:(0,n.i)(l.skeleton,u&&x,"circle"===o&&l.modifiers.circle,"square"===o&&l.modifiers.square,i)},(t||c)&&{style:Object.assign({[d.name]:t||void 0,[a.name]:c||void 0},m.style)},{children:(0,s.jsx)("span",{className:"pf-v6-screen-reader",children:h})}))};c.displayName="Skeleton"},26235:function(e,i,t){t.d(i,{ZP:()=>r});let r=(0,t(24329).I)({name:"PenIcon",height:512,width:512,svgPath:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z",yOffset:0,xOffset:0})},67447:function(e,i,t){t.d(i,{G:()=>a});var r=t(59390),s=t(24246),l=t(15508),n=t(39157);let a=e=>{var{children:i=null}=e,t=(0,r.__rest)(e,["children"]);return(0,s.jsx)("div",Object.assign({},t,{className:(0,l.i)(n.Z.tableExpandableRowContent),children:i}))};a.displayName="ExpandableRowContent"},37818:function(e,i,t){t.d(i,{u:()=>a});var r=t(24246),s=t(8305),l=t(13754),n=t(39826);let a=e=>e.isFetching?e.isFetchingState||(0,r.jsx)(s.b,{children:(0,r.jsx)(l.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,r.jsx)(n.y,{}):e.children},69876:function(e,i,t){t.d(i,{D:()=>l});var r=t(24246),s=t(70400);let l=e=>{let{value:i}=e;return(0,r.jsx)(r.Fragment,{children:Object.entries(i).map(e=>{let[i,t]=e;return(0,r.jsx)(s._,{isCompact:!0,children:`${i}=${t}`},`${i}=${t}`)})})}},68057:function(e,i,t){t.d(i,{V:()=>a});var r=t(24246),s=t(27378),l=t(63763),n=t(32947);let a=e=>{let{vulnerabilitiesSummary:i}=e,t=s.useMemo(()=>Object.keys(i.severities).map(e=>{let t=i.severities[e],r=n.V4[e];return{severity:e,count:t,label:r.name,color:r.color.value}}).sort((0,n.A0)(e=>e.severity)).reverse(),[i]);return(0,r.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,r.jsx)(l.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${i.total}`,subTitle:"Total vulnerabilities",width:350,legendData:t.map(e=>{let{label:i,count:t}=e;return{name:`${i}: ${t}`}}),data:t.map(e=>{let{label:i,count:t}=e;return{x:i,y:t}}),labels:e=>{let{datum:i}=e;return`${i.x}: ${i.y}`},colorScale:t.map(e=>{let{color:i}=e;return i})})})}},42573:function(e,i,t){t.d(i,{C:()=>l});var r=t(24246),s=t(70400);let l=e=>{let{error:i}=e;return(0,r.jsxs)(s._,{color:"red",children:[i.status," Error"]})}},3586:function(e,i,t){t.d(i,{j:()=>l});var r=t(24246),s=t(27378);let l=e=>{let{children:i}=e,[t,l]=s.useState(!1);return(0,r.jsx)(r.Fragment,{children:i(t,l)})}},24200:function(e,i,t){t.d(i,{G:()=>s});var r=t(24246);let s=e=>{let{vulnerability:i}=e;return(0,r.jsxs)("p",{children:[i.withdrawn&&(0,r.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},49304:function(e,i,t){t.d(i,{u:()=>u});var r=t(24246),s=t(34747),l=t(46770),n=t(25138),a=t(87445),d=t(32947),c=t(57524);let u=e=>{let{severities:i}=e,t=Object.values(i).reduce((e,i)=>e+i,0);return(0,r.jsxs)(s.k,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,r.jsx)(l.B,{style:{minWidth:15,textAlign:a.F2},children:t}),(0,r.jsx)(n.i,{orientation:{default:"vertical"}}),(0,r.jsx)(l.B,{children:(0,r.jsx)(s.k,{children:Object.entries(i).filter(e=>{let[i,t]=e;return t>0}).sort((0,d.A0)(e=>{let[i,t]=e;return i})).reverse().map(e=>{let[i,t]=e;return(0,r.jsx)(l.B,{spacer:{default:"spacerXs"},children:(0,r.jsxs)(s.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,r.jsx)(l.B,{children:(0,r.jsx)(c.o,{value:i,score:null})}),(0,r.jsx)(l.B,{children:t})]})},i)})})})]})}},31373:function(e,i,t){t.d(i,{useVulnerabilitiesOfPackage:()=>u});var r=t(27378),s=t(7615),l=t(59015);let n=(e,i)=>e.vulnerability.identifier===i.vulnerability.identifier&&e.vulnerabilityStatus===i.vulnerabilityStatus,a={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},d={vulnerabilityStatus:{affected:{...a},fixed:{...a},not_affected:{...a},known_not_affected:{...a}}},c=e=>{let i=e.flatMap(e=>(e.status??[]).map(i=>{let t=(0,s.g)(i.average_severity);return{vulnerability:{...i.vulnerability,average_severity:t,average_score:i.average_score},vulnerabilityStatus:i.status,advisory:e}})).reduce((e,i)=>{let t,r=e.find(e=>n(e,i));if(r)t=[...e.filter(e=>!n(e,r)),{...r,relatedSboms:[...r.relatedSboms,{advisory:i.advisory}]}];else{let r={vulnerability:i.vulnerability,vulnerabilityStatus:i.vulnerabilityStatus,relatedSboms:[{advisory:i.advisory}]};t=[...e.slice(),r]}return t},[]),t=i.reduce((e,i)=>{let t=i.vulnerabilityStatus,r=i.vulnerability.average_severity,s=e.vulnerabilityStatus[t];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[t]:{total:s.total+1,severities:{...s.severities,[r]:s.severities[r]+1}}}})},{...d});return{vulnerabilities:i,summary:t}},u=e=>{let{pkg:i,isFetching:t,fetchError:s}=(0,l.useFetchPackageById)(e);return{data:r.useMemo(()=>c(i?.advisories||[]),[i]),isFetching:t,fetchError:s}}},82413:function(e,i,t){t.d(i,{useVulnerabilitiesOfSbom:()=>u,useVulnerabilitiesOfSboms:()=>o});var r=t(27378),s=t(7615),l=t(43959);let n=(e,i)=>e.vulnerability.identifier===i.vulnerability.identifier&&e.vulnerabilityStatus===i.vulnerabilityStatus,a={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},d={vulnerabilityStatus:{affected:{...a},fixed:{...a},not_affected:{...a},known_not_affected:{...a}}},c=e=>{let i=e.flatMap(e=>(e.status??[]).map(i=>({vulnerability:i,vulnerabilityStatus:i.status,advisory:e,packages:i.packages}))).reduce((e,i)=>{let t,r=e.find(e=>n(e,i));if(r)t=[...e.filter(e=>!n(e,r)),{...r,relatedPackages:[...r.relatedPackages,{advisory:i.advisory,packages:i.packages}]}];else{let r={vulnerability:i.vulnerability,vulnerabilityStatus:i.vulnerabilityStatus,relatedPackages:[{advisory:i.advisory,packages:i.packages}]};t=[...e.slice(),r]}return t},[]),t=i.reduce((e,i)=>{let t=i.vulnerabilityStatus,r=(0,s.g)(i.vulnerability.average_severity),l=e.vulnerabilityStatus[t];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[t]:{total:l.total+1,severities:{...l.severities,[r]:l.severities[r]+1}}}})},{...d});return{vulnerabilities:i,summary:t}},u=e=>{let{advisories:i,isFetching:t,fetchError:s}=(0,l.useFetchSbomsAdvisory)(e);return{data:r.useMemo(()=>c(i||[]),[i]),isFetching:t,fetchError:s}},o=e=>{let{advisories:i,isFetching:t,fetchError:s}=(0,l.useFetchSbomsAdvisoryBatch)(e);return{data:r.useMemo(()=>(i??[]).map(e=>c(e||[])),[i]),isFetching:t,fetchError:s}}},96308:function(e,i,t){t.d(i,{n:()=>c});var r=t(24246),s=t(11797),l=t(37818),n=t(42573),a=t(49304),d=t(31373);let c=e=>{let{packageId:i}=e,{data:t,isFetching:c,fetchError:u}=(0,d.useVulnerabilitiesOfPackage)(i);return(0,r.jsx)(l.u,{isFetching:c,fetchError:u,isFetchingState:(0,r.jsx)(s.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,r.jsx)(n.C,{error:e}),children:(0,r.jsx)(a.u,{severities:t.summary.vulnerabilityStatus.affected.severities})})}},41362:function(e,i,t){t.r(i),t.d(i,{default:()=>eO});var r=t(24246),s=t(27378),l=t(65783),n=t(45043),a=t(97339),d=t(18091),c=t(11192),u=t(32591),o=t(34747),h=t(46770),m=t(68802),x=t(70400),p=t(32939),b=t(24620),j=t(37961),f=t(69265),g=t(4075),y=t(27090),v=t(75165),S=t(31762),_=t(99),T=t(24787),F=t(12621),k=t(9839),P=t(37818),w=t(73227),E=t(43959),M=t(65872),B=t(87727),O=t(3498),N=t(31757),I=t(87069),K=t(51527),L=t(30329),C=t(50689),Z=t(67761),q=t(81391),D=t(17528),$=t(81211),V=t(45882),R=t(79551),A=t(32489),H=t(90519),U=t(26235),Q=t(73827),W=t(63706),G=t(66043);let z=e=>{let{sbom:i}=e,[t,l]=s.useState(!1),n=()=>{l(!1)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(B.r,{hasGutter:!0,children:[(0,r.jsx)(O.P,{md:4,children:(0,r.jsxs)(N.Z,{isFullHeight:!0,children:[(0,r.jsx)(I.l,{children:"Metadata"}),(0,r.jsx)(K.e,{children:(0,r.jsxs)(L.o,{children:[(0,r.jsxs)(C.g,{children:[(0,r.jsx)(Z.M,{children:"Name"}),(0,r.jsx)(q.b,{"aria-label":"SBOM's name",children:i.name})]}),(0,r.jsxs)(C.g,{children:[(0,r.jsx)(Z.M,{children:"Namespace"}),(0,r.jsx)(q.b,{"aria-label":"SBOM's namespace",children:i.document_id})]}),(0,r.jsxs)(C.g,{children:[(0,r.jsx)(Z.M,{children:"Data License"}),(0,r.jsx)(q.b,{"aria-label":"SBOM's license",children:i.data_licenses.join(", ")})]})]})})]})}),(0,r.jsx)(O.P,{md:4,children:(0,r.jsxs)(N.Z,{isFullHeight:!0,children:[(0,r.jsx)(I.l,{children:"Creation"}),(0,r.jsx)(K.e,{children:(0,r.jsxs)(L.o,{children:[(0,r.jsxs)(C.g,{children:[(0,r.jsx)(Z.M,{children:"Created"}),(0,r.jsx)(q.b,{"aria-label":"SBOM's creation date",children:(0,W.p6)(i.published)})]}),(0,r.jsxs)(C.g,{children:[(0,r.jsx)(Z.M,{children:"Creator"}),(0,r.jsx)(q.b,{"aria-label":"SBOM's creator",children:i.suppliers})]})]})})]})}),(0,r.jsx)(O.P,{md:4,children:(0,r.jsxs)(N.Z,{isFullHeight:!0,children:[(0,r.jsx)(I.l,{children:"Statistics"}),(0,r.jsx)(K.e,{children:(0,r.jsxs)(L.o,{children:[(0,r.jsxs)(C.g,{children:[(0,r.jsx)(Z.M,{children:"Size"}),(0,r.jsx)(q.b,{children:(0,M.Z)(i.size)})]}),(0,r.jsxs)(C.g,{children:[(0,r.jsx)(Z.M,{children:"Packages"}),(0,r.jsx)(q.b,{children:i.number_of_packages})]}),(0,r.jsxs)(C.g,{children:[(0,r.jsxs)(Z.M,{children:["Labels ","",(0,r.jsx)(D.zx,{variant:D.Wu.link,size:"sm",icon:(0,r.jsx)(U.ZP,{}),iconPosition:"end",onClick:()=>l(!0),children:"Edit"})]}),(0,r.jsx)(q.b,{children:(0,r.jsx)(N.Z,{isCompact:!0,children:(0,r.jsx)(K.e,{children:i.labels&&(0,r.jsx)(Q.C,{defaultIsOpen:!0,value:i.labels})})})})]})]})})]})}),(0,r.jsx)(O.P,{md:12,children:(0,r.jsxs)(N.Z,{isFullHeight:!0,children:[(0,r.jsx)(I.l,{children:"Package"}),(0,r.jsx)(K.e,{children:(0,r.jsxs)(L.o,{children:[(0,r.jsxs)(C.g,{children:[(0,r.jsx)(Z.M,{children:"Name"}),(0,r.jsx)(q.b,{children:i.name})]}),(0,r.jsxs)(C.g,{children:[(0,r.jsx)(Z.M,{children:"Version"}),(0,r.jsx)(q.b,{children:i.described_by.map(e=>e.version).join(", ")})]}),(0,r.jsxs)(C.g,{children:[(0,r.jsx)(Z.M,{children:"External References"}),(0,r.jsx)(q.b,{children:(0,r.jsxs)($.aV,{children:[i.described_by.flatMap(e=>e.cpe).map(e=>(0,r.jsx)(V.H,{children:e},e)),(0,r.jsx)(V.H,{children:i.described_by.flatMap(e=>e.purl).map(e=>e.purl)})]})})]})]})})]})})]}),(0,r.jsxs)(R.u,{isOpen:t,variant:"medium",onClose:n,children:[(0,r.jsx)(A.x,{title:"Edit labels"}),(0,r.jsx)(H.f,{children:(0,r.jsx)(G._,{sbom:i,onClose:n})})]})]})};var X=t(70715),J=t(40982),Y=t(89226),ee=t(62997),ei=t(4835),et=t(14350),er=t(11165),es=t(89330),el=t(31423),en=t(94154),ea=t(67447),ed=t(74502),ec=t(14629),eu=t(3804),eo=t(31336),eh=t(49988),em=t(59015),ex=t(96308);let ep=(e,i)=>i.reduce((e,i)=>{let{license_id:t,license_name:r}=i;return e.replaceAll(t,r)},`${e}`),eb=e=>{let{sbomId:i}=e,{licenseIds:t}=(0,E.useFetchSbomsLicenseIds)(i),s=(0,eh.vZ)({tableName:"package-table",columnNames:{name:"Name",version:"Version",vulnerabilities:"Vulnerabilities",licenses:"Licenses",purls:"PURLs",cpes:"CPEs"},isSortEnabled:!0,sortableColumns:["name"],isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:ed.L4,title:"Filter text",placeholderText:"Search",type:ec.vA.search},{categoryKey:"license",title:"License",placeholderText:"Filter results by license",type:ec.vA.multiselect,operator:"~",logicOperator:"OR",selectOptions:t.map(e=>({value:e.license_id,label:e.license_name}))}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:n,total:a},isFetching:d,fetchError:c}=(0,em.useFetchPackagesBySbomId)(i,(0,eh.QO)({...s,hubSortFieldKeys:{name:"name"}})),u=(0,eh.KC)({...s,idProperty:"id",currentPageItems:n,totalItemCount:a,isLoading:d}),{currentPageItems:o,numRenderedColumns:h,propHelpers:{toolbarProps:m,filterToolbarProps:p,paginationToolbarItemProps:b,paginationProps:j,tableProps:f,getThProps:g,getTrProps:y,getTdProps:v,getExpandedContentTdProps:S},expansionDerivedState:{isCellExpanded:_}}=u;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(X.o,{...m,children:(0,r.jsxs)(J.c,{children:[(0,r.jsx)(ec.Ki,{...p}),(0,r.jsx)(Y.E,{...b,children:(0,r.jsx)(eu.p,{idPrefix:"package-table",isTop:!0,paginationProps:j})})]})}),(0,r.jsxs)(ei.i,{...f,"aria-label":"Package table",children:[(0,r.jsx)(et.h,{children:(0,r.jsx)(er.Tr,{children:(0,r.jsxs)(eo.qK,{...u,children:[(0,r.jsx)(es.Th,{...g({columnKey:"name"})}),(0,r.jsx)(es.Th,{...g({columnKey:"version"})}),(0,r.jsx)(es.Th,{...g({columnKey:"vulnerabilities"})}),(0,r.jsx)(es.Th,{...g({columnKey:"licenses"})}),(0,r.jsx)(es.Th,{...g({columnKey:"purls"})}),(0,r.jsx)(es.Th,{...g({columnKey:"cpes"})})]})})}),(0,r.jsx)(eo.hp,{isLoading:d,isError:!!c,isNoData:0===a,numRenderedColumns:h,children:o?.map((e,i)=>(0,r.jsxs)(el.p,{isExpanded:_(e),children:[(0,r.jsx)(er.Tr,{...y({item:e}),children:(0,r.jsxs)(eo.Cx,{...u,item:e,rowIndex:i,children:[(0,r.jsx)(en.Td,{width:15,...v({columnKey:"name"}),children:[e.name,e.group].filter(Boolean).join("/")}),(0,r.jsx)(en.Td,{width:15,modifier:"truncate",...v({columnKey:"version"}),children:e?.version}),(0,r.jsx)(en.Td,{width:10,modifier:"breakWord",...v({columnKey:"vulnerabilities"}),children:e.purl[0]&&(0,r.jsx)(ex.n,{packageId:e.purl[0].uuid})}),(0,r.jsx)(en.Td,{width:20,modifier:"breakWord",...v({columnKey:"licenses",isCompoundExpandToggle:e.licenses.length>1,item:e,rowIndex:i}),children:1===e.licenses.length?ep(e.licenses[0].license_name,e.licenses_ref_mapping):`${e.licenses.length} Licenses`}),(0,r.jsx)(en.Td,{width:20,modifier:"breakWord",...v({columnKey:"purls",isCompoundExpandToggle:e.purl.length>1,item:e,rowIndex:i}),children:1===e.purl.length?(0,r.jsx)(l.rU,{to:`/packages/${e.purl[0].uuid}`,children:e.purl[0].purl}):`${e.purl.length} PURLs`}),(0,r.jsxs)(en.Td,{width:20,modifier:"breakWord",...v({columnKey:"cpes",isCompoundExpandToggle:e.cpe.length>0,item:e,rowIndex:i}),children:[e.cpe.length," CPEs"]})]})}),_(e)?(0,r.jsx)(er.Tr,{isExpanded:!0,children:(0,r.jsx)(en.Td,{...S({item:e}),className:ee.Z.pLg,children:(0,r.jsx)(ea.G,{children:(0,r.jsxs)("div",{className:ee.Z.ptLg,children:[_(e,"licenses")?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)($.aV,{isPlain:!0,children:e.licenses.map(i=>(0,r.jsxs)(V.H,{children:[ep(i.license_name,e.licenses_ref_mapping)," ",(0,r.jsx)(x._,{isCompact:!0,children:i.license_type})]},`${i.license_name}-${i.license_type}`))})}):null,_(e,"purls")?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)($.aV,{isPlain:!0,children:e.purl.map(e=>(0,r.jsx)(V.H,{children:(0,r.jsx)(l.rU,{to:`/packages/${e.uuid}`,children:e.purl})},e.uuid))})}):null,_(e,"cpes")?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)($.aV,{isPlain:!0,children:e.cpe.map(e=>(0,r.jsx)(V.H,{children:e},e))})}):null]})})})}):null]},e.id))})]}),(0,r.jsx)(eu.p,{idPrefix:"package-table",isTop:!1,paginationProps:j})]})};var ej=t(27693),ef=t.n(ej),eg=t(27317),ey=t(93095),ev=t(9905),eS=t(32947),e_=t(7615),eT=t(69876),eF=t(68057),ek=t(57524),eP=t(3586),ew=t(24200),eE=t(82413),eM=t(41135);let eB=e=>{let{sbomId:i}=e,{sbom:t,isFetching:n,fetchError:a}=(0,E.useFetchSBOMById)(i),{data:{vulnerabilities:d,summary:c},isFetching:u,fetchError:o}=(0,eE.useVulnerabilitiesOfSbom)(i),h=s.useMemo(()=>d.filter(e=>"affected"===e.vulnerabilityStatus),[d]),m=s.useMemo(()=>h.map(e=>{let i=e.relatedPackages.flatMap(e=>e.packages).reduce((e,i)=>(e.find(e=>e.id===i.id)||e.push(i),e),[]);return{...e,summary:{totalPackages:i.length,allPackages:i}}}),[h]),x=(0,eM.T)(m,e=>`${e.vulnerability.identifier}-${e.vulnerabilityStatus}`),p=(0,eh.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:x,isLoading:u,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>({id:e.vulnerability.identifier,cvss:(0,eS.XE)(e.vulnerability.average_severity),affectedDependencies:e.summary.totalPackages,published:e.vulnerability?.published?ef()(e.vulnerability.published).valueOf():0,updated:e.vulnerability?.modified?ef()(e.vulnerability.modified).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:b,numRenderedColumns:j,propHelpers:{toolbarProps:f,paginationToolbarItemProps:g,paginationProps:y,tableProps:v,getThProps:S,getTrProps:_,getTdProps:T,getExpandedContentTdProps:F},expansionDerivedState:{isCellExpanded:k}}=p;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(eg.K,{hasGutter:!0,children:[(0,r.jsx)(ey.v,{children:(0,r.jsx)(N.Z,{children:(0,r.jsx)(K.e,{children:(0,r.jsx)(P.u,{isFetching:n||u,fetchError:a,children:(0,r.jsxs)(B.r,{hasGutter:!0,children:[(0,r.jsx)(O.P,{md:6,children:(0,r.jsx)(eF.V,{vulnerabilitiesSummary:c.vulnerabilityStatus.affected})}),(0,r.jsx)(O.P,{md:6,children:(0,r.jsxs)(L.o,{children:[(0,r.jsxs)(C.g,{children:[(0,r.jsx)(Z.M,{children:"Name"}),(0,r.jsx)(q.b,{children:t?.name})]}),(0,r.jsxs)(C.g,{children:[(0,r.jsx)(Z.M,{children:"Version"}),(0,r.jsx)(q.b,{children:t?.described_by.map(e=>e.version).join(", ")})]}),(0,r.jsxs)(C.g,{children:[(0,r.jsx)(Z.M,{children:"Creation date"}),(0,r.jsx)(q.b,{children:(0,W.p6)(t?.published)})]})]})})]})})})})}),(0,r.jsxs)(ey.v,{children:[(0,r.jsx)(X.o,{...f,children:(0,r.jsx)(J.c,{children:(0,r.jsx)(Y.E,{...g,children:(0,r.jsx)(eu.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:y})})})}),(0,r.jsxs)(ei.i,{...v,"aria-label":"Vulnerability table",children:[(0,r.jsx)(et.h,{children:(0,r.jsx)(er.Tr,{children:(0,r.jsxs)(eo.qK,{...p,children:[(0,r.jsx)(es.Th,{...S({columnKey:"id"})}),(0,r.jsx)(es.Th,{...S({columnKey:"description"})}),(0,r.jsx)(es.Th,{...S({columnKey:"cvss"})}),(0,r.jsx)(es.Th,{...S({columnKey:"affectedDependencies"})}),(0,r.jsx)(es.Th,{...S({columnKey:"published"})}),(0,r.jsx)(es.Th,{...S({columnKey:"updated"})})]})})}),(0,r.jsx)(eo.hp,{isLoading:u,isError:!!o,isNoData:0===x.length,numRenderedColumns:j,children:b?.map((e,i)=>(0,r.jsxs)(el.p,{isExpanded:k(e),children:[(0,r.jsx)(er.Tr,{..._({item:e}),children:(0,r.jsxs)(eo.Cx,{...p,item:e,rowIndex:i,children:[(0,r.jsx)(en.Td,{width:15,modifier:"breakWord",...T({columnKey:"id"}),children:(0,r.jsx)(l.rU,{to:`/vulnerabilities/${e.vulnerability.identifier}`,children:e.vulnerability.identifier})}),(0,r.jsx)(eP.j,{children:(i,t)=>(0,r.jsx)(en.Td,{width:35,modifier:"truncate",onFocus:()=>t(!0),onBlur:()=>t(!1),tabIndex:0,...T({columnKey:"description"}),children:(0,r.jsx)(ev.cE,{focused:i,wrapModifier:"truncate",children:e.vulnerability&&(0,r.jsx)(ew.G,{vulnerability:e.vulnerability})})})}),(0,r.jsx)(en.Td,{width:10,...T({columnKey:"cvss"}),children:(0,r.jsx)(ek.o,{value:(0,e_.g)(e.vulnerability.average_severity),score:e.vulnerability.average_score,showLabel:!0,showScore:!0})}),(0,r.jsx)(en.Td,{width:15,modifier:"truncate",...T({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:i}),children:e.summary.totalPackages}),(0,r.jsx)(en.Td,{width:10,modifier:"truncate",...T({columnKey:"published"}),children:(0,W.p6)(e.vulnerability?.published)}),(0,r.jsx)(en.Td,{width:10,modifier:"truncate",...T({columnKey:"updated"}),children:(0,W.p6)(e.vulnerability?.modified)})]})}),k(e)?(0,r.jsx)(er.Tr,{isExpanded:!0,children:(0,r.jsx)(en.Td,{...F({item:e}),children:(0,r.jsx)(ea.G,{children:k(e,"affectedDependencies")?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(ei.i,{variant:"compact",children:[(0,r.jsx)(et.h,{children:(0,r.jsxs)(er.Tr,{children:[(0,r.jsx)(es.Th,{children:"Type"}),(0,r.jsx)(es.Th,{children:"Namespace"}),(0,r.jsx)(es.Th,{children:"Name"}),(0,r.jsx)(es.Th,{children:"Version"}),(0,r.jsx)(es.Th,{children:"Path"}),(0,r.jsx)(es.Th,{children:"Qualifiers"})]})}),(0,r.jsx)(el.p,{children:e.summary.allPackages.flatMap(e=>e.name&&0===e.purl.length?[{parentName:e.name}]:e.purl.map(i=>({parentName:e.name,purlSummary:i}))).map((e,i)=>{if(e.purlSummary){let i=(0,W.qX)(e.purlSummary.purl);return(0,r.jsxs)(er.Tr,{children:[(0,r.jsx)(en.Td,{children:i?.type}),(0,r.jsx)(en.Td,{children:i?.namespace}),(0,r.jsx)(en.Td,{children:(0,r.jsx)(l.rU,{to:`/packages/${e.purlSummary.uuid}`,children:i?.name})}),(0,r.jsx)(en.Td,{children:i?.version}),(0,r.jsx)(en.Td,{children:i?.path}),(0,r.jsx)(en.Td,{children:i?.qualifiers&&(0,r.jsx)(eT.D,{value:i?.qualifiers})})]},e.purlSummary.uuid)}return(0,r.jsxs)(er.Tr,{children:[(0,r.jsx)(en.Td,{}),(0,r.jsx)(en.Td,{}),(0,r.jsx)(en.Td,{children:e.parentName}),(0,r.jsx)(en.Td,{}),(0,r.jsx)(en.Td,{}),(0,r.jsx)(en.Td,{})]},`${e.parentName}-${i}-name`)})})]})}):null})})}):null]},e._ui_unique_id))})]}),(0,r.jsx)(eu.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:y})]})]})})},eO=()=>{let e=(0,k.ZX)(k.Uo.SBOM_ID),{sbom:i,isFetching:t,fetchError:M}=(0,E.useFetchSBOMById)(e),{downloadSBOM:B,downloadSBOMLicenses:O}=(0,w.useDownload)(),[N,I]=s.useState(!1),[K,L]=s.useState(0),C=s.createRef(),Z=s.createRef(),q=s.createRef(),D=s.createRef(),$=()=>{I(!N)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.NP,{type:"breadcrumb",children:(0,r.jsxs)(a.a,{children:[(0,r.jsx)(d.g,{children:(0,r.jsx)(l.rU,{to:"/sboms",children:"SBOMs"})}),(0,r.jsx)(d.g,{isActive:!0,children:"SBOM details"})]})}),(0,r.jsx)(n.NP,{children:(0,r.jsxs)(c.P,{children:[(0,r.jsx)(u.J,{isFilled:!0,children:(0,r.jsxs)(o.k,{children:[(0,r.jsx)(h.B,{spacer:{default:"spacerSm"},children:(0,r.jsx)(m.V,{children:(0,r.jsx)(m.V,{component:"h1",children:i?.name??e??""})})}),(0,r.jsx)(h.B,{children:i?.labels.type&&(0,r.jsx)(x._,{color:"blue",children:i?.labels.type})})]})}),(0,r.jsx)(u.J,{children:i&&(0,r.jsx)(p.L,{isOpen:N,onSelect:()=>I(!1),onOpenChange:e=>I(e),popperProps:{position:"right"},toggle:e=>(0,r.jsx)(b.O_,{ref:e,onClick:$,isExpanded:N,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,r.jsxs)(j.s,{children:[(0,r.jsx)(f.h,{onClick:()=>{e&&B(e,i?.name?`${i?.name}.json`:`${e}.json`)},children:"Download SBOM"},"sbom"),(0,r.jsx)(f.h,{onClick:()=>{e&&O(e)},children:"Download License Report"},"license")]})})})]})}),(0,r.jsx)(n.NP,{children:(0,r.jsxs)(g.m,{mountOnEnter:!0,activeKey:K,onSelect:(e,i)=>{L(i)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,r.jsx)(y.O,{eventKey:0,title:(0,r.jsx)(v.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:C}),(0,r.jsx)(y.O,{eventKey:1,title:(0,r.jsx)(v.T,{children:"Packages"}),tabContentId:"refTabPackagesSection",tabContentRef:Z}),(0,r.jsx)(y.O,{eventKey:2,title:(0,r.jsx)(v.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:q,actions:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.b,{ref:D,children:(0,r.jsx)(F.ZP,{})}),(0,r.jsx)(_.J,{triggerRef:D,bodyContent:(0,r.jsx)("div",{children:"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed."})})]})})]})}),(0,r.jsxs)(n.NP,{children:[(0,r.jsx)(T.I,{eventKey:0,id:"refTabInfoSection",ref:C,"aria-label":"Information of the SBOM",children:(0,r.jsx)(P.u,{isFetching:t,fetchError:M,children:i&&(0,r.jsx)(z,{sbom:i})})}),(0,r.jsx)(T.I,{eventKey:1,id:"refTabPackagesSection",ref:Z,"aria-label":"Packages within the SBOM",hidden:!0,children:e&&(0,r.jsx)(eb,{sbomId:e})}),(0,r.jsx)(T.I,{eventKey:2,id:"refVulnerabilitiesSection",ref:q,"aria-label":"Vulnerabilities within the SBOM",hidden:!0,children:e&&(0,r.jsx)(eB,{sbomId:e})})]})]})}},66043:function(e,i,t){t.d(i,{_:()=>d});var r=t(24246),s=t(27378),l=t(24502),n=t(15726),a=t(43959);let d=e=>{let{sbom:i,onClose:t}=e,{pushNotification:d}=s.useContext(n.c),[c,u]=s.useState(""),[o,h]=s.useState("");s.useEffect(()=>{let e=setTimeout(()=>{h(c)},400);return()=>clearTimeout(e)},[c]);let{labels:m}=(0,a.useFetchSBOMLabels)(o),{mutate:x,isPending:p}=(0,a.useUpdateSbomLabelsMutation)(()=>{d({title:`Labels updated for SBOM ${i.name}`,variant:"success"}),t()},e=>{d({title:`Error while updating labels for SBOM ${i.name}`,variant:"danger"})});return(0,r.jsx)(l.M,{title:`Labels of SBOM: ${i.name}`,value:i.labels,isDisabled:p,onSave:e=>{x({id:i.id,labels:e})},onClose:t,onInputChange:u,options:m})}},59015:function(e,i,t){t.d(i,{useFetchPackageById:()=>c,useFetchPackages:()=>d,useFetchPackagesBySbomId:()=>u});var r=t(1183),s=t(50576),l=t(40371),n=t(49988);let a="packages",d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:t,isLoading:d,error:c,refetch:u}=(0,r.useQuery)({queryKey:[a,e],queryFn:()=>(0,l.tj)({client:s.L,query:{...(0,n.rm)(e)}}),enabled:!i});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:e},isFetching:d,fetchError:c,refetch:u}},c=e=>{let{data:i,isLoading:t,error:n}=(0,r.useQuery)({queryKey:[a,e],queryFn:()=>(0,l.BK)({client:s.L,path:{key:e}})});return{pkg:i?.data,isFetching:t,fetchError:n}},u=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:t,isLoading:d,error:c,refetch:u}=(0,r.useQuery)({queryKey:[a,"by-sbom",e,i],queryFn:()=>(0,l.Pg)({client:s.L,path:{id:e},query:{...(0,n.rm)(i)}})});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:i},isFetching:d,fetchError:c,refetch:u}}},43959:function(e,i,t){t.d(i,{useFetchSBOMById:()=>b,useFetchSBOMLabels:()=>x,useFetchSBOMs:()=>p,useFetchSbomsAdvisory:()=>y,useFetchSbomsAdvisoryBatch:()=>v,useFetchSbomsByPackageId:()=>g,useFetchSbomsLicenseIds:()=>S,useUpdateSbomLabelsMutation:()=>f,useUploadSBOM:()=>j});var r=t(1183),s=t(24038),l=t(68e3),n=t(75503),a=t(16072),d=t(50576),c=t(40371),u=t(95169),o=t(87017),h=t(49988);let m="sboms",x=e=>{let{data:i,isLoading:t,error:l,refetch:n}=(0,r.useQuery)({queryKey:[m,"labels",e],queryFn:()=>(0,c.mh)({client:d.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:i?.data||[],isFetching:t,fetchError:l,refetch:n}},p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:s,...l}=(0,h.rm)(e),n=(0,h.Rb)(i),{data:a,isLoading:u,error:o,refetch:x}=(0,r.useQuery)({queryKey:[m,e,n],queryFn:()=>(0,c.Wp)({client:d.L,query:{...l,q:[s,n].filter(e=>e).join("&")}}),enabled:!t});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e??e},isFetching:u,fetchError:o,refetch:x}},b=e=>{let{data:i,isLoading:t,error:s}=(0,r.useQuery)({queryKey:[m,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,c._Q)({client:d.L,path:{id:e}}),enabled:void 0!==e});return{sbom:i?.data,isFetching:t,fetchError:s}},j=()=>{let e=(0,l.NL)();return(0,u.V)({parallel:!0,uploadFn:(e,i)=>(0,o.Hb)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},f=(e,i)=>{let t=(0,l.NL)();return(0,n.D)({mutationFn:e=>(0,c.zx)({client:d.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await t.invalidateQueries({queryKey:[m]})},onError:i})},g=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:t,isLoading:s,error:l,refetch:n}=(0,r.useQuery)({queryKey:[m,"by-package",e,i],queryFn:()=>(0,c.DU)({client:d.L,query:{purl:e,...(0,h.rm)(i)}})});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:i??i},isFetching:s,fetchError:l,refetch:n}},y=e=>{let{data:i,isLoading:t,error:s}=(0,r.useQuery)({queryKey:[m,e,"advisory"],queryFn:()=>(0,c.NU)({client:d.L,path:{id:e}})});return{advisories:i?.data||[],isFetching:t,fetchError:s}},v=e=>{let i=(0,a.h)({queries:e.map(e=>({queryKey:[m,e,"advisory"],queryFn:()=>(0,c.NU)({client:d.L,path:{id:e}})}))});return{advisories:i.map(e=>{let{data:i}=e;return i?.data||[]}),isFetching:i.some(e=>{let{isLoading:i}=e;return i}),fetchError:i.map(e=>{let{error:i}=e;return i})}},S=e=>{let{data:i,isLoading:t,error:s}=(0,r.useQuery)({queryKey:[m,e,"license-ids"],queryFn:()=>(0,c.J4)({client:d.L,path:{id:e}})});return{licenseIds:i?.data||[],isFetching:t,fetchError:s}}},41135:function(e,i,t){t.d(i,{T:()=>l});var r=t(27378),s=t(74502);let l=(e,i)=>(0,r.useMemo)(()=>e&&0!==e.length?e.map(e=>({...e,[s.nM]:i(e)})):[],[e,i])},40269:function(e,i,t){t.d(i,{Z:()=>r});let r={list:"pf-v6-c-list",listItem:"pf-v6-c-list__item",listItemIcon:"pf-v6-c-list__item-icon",modifiers:{iconLg:"pf-m-icon-lg",plain:"pf-m-plain",inline:"pf-m-inline",bordered:"pf-m-bordered"}}},65872:function(e,i,t){t.d(i,{Z:()=>d});let r=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],s=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],l=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],n=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],a=(e,i,t)=>{let r=e;return"string"==typeof i||Array.isArray(i)?r=e.toLocaleString(i,t):(!0===i||void 0!==t)&&(r=e.toLocaleString(void 0,t)),r};function d(e,i){let t;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let d=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?n:l:i.binary?s:r,c=i.space?" ":"";if(i.signed&&0===e)return` 0${c}${d[0]}`;let u=e<0,o=u?"-":i.signed?"+":"";if(u&&(e=-e),void 0!==i.minimumFractionDigits&&(t={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(t={maximumFractionDigits:i.maximumFractionDigits,...t}),e<1)return o+a(e,i.locale,t)+c+d[0];let h=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),d.length-1);return e/=(i.binary?1024:1e3)**h,t||(e=e.toPrecision(3)),o+a(Number(e),i.locale,t)+c+d[h]}}}]);