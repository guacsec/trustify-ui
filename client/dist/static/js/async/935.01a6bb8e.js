"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["935"],{32947:function(e,r,n){n.d(r,{A0:()=>v,Bn:()=>y,V4:()=>j,W:()=>f,X6:()=>p,dn:()=>T,nE:()=>_});var i=n(91566),t=n(839),l=n(73657),s=n(20644),a=n(89502),d=n(7596),o=n(1811),c=n(24917),u=n(4720),h=n(54178),x=n(37106),m=n(34313);let j={unknown:{name:"Unknown",color:o.P,progressProps:{variant:void 0},icon:i.M$},none:{name:"None",color:c.E,progressProps:{variant:void 0},icon:t.f6},low:{name:"Low",color:u.c,progressProps:{variant:void 0},icon:l._$},medium:{name:"Medium",color:h.L,progressProps:{variant:"warning"},icon:s.zI},high:{name:"High",color:x.H,progressProps:{variant:"danger"},icon:a.E2},critical:{name:"Critical",color:m.J,progressProps:{variant:"danger"},icon:d.ki}},p={fixed:{name:"Fixed",color:"blue"},not_affected:{name:"Not affected",color:"green"},known_not_affected:{name:"Known not affected",color:"green"},under_investigation:{name:"Under investigation",color:"yellow"},affected:{name:"Affected",color:"red"}},b=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function v(e){return(r,n)=>b(e(r))-b(e(n))}let f=e=>{let{key:r,value:n}=e;return"".concat(n?"".concat(r,"=").concat(n):"".concat(r))},_=e=>{let[r,n]=e.split("=");return{key:r,value:null!=n?n:""}},g=e=>{if(!e)return 0;switch(e){case"3.1":return 1;case"3.0":return 2;case"4.0":return 3;case"2.0":return 4;default:return 0}};function y(e){return(r,n)=>g(e(r))-g(e(n))}let T=e=>0===e.length?null:[...e].sort(y(e=>e.type))[0]},7615:function(e,r,n){n.d(r,{g:()=>i});let i=e=>null!=e?e:"unknown"},37818:function(e,r,n){n.d(r,{u:()=>a});var i=n(24246),t=n(8305),l=n(13754),s=n(39826);let a=e=>e.isFetching?e.isFetchingState||(0,i.jsx)(t.b,{children:(0,i.jsx)(l.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,i.jsx)(s.y,{}):e.children},69876:function(e,r,n){n.d(r,{D:()=>l});var i=n(24246),t=n(70400);let l=e=>{let{value:r}=e;return(0,i.jsx)(i.Fragment,{children:Object.entries(r).map(e=>{let[r,n]=e;return(0,i.jsx)(t._,{isCompact:!0,children:"".concat(r,"=").concat(n)},"".concat(r,"=").concat(n))})})}},57524:function(e,r,n){n.d(r,{o:()=>o});var i=n(24246),t=n(34747),l=n(46770),s=n(64766),a=n(2499),d=n(32947);let o=e=>{let{value:r,score:n,showScore:o,showLabel:c}=e,u=d.V4[r],h=u.name,x=u.icon;return(0,i.jsxs)(t.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,i.jsx)(l.B,{children:c?(0,i.jsx)(s.J,{children:(0,i.jsx)(x,{color:u.color.value})}):(0,i.jsx)(a.u,{content:h,children:(0,i.jsx)(s.J,{children:(0,i.jsx)(x,{color:u.color.value})})})}),c&&(0,i.jsx)(l.B,{children:h}),o&&null!==n&&(0,i.jsxs)(l.B,{children:["(",Math.round(10*n)/10,")"]})]})}},3804:function(e,r,n){n.d(r,{p:()=>a});var i=n(79192),t=n(53195),l=n(24246),s=n(27230);let a=e=>{let{paginationProps:r,isTop:n,isCompact:a=!1,idPrefix:d=""}=e;return(0,l.jsx)(s.t,(0,t._)((0,i._)({id:"".concat(d?"".concat(d,"-"):"","pagination-").concat(n?"top":"bottom"),variant:n?s.a.top:s.a.bottom,isCompact:a},r),{widgetId:"pagination-id"}))}},39826:function(e,r,n){n.d(r,{y:()=>a});var i=n(24246),t=n(10707),l=n(16668),s=n(42160);let a=()=>(0,i.jsx)(t.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:s.ZP,variant:t.IQ.sm,children:(0,i.jsx)(l.B,{children:"There was an error retrieving data. Check your connection and try again."})})},31336:function(e,r,n){n.d(r,{hp:()=>j,qK:()=>b,Cx:()=>f});var i=n(24246),t=n(8305),l=n(13754),s=n(31423),a=n(11165),d=n(94154),o=n(39826),c=n(10707),u=n(16668),h=n(22119);let x=e=>{let{title:r,description:n}=e;return(0,i.jsx)(c.ub,{titleText:r,headingLevel:"h4",icon:h.ZP,variant:c.IQ.sm,children:n&&(0,i.jsx)(u.B,{children:n})})},m=()=>(0,i.jsx)(x,{title:"No data available",description:"No data available to be shown here."}),j=e=>{let{numRenderedColumns:r,isLoading:n=!1,isError:c=!1,isNoData:u=!1,errorEmptyState:h=null,noDataEmptyState:x=null,children:j}=e;return(0,i.jsx)(i.Fragment,{children:n?(0,i.jsx)(s.p,{"aria-label":"Table loading",children:(0,i.jsx)(a.Tr,{children:(0,i.jsx)(d.Td,{colSpan:r,children:(0,i.jsx)(t.b,{children:(0,i.jsx)(l.$,{size:"xl"})})})})}):c?(0,i.jsx)(s.p,{"aria-label":"Table error",children:(0,i.jsx)(a.Tr,{children:(0,i.jsx)(d.Td,{colSpan:r,children:(0,i.jsx)(t.b,{children:h||(0,i.jsx)(o.y,{})})})})}):u?(0,i.jsx)(s.p,{"aria-label":"Table empty",children:(0,i.jsx)(a.Tr,{children:(0,i.jsx)(d.Td,{colSpan:r,children:(0,i.jsx)(t.b,{children:x||(0,i.jsx)(m,{})})})})}):j})};var p=n(89330);let b=e=>{let{numColumnsBeforeData:r,numColumnsAfterData:n,children:t}=e;return(0,i.jsxs)(i.Fragment,{children:[Array(r).fill(null).map((e,r)=>(0,i.jsx)(p.Th,{screenReaderText:"before-data-".concat(r)},r)),t,Array(n).fill(null).map((e,r)=>(0,i.jsx)(p.Th,{screenReaderText:"after-data-".concat(r)},r))]})};var v=n(79192);let f=e=>{let{isExpansionEnabled:r=!1,expandableVariant:n,getSelectCheckboxTdProps:t,propHelpers:{getSingleExpandButtonTdProps:l},item:s,rowIndex:a,children:o}=e;return(0,i.jsxs)(i.Fragment,{children:[r&&"single"===n?(0,i.jsx)(d.Td,(0,v._)({},l({item:s,rowIndex:a}))):null,t?(0,i.jsx)(d.Td,(0,v._)({},t({item:s,rowIndex:a}))):null,o]})}},24200:function(e,r,n){n.d(r,{G:()=>t});var i=n(24246);let t=e=>{let{vulnerability:r}=e;return(0,i.jsxs)("p",{children:[r.withdrawn&&(0,i.jsx)("em",{children:"Rejected:\xa0"}),r.title||r.description]})}},43006:function(e,r,n){n.d(r,{S:()=>s});var i=n(24246),t=n(70400),l=n(32947);let s=e=>{var r;let{value:n}=e,s=null!=(r=l.X6[n])?r:{name:n,color:void 0};return(0,i.jsx)(t._,{color:s.color,children:s.name})}},51144:function(e,r,n){n.d(r,{s:()=>o});var i=n(79192),t=n(53195),l=n(27378),s=n(52030);let a=(e,r)=>e.sbom.id===r.sbom.id&&e.sbomStatus===r.sbomStatus,d={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0,under_investigation:0}},o=e=>{let{vulnerability:r,isFetching:n,fetchError:o}=(0,s.p6)(e);return{data:l.useMemo(()=>(e=>{let r=e.flatMap(e=>{var r;return(null!=(r=e.sboms)?r:[]).flatMap(r=>Object.entries(r.purl_statuses||{}).map(n=>{let[t,l]=n;return{sbom:(0,i._)({},r),sbomStatus:t,advisory:e,packages:l}}))}).reduce((e,r)=>{let n,l=e.find(e=>a(e,r));if(l)n=[...e.filter(e=>!a(e,l)),(0,t._)((0,i._)({},l),{relatedPackages:[...l.relatedPackages,{advisory:r.advisory,packages:r.packages}]})];else{let i={sbom:r.sbom,sbomStatus:r.sbomStatus,relatedPackages:[{advisory:r.advisory,packages:r.packages}]};n=[...e.slice(),i]}return n},[]),n=r.reduce((e,r)=>{let n=r.sbomStatus;return Object.assign(e,{total:e.total+1,sbomStatus:(0,t._)((0,i._)({},e.sbomStatus),{[n]:e.sbomStatus[n]+1})})},(0,i._)({},d));return{sboms:r,summary:n}})((null==r?void 0:r.advisories)||[]),[r]),isFetching:n,fetchError:o}}},80943:function(e,r,n){n.r(r),n.d(r,{default:()=>el});var i=n(24246),t=n(27378),l=n(6501),s=n(45043),a=n(97339),d=n(18091),o=n(34747),c=n(46770),u=n(68802),h=n(2075),x=n(27090),m=n(75165),j=n(59086),p=n(62997),b=n(27031),v=n(7615),f=n(37818),_=n(57524),g=n(52030),y=n(79192),T=n(53195),S=n(70715),P=n(40982),w=n(89226),K=n(4835),E=n(14350),k=n(11165),C=n(89330),F=n(31423),I=n(94154),V=n(14629),N=n(3804),A=n(31336),R=n(49988),q=n(63706);let B=e=>{let{advisories:r}=e,n=(0,R.sz)({tableName:"advisory-table",idProperty:"uuid",items:r,isLoading:!1,columnNames:{identifier:"ID",title:"Title",type:"Type",revision:"Revision",vulnerabilities:"Vulnerabilities"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.identifier}),isPaginationEnabled:!0,initialItemsPerPage:10,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:V.vA.search,getItemValue:e=>{var r;return null!=(r=e.identifier)?r:""}}]}),{currentPageItems:t,numRenderedColumns:s,propHelpers:{toolbarProps:a,filterToolbarProps:d,paginationToolbarItemProps:o,paginationProps:c,tableProps:u,getThProps:h,getTrProps:x,getTdProps:m}}=n;return(0,i.jsxs)(i.Fragment,{children:[n.isFilterEnabled&&(0,i.jsx)(S.o,(0,T._)((0,y._)({},a),{"aria-label":"Advisory toolbar",children:(0,i.jsxs)(P.c,{children:[(0,i.jsx)(V.Ki,(0,y._)({},d)),(0,i.jsx)(w.E,(0,T._)((0,y._)({},o),{children:(0,i.jsx)(N.p,{idPrefix:"advisory-table",isTop:!0,paginationProps:c})}))]})})),(0,i.jsxs)(K.i,(0,T._)((0,y._)({},u),{"aria-label":"Advisory table",children:[(0,i.jsx)(E.h,{children:(0,i.jsx)(k.Tr,{children:(0,i.jsxs)(A.qK,(0,T._)((0,y._)({},n),{children:[(0,i.jsx)(C.Th,(0,y._)({},h({columnKey:"identifier"}))),(0,i.jsx)(C.Th,(0,y._)({},h({columnKey:"title"}))),(0,i.jsx)(C.Th,(0,y._)({},h({columnKey:"type"}))),(0,i.jsx)(C.Th,(0,y._)({},h({columnKey:"revision"}))),(0,i.jsx)(C.Th,(0,y._)({},h({columnKey:"vulnerabilities"})))]}))})}),(0,i.jsx)(A.hp,{isLoading:!1,isError:void 0,isNoData:0===r.length,numRenderedColumns:s,children:(0,i.jsx)(F.p,{children:null==t?void 0:t.map(e=>(0,i.jsxs)(k.Tr,(0,T._)((0,y._)({},x({item:e})),{children:[(0,i.jsx)(I.Td,(0,T._)((0,y._)({width:20,modifier:"breakWord"},m({columnKey:"identifier"})),{children:(0,i.jsx)(l.rU,{to:(0,l.Gn)(b.nB.advisoryDetails,{advisoryId:e.uuid}),children:e.document_id})})),(0,i.jsx)(I.Td,(0,T._)((0,y._)({width:50,modifier:"truncate"},m({columnKey:"title"})),{children:e.title})),(0,i.jsx)(I.Td,(0,T._)((0,y._)({width:10,modifier:"truncate"},m({columnKey:"type"})),{children:e.labels.type})),(0,i.jsx)(I.Td,(0,T._)((0,y._)({width:10,modifier:"truncate"},m({columnKey:"revision"})),{children:(0,q.p6)(e.modified)})),(0,i.jsx)(I.Td,(0,T._)((0,y._)({width:10,modifier:"truncate"},m({columnKey:"vulnerabilities"})),{children:e.number_of_vulnerabilities}))]}),e.identifier))})})]})),(0,i.jsx)(N.p,{idPrefix:"advisory-table",isTop:!1,paginationProps:c})]})};var M=n(27317),D=n(93095),L=n(87727),O=n(3498),U=n(50689),G=n(81391),H=n(30329),J=n(70781),$=n(99),X=n(35318),z=n(24200);let W=e=>{let{vulnerability:r}=e;return(0,i.jsx)(M.K,{hasGutter:!0,children:(0,i.jsx)(D.v,{children:(0,i.jsxs)(L.r,{hasGutter:!0,children:[(0,i.jsx)(O.P,{md:10,children:(0,i.jsx)(L.r,{children:(0,i.jsx)(O.P,{md:8,children:(0,i.jsx)(U.g,{children:(0,i.jsx)(G.b,{children:(0,i.jsx)(z.G,{vulnerability:r})})})})})}),(0,i.jsx)(O.P,{md:10,children:(0,i.jsxs)(H.o,{columnModifier:{default:"3Col"},children:[(0,i.jsxs)(U.g,{children:[(0,i.jsx)(J.H,{children:(0,i.jsx)($.J,{bodyContent:(0,i.jsx)("div",{children:"The date the Vulnerability identifier was assigned by CVE Numbering Authority (CNA)."}),children:(0,i.jsx)(X.$,{children:"Reserved"})})}),(0,i.jsx)(G.b,{children:(0,q.p6)(r.reserved)})]}),(0,i.jsxs)(U.g,{children:[(0,i.jsx)(J.H,{children:(0,i.jsx)($.J,{bodyContent:(0,i.jsx)("div",{children:"The date the Vulnerability went public."}),children:(0,i.jsx)(X.$,{children:"Published"})})}),(0,i.jsx)(G.b,{children:(0,q.p6)(r.published)})]}),(0,i.jsxs)(U.g,{children:[(0,i.jsx)(J.H,{children:(0,i.jsx)($.J,{bodyContent:(0,i.jsx)("div",{children:"The last date when information for this Vulnerability was updated in the National Vulnerability Database (NVD)."}),children:(0,i.jsx)(X.$,{children:"Modified"})})}),(0,i.jsx)(G.b,{children:(0,q.p6)(r.modified)})]})]})})]})})})};var Z=n(27693),Q=n.n(Z),Y=n(67447),ee=n(69876),er=n(43006),en=n(51144),ei=n(41135);let et=e=>{let{vulnerabilityId:r}=e,{data:{sboms:n},isFetching:s,fetchError:a}=(0,en.s)(r),d=t.useMemo(()=>n.map(e=>{let r=e.relatedPackages.flatMap(e=>e.packages).reduce((e,r)=>e.find(e=>e.uuid===r.uuid)?e:[...e.slice(),r],[]).map(e=>{let r=(0,q.qX)(e.purl);return{purlSummary:e,decomposedPurl:r}});return(0,T._)((0,y._)({},e),{allUniquePackages:r})}),[n]),o=(0,ei.T)(d,e=>"".concat(e.sbom.id,"-").concat(e.sbomStatus)),c=(0,R.sz)({tableName:"sboms-table",idProperty:"_ui_unique_id",items:o,isLoading:s,columnNames:{name:"Name",version:"Version",status:"Status",dependencies:"Dependencies",supplier:"Supplier",created:"Created on"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","dependencies","created"],getSortValues:e=>{var r;return{name:e.sbom.name,dependencies:e.sbom.number_of_packages,created:(null==(r=e.sbom)?void 0:r.published)?Q()(e.sbom.published).valueOf():0}},isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:V.vA.search,getItemValue:e=>{var r,n;return null!=(n=null==(r=e.sbom)?void 0:r.name)?n:""}}],isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:u,numRenderedColumns:h,propHelpers:{toolbarProps:x,paginationToolbarItemProps:m,paginationProps:j,tableProps:p,getThProps:v,getTrProps:f,getTdProps:_,getExpandedContentTdProps:g},expansionDerivedState:{isCellExpanded:B}}=c;return(0,i.jsxs)(i.Fragment,{children:[c.isFilterEnabled&&(0,i.jsx)(S.o,(0,T._)((0,y._)({},x),{"aria-label":"Sbom toolbar",children:(0,i.jsx)(P.c,{children:(0,i.jsx)(w.E,(0,T._)((0,y._)({},m),{children:(0,i.jsx)(N.p,{idPrefix:"sbom-table",isTop:!0,paginationProps:j})}))})})),(0,i.jsxs)(K.i,(0,T._)((0,y._)({},p),{"aria-label":"Sbom table",children:[(0,i.jsx)(E.h,{children:(0,i.jsx)(k.Tr,{children:(0,i.jsxs)(A.qK,(0,T._)((0,y._)({},c),{children:[(0,i.jsx)(C.Th,(0,y._)({},v({columnKey:"name"}))),(0,i.jsx)(C.Th,(0,y._)({},v({columnKey:"version"}))),(0,i.jsx)(C.Th,(0,y._)({},v({columnKey:"status"}))),(0,i.jsx)(C.Th,(0,y._)({},v({columnKey:"dependencies"}))),(0,i.jsx)(C.Th,(0,y._)({},v({columnKey:"supplier"}))),(0,i.jsx)(C.Th,(0,y._)({},v({columnKey:"created"})))]}))})}),(0,i.jsx)(A.hp,{isLoading:s,isError:!!a,isNoData:0===o.length,numRenderedColumns:h,children:null==u?void 0:u.map((e,r)=>{var n,t,s,a;return(0,i.jsxs)(F.p,{isExpanded:B(e),children:[(0,i.jsx)(k.Tr,(0,T._)((0,y._)({},f({item:e})),{children:(0,i.jsxs)(A.Cx,(0,T._)((0,y._)({},c),{item:e,rowIndex:r,children:[(0,i.jsx)(I.Td,(0,T._)((0,y._)({width:25,modifier:"breakWord"},_({columnKey:"name"})),{children:(0,i.jsx)(l.rU,{to:(0,l.Gn)(b.nB.sbomDetails,{sbomId:e.sbom.id}),children:null==e||null==(n=e.sbom)?void 0:n.name})})),(0,i.jsx)(I.Td,(0,T._)((0,y._)({width:10,modifier:"truncate"},_({columnKey:"version"})),{children:null==(t=e.sbom)?void 0:t.version})),(0,i.jsx)(I.Td,(0,T._)((0,y._)({width:10},_({columnKey:"status"})),{children:(0,i.jsx)(er.S,{value:e.sbomStatus})})),(0,i.jsx)(I.Td,(0,T._)((0,y._)({width:10},_({columnKey:"dependencies",isCompoundExpandToggle:!0,item:e,rowIndex:r})),{children:e.allUniquePackages.length})),(0,i.jsx)(I.Td,(0,T._)((0,y._)({width:10,modifier:"truncate"},_({columnKey:"supplier"})),{children:null==e||null==(s=e.sbom)?void 0:s.suppliers.join(", ")})),(0,i.jsx)(I.Td,(0,T._)((0,y._)({width:10,modifier:"truncate"},_({columnKey:"created"})),{children:(0,q.p6)(null==(a=e.sbom)?void 0:a.published)}))]}))})),B(e)?(0,i.jsx)(k.Tr,{isExpanded:!0,children:(0,i.jsx)(I.Td,(0,T._)((0,y._)({},g({item:e})),{children:(0,i.jsx)(Y.G,{children:B(e,"dependencies")?(0,i.jsxs)(K.i,{variant:"compact",children:[(0,i.jsx)(E.h,{children:(0,i.jsxs)(k.Tr,{children:[(0,i.jsx)(C.Th,{children:"Type"}),(0,i.jsx)(C.Th,{children:"Namespace"}),(0,i.jsx)(C.Th,{children:"Name"}),(0,i.jsx)(C.Th,{children:"Version"}),(0,i.jsx)(C.Th,{children:"Path"}),(0,i.jsx)(C.Th,{children:"Qualifiers"})]})}),(0,i.jsx)(F.p,{children:e.allUniquePackages.map(e=>{var r,n,t,s,a,d,o;return(0,i.jsxs)(k.Tr,{children:[(0,i.jsx)(I.Td,{children:null==(r=e.decomposedPurl)?void 0:r.type}),(0,i.jsx)(I.Td,{children:null==(n=e.decomposedPurl)?void 0:n.namespace}),(0,i.jsx)(I.Td,{children:(0,i.jsx)(l.rU,{to:(0,l.Gn)(b.nB.packageDetails,{packageId:e.purlSummary.uuid}),children:null==(t=e.decomposedPurl)?void 0:t.name})}),(0,i.jsx)(I.Td,{children:null==(s=e.decomposedPurl)?void 0:s.version}),(0,i.jsx)(I.Td,{children:null==(a=e.decomposedPurl)?void 0:a.path}),(0,i.jsx)(I.Td,{children:(null==(d=e.decomposedPurl)?void 0:d.qualifiers)&&(0,i.jsx)(ee.D,{value:null==(o=e.decomposedPurl)?void 0:o.qualifiers})})]},e.purlSummary.uuid)})})]}):null})}))}):null]},e._ui_unique_id)})})]})),(0,i.jsx)(N.p,{idPrefix:"sboms-table",isTop:!1,paginationProps:j})]})},el=()=>{var e;let r=(0,b.ZX)(b.Uo.VULNERABILITY_ID),{vulnerability:n,isFetching:y,fetchError:T}=(0,g.p6)(r),[S,P]=(0,t.useState)(0),w=t.createRef(),K=t.createRef();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.NP,{type:"breadcrumb",children:(0,i.jsxs)(a.a,{children:[(0,i.jsx)(d.g,{children:(0,i.jsx)(l.rU,{to:b.nB.vulnerabilities,children:"Vulnerabilities"})}),(0,i.jsx)(d.g,{isActive:!0,children:"Vulnerability details"})]})}),(0,i.jsxs)(s.NP,{children:[(0,i.jsxs)(o.k,{children:[(0,i.jsx)(c.B,{children:(0,i.jsx)(u.V,{children:(0,i.jsxs)(u.V,{component:"h1",children:[null!=(e=null==n?void 0:n.identifier)?e:""," "]})})}),(0,i.jsx)(c.B,{children:n&&(0,i.jsx)(_.o,{value:(0,v.g)(n.average_severity),score:n.average_score,showLabel:!0,showScore:!0})})]}),(0,i.jsx)("div",{className:p.Z.mtSm,children:(0,i.jsx)(f.u,{isFetching:y,fetchError:T,children:n&&(0,i.jsx)(W,{vulnerability:n})})})]}),(0,i.jsx)(s.NP,{children:(0,i.jsxs)(h.m,{mountOnEnter:!0,activeKey:S,onSelect:(e,r)=>{P(r)},"aria-label":"Vulnerability detail tabs",role:"region",children:[(0,i.jsx)(x.O,{eventKey:0,title:(0,i.jsx)(m.T,{children:"Related SBOMs"}),tabContentId:"refTabSbomsSection",tabContentRef:w,"aria-label":"Related SBOMs for this Vulnerability"}),(0,i.jsx)(x.O,{eventKey:1,title:(0,i.jsx)(m.T,{children:"Related Advisories"}),tabContentId:"refTabAdvisoriesSection",tabContentRef:K,"aria-label":"Advisories that explain the current Vulnerability"})]})}),(0,i.jsxs)(s.NP,{children:[(0,i.jsx)(j.I,{eventKey:0,id:"refTabSbomsSection",ref:w,"aria-label":"Related SBOMs",children:(0,i.jsx)(et,{vulnerabilityId:r})}),(0,i.jsx)(j.I,{eventKey:1,id:"refTabAdvisoriesSection",ref:K,"aria-label":"Related Advisories",hidden:!0,children:(0,i.jsx)(B,{isFetching:y,fetchError:T,advisories:(null==n?void 0:n.advisories)||[]})})]})]})}},52030:function(e,r,n){n.d(r,{DK:()=>u,fd:()=>c,p6:()=>h});var i=n(79192),t=n(1183),l=n(16072),s=n(50576),a=n(40371),d=n(49988);let o="vulnerabilities",c=function(){var e,r,n;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:u,isLoading:h,error:x,refetch:m}=(0,t.a)({queryKey:[o,l],queryFn:()=>(0,a.b5)({client:s.L,query:(0,i._)({},(0,d.rm)(l))}),enabled:!c});return{result:{data:(null==u||null==(e=u.data)?void 0:e.items)||[],total:null!=(n=null==u||null==(r=u.data)?void 0:r.total)?n:0,params:l},isFetching:h,fetchError:x,refetch:m}},u=e=>{var r;let n={ids:e.reduce((e,r,n)=>(n%100==0?e.push([r]):e[e.length-1].push(r),e),[]),dataResolver:async e=>(await (0,a.BJ)({client:s.L,body:{purls:e}})).data},i=(0,l.h)({queries:n.ids.map(e=>({queryKey:[o,e],queryFn:()=>n.dataResolver(e),retry:!1}))}),t=i.some(e=>{let{isLoading:r}=e;return r}),d=i.find(e=>{let{error:r}=e;return!!r}),c={};if(!t)for(let e of i.map(e=>{var r;return null!=(r=null==e?void 0:e.data)?r:{}}))for(let[r,n]of Object.entries(e))c[r]=n;return{analysisResponse:c,isFetching:t,fetchError:null!=(r=null==d?void 0:d.error)?r:void 0}},h=e=>{let{data:r,isLoading:n,error:i}=(0,t.a)({queryKey:[o,e],queryFn:()=>(0,a.OG)({client:s.L,path:{id:e}})});return{vulnerability:null==r?void 0:r.data,isFetching:n,fetchError:i}}},41135:function(e,r,n){n.d(r,{T:()=>a});var i=n(79192),t=n(53195),l=n(27378),s=n(74502);let a=(e,r)=>(0,l.useMemo)(()=>e&&0!==e.length?e.map(e=>(0,t._)((0,i._)({},e),{[s.nM]:r(e)})):[],[e,r])}}]);