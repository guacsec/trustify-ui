"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["944"],{6348:function(e,i,n){n.d(i,{Q:()=>c});var l=n(24246),r=n(78700),t=n(79551),s=n(32489),a=n(90519),d=n(35072);let c=e=>{let{isOpen:i,title:n,titleIconVariant:c,message:o,confirmBtnLabel:u,cancelBtnLabel:h,inProgress:x,confirmBtnVariant:j,onClose:b,onConfirm:v,onCancel:m}=e,p=(0,l.jsx)(r.zx,{id:"confirm-dialog-button","aria-label":"confirm",variant:j,isDisabled:x,onClick:v,children:u},"confirm"),y=m?(0,l.jsx)(r.zx,{id:"confirm-cancel-button","aria-label":"cancel",variant:r.Wu.link,isDisabled:x,onClick:m,children:h},"cancel"):void 0;return(0,l.jsxs)(t.u,{id:"confirm-dialog",variant:"small",isOpen:i,onClose:b,"aria-label":"Confirm dialog",children:[(0,l.jsx)(s.x,{title:n,titleIconVariant:c}),(0,l.jsx)(a.f,{children:o}),(0,l.jsx)(d.m,{children:m?(0,l.jsxs)(l.Fragment,{children:[p,y]}):p})]})}},24502:function(e,i,n){n.d(i,{M:()=>y});var l=n(24246),r=n(27378),t=n(27317),s=n(93095),a=n(54816),d=n(68802),c=n(31757),o=n(74607),u=n(70400),h=n(51088),x=n(58730),j=n(78700),b=n(63706),v=n(32947),m=n(40165);let p=e=>{let i=(0,v.W)(e);return{id:i,name:i}},y=e=>{let{title:i,value:n,isDisabled:y,onSave:f,onClose:g,options:_,onInputChange:C}=e,[w,S]=r.useState(Object.entries(n).map(e=>{let[i,n]=e;return p({key:i,value:n})}));return(0,l.jsxs)(t.K,{hasGutter:!0,children:[(0,l.jsx)(s.v,{children:"Labels help you organize and select resources. Adding labels below will let you query for objects that have similar, overlapping or dissimilar labels."}),(0,l.jsx)(s.v,{children:(0,l.jsx)(a.c,{label:(0,l.jsx)(d.V,{component:"h4",children:i}),children:(0,l.jsx)(c.Z,{children:(0,l.jsx)(o.e,{style:{padding:10,minHeight:10},defaultIsOpen:!0,numLabels:10,children:w.sort((e,i)=>(0,b.KF)(e.name).localeCompare((0,b.KF)(i.name))).map((e,i)=>(0,l.jsx)(u._,{color:"blue",onClose:()=>{let e=[...w];e.splice(i,1),S(e)},children:(0,b.KF)(e.labelName||e.name)},e.id))})})})}),(0,l.jsx)(s.v,{children:(0,l.jsxs)(h.l,{onSubmit:e=>e.preventDefault(),children:[(0,l.jsx)(m.F,{selections:w,options:_.map(e=>{let{key:i,value:n}=e;return p({key:i,value:n})}),onChange:S,placeholderText:"Add label",searchInputAriaLabel:"labels-select-toggle",onSearchChange:C,onCreateNewOption:e=>({id:e,name:e}),validateNewOption:e=>!!e&&e.trim().length>0&&/^(?!.*\\)(?!\s*\\)(?!\s*=)[^=\\\s][^=\\]*\s*=?\s*[^=\\]+$/.test(e),filterBeforeOnChange:(e,i)=>{let n=(0,v.nE)((0,b.KF)(i.name));return e.filter(e=>(0,v.nE)((0,b.KF)(e.name)).key!==n.key)}}),(0,l.jsxs)(x.W,{children:[(0,l.jsx)(j.zx,{type:"button",id:"submit","aria-label":"submit",variant:j.Wu.primary,isDisabled:y,onClick:()=>{f(w.map(e=>(0,v.nE)((0,b.KF)(e.name))).reduce((e,i)=>{let{key:n,value:l}=i;return e[n]=null!=l?l:"",e},{}))},children:"Save"}),(0,l.jsx)(j.zx,{type:"button",id:"cancel","aria-label":"cancel",variant:j.Wu.link,isDisabled:y,onClick:g,children:"Cancel"})]})]})})]})}},73827:function(e,i,n){n.d(i,{C:()=>d});var l=n(24246),r=n(74607),t=n(70400),s=n(85295),a=n(32947);let d=e=>{let{value:i,defaultIsOpen:n,onClick:d}=e;return(0,l.jsx)(r.e,{defaultIsOpen:n,numLabels:5,children:Object.entries(i).sort((e,i)=>{let[n]=e,[l]=i;return l.localeCompare(n)}).map(e=>{let[i,n]=e;return(0,l.jsx)(t._,{color:"blue",onClick:d?()=>d({key:i,value:n}):void 0,children:(0,l.jsx)(s.k,{content:(0,a.W)({key:i,value:n})})},i)})})}},37818:function(e,i,n){n.d(i,{u:()=>a});var l=n(24246),r=n(8305),t=n(13754),s=n(39826);let a=e=>e.isFetching?e.isFetchingState||(0,l.jsx)(r.b,{children:(0,l.jsx)(t.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,l.jsx)(s.y,{}):e.children},3586:function(e,i,n){n.d(i,{j:()=>t});var l=n(24246),r=n(27378);let t=e=>{let{children:i}=e,[n,t]=r.useState(!1);return(0,l.jsx)(l.Fragment,{children:i(n,t)})}},24200:function(e,i,n){n.d(i,{G:()=>r});var l=n(24246);let r=e=>{let{vulnerability:i}=e;return(0,l.jsxs)("p",{children:[i.withdrawn&&(0,l.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},73227:function(e,i,n){n.d(i,{i:()=>d});var l=n(2926),r=n(87017),t=n(50576),s=n(40371),a=n(63706);let d=()=>({downloadAdvisory:(e,i)=>{(0,s.Em)({client:t.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(n=>{(0,l.saveAs)(new Blob([n.data]),i||"".concat(e,".json"))})},downloadSBOM:(e,i)=>{(0,s.XW)({client:t.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(n=>{(0,l.saveAs)(new Blob([n.data]),i||"".concat(e,".json"))})},downloadSBOMLicenses:e=>{(0,r.Co)(e).then(i=>{var n,r;let t=null,s=null==(r=i.headers)||null==(n=r["content-disposition"])?void 0:n.toString();s&&(t=(0,a.lj)(s)),(0,l.saveAs)(new Blob([i.data]),t||"".concat(e,".tar.gz"))})}})},74247:function(e,i,n){n.r(i),n.d(i,{default:()=>ev});var l=n(79192),r=n(53195),t=n(24246),s=n(27378),a=n(6501),d=n(45043),c=n(97339),o=n(18091),u=n(11192),h=n(32591),x=n(34747),j=n(46770),b=n(68802),v=n(70400),m=n(32939),p=n(24620),y=n(37961),f=n(69265),g=n(25138),_=n(2075),C=n(27090),w=n(75165),S=n(59086),T=n(78700),E=n(74502),F=n(27031),K=n(6348),k=n(37818),A=n(15726),I=n(73227),L=n(17598),O=n(65872),D=n(87727),P=n(3498),q=n(31757),B=n(87069),V=n(51527),N=n(30329),M=n(50689),W=n(67761),z=n(81391),R=n(79551),Z=n(32489),G=n(90519),Q=n(26235),H=n(73827),U=n(63706),Y=n(15167);let J=e=>{var i,n;let{advisory:l}=e,[r,a]=s.useState(!1),d=()=>{a(!1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(D.r,{hasGutter:!0,children:[(0,t.jsx)(P.P,{md:4,children:(0,t.jsxs)(q.Z,{isFullHeight:!0,children:[(0,t.jsx)(B.l,{children:"Overview"}),(0,t.jsx)(V.e,{children:(0,t.jsxs)(N.o,{children:[(0,t.jsxs)(M.g,{children:[(0,t.jsx)(W.M,{children:"Title"}),(0,t.jsx)(z.b,{children:l.title})]}),(0,t.jsxs)(M.g,{children:[(0,t.jsx)(W.M,{children:"Type"}),(0,t.jsx)(z.b,{children:l.labels.type})]}),(0,t.jsxs)(M.g,{children:[(0,t.jsx)(W.M,{children:"Size"}),(0,t.jsx)(z.b,{children:(0,O.Z)(l.size)})]}),(0,t.jsxs)(M.g,{children:[(0,t.jsxs)(W.M,{children:["Labels ","",(0,t.jsx)(T.zx,{variant:T.Wu.link,size:"sm",icon:(0,t.jsx)(Q.ZP,{}),iconPosition:"end",onClick:()=>a(!0),children:"Edit"})]}),(0,t.jsx)(z.b,{children:(0,t.jsx)(q.Z,{isCompact:!0,children:(0,t.jsx)(V.e,{children:l.labels&&(0,t.jsx)(H.C,{defaultIsOpen:!0,value:l.labels})})})})]})]})})]})}),(0,t.jsx)(P.P,{md:4,children:(0,t.jsxs)(q.Z,{isFullHeight:!0,children:[(0,t.jsx)(B.l,{children:"Publisher"}),(0,t.jsx)(V.e,{children:(0,t.jsxs)(N.o,{children:[(0,t.jsxs)(M.g,{children:[(0,t.jsx)(W.M,{children:"Name"}),(0,t.jsx)(z.b,{children:null==(i=l.issuer)?void 0:i.name})]}),(0,t.jsxs)(M.g,{children:[(0,t.jsx)(W.M,{children:"Contact details"}),(0,t.jsx)(z.b,{children:null==(n=l.issuer)?void 0:n.website})]})]})})]})}),(0,t.jsx)(P.P,{md:4,children:(0,t.jsxs)(q.Z,{isFullHeight:!0,children:[(0,t.jsx)(B.l,{children:"Tracking"}),(0,t.jsx)(V.e,{children:(0,t.jsxs)(N.o,{children:[(0,t.jsxs)(M.g,{children:[(0,t.jsx)(W.M,{children:"ID"}),(0,t.jsx)(z.b,{children:l.identifier})]}),(0,t.jsxs)(M.g,{children:[(0,t.jsx)(W.M,{children:"Initial release date"}),(0,t.jsx)(z.b,{children:(0,U.p6)(l.published)})]}),(0,t.jsxs)(M.g,{children:[(0,t.jsx)(W.M,{children:"Current release date"}),(0,t.jsx)(z.b,{children:(0,U.p6)(l.modified)})]})]})})]})})]}),(0,t.jsxs)(R.u,{isOpen:r,variant:"medium",title:"Edit labels",onClose:d,children:[(0,t.jsx)(Z.x,{title:"Edit labels"}),(0,t.jsx)(G.f,{children:(0,t.jsx)(Y.q,{advisory:l,onClose:d})})]})]})};var X=n(70715),$=n(40982),ee=n(89226),ei=n(4835),en=n(14350),el=n(11165),er=n(89330),et=n(31423),es=n(94154),ea=n(9905),ed=n(7615),ec=n(57524),eo=n(3804),eu=n(31336),eh=n(3586),ex=n(24200),ej=n(49988);let eb=e=>{let{isFetching:i,fetchError:n,vulnerabilities:s}=e,d=(0,ej.sz)({tableName:"vulnerability-table",idProperty:"identifier",items:s,isLoading:i,columnNames:{identifier:"ID",title:"Title",discovery:"Discovery",release:"Release",score:"Score",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.identifier}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:c,numRenderedColumns:o,propHelpers:{toolbarProps:u,paginationToolbarItemProps:h,paginationProps:x,tableProps:j,getThProps:b,getTrProps:v,getTdProps:m},expansionDerivedState:{isCellExpanded:p}}=d;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(X.o,(0,r._)((0,l._)({},u),{"aria-label":"vulnerability toolbar",children:(0,t.jsx)($.c,{children:(0,t.jsx)(ee.E,(0,r._)((0,l._)({},h),{children:(0,t.jsx)(eo.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:x})}))})})),(0,t.jsxs)(ei.i,(0,r._)((0,l._)({},j),{"aria-label":"vulnerability table",children:[(0,t.jsx)(en.h,{children:(0,t.jsx)(el.Tr,{children:(0,t.jsxs)(eu.qK,(0,r._)((0,l._)({},d),{children:[(0,t.jsx)(er.Th,(0,l._)({},b({columnKey:"identifier"}))),(0,t.jsx)(er.Th,(0,l._)({},b({columnKey:"title"}))),(0,t.jsx)(er.Th,(0,l._)({},b({columnKey:"discovery"}))),(0,t.jsx)(er.Th,(0,l._)({},b({columnKey:"release"}))),(0,t.jsx)(er.Th,(0,l._)({},b({columnKey:"score"}))),(0,t.jsx)(er.Th,(0,l._)({},b({columnKey:"cwe"})))]}))})}),(0,t.jsx)(eu.hp,{isLoading:i,isError:!!n,isNoData:0===s.length,numRenderedColumns:o,children:null==c?void 0:c.map((e,i)=>{var n;return(0,t.jsx)(et.p,{isExpanded:p(e),children:(0,t.jsx)(el.Tr,(0,r._)((0,l._)({},v({item:e})),{children:(0,t.jsxs)(eu.Cx,(0,r._)((0,l._)({},d),{item:e,rowIndex:i,children:[(0,t.jsx)(es.Td,(0,r._)((0,l._)({width:15,modifier:"breakWord"},m({columnKey:"identifier"})),{children:(0,t.jsx)(a.rU,{to:(0,a.Gn)(F.nB.vulnerabilityDetails,{vulnerabilityId:e.identifier}),children:e.identifier})})),(0,t.jsx)(eh.j,{children:(i,n)=>(0,t.jsx)(es.Td,(0,r._)((0,l._)({width:40,modifier:"truncate",onFocus:()=>n(!0),onBlur:()=>n(!1),tabIndex:0},m({columnKey:"title"})),{children:(0,t.jsx)(ea.cE,{focused:i,wrapModifier:"truncate",children:(0,t.jsx)(ex.G,{vulnerability:e})})}))}),(0,t.jsx)(es.Td,(0,r._)((0,l._)({width:15},m({columnKey:"discovery"})),{children:(0,U.p6)(e.discovered)})),(0,t.jsx)(es.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},m({columnKey:"release"})),{children:(0,U.p6)(e.released)})),(0,t.jsx)(es.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},m({columnKey:"score"})),{children:e.severity&&(0,t.jsx)(ec.o,{value:(0,ed.g)(e.severity),score:null!=(n=e.score)?n:null,showLabel:!0,showScore:!0})})),(0,t.jsx)(es.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},m({columnKey:"cwe"})),{children:e.cwes.join(", ")}))]}))}))},e.identifier)})})]})),(0,t.jsx)(eo.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:x})]})},ev=()=>{var e,i;let n=(0,a.s0)(),{pushNotification:O}=s.useContext(A.c),D=(0,F.ZX)(F.Uo.ADVISORY_ID),{advisory:P,isFetching:q,fetchError:B}=(0,L.gw)(D),[V,N]=s.useState(!1),M=()=>{N(!V)},{downloadAdvisory:W}=(0,I.i)(),[z,R]=s.useState(!1),{mutate:Z,isPending:G}=(0,L.y2)(e=>{R(!1),O({title:(0,E.TR)(e),variant:"success"}),n("/advisories")},e=>{O({title:(0,E.BS)(e),variant:"danger"})}),[Q,H]=s.useState(0),U=s.createRef(),Y=s.createRef();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.NP,{type:"breadcrumb",children:(0,t.jsxs)(c.a,{children:[(0,t.jsx)(o.g,{children:(0,t.jsx)(a.rU,{to:F.nB.advisories,children:"Advisories"})}),(0,t.jsx)(o.g,{isActive:!0,children:"Advisory details"})]})}),(0,t.jsx)(d.NP,{children:(0,t.jsxs)(u.P,{children:[(0,t.jsx)(h.J,{isFilled:!0,children:(0,t.jsxs)(x.k,{children:[(0,t.jsx)(j.B,{spacer:{default:"spacerSm"},children:(0,t.jsxs)(b.V,{children:[(0,t.jsx)(b.V,{component:"h1",children:null!=(i=null!=(e=null==P?void 0:P.document_id)?e:D)?i:""}),(0,t.jsx)(b.V,{component:"p",children:"Advisory detail information"})]})}),(0,t.jsx)(j.B,{children:(null==P?void 0:P.labels.type)&&(0,t.jsx)(v._,{color:"blue",children:null==P?void 0:P.labels.type})})]})}),(0,t.jsx)(h.J,{children:P&&(0,t.jsx)(m.L,{isOpen:V,onSelect:()=>N(!1),onOpenChange:e=>N(e),popperProps:{position:"right"},toggle:e=>(0,t.jsx)(p.O_,{ref:e,onClick:M,isExpanded:V,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,t.jsxs)(y.s,{children:[(0,t.jsx)(f.h,{onClick:()=>{D&&W(D,(null==P?void 0:P.identifier)?"".concat(null==P?void 0:P.identifier,".json"):"".concat(D,".json"))},children:"Download Advisory"},"advisory"),(0,t.jsx)(g.i,{component:"li"},"separator"),(0,t.jsx)(f.h,{onClick:()=>R(!0),children:"Delete"},"delete")]})})})]})}),(0,t.jsx)(d.NP,{children:(0,t.jsxs)(_.m,{mountOnEnter:!0,activeKey:Q,onSelect:(e,i)=>{H(i)},"aria-label":"Tabs that contain the Advisory information",role:"region",children:[(0,t.jsx)(C.O,{eventKey:0,title:(0,t.jsx)(w.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:U}),(0,t.jsx)(C.O,{eventKey:1,title:(0,t.jsx)(w.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:Y})]})}),(0,t.jsxs)(d.NP,{children:[(0,t.jsx)(S.I,{eventKey:0,id:"refTabInfoSection",ref:U,"aria-label":"Information of the Advisory",children:(0,t.jsx)(k.u,{isFetching:q,fetchError:B,children:P&&(0,t.jsx)(J,{advisory:P})})}),(0,t.jsx)(S.I,{eventKey:1,id:"refVulnerabilitiesSection",ref:Y,"aria-label":"Vulnerabilities within the Advisory",hidden:!0,children:(0,t.jsx)(eb,{isFetching:q,fetchError:B,vulnerabilities:(null==P?void 0:P.vulnerabilities)||[]})})]}),(0,t.jsx)(K.Q,(0,r._)((0,l._)({},(0,E.gn)(P)),{inProgress:G,titleIconVariant:"warning",isOpen:z,confirmBtnVariant:T.Wu.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>R(!1),onClose:()=>R(!1),onConfirm:()=>{P&&Z(P.uuid)}}))]})}},15167:function(e,i,n){n.d(i,{q:()=>d});var l=n(24246),r=n(27378),t=n(24502),s=n(15726),a=n(17598);let d=e=>{let{advisory:i,onClose:n}=e,{pushNotification:d}=r.useContext(s.c),[c,o]=r.useState(""),[u,h]=r.useState(""),{labels:x}=(0,a.VY)(u);r.useEffect(()=>{let e=setTimeout(()=>{h(c)},400);return()=>clearTimeout(e)},[c]);let{mutate:j,isPending:b}=(0,a.sj)(()=>{d({title:"Labels updated for Advisory ".concat(i.document_id),variant:"success"}),n()},e=>{d({title:"Error while updating labels for Advisory ".concat(i.document_id),variant:"danger"})});return(0,l.jsx)(t.M,{title:"Labels of Advisory: ".concat(i.document_id),value:i.labels,isDisabled:b,onSave:e=>{j({id:i.uuid,labels:e})},onClose:n,onInputChange:o,options:x})}},17598:function(e,i,n){n.d(i,{N7:()=>m,VY:()=>v,gw:()=>p,sj:()=>g,tG:()=>f,y2:()=>y});var l=n(79192),r=n(53195),t=n(70186),s=n(1183),a=n(24038),d=n(68e3),c=n(75503),o=n(50576),u=n(40371),h=n(87017),x=n(49988),j=n(95169);let b="advisories",v=e=>{let{data:i,isLoading:n,error:l,refetch:r}=(0,s.a)({queryKey:[b,"labels",e],queryFn:()=>(0,u.sf)({client:o.L,query:{limit:10,filter_text:e}}),placeholderData:a.Wk});return{labels:(null==i?void 0:i.data)||[],isFetching:n,fetchError:l,refetch:r}},m=function(){var e,i,n;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=(0,x.rm)(a),{q:j}=h,v=(0,t._)(h,["q"]),m=(0,x.Rb)(d),{data:p,isLoading:y,error:f,refetch:g}=(0,s.a)({queryKey:[b,a,m],queryFn:()=>(0,u.A1)({client:o.L,query:(0,r._)((0,l._)({},v),{q:[j,m].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==p||null==(e=p.data)?void 0:e.items)||[],total:null!=(n=null==p||null==(i=p.data)?void 0:i.total)?n:0,params:a},isFetching:y,fetchError:f||null,refetch:g}},p=e=>{let{data:i,isLoading:n,error:l}=(0,s.a)({queryKey:[b,e],queryFn:()=>(0,u.pB)({client:o.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==i?void 0:i.data,isFetching:n,fetchError:l}},y=(e,i)=>{let n=(0,d.NL)();return(0,c.D)({mutationFn:async e=>(await (0,u.Wr)({client:o.L,path:{key:e}})).data,onSuccess:async(i,l)=>{e(i,l),await n.invalidateQueries({queryKey:[b]})},onError:async e=>{i(e),await n.invalidateQueries({queryKey:[b]})}})},f=()=>{let e=(0,d.NL)();return(0,j.V)({parallel:!0,uploadFn:(e,i)=>(0,h.Cu)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[b]})}})},g=(e,i)=>{let n=(0,d.NL)();return(0,c.D)({mutationFn:e=>(0,u.m5)({client:o.L,path:{id:e.id},body:e.labels}),onSuccess:async(i,l)=>{e(),await n.invalidateQueries({queryKey:[b]})},onError:i})}}}]);