"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["962"],{85790:function(e,l,t){t.d(l,{a:()=>a});var i=t(62540),r=t(69548);let a=e=>{let{value:l}=e;return(0,i.jsx)(i.Fragment,{children:Object.entries(l).map(e=>{let[l,t]=e;return(0,i.jsx)(r.J,{isCompact:!0,children:"".concat(l,"=").concat(t)},"".concat(l,"=").concat(t))})})}},77029:function(e,l,t){t.d(l,{l:()=>a});var i=t(62540),r=t(33468);let a=e=>{let{packageId:l,children:t}=e,{pkg:a,isFetching:n,fetchError:s}=(0,r.Si)(l);return(0,i.jsx)(i.Fragment,{children:t(a,n,s)})}},35913:function(e,l,t){t.d(l,{$:()=>h,G:()=>v});var i=t(32909),r=t(42642),a=t(63696),n=t(27875),s=t(33468);let u=(e,l)=>e.vulnerability.identifier===l.vulnerability.identifier&&e.vulnerabilityStatus===l.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:(0,i._)({},c),fixed:(0,i._)({},c),not_affected:(0,i._)({},c),known_not_affected:(0,i._)({},c),under_investigation:(0,i._)({},c)}},d=e=>{let l=e.flatMap(e=>{var l;return(null!=(l=e.status)?l:[]).map(l=>{let t=(0,n.U)(l.average_severity);return{vulnerability:(0,r._)((0,i._)({},l.vulnerability),{average_severity:t,average_score:l.average_score}),vulnerabilityStatus:l.status,advisory:e}})}).reduce((e,l)=>{let t,a=e.find(e=>u(e,l));if(a)t=[...e.filter(e=>!u(e,a)),(0,r._)((0,i._)({},a),{relatedSboms:[...a.relatedSboms,{advisory:l.advisory}]})];else{let i={vulnerability:l.vulnerability,vulnerabilityStatus:l.vulnerabilityStatus,relatedSboms:[{advisory:l.advisory}]};t=[...e.slice(),i]}return t},[]),t=l.reduce((e,l)=>{let t=l.vulnerabilityStatus,a=l.vulnerability.average_severity,n=e.vulnerabilityStatus[t];return Object.assign(e,{vulnerabilityStatus:(0,r._)((0,i._)({},e.vulnerabilityStatus),{[t]:{total:n.total+1,severities:(0,r._)((0,i._)({},n.severities),{[a]:n.severities[a]+1})}})})},(0,i._)({},o));return{vulnerabilities:l,summary:t}},v=e=>{let{pkg:l,isFetching:t,fetchError:i}=(0,s.Si)(e);return{data:a.useMemo(()=>d((null==l?void 0:l.advisories)||[]),[l]),isFetching:t,fetchError:i}},h=e=>({data:a.useMemo(()=>d((null==e?void 0:e.advisories)||[]),[e])})},55178:function(e,l,t){t.d(l,{H:()=>c});var i=t(62540),r=t(15461),a=t(35913),n=t(24296),s=t(6160),u=t(92107);let c=e=>{let{pkg:l,isFetching:t,fetchError:c}=e,{data:o}=(0,a.$)(l);return(0,i.jsx)(n.a,{isFetching:t,fetchError:c,isFetchingState:(0,i.jsx)(s.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,i.jsx)(u.D,{error:e}),children:(0,i.jsx)(r.n,{severities:o.summary.vulnerabilityStatus.affected.severities})})}},13701:function(e,l,t){t.d(l,{Y:()=>d,a:()=>v});var i=t(32909),r=t(42642),a=t(62540),n=t(63696),s=t(98259);t(1480);var u=t(73470),c=t(23909),o=t(33468);let d=n.createContext({}),v=e=>{let{children:l}=e,t=(0,u.MM)({tableName:"packages",persistenceKeyPrefix:s.rt.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",licenses:"Licenses",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:s._G,title:"Filter text",placeholderText:"Search",type:"search"},{categoryKey:"type",title:"Type",placeholderText:"Type",type:"multiselect",selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:"multiselect",selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:v,total:h},isFetching:p,fetchError:m}=(0,o.Lx)((0,u.Ng)((0,r._)((0,i._)({},t),{hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}}))),_=n.useMemo(()=>v.map(e=>(0,r._)((0,i._)({},e),{decomposedPurl:(0,c.fe)(e.purl)})),[v]),y=(0,u.PB)((0,r._)((0,i._)({},t),{idProperty:"uuid",currentPageItems:_,totalItemCount:h,isLoading:p}));return(0,a.jsx)(d.Provider,{value:{totalItemCount:h,isFetching:p,fetchError:m,tableControls:y},children:l})}},66005:function(e,l,t){t.d(l,{N:()=>F});var i=t(32909),r=t(42642),a=t(62540),n=t(63696),s=t(74343),u=t(26917),c=t(16646),o=t(21758),d=t(40384),v=t(28516),h=t(78517),p=t(38139),m=t(52526),_=t(85790),y=t(93826),x=t(30448),b=t(52362),g=t(13701),j=t(55178),f=t(94279),T=t(16172),S=t(77029),P=t(6160),k=t(24296),K=t(92107);let E=e=>{var l,t,i,r;let{pkg:n,isFetching:u,fetchError:c}=e;return(0,a.jsx)(k.a,{isFetching:u,fetchError:c,isFetchingState:(0,a.jsx)(P.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,a.jsx)(K.D,{error:e}),children:(0,a.jsxs)(s.k2,{to:(0,s.tW)(b.Jh.packageDetails,{packageId:(null==n?void 0:n.uuid)||""}),children:[null!=(i=null==n||null==(l=n.licenses)?void 0:l.length)?i:0," ",(null!=(r=null==n||null==(t=n.licenses)?void 0:t.length)?r:0)>1?"Licenses":"License"]})})},F=()=>{let{isFetching:e,fetchError:l,totalItemCount:t,tableControls:P}=n.useContext(g.Y),{numRenderedColumns:k,currentPageItems:K,propHelpers:{paginationProps:F,tableProps:w,getThProps:q,getTrProps:C,getTdProps:M,getExpandedContentTdProps:N},expansionDerivedState:{isCellExpanded:L}}=P;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u.X,(0,r._)((0,i._)({},w),{"aria-label":"Package table",children:[(0,a.jsx)(c.d,{children:(0,a.jsx)(o.Tr,{children:(0,a.jsxs)(x.Ze,(0,r._)((0,i._)({},P),{children:[(0,a.jsx)(d.Th,(0,i._)({},q({columnKey:"name"}))),(0,a.jsx)(d.Th,(0,i._)({},q({columnKey:"namespace"}))),(0,a.jsx)(d.Th,(0,i._)({},q({columnKey:"version"}))),(0,a.jsx)(d.Th,(0,i._)({},q({columnKey:"type"}))),(0,a.jsx)(d.Th,(0,i._)({},q({columnKey:"licenses"}))),(0,a.jsx)(d.Th,(0,i._)({},q({columnKey:"path"}))),(0,a.jsx)(d.Th,(0,i._)({},q({columnKey:"qualifiers"}))),(0,a.jsx)(d.Th,(0,i._)({},q({columnKey:"vulnerabilities"})))]}))})}),(0,a.jsx)(x.nJ,{isLoading:e,isError:!!l,isNoData:0===t,numRenderedColumns:k,children:K.map((e,l)=>(0,a.jsx)(S.l,{packageId:e.uuid,children:(t,n,u)=>{var c,d,y,g,S,k,K,F;return(0,a.jsxs)(v.N,{children:[(0,a.jsx)(o.Tr,(0,r._)((0,i._)({},C({item:e})),{children:(0,a.jsxs)(x.Oi,(0,r._)((0,i._)({},P),{item:e,rowIndex:l,children:[(0,a.jsx)(h.Td,(0,r._)((0,i._)({width:15,modifier:"breakWord"},M({columnKey:"name"})),{children:(0,a.jsx)(s.k2,{to:(0,s.tW)(b.Jh.packageDetails,{packageId:e.uuid}),children:e.decomposedPurl?null==(c=e.decomposedPurl)?void 0:c.name:e.purl})})),(0,a.jsx)(h.Td,(0,r._)((0,i._)({width:15,modifier:"truncate"},M({columnKey:"namespace"})),{children:null==(d=e.decomposedPurl)?void 0:d.namespace})),(0,a.jsx)(h.Td,(0,r._)((0,i._)({width:10,modifier:"truncate"},M({columnKey:"version"})),{children:null==(y=e.decomposedPurl)?void 0:y.version})),(0,a.jsx)(h.Td,(0,r._)((0,i._)({width:10,modifier:"truncate"},M({columnKey:"type"})),{children:null==(g=e.decomposedPurl)?void 0:g.type})),(0,a.jsx)(h.Td,(0,r._)((0,i._)({width:10,modifier:"truncate"},M({columnKey:"licenses",isCompoundExpandToggle:!0,item:e,rowIndex:l})),{children:(0,a.jsx)(E,{pkg:t,isFetching:n,fetchError:u})})),(0,a.jsx)(h.Td,(0,r._)((0,i._)({width:10,modifier:"truncate"},M({columnKey:"path"})),{children:null==(S=e.decomposedPurl)?void 0:S.path})),(0,a.jsx)(h.Td,(0,r._)((0,i._)({width:20},M({columnKey:"qualifiers"})),{children:(null==(k=e.decomposedPurl)?void 0:k.qualifiers)&&(0,a.jsx)(_.a,{value:null==(K=e.decomposedPurl)?void 0:K.qualifiers})})),(0,a.jsx)(h.Td,(0,r._)((0,i._)({width:10},M({columnKey:"vulnerabilities"})),{children:(0,a.jsx)(j.H,{pkg:t,isFetching:n,fetchError:u})}))]}))})),L(e)?(0,a.jsx)(o.Tr,{isExpanded:!0,children:(0,a.jsx)(h.Td,(0,r._)((0,i._)({},N({item:e})),{className:m.A.pLg,children:(0,a.jsx)(p.g,{children:(0,a.jsx)("div",{className:m.A.ptLg,children:L(e,"licenses")?(0,a.jsx)(f.B8,{isPlain:!0,children:null==t||null==(F=t.licenses)?void 0:F.map((e,l)=>(0,a.jsx)(T.c,{children:e.license_name},"".concat(e.license_name,"-").concat(l)))}):null})})}))}):null]})}},e.uuid))})]})),(0,a.jsx)(y.n,{idPrefix:"package-table",isTop:!1,paginationProps:F})]})}},22549:function(e,l,t){t.d(l,{I:()=>h});var i=t(32909),r=t(42642),a=t(62540),n=t(63696),s=t(61360),u=t(35048),c=t(32490),o=t(1480),d=t(93826),v=t(13701);let h=e=>{let{showFilters:l}=e,{tableControls:t}=n.useContext(v.Y),{propHelpers:{toolbarProps:h,filterToolbarProps:p,paginationToolbarItemProps:m,paginationProps:_}}=t;return(0,a.jsx)(s.M,(0,r._)((0,i._)({},h),{"aria-label":"package-toolbar",children:(0,a.jsxs)(u.P,{children:[l&&(0,a.jsx)(o.Us,(0,i._)({},p)),(0,a.jsx)(c.T,(0,r._)((0,i._)({},m),{children:(0,a.jsx)(d.n,{idPrefix:"package-table",isTop:!0,paginationProps:_})}))]})}))}},33468:function(e,l,t){t.d(l,{Lx:()=>c,Si:()=>o,sl:()=>d});var i=t(32909),r=t(77184),a=t(96002),n=t(86141),s=t(73470);let u="packages",c=function(){var e,l,t;let c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:d,isLoading:v,error:h,refetch:p}=(0,r.I)({queryKey:[u,c],queryFn:()=>(0,n.UD)({client:a.S,query:(0,i._)({},(0,s.kd)(c))}),enabled:!o});return{result:{data:(null==d||null==(e=d.data)?void 0:e.items)||[],total:null!=(t=null==d||null==(l=d.data)?void 0:l.total)?t:0,params:c},isFetching:v,fetchError:h,refetch:p}},o=e=>{let{data:l,isLoading:t,error:i}=(0,r.I)({queryKey:[u,e],queryFn:()=>(0,n.Y0)({client:a.S,path:{key:e}})});return{pkg:null==l?void 0:l.data,isFetching:t,fetchError:i}},d=function(e){var l,t,c;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d,isLoading:v,error:h,refetch:p}=(0,r.I)({queryKey:[u,"by-sbom",e,o],queryFn:()=>(0,n.Ad)({client:a.S,path:{id:e},query:(0,i._)({},(0,s.kd)(o))})});return{result:{data:(null==d||null==(l=d.data)?void 0:l.items)||[],total:null!=(c=null==d||null==(t=d.data)?void 0:t.total)?c:0,params:o},isFetching:v,fetchError:h,refetch:p}}}}]);