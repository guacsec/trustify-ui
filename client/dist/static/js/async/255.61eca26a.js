"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["255"],{25769:function(e,i,r){r.d(i,{D:()=>l});var n=r(24246),s=r(6364);let l=e=>{let{value:i}=e;return(0,n.jsx)(n.Fragment,{children:Object.entries(i).map(e=>{let[i,r]=e;return(0,n.jsx)(s._,{isCompact:!0,children:`${i}=${r}`},`${i}=${r}`)})})}},99196:function(e,i,r){r.d(i,{V:()=>t});var n=r(24246),s=r(27378),l=r(73474),a=r(18142);let t=e=>{let{vulnerabilitiesSummary:i}=e,r=s.useMemo(()=>Object.keys(i.severities).map(e=>{let r=i.severities[e],n=a.V4[e];return{severity:e,count:r,label:n.name,color:n.color.value}}).sort((0,a.A0)(e=>e.severity)),[i]);return(0,n.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,n.jsx)(l.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${i.total}`,subTitle:"Total vulnerabilities",width:350,legendData:r.map(e=>{let{label:i,count:r}=e;return{name:`${i}: ${r}`}}),data:r.map(e=>{let{label:i,count:r}=e;return{x:i,y:r}}),labels:e=>{let{datum:i}=e;return`${i.x}: ${i.y}`},colorScale:r.map(e=>{let{color:i}=e;return i})})})}},3175:function(e,i,r){r.d(i,{o:()=>c});var n=r(24246),s=r(34747),l=r(46770),a=r(2499),t=r(35676),d=r(18142);let c=e=>{let{value:i,hideLabel:r}=e,c=d.V4[i],o=c.name;return(0,n.jsxs)(s.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,n.jsx)(l.B,{children:r?(0,n.jsx)(a.u,{content:o,children:(0,n.jsx)(t.ZP,{color:c.color.value})}):(0,n.jsx)(t.ZP,{color:c.color.value})}),!r&&(0,n.jsx)(l.B,{children:o})]})}},42835:function(e,i,r){r.d(i,{p:()=>l});var n=r(24246),s=r(40583);let l=e=>{let{paginationProps:i,isTop:r,isCompact:l=!1,idPrefix:a=""}=e;return(0,n.jsx)(s.t,{id:`${a?`${a}-`:""}pagination-${r?"top":"bottom"}`,variant:r?s.a.top:s.a.bottom,isCompact:l,...i,widgetId:"pagination-id"})}},37024:function(e,i,r){r.d(i,{hp:()=>b,qK:()=>g,Cx:()=>y});var n=r(24246),s=r(8305),l=r(13754),a=r(31423),t=r(11165),d=r(94154),c=r(48336),o=r(96582),h=r(610),x=r(68940),j=r(16668),u=r(22119);let p=e=>{let{title:i,description:r}=e;return(0,n.jsxs)(o.u,{variant:o.I.sm,children:[(0,n.jsx)(h.k,{icon:u.ZP}),(0,n.jsx)(x.D,{headingLevel:"h2",size:"lg",children:i}),r&&(0,n.jsx)(j.B,{children:r})]})},m=()=>(0,n.jsx)(p,{title:"No data available",description:"No data available to be shown here."}),b=e=>{let{numRenderedColumns:i,isLoading:r=!1,isError:o=!1,isNoData:h=!1,errorEmptyState:x=null,noDataEmptyState:j=null,children:u}=e;return(0,n.jsx)(n.Fragment,{children:r?(0,n.jsx)(a.p,{children:(0,n.jsx)(t.Tr,{children:(0,n.jsx)(d.Td,{colSpan:i,children:(0,n.jsx)(s.b,{children:(0,n.jsx)(l.$,{size:"xl"})})})})}):o?(0,n.jsx)(a.p,{"aria-label":"Table error",children:(0,n.jsx)(t.Tr,{children:(0,n.jsx)(d.Td,{colSpan:i,children:(0,n.jsx)(s.b,{children:x||(0,n.jsx)(c.y,{})})})})}):h?(0,n.jsx)(a.p,{"aria-label":"Table error",children:(0,n.jsx)(t.Tr,{children:(0,n.jsx)(d.Td,{colSpan:i,children:(0,n.jsx)(s.b,{children:j||(0,n.jsx)(m,{})})})})}):u})};var f=r(67918);let g=e=>{let{numColumnsBeforeData:i,numColumnsAfterData:r,children:s}=e;return(0,n.jsxs)(n.Fragment,{children:[Array(i).fill(null).map((e,i)=>(0,n.jsx)(f.Th,{screenReaderText:`before-data-${i}`},i)),s,Array(r).fill(null).map((e,i)=>(0,n.jsx)(f.Th,{screenReaderText:`after-data-${i}`},i))]})},y=e=>{let{isExpansionEnabled:i=!1,expandableVariant:r,isSelectionEnabled:s=!1,propHelpers:{getSingleExpandButtonTdProps:l,getSelectCheckboxTdProps:a},item:t,rowIndex:c,children:o}=e;return(0,n.jsxs)(n.Fragment,{children:[i&&"single"===r?(0,n.jsx)(d.Td,{...l({item:t,rowIndex:c})}):null,s?(0,n.jsx)(d.Td,{...a({item:t,rowIndex:c})}):null,o]})}},28986:function(e,i,r){r.d(i,{G:()=>s});var n=r(24246);let s=e=>{let{vulnerability:i}=e;return(0,n.jsxs)("p",{children:[i.withdrawn&&(0,n.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},60767:function(e,i,r){r.d(i,{i:()=>d});var n=r(2926),s=r(54774),l=r(22285),a=r(54227),t=r(62126);let d=()=>({downloadAdvisory:(e,i)=>{(0,a.Em)({client:l.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(r=>{(0,n.saveAs)(new Blob([r.data]),i||`${e}.json`)})},downloadSBOM:(e,i)=>{(0,a.XW)({client:l.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(r=>{(0,n.saveAs)(new Blob([r.data]),i||`${e}.json`)})},downloadSBOMLicenses:e=>{(0,s.Co)(e).then(i=>{let r=null,s=i.headers?.["content-disposition"]?.toString();s&&(r=(0,t.lj)(s)),(0,n.saveAs)(new Blob([i.data]),r||`${e}.tar.gz`)})}})},9280:function(e,i,r){r.r(i),r.d(i,{default:()=>eg});var n=r(24246),s=r(27378),l=r(45043),a=r(11192),t=r(32591),d=r(34747),c=r(46770),o=r(25236),h=r(25645),x=r(6364),j=r(32939),u=r(24620),p=r(37961),m=r(69265),b=r(4075),f=r(27090),g=r(75165),y=r(31762),v=r(99),T=r(24787),P=r(12621),S=r(6643),M=r(35843),k=r(60767),C=r(99915),K=r(65872),$=r(87727),w=r(3498),F=r(31757),E=r(87069),B=r(51527),O=r(74481),_=r(50689),D=r(67761),I=r(81391),N=r(81211),V=r(45882),q=r(62126);let A=e=>{let{sbom:i}=e;return(0,n.jsxs)($.r,{hasGutter:!0,children:[(0,n.jsx)(w.P,{md:4,children:(0,n.jsxs)(F.Z,{isFullHeight:!0,children:[(0,n.jsx)(E.l,{children:"Metadata"}),(0,n.jsx)(B.e,{children:(0,n.jsxs)(O.o,{children:[(0,n.jsxs)(_.g,{children:[(0,n.jsx)(D.M,{children:"Name"}),(0,n.jsx)(I.b,{"aria-label":"SBOM's name",children:i.name})]}),(0,n.jsxs)(_.g,{children:[(0,n.jsx)(D.M,{children:"Namespace"}),(0,n.jsx)(I.b,{"aria-label":"SBOM's namespace",children:i.document_id})]}),(0,n.jsxs)(_.g,{children:[(0,n.jsx)(D.M,{children:"Data License"}),(0,n.jsx)(I.b,{"aria-label":"SBOM's license",children:i.data_licenses.join(", ")})]})]})})]})}),(0,n.jsx)(w.P,{md:4,children:(0,n.jsxs)(F.Z,{isFullHeight:!0,children:[(0,n.jsx)(E.l,{children:"Creation"}),(0,n.jsx)(B.e,{children:(0,n.jsxs)(O.o,{children:[(0,n.jsxs)(_.g,{children:[(0,n.jsx)(D.M,{children:"Created"}),(0,n.jsx)(I.b,{"aria-label":"SBOM's creation date",children:(0,q.p6)(i.published)})]}),(0,n.jsxs)(_.g,{children:[(0,n.jsx)(D.M,{children:"Creator"}),(0,n.jsx)(I.b,{"aria-label":"SBOM's creator",children:i.authors})]})]})})]})}),(0,n.jsx)(w.P,{md:4,children:(0,n.jsxs)(F.Z,{isFullHeight:!0,children:[(0,n.jsx)(E.l,{children:"Statistics"}),(0,n.jsx)(B.e,{children:(0,n.jsxs)(O.o,{children:[(0,n.jsxs)(_.g,{children:[(0,n.jsx)(D.M,{children:"Size"}),(0,n.jsx)(I.b,{children:(0,K.Z)(i.size)})]}),(0,n.jsxs)(_.g,{children:[(0,n.jsx)(D.M,{children:"Packages"}),(0,n.jsx)(I.b,{children:i.number_of_packages})]})]})})]})}),(0,n.jsx)(w.P,{md:12,children:(0,n.jsxs)(F.Z,{isFullHeight:!0,children:[(0,n.jsx)(E.l,{children:"Package"}),(0,n.jsx)(B.e,{children:(0,n.jsxs)(O.o,{children:[(0,n.jsxs)(_.g,{children:[(0,n.jsx)(D.M,{children:"Name"}),(0,n.jsx)(I.b,{children:i.name})]}),(0,n.jsxs)(_.g,{children:[(0,n.jsx)(D.M,{children:"Version"}),(0,n.jsx)(I.b,{children:i.described_by.map(e=>e.version).join(", ")})]}),(0,n.jsxs)(_.g,{children:[(0,n.jsx)(D.M,{children:"External References"}),(0,n.jsx)(I.b,{children:(0,n.jsxs)(N.aV,{children:[i.described_by.flatMap(e=>e.cpe).map(e=>(0,n.jsx)(V.H,{children:e},e)),(0,n.jsx)(V.H,{children:i.described_by.flatMap(e=>e.purl).map(e=>e.purl)})]})})]})]})})]})})]})};var L=r(65783),R=r(27308),Z=r(40982),H=r(27763),z=r(62997),G=r(4835),X=r(14350),U=r(11165),J=r(67918),W=r(31423),Q=r(94154),Y=r(67447),ee=r(55096),ei=r(25769),er=r(42835),en=r(37024),es=r(94426),el=r(71008);let ea=e=>{let{sbomId:i}=e,{result:{data:r},isFetching:l,fetchError:a}=(0,el.D4)(i,{page:{pageNumber:1,itemsPerPage:0}}),t=(0,s.useMemo)(()=>r.flatMap(e=>e.purl).map(e=>({...e,decomposedPurl:(0,q.qX)(e.purl)})),[r]),o=(0,es.sz)({tableName:"package-table",idProperty:"uuid",items:t,isLoading:l,columnNames:{name:"Name",version:"Version",qualifiers:"Qualifiers"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","version"],getSortValues:e=>({name:`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`,version:e.version.version}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter tex",type:ee.vA.search,placeholderText:"Filter",getItemValue:e=>`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`||""}],isExpansionEnabled:!0,expandableVariant:"single"}),{currentPageItems:h,numRenderedColumns:j,propHelpers:{toolbarProps:u,filterToolbarProps:p,paginationToolbarItemProps:m,paginationProps:b,tableProps:f,getThProps:g,getTrProps:y,getTdProps:v,getExpandedContentTdProps:T},expansionDerivedState:{isCellExpanded:P}}=o;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(R.o,{...u,children:(0,n.jsxs)(Z.c,{children:[(0,n.jsx)(ee.Ki,{showFiltersSideBySide:!0,...p}),(0,n.jsx)(H.E,{...m,children:(0,n.jsx)(er.p,{idPrefix:"package-table",isTop:!0,paginationProps:b})})]})}),(0,n.jsxs)(G.i,{...f,"aria-label":"Package table",children:[(0,n.jsx)(X.h,{children:(0,n.jsx)(U.Tr,{children:(0,n.jsxs)(en.qK,{...o,children:[(0,n.jsx)(J.Th,{...g({columnKey:"name"})}),(0,n.jsx)(J.Th,{...g({columnKey:"version"})}),(0,n.jsx)(J.Th,{...g({columnKey:"qualifiers"})})]})})}),(0,n.jsx)(en.hp,{isLoading:l,isError:!!a,isNoData:t?.length===0,numRenderedColumns:j,children:h?.map((e,i)=>n.jsxs(W.p,{children:[n.jsx(U.Tr,{...y({item:e}),children:n.jsxs(en.Cx,{...o,item:e,rowIndex:i,children:[n.jsx(Q.Td,{width:30,...v({columnKey:"name"}),children:n.jsxs(d.k,{children:[n.jsx(c.B,{spacer:{default:"spacerSm"},children:(()=>{let i=e.decomposedPurl?.name||"",r=e.decomposedPurl?.namespace?`/${e.decomposedPurl.namespace}`:"";return`${i}${r}`})()}),n.jsx(c.B,{children:n.jsx(x._,{isCompact:!0,color:"blue",children:e.decomposedPurl?.type})})]})}),n.jsx(Q.Td,{width:20,...v({columnKey:"version"}),children:e.decomposedPurl?.version}),n.jsx(Q.Td,{width:50,...v({columnKey:"qualifiers"}),children:e.decomposedPurl?.qualifiers&&n.jsx(ei.D,{value:e.decomposedPurl?.qualifiers})})]})}),P(e)?n.jsxs(U.Tr,{isExpanded:!0,children:[n.jsx(Q.Td,{}),n.jsx(Q.Td,{...T({item:e}),className:z.Z.pyLg,children:n.jsx(Y.G,{children:n.jsxs(O.o,{columnModifier:{default:"3Col"},children:[n.jsxs(_.g,{children:[n.jsx(D.M,{children:"Packages"}),n.jsx(I.b,{children:n.jsx(N.aV,{children:n.jsx(V.H,{children:n.jsx(L.rU,{to:`/packages/${e.uuid}`,children:e.purl})})})})]}),n.jsxs(_.g,{children:[n.jsx(D.M,{children:"Base package"}),n.jsx(I.b,{children:e.base.purl})]}),n.jsxs(_.g,{children:[n.jsx(D.M,{children:"Versions"}),n.jsx(I.b,{children:n.jsx(N.aV,{children:n.jsx(V.H,{children:e.version.version})})})]})]})})})]}):null]},e.uuid))})]}),(0,n.jsx)(er.p,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:b})]})};var et=r(27693),ed=r.n(et),ec=r(27317),eo=r(93095),eh=r(18142),ex=r(86602),ej=r(99196),eu=r(3175),ep=r(28986),em=r(74889),eb=r(3946);let ef=e=>{let{sbomId:i}=e,{sbom:r,isFetching:l,fetchError:a}=(0,C.p4)(i),{data:{vulnerabilities:t,summary:d},isFetching:c,fetchError:o}=(0,em.A)(i),h=s.useMemo(()=>t.filter(e=>"affected"===e.vulnerabilityStatus),[t]),x=s.useMemo(()=>h.map(e=>{let i=e.relatedPackages.flatMap(e=>e.packages).reduce((e,i)=>(e.find(e=>e.id===i.id)||e.push(i),e),[]);return{...e,summary:{totalPackages:i.length,allPackages:i}}}),[h]),j=(0,eb.T)(x,e=>`${e.vulnerability.identifier}-${e.vulnerabilityStatus}`),u=(0,es.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:j,isLoading:c,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>({id:e.vulnerability.identifier,cvss:(0,eh.XE)(e.vulnerability.average_severity),affectedDependencies:e.summary.totalPackages,published:e.vulnerability?.published?ed()(e.vulnerability.published).valueOf():0,updated:e.vulnerability?.modified?ed()(e.vulnerability.modified).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:p,numRenderedColumns:m,propHelpers:{toolbarProps:b,paginationToolbarItemProps:f,paginationProps:g,tableProps:y,getThProps:v,getTrProps:T,getTdProps:P,getExpandedContentTdProps:S},expansionDerivedState:{isCellExpanded:k}}=u;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(ec.K,{hasGutter:!0,children:[(0,n.jsx)(eo.v,{children:(0,n.jsx)(F.Z,{children:(0,n.jsx)(B.e,{children:(0,n.jsx)(M.u,{isFetching:l||c,fetchError:a,children:(0,n.jsxs)($.r,{hasGutter:!0,children:[(0,n.jsx)(w.P,{md:6,children:(0,n.jsx)(ej.V,{vulnerabilitiesSummary:d.vulnerabilityStatus.affected})}),(0,n.jsx)(w.P,{md:6,children:(0,n.jsxs)(O.o,{children:[(0,n.jsxs)(_.g,{children:[(0,n.jsx)(D.M,{children:"Name"}),(0,n.jsx)(I.b,{children:r?.name})]}),(0,n.jsxs)(_.g,{children:[(0,n.jsx)(D.M,{children:"Version"}),(0,n.jsx)(I.b,{children:r?.described_by.map(e=>e.version).join(", ")})]}),(0,n.jsxs)(_.g,{children:[(0,n.jsx)(D.M,{children:"Creation date"}),(0,n.jsx)(I.b,{children:(0,q.p6)(r?.published)})]})]})})]})})})})}),(0,n.jsxs)(eo.v,{children:[(0,n.jsx)(R.o,{...b,children:(0,n.jsx)(Z.c,{children:(0,n.jsx)(H.E,{...f,children:(0,n.jsx)(er.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:g})})})}),(0,n.jsxs)(G.i,{...y,"aria-label":"Vulnerability table",children:[(0,n.jsx)(X.h,{children:(0,n.jsx)(U.Tr,{children:(0,n.jsxs)(en.qK,{...u,children:[(0,n.jsx)(J.Th,{...v({columnKey:"id"})}),(0,n.jsx)(J.Th,{...v({columnKey:"description"})}),(0,n.jsx)(J.Th,{...v({columnKey:"cvss"})}),(0,n.jsx)(J.Th,{...v({columnKey:"affectedDependencies"})}),(0,n.jsx)(J.Th,{...v({columnKey:"published"})}),(0,n.jsx)(J.Th,{...v({columnKey:"updated"})})]})})}),(0,n.jsx)(en.hp,{isLoading:c,isError:!!o,isNoData:0===j.length,numRenderedColumns:m,children:p?.map((e,i)=>n.jsxs(W.p,{isExpanded:k(e),children:[n.jsx(U.Tr,{...T({item:e}),children:n.jsxs(en.Cx,{...u,item:e,rowIndex:i,children:[n.jsx(Q.Td,{width:15,...P({columnKey:"id"}),children:n.jsx(L.rU,{to:`/vulnerabilities/${e.vulnerability.identifier}`,children:e.vulnerability.identifier})}),n.jsx(Q.Td,{width:35,modifier:"truncate",...P({columnKey:"description"}),children:e.vulnerability&&n.jsx(ep.G,{vulnerability:e.vulnerability})}),n.jsx(Q.Td,{width:10,...P({columnKey:"cvss"}),children:n.jsx(eu.o,{value:ex.g(e.vulnerability.average_severity)})}),n.jsx(Q.Td,{width:15,modifier:"truncate",...P({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:i}),children:e.summary.totalPackages}),n.jsx(Q.Td,{width:10,modifier:"truncate",...P({columnKey:"published"}),children:q.p6(e.vulnerability?.published)}),n.jsx(Q.Td,{width:10,modifier:"truncate",...P({columnKey:"updated"}),children:q.p6(e.vulnerability?.modified)})]})}),k(e)?n.jsx(U.Tr,{isExpanded:!0,children:n.jsx(Q.Td,{...S({item:e}),children:n.jsx(Y.G,{children:k(e,"affectedDependencies")?n.jsx(n.Fragment,{children:n.jsxs(G.i,{variant:"compact",children:[n.jsx(X.h,{children:n.jsxs(U.Tr,{children:[n.jsx(J.Th,{children:"Type"}),n.jsx(J.Th,{children:"Namespace"}),n.jsx(J.Th,{children:"Name"}),n.jsx(J.Th,{children:"Version"}),n.jsx(J.Th,{children:"Path"}),n.jsx(J.Th,{children:"Qualifiers"})]})}),n.jsx(W.p,{children:e.summary.allPackages.flatMap(e=>e.name&&0===e.purl.length?[{parentName:e.name}]:e.purl.map(i=>({parentName:e.name,purlSummary:i}))).map((e,i)=>{if(e.purlSummary){let i=q.qX(e.purlSummary.purl);return n.jsxs(U.Tr,{children:[n.jsx(Q.Td,{children:i?.type}),n.jsx(Q.Td,{children:i?.namespace}),n.jsx(Q.Td,{children:n.jsx(L.rU,{to:`/packages/${e.purlSummary.uuid}`,children:i?.name})}),n.jsx(Q.Td,{children:i?.version}),n.jsx(Q.Td,{children:i?.path}),n.jsx(Q.Td,{children:i?.qualifiers&&n.jsx(ei.D,{value:i?.qualifiers})})]},e.purlSummary.uuid)}return n.jsxs(U.Tr,{children:[n.jsx(Q.Td,{}),n.jsx(Q.Td,{}),n.jsx(Q.Td,{children:e.parentName}),n.jsx(Q.Td,{}),n.jsx(Q.Td,{}),n.jsx(Q.Td,{})]},`${e.parentName}-${i}-name`)})})]})}):null})})}):null]},e._ui_unique_id))})]}),(0,n.jsx)(er.p,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:g})]})]})})},eg=()=>{let e=(0,S.ZX)(S.Uo.SBOM_ID),{sbom:i,isFetching:r,fetchError:K}=(0,C.p4)(e),{downloadSBOM:$,downloadSBOMLicenses:w}=(0,k.i)(),[F,E]=s.useState(!1),[B,O]=s.useState(0),_=s.createRef(),D=s.createRef(),I=s.createRef(),N=s.createRef(),V=()=>{E(!F)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.NP,{variant:"light",children:(0,n.jsxs)(a.P,{children:[(0,n.jsx)(t.J,{isFilled:!0,children:(0,n.jsxs)(d.k,{children:[(0,n.jsx)(c.B,{spacer:{default:"spacerSm"},children:(0,n.jsx)(o.D,{children:(0,n.jsx)(h.x,{component:"h1",children:i?.name??e??""})})}),(0,n.jsx)(c.B,{children:i?.labels.type&&(0,n.jsx)(x._,{color:"blue",children:i?.labels.type})})]})}),(0,n.jsx)(t.J,{children:(0,n.jsx)(j.L,{isOpen:F,onSelect:()=>E(!1),onOpenChange:e=>E(e),popperProps:{position:"right"},toggle:e=>(0,n.jsx)(u.O,{ref:e,onClick:V,isExpanded:F,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,n.jsxs)(p.s,{children:[(0,n.jsx)(m.h,{onClick:()=>{e&&$(e,i?.name?`${i?.name}.json`:`${e}.json`)},children:"Download SBOM"},"sbom"),(0,n.jsx)(m.h,{onClick:()=>{e&&w(e)},children:"Download License Report"},"license")]})})})]})}),(0,n.jsx)(l.NP,{type:"nav",children:(0,n.jsxs)(b.m,{mountOnEnter:!0,activeKey:B,onSelect:(e,i)=>{O(i)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,n.jsx)(f.O,{eventKey:0,title:(0,n.jsx)(g.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:_}),(0,n.jsx)(f.O,{eventKey:1,title:(0,n.jsx)(g.T,{children:"Packages"}),tabContentId:"refTabPackagesSection",tabContentRef:D}),(0,n.jsx)(f.O,{eventKey:2,title:(0,n.jsx)(g.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:I,actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.b,{ref:N,children:(0,n.jsx)(P.ZP,{})}),(0,n.jsx)(v.J,{triggerRef:N,bodyContent:(0,n.jsx)("div",{children:"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed."})})]})})]})}),(0,n.jsxs)(l.NP,{children:[(0,n.jsx)(T.I,{eventKey:0,id:"refTabInfoSection",ref:_,"aria-label":"Information of the SBOM",children:(0,n.jsx)(M.u,{isFetching:r,fetchError:K,children:i&&(0,n.jsx)(A,{sbom:i})})}),(0,n.jsx)(T.I,{eventKey:1,id:"refTabPackagesSection",ref:D,"aria-label":"Packages within the SBOM",hidden:!0,children:e&&(0,n.jsx)(ea,{sbomId:e})}),(0,n.jsx)(T.I,{eventKey:2,id:"refVulnerabilitiesSection",ref:I,"aria-label":"Vulnerabilities within the SBOM",hidden:!0,children:e&&(0,n.jsx)(ef,{sbomId:e})})]})]})}},71008:function(e,i,r){r.d(i,{D4:()=>o,ZA:()=>c,fF:()=>d});var n=r(1183),s=r(22285),l=r(54227),a=r(94426);let t="packages",d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:d,error:c,refetch:o}=(0,n.a)({queryKey:[t,e],queryFn:()=>(0,l.tj)({client:s.L,query:{...(0,a.rm)(e)}}),enabled:!i});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e},isFetching:d,fetchError:c,refetch:o}},c=e=>{let{data:i,isLoading:r,error:a}=(0,n.a)({queryKey:[t,e],queryFn:()=>(0,l.BK)({client:s.L,path:{key:e}})});return{pkg:i?.data,isFetching:r,fetchError:a}},o=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:d,error:c,refetch:o}=(0,n.a)({queryKey:[t,"by-sbom",e,i],queryFn:()=>(0,l.Pg)({client:s.L,path:{id:e},query:{...(0,a.rm)(i)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:i},isFetching:d,fetchError:c,refetch:o}}},3946:function(e,i,r){r.d(i,{T:()=>l});var n=r(27378),s=r(44072);let l=(e,i)=>(0,n.useMemo)(()=>e&&0!==e.length?e.map(e=>({...e,[s.nM]:i(e)})):[],[e,i])}}]);