"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["46"],{92934:function(e,i,t){t.d(i,{F:()=>h,P:()=>y});var l=t(79192),n=t(53195),r=t(24246),a=t(27378),s=t(74502),d=t(32947),o=t(14629),u=t(49988),c=t(17598);let y=a.createContext({}),h=e=>{var i;let{children:t}=e,[h,m]=a.useState(""),[p,x]=a.useState("");a.useEffect(()=>{let e=setTimeout(()=>{x(h)},400);return()=>clearTimeout(e)},[h]);let{labels:v}=(0,c.VY)(p),f=(0,u.vZ)({tableName:"advisory",persistenceKeyPrefix:s.yq.advisories,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Title",type:"Type",labels:"Labels",modified:"Revision",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","modified"],initialSort:{columnKey:"modified",direction:"desc"},isFilterEnabled:!0,filterCategories:[{categoryKey:s.L4,title:"Filter text",placeholderText:"Search",type:o.vA.search},{categoryKey:"modified",title:"Revision",type:o.vA.dateRange},{categoryKey:"labels",title:"Label",type:o.vA.autocompleteLabel,placeholderText:"Filter results by label",selectOptions:v.map(e=>{let i=(0,d.W)({key:e.key,value:e.value});return{value:i,label:i}}),onInputValueChange:m}],isExpansionEnabled:!1}),{result:{data:b,total:_},isFetching:j,fetchError:g}=(0,c.N7)((0,u.QO)((0,n._)((0,l._)({},f),{hubSortFieldKeys:{identifier:"identifier",modified:"modified"}})),(null!=(i=f.filterState.filterValues.labels)?i:[]).map(e=>(0,d.nE)(e))),T=(0,u.KC)((0,n._)((0,l._)({},f),{idProperty:"identifier",currentPageItems:b,totalItemCount:_,isLoading:j}));return(0,r.jsx)(y.Provider,{value:{totalItemCount:_,isFetching:j,fetchError:g,tableControls:T},children:t})}},26179:function(e,i,t){t.d(i,{H:()=>w});var l=t(79192),n=t(53195),r=t(24246),a=t(27378),s=t(65783),d=t(79551),o=t(32489),u=t(90519),c=t(4835),y=t(14350),h=t(11165),m=t(89330),p=t(31423),x=t(94154),v=t(88935),f=t(3804),b=t(31336),_=t(73227),j=t(7615),g=t(49304),T=t(63706),K=t(32947),C=t(73827),E=t(92934),q=t(15167);let w=()=>{let{isFetching:e,fetchError:i,totalItemCount:t,tableControls:w}=a.useContext(E.P),[S,L]=a.useState(null),k=null!==S,{numRenderedColumns:F,currentPageItems:P,propHelpers:{paginationProps:A,tableProps:D,getThProps:N,getTrProps:V,getTdProps:I},expansionDerivedState:{isCellExpanded:R},filterState:{filterValues:O,setFilterValues:W}}=w,{downloadAdvisory:H}=(0,_.i)(),Q=()=>{L(null)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c.i,(0,n._)((0,l._)({},D),{"aria-label":"advisory-table",children:[(0,r.jsx)(y.h,{children:(0,r.jsx)(h.Tr,{children:(0,r.jsxs)(b.qK,(0,n._)((0,l._)({},w),{children:[(0,r.jsx)(m.Th,(0,l._)({},N({columnKey:"identifier"}))),(0,r.jsx)(m.Th,(0,l._)({},N({columnKey:"title"}))),(0,r.jsx)(m.Th,(0,l._)({},N({columnKey:"type"}))),(0,r.jsx)(m.Th,(0,l._)({},N({columnKey:"labels"}))),(0,r.jsx)(m.Th,(0,l._)({},N({columnKey:"modified"}))),(0,r.jsx)(m.Th,(0,l._)({},N({columnKey:"vulnerabilities"})))]}))})}),(0,r.jsx)(b.hp,{isLoading:e,isError:!!i,isNoData:0===t,numRenderedColumns:F,children:P.map((e,i)=>{let t=e.vulnerabilities.reduce((e,i)=>{let t=(0,j.g)(i.severity);return e[t]=e[t]+1,e},{critical:0,high:0,medium:0,low:0,none:0,unknown:0});return(0,r.jsx)(p.p,{isExpanded:R(e),children:(0,r.jsx)(h.Tr,(0,n._)((0,l._)({},V({item:e})),{children:(0,r.jsxs)(b.Cx,(0,n._)((0,l._)({},w),{item:e,rowIndex:i,children:[(0,r.jsx)(x.Td,(0,n._)((0,l._)({width:15,modifier:"breakWord"},I({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:i})),{children:(0,r.jsx)(s.OL,{to:"/advisories/".concat(e.uuid),children:e.document_id})})),(0,r.jsx)(x.Td,(0,n._)((0,l._)({width:35,modifier:"truncate"},I({columnKey:"title"})),{children:e.title})),(0,r.jsx)(x.Td,(0,n._)((0,l._)({width:10},I({columnKey:"type"})),{children:e.labels.type})),(0,r.jsx)(x.Td,(0,n._)((0,l._)({width:20},I({columnKey:"labels"})),{children:(0,r.jsx)(C.C,{value:e.labels,onClick:e=>{let{key:i,value:t}=e,r=(0,K.W)({key:i,value:t}),a=O.labels;if(!(null==a?void 0:a.includes(r))){let e=a?[...a,r]:[r];W((0,n._)((0,l._)({},O),{labels:e}))}}})})),(0,r.jsx)(x.Td,(0,n._)((0,l._)({width:10,modifier:"truncate"},I({columnKey:"modified"})),{children:(0,T.p6)(e.modified)})),(0,r.jsx)(x.Td,(0,n._)((0,l._)({width:10},I({columnKey:"vulnerabilities"})),{children:(0,r.jsx)(g.u,{severities:t})})),(0,r.jsx)(x.Td,{isActionCell:!0,children:(0,r.jsx)(v.k,{items:[{title:"Edit labels",onClick:()=>{L(e)}},{isSeparator:!0},{title:"Download",onClick:()=>{H(e.uuid,"".concat(e.identifier,".json"))}}]})})]}))}))},e.identifier)})})]})),(0,r.jsx)(f.p,{idPrefix:"advisory-table",isTop:!1,paginationProps:A}),(0,r.jsxs)(d.u,{isOpen:k,variant:"medium",onClose:Q,children:[(0,r.jsx)(o.x,{title:"Edit labels"}),(0,r.jsx)(u.f,{children:S&&(0,r.jsx)(q.q,{advisory:S,onClose:Q})})]})]})}},80475:function(e,i,t){t.d(i,{P:()=>h});var l=t(79192),n=t(53195),r=t(24246),a=t(27378),s=t(70715),d=t(40982),o=t(89226),u=t(14629),c=t(3804),y=t(92934);let h=e=>{let{showFilters:i}=e,{tableControls:t}=a.useContext(y.P),{propHelpers:{toolbarProps:h,filterToolbarProps:m,paginationToolbarItemProps:p,paginationProps:x}}=t;return(0,r.jsx)(s.o,(0,n._)((0,l._)({},h),{"aria-label":"advisory-toolbar",children:(0,r.jsxs)(d.c,{children:[i&&(0,r.jsx)(u.Ki,(0,l._)({},m)),(0,r.jsx)(o.E,(0,n._)((0,l._)({},p),{children:(0,r.jsx)(c.p,{idPrefix:"advisory-table",isTop:!0,paginationProps:x})}))]})}))}},15167:function(e,i,t){t.d(i,{q:()=>d});var l=t(24246),n=t(27378),r=t(24502),a=t(15726),s=t(17598);let d=e=>{let{advisory:i,onClose:t}=e,{pushNotification:d}=n.useContext(a.c),[o,u]=n.useState(""),[c,y]=n.useState(""),{labels:h}=(0,s.VY)(c);n.useEffect(()=>{let e=setTimeout(()=>{y(o)},400);return()=>clearTimeout(e)},[o]);let{mutate:m,isPending:p}=(0,s.sj)(()=>{d({title:"Labels updated for Advisory ".concat(i.document_id),variant:"success"}),t()},e=>{d({title:"Error while updating labels for Advisory ".concat(i.document_id),variant:"danger"})});return(0,l.jsx)(r.M,{title:"Labels of Advisory: ".concat(i.document_id),value:i.labels,isDisabled:p,onSave:e=>{m({id:i.uuid,labels:e})},onClose:t,onInputChange:u,options:h})}},17598:function(e,i,t){t.d(i,{N7:()=>v,VY:()=>x,gw:()=>f,sj:()=>_,tG:()=>b});var l=t(79192),n=t(53195),r=t(70186),a=t(1183),s=t(24038),d=t(68e3),o=t(75503),u=t(50576),c=t(40371),y=t(87017),h=t(49988),m=t(95169);let p="advisories",x=e=>{let{data:i,isLoading:t,error:l,refetch:n}=(0,a.a)({queryKey:[p,"labels",e],queryFn:()=>(0,c.sf)({client:u.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:(null==i?void 0:i.data)||[],isFetching:t,fetchError:l,refetch:n}},v=function(){var e,i,t;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],y=(0,h.rm)(s),{q:m}=y,x=(0,r._)(y,["q"]),v=(0,h.Rb)(d),{data:f,isLoading:b,error:_,refetch:j}=(0,a.a)({queryKey:[p,s,v],queryFn:()=>(0,c.A1)({client:u.L,query:(0,n._)((0,l._)({},x),{q:[m,v].filter(e=>e).join("&")})}),enabled:!o});return{result:{data:(null==f||null==(e=f.data)?void 0:e.items)||[],total:null!=(t=null==f||null==(i=f.data)?void 0:i.total)?t:0,params:s},isFetching:b,fetchError:_||null,refetch:j}},f=e=>{let{data:i,isLoading:t,error:l}=(0,a.a)({queryKey:[p,e],queryFn:()=>(0,c.pB)({client:u.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==i?void 0:i.data,isFetching:t,fetchError:l}},b=()=>{let e=(0,d.NL)();return(0,m.V)({parallel:!0,uploadFn:(e,i)=>(0,y.Cu)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[p]})}})},_=(e,i)=>{let t=(0,d.NL)();return(0,o.D)({mutationFn:e=>(0,c.m5)({client:u.L,path:{id:e.id},body:e.labels}),onSuccess:async(i,l)=>{e(),await t.invalidateQueries({queryKey:[p]})},onError:i})}}}]);