"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["181"],{98261:function(e,i,l){l.d(i,{Q:()=>c});var n=l(97517),t=l(62540),r=l(63696),s=l(539),a=l(62634),d=l(1850);let c=e=>{var{children:i=null,className:l="","aria-label":o="Breadcrumb",ouiaId:u,ouiaSafe:h=!0}=e,m=(0,n.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let x=(0,d.iK)(c.displayName,u,h);return(0,t.jsx)("nav",Object.assign({},m,{"aria-label":o,className:(0,a.A)(s.A.breadcrumb,l)},x,{children:(0,t.jsx)("ol",{className:s.A.breadcrumbList,role:"list",children:r.Children.map(i,(e,i)=>(0,r.isValidElement)(e)?(0,r.cloneElement)(e,{showDivider:i>0}):e)})}))};c.displayName="Breadcrumb"},75530:function(e,i,l){l.d(i,{J:()=>d});var n=l(97517),t=l(62540),r=l(21579),s=l(539),a=l(62634);let d=e=>{var{children:i=null,className:l="",to:d,isActive:c=!1,isDropdown:o=!1,showDivider:u,target:h,component:m="a",render:x}=e,p=(0,n.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let j=c?"page":void 0,b=(0,a.A)(s.A.breadcrumbLink,c&&s.A.modifiers.current);return(0,t.jsxs)("li",Object.assign({},p,{className:(0,a.A)(s.A.breadcrumbItem,l),children:[u&&(0,t.jsx)("span",{className:s.A.breadcrumbItemDivider,children:(0,t.jsx)(r.Ay,{})}),"button"===m&&(0,t.jsx)("button",{className:b,"aria-current":j,type:"button",children:i}),o&&(0,t.jsx)("span",{className:(0,a.A)(s.A.breadcrumbDropdown),children:i}),x&&x({className:b,ariaCurrent:j}),d&&!x&&(0,t.jsx)(m,{href:d,target:h,className:b,"aria-current":j,children:i}),!d&&"button"!==m&&!o&&i]}))};d.displayName="BreadcrumbItem"},94279:function(e,i,l){l.d(i,{B8:()=>h});var n,t,r,s,a,d=l(97517),c=l(62540),o=l(87844),u=l(62634);(n=r||(r={})).number="1",n.lowercaseLetter="a",n.uppercaseLetter="A",n.lowercaseRomanNumber="i",n.uppercaseRomanNumber="I",(s||(s={})).inline="inline",(t=a||(a={})).ol="ol",t.ul="ul";let h=e=>{var{className:i="",children:l=null,variant:n=null,isBordered:t=!1,isPlain:s=!1,iconSize:h="default",type:m=r.number,ref:x=null,component:p=a.ul,"aria-label":j}=e,b=(0,d.__rest)(e,["className","children","variant","isBordered","isPlain","iconSize","type","ref","component","aria-label"]);return p===a.ol?(0,c.jsx)("ol",Object.assign({ref:x,type:m,"aria-label":j},s&&{role:"list"},b,{className:(0,u.A)(o.A.list,n&&o.A.modifiers[n],t&&o.A.modifiers.bordered,s&&o.A.modifiers.plain,h&&"large"===h&&o.A.modifiers.iconLg,i),children:l})):(0,c.jsx)("ul",Object.assign({ref:x,"aria-label":j},s&&{role:"list"},b,{className:(0,u.A)(o.A.list,n&&o.A.modifiers[n],t&&o.A.modifiers.bordered,s&&o.A.modifiers.plain,h&&"large"===h&&o.A.modifiers.iconLg,i),children:l}))};h.displayName="List"},16172:function(e,i,l){l.d(i,{c:()=>a});var n=l(97517),t=l(62540),r=l(87844),s=l(62634);let a=e=>{var{className:i,children:l=null,icon:a=null}=e,d=(0,n.__rest)(e,["className","children","icon"]);return(0,t.jsxs)("li",Object.assign({className:(0,s.A)(a&&r.A.listItem,i)},d,{children:[a&&(0,t.jsx)("span",{className:(0,s.A)(r.A.listItemIcon),children:a}),(0,t.jsx)("span",{className:a&&(0,s.A)(`${r.A.list}__item-text`),children:l})]}))};a.displayName="ListItem"},6160:function(e,i,l){l.d(i,{E:()=>a});var n=l(97517),t=l(62540);let r={circle:"pf-m-circle",square:"pf-m-square",widthSm:"pf-m-width-sm",widthMd:"pf-m-width-md",widthLg:"pf-m-width-lg",width_25:"pf-m-width-25",width_33:"pf-m-width-33",width_50:"pf-m-width-50",width_66:"pf-m-width-66",width_75:"pf-m-width-75",heightSm:"pf-m-height-sm",heightMd:"pf-m-height-md",heightLg:"pf-m-height-lg",height_25:"pf-m-height-25",height_33:"pf-m-height-33",height_50:"pf-m-height-50",height_66:"pf-m-height-66",height_75:"pf-m-height-75",height_100:"pf-m-height-100",text_4xl:"pf-m-text-4xl",text_3xl:"pf-m-text-3xl",text_2xl:"pf-m-text-2xl",textXl:"pf-m-text-xl",textLg:"pf-m-text-lg",textMd:"pf-m-text-md",textSm:"pf-m-text-sm"};var s=l(62634);let a=e=>{var{className:i,width:l,height:a,fontSize:d,shape:c,screenreaderText:o}=e,u=(0,n.__rest)(e,["className","width","height","fontSize","shape","screenreaderText"]);let h=d?Object.values(r).find(e=>e===`pf-m-text-${d}`):void 0;return(0,t.jsx)("div",Object.assign({},u,{className:(0,s.A)("pf-v6-c-skeleton",d&&h,"circle"===c&&r.circle,"square"===c&&r.square,i)},(l||a)&&{style:Object.assign({"--pf-v6-c-skeleton--Width":l||void 0,"--pf-v6-c-skeleton--Height":a||void 0},u.style)},{children:(0,t.jsx)("span",{className:"pf-v6-screen-reader",children:o})}))};a.displayName="Skeleton"},10410:function(e,i,l){l.d(i,{Ay:()=>n});let n=(0,l(32791).w)({name:"PenIcon",height:512,width:512,svgPath:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z",yOffset:0,xOffset:0,svgClassName:void 0})},38139:function(e,i,l){l.d(i,{g:()=>a});var n=l(97517),t=l(62540),r=l(62634),s=l(82980);let a=e=>{var{children:i=null,hasNoBackground:l}=e,a=(0,n.__rest)(e,["children","hasNoBackground"]);return(0,t.jsx)("div",Object.assign({},a,{className:(0,r.A)(s.A.tableExpandableRowContent,l&&s.A.modifiers.noBackground),children:i}))};a.displayName="ExpandableRowContent"},85790:function(e,i,l){l.d(i,{a:()=>r});var n=l(62540),t=l(69548);let r=e=>{let{value:i}=e;return(0,n.jsx)(n.Fragment,{children:Object.entries(i).map(e=>{let[i,l]=e;return(0,n.jsx)(t.J,{isCompact:!0,children:"".concat(i,"=").concat(l)},"".concat(i,"=").concat(l))})})}},65346:function(e,i,l){l.d(i,{Y:()=>a});var n=l(62540),t=l(63696),r=l(88057),s=l(71284);let a=e=>{let{vulnerabilitiesSummary:i}=e,l=t.useMemo(()=>Object.keys(i.severities).map(e=>{let l=i.severities[e],n=s.Kb[e];return{severity:e,count:l,label:n.name,color:n.color.var}}).sort((0,s.Sx)(e=>e.severity)).reverse(),[i]);return(0,n.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,n.jsx)(r.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:"".concat(i.total),subTitle:"Total vulnerabilities",width:350,legendData:l.map(e=>{let{label:i,count:l}=e;return{name:"".concat(i,": ").concat(l)}}),data:l.map(e=>{let{label:i,count:l}=e;return{x:i,y:l}}),labels:e=>{let{datum:i}=e;return"".concat(i.x,": ").concat(i.y)},colorScale:l.map(e=>{let{color:i}=e;return i})})})}},20311:function(e,i,l){l.d(i,{R:()=>r});var n=l(62540),t=l(63696);let r=e=>{let{children:i}=e,[l,r]=t.useState(!1);return(0,n.jsx)(n.Fragment,{children:i(l,r)})}},64377:function(e,i,l){l.d(i,{j:()=>t});var n=l(62540);let t=e=>{let{vulnerability:i}=e;return(0,n.jsxs)("p",{children:[i.withdrawn&&(0,n.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},77029:function(e,i,l){l.d(i,{l:()=>r});var n=l(62540),t=l(33468);let r=e=>{let{packageId:i,children:l}=e,{pkg:r,isFetching:s,fetchError:a}=(0,t.Si)(i);return(0,n.jsx)(n.Fragment,{children:l(r,s,a)})}},35913:function(e,i,l){l.d(i,{$:()=>m,G:()=>h});var n=l(32909),t=l(42642),r=l(63696),s=l(27875),a=l(33468);let d=(e,i)=>e.vulnerability.identifier===i.vulnerability.identifier&&e.vulnerabilityStatus===i.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:(0,n._)({},c),fixed:(0,n._)({},c),not_affected:(0,n._)({},c),known_not_affected:(0,n._)({},c),under_investigation:(0,n._)({},c)}},u=e=>{let i=e.flatMap(e=>{var i;return(null!=(i=e.status)?i:[]).map(i=>{let l=(0,s.U)(i.average_severity);return{vulnerability:(0,t._)((0,n._)({},i.vulnerability),{average_severity:l,average_score:i.average_score}),vulnerabilityStatus:i.status,advisory:e}})}).reduce((e,i)=>{let l,r=e.find(e=>d(e,i));if(r)l=[...e.filter(e=>!d(e,r)),(0,t._)((0,n._)({},r),{relatedSboms:[...r.relatedSboms,{advisory:i.advisory}]})];else{let n={vulnerability:i.vulnerability,vulnerabilityStatus:i.vulnerabilityStatus,relatedSboms:[{advisory:i.advisory}]};l=[...e.slice(),n]}return l},[]),l=i.reduce((e,i)=>{let l=i.vulnerabilityStatus,r=i.vulnerability.average_severity,s=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,t._)((0,n._)({},e.vulnerabilityStatus),{[l]:{total:s.total+1,severities:(0,t._)((0,n._)({},s.severities),{[r]:s.severities[r]+1})}})})},(0,n._)({},o));return{vulnerabilities:i,summary:l}},h=e=>{let{pkg:i,isFetching:l,fetchError:n}=(0,a.Si)(e);return{data:r.useMemo(()=>u((null==i?void 0:i.advisories)||[]),[i]),isFetching:l,fetchError:n}},m=e=>({data:r.useMemo(()=>u((null==e?void 0:e.advisories)||[]),[e])})},49325:function(e,i,l){l.d(i,{tc:()=>a});var n=l(32909),t=l(42642),r=l(31550),s=l(73470);let a=e=>{let i=(e=>{var i;let{persistTo:l="state",persistenceKeyPrefix:t}=e,a=null!=(i=e.defaultActiveTab)?i:{tabKey:e.tabKeys[0]},[d,c]=(0,r.u)((0,n._)({isEnabled:!0,defaultValue:a,persistenceKeyPrefix:t},"urlParams"===l?{persistTo:l,keys:["activeTab"],serialize:e=>({activeTab:(null==e?void 0:e.tabKey)||null}),deserialize:e=>e.activeTab?{tabKey:e.activeTab}:null}:"localStorage"===l||"sessionStorage"===l?{persistTo:l,key:"tab"}:(0,s.xG)(l)?{persistTo:"provider",serialize:l.write,deserialize:()=>l.read()}:{persistTo:"state"}));return{activeTab:d,setActiveTab:c}})(e),l=(e=>{let{tabState:i}=e;return{isTabActive:e=>{var l;return e===(null==(l=i.activeTab)?void 0:l.tabKey)},setActiveTab:e=>{i.setActiveTab({tabKey:e})}}})({tabState:i});return(0,t._)((0,n._)({},e),{state:i,derivedState:l,propHelpers:{getTabsProps:()=>{var e;return{activeKey:null==(e=i.activeTab)?void 0:e.tabKey,onSelect:(e,i)=>{l.setActiveTab(i)}}},getTabProps:e=>({eventKey:e,tabContentId:"".concat(e,"-tab-section")}),getTabContentProps:e=>({id:"".concat(e,"-tab-section"),eventKey:e,hidden:!l.isTabActive(e)})}})}},55178:function(e,i,l){l.d(i,{H:()=>c});var n=l(62540),t=l(15461),r=l(35913),s=l(24296),a=l(6160),d=l(92107);let c=e=>{let{pkg:i,isFetching:l,fetchError:c}=e,{data:o}=(0,r.$)(i);return(0,n.jsx)(s.a,{isFetching:l,fetchError:c,isFetchingState:(0,n.jsx)(a.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,n.jsx)(d.D,{error:e}),children:(0,n.jsx)(t.n,{severities:o.summary.vulnerabilityStatus.affected.severities})})}},79832:function(e,i,l){l.r(i),l.d(i,{default:()=>eL});var n=l(32909),t=l(42642),r=l(62540),s=l(63696),a=l(74343),d=l(68430),c=l(98261),o=l(75530),u=l(54518),h=l(48281),m=l(28338),x=l(70045),p=l(42957),j=l(69548),b=l(90717),v=l(96526),f=l(52993),g=l(84818),_=l(7261),y=l(40989),T=l(60423),S=l(40111),A=l(70414),k=l(66542),w=l(93472),N=l(24773),B=l(8210),E=l(98259),P=l(52424),K=l(89705),C=l(24296),M=l(4392),O=l(99528),F=l(49325),I=l(30111),D=l(51380),L=l(76072),W=l(97299),R=l(17327),q=l(64361),V=l(71603),X=l(1020),Z=l(24974),J=l(21639),z=l(3939),H=l(94279),Y=l(16172),U=l(38927),G=l(80057),$=l(13021),Q=l(10410),ee=l(12852),ei=l(23909),el=l(98345);let en=e=>{let{sbom:i}=e,[l,n]=s.useState(!1),t=()=>{n(!1)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(L.x,{hasGutter:!0,children:[(0,r.jsx)(W.E,{md:4,children:(0,r.jsxs)(R.Z,{isFullHeight:!0,children:[(0,r.jsx)(q.Z,{children:"Metadata"}),(0,r.jsx)(V.b,{children:(0,r.jsxs)(X.B,{children:[(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"Name"}),(0,r.jsx)(z.d,{"aria-label":"SBOM's name",children:i.name})]}),(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"Namespace"}),(0,r.jsx)(z.d,{"aria-label":"SBOM's namespace",children:i.document_id})]}),(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"Data License"}),(0,r.jsx)(z.d,{"aria-label":"SBOM's license",children:i.data_licenses.join(", ")})]})]})})]})}),(0,r.jsx)(W.E,{md:4,children:(0,r.jsxs)(R.Z,{isFullHeight:!0,children:[(0,r.jsx)(q.Z,{children:"Creation"}),(0,r.jsx)(V.b,{children:(0,r.jsxs)(X.B,{children:[(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"Created"}),(0,r.jsx)(z.d,{"aria-label":"SBOM's creation date",children:(0,ei.Yq)(i.published)})]}),(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"Supplier"}),(0,r.jsx)(z.d,{"aria-label":"SBOM's supplier",children:i.suppliers.join(", ")})]}),(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"Author"}),(0,r.jsx)(z.d,{"aria-label":"SBOM's author",children:i.authors.join(", ")})]})]})})]})}),(0,r.jsx)(W.E,{md:4,children:(0,r.jsxs)(R.Z,{isFullHeight:!0,children:[(0,r.jsx)(q.Z,{children:"Statistics"}),(0,r.jsx)(V.b,{children:(0,r.jsxs)(X.B,{children:[(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"Size"}),(0,r.jsx)(z.d,{children:(0,D.A)(i.size)})]}),(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"Packages"}),(0,r.jsx)(z.d,{children:i.number_of_packages})]}),(0,r.jsxs)(Z.W,{children:[(0,r.jsxs)(J.X,{children:["Labels ","",(0,r.jsx)(N.$n,{variant:N.Ak.link,size:"sm",icon:(0,r.jsx)(Q.Ay,{}),iconPosition:"end",onClick:()=>n(!0),children:"Edit"})]}),(0,r.jsx)(z.d,{children:(0,r.jsx)(R.Z,{isCompact:!0,children:(0,r.jsx)(V.b,{children:i.labels&&(0,r.jsx)(ee.g,{defaultIsOpen:!0,value:i.labels})})})})]})]})})]})}),(0,r.jsx)(W.E,{md:12,children:(0,r.jsxs)(R.Z,{isFullHeight:!0,children:[(0,r.jsx)(q.Z,{children:"Package"}),(0,r.jsx)(V.b,{children:(0,r.jsxs)(X.B,{children:[(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"Name"}),(0,r.jsx)(z.d,{children:i.name})]}),(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"Version"}),(0,r.jsx)(z.d,{children:i.described_by.map(e=>e.version).join(", ")})]}),(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"External References"}),(0,r.jsx)(z.d,{children:(0,r.jsxs)(H.B8,{children:[i.described_by.flatMap(e=>e.cpe).map(e=>(0,r.jsx)(Y.c,{children:e},e)),i.described_by.flatMap(e=>e.purl).map(e=>(0,r.jsx)(Y.c,{children:e.purl},e.uuid))]})})]})]})})]})})]}),(0,r.jsxs)(U.a,{isOpen:l,variant:"medium",onClose:t,children:[(0,r.jsx)(G.r,{title:"Edit labels"}),(0,r.jsx)($.c,{children:(0,r.jsx)(el.f,{sbom:i,onClose:t})})]})]})};var et=l(61360),er=l(35048),es=l(32490),ea=l(52526),ed=l(26917),ec=l(16646),eo=l(21758),eu=l(40384),eh=l(28516),em=l(78517),ex=l(38139),ep=l(21999),ej=l(93826),eb=l(30448),ev=l(73470),ef=l(33468),eg=l(55178),e_=l(77029),ey=l(15461);let eT=e=>{let{sbomId:i}=e,{licenseIds:l}=(0,I.bj)(i),s=(0,ev.MM)({tableName:"package-table",columnNames:{name:"Name",version:"Version",vulnerabilities:"Vulnerabilities",licenses:"Licenses",purls:"PURLs",cpes:"CPEs"},isSortEnabled:!0,sortableColumns:["name"],isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:E._G,title:"Filter text",placeholderText:"Search",type:"search"},{categoryKey:"license",title:"License",placeholderText:"Filter results by license",type:"multiselect",operator:"=",logicOperator:"OR",selectOptions:l.map(e=>({value:e.license_id,label:e.license_name}))}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:d,total:c},isFetching:o,fetchError:u}=(0,ef.sl)(i,(0,ev.Ng)((0,t._)((0,n._)({},s),{hubSortFieldKeys:{name:"name"}}))),h=(0,ev.PB)((0,t._)((0,n._)({},s),{idProperty:"id",currentPageItems:d,totalItemCount:c,isLoading:o})),{currentPageItems:m,numRenderedColumns:x,propHelpers:{toolbarProps:p,filterToolbarProps:j,paginationToolbarItemProps:b,paginationProps:v,tableProps:f,getThProps:g,getTrProps:_,getTdProps:y,getExpandedContentTdProps:T},expansionDerivedState:{isCellExpanded:S}}=h;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(et.M,(0,t._)((0,n._)({},p),{"aria-label":"Package toolbar",children:(0,r.jsxs)(er.P,{children:[(0,r.jsx)(ep.Us,(0,n._)({},j)),(0,r.jsx)(es.T,(0,t._)((0,n._)({},b),{children:(0,r.jsx)(ej.n,{idPrefix:"package-table",isTop:!0,paginationProps:v})}))]})})),(0,r.jsxs)(ed.X,(0,t._)((0,n._)({},f),{"aria-label":"Package table",children:[(0,r.jsx)(ec.d,{children:(0,r.jsx)(eo.Tr,{children:(0,r.jsxs)(eb.Ze,(0,t._)((0,n._)({},h),{children:[(0,r.jsx)(eu.Th,(0,n._)({},g({columnKey:"name"}))),(0,r.jsx)(eu.Th,(0,n._)({},g({columnKey:"version"}))),(0,r.jsx)(eu.Th,(0,n._)({},g({columnKey:"vulnerabilities"}))),(0,r.jsx)(eu.Th,(0,n._)({},g({columnKey:"licenses"}))),(0,r.jsx)(eu.Th,(0,n._)({},g({columnKey:"purls"}))),(0,r.jsx)(eu.Th,(0,n._)({},g({columnKey:"cpes"})))]}))})}),(0,r.jsx)(eb.nJ,{isLoading:o,isError:!!u,isNoData:0===c,numRenderedColumns:x,children:null==m?void 0:m.map((e,i)=>(0,r.jsxs)(eh.N,{isExpanded:S(e),children:[(0,r.jsx)(eo.Tr,(0,t._)((0,n._)({},_({item:e})),{children:(0,r.jsxs)(eb.Oi,(0,t._)((0,n._)({},h),{item:e,rowIndex:i,children:[(0,r.jsx)(em.Td,(0,t._)((0,n._)({width:15},y({columnKey:"name"})),{children:[e.name,e.group].filter(Boolean).join("/")})),(0,r.jsx)(em.Td,(0,t._)((0,n._)({width:15,modifier:"truncate"},y({columnKey:"version"})),{children:null==e?void 0:e.version})),(0,r.jsx)(em.Td,(0,t._)((0,n._)({width:10,modifier:"breakWord"},y({columnKey:"vulnerabilities"})),{children:e.purl[0]?(0,r.jsx)(e_.l,{packageId:e.purl[0].uuid,children:(e,i,l)=>(0,r.jsx)(eg.H,{pkg:e,isFetching:i,fetchError:l})}):(0,r.jsx)(ey.n,{severities:{critical:0,high:0,medium:0,low:0,none:0,unknown:0}})})),(0,r.jsxs)(em.Td,(0,t._)((0,n._)({width:20,modifier:"breakWord"},y({columnKey:"licenses",isCompoundExpandToggle:e.licenses.length>0,item:e,rowIndex:i})),{children:[e.licenses.length," Licenses"]})),(0,r.jsx)(em.Td,(0,t._)((0,n._)({width:20,modifier:"breakWord"},y({columnKey:"purls",isCompoundExpandToggle:e.purl.length>1,item:e,rowIndex:i})),{children:1===e.purl.length?(0,r.jsx)(a.N_,{to:(0,a.tW)(P.Jh.packageDetails,{packageId:e.purl[0].uuid}),children:e.purl[0].purl}):"".concat(e.purl.length," PURLs")})),(0,r.jsxs)(em.Td,(0,t._)((0,n._)({width:20,modifier:"breakWord"},y({columnKey:"cpes",isCompoundExpandToggle:e.cpe.length>0,item:e,rowIndex:i})),{children:[e.cpe.length," CPEs"]}))]}))})),S(e)?(0,r.jsx)(eo.Tr,{isExpanded:!0,children:(0,r.jsx)(em.Td,(0,t._)((0,n._)({},T({item:e})),{className:ea.A.pLg,children:(0,r.jsx)(ex.g,{children:(0,r.jsxs)("div",{className:ea.A.ptLg,children:[S(e,"licenses")?(0,r.jsx)(H.B8,{isPlain:!0,children:e.licenses.map(i=>{let l;return(0,r.jsx)(Y.c,{children:(l=i.license_name,e.licenses_ref_mapping.reduce((e,i)=>{let{license_id:l,license_name:n}=i;return e.replaceAll(l,n)},"".concat(l)))},"".concat(i.license_name,"-").concat(i.license_type))})}):null,S(e,"purls")?(0,r.jsx)(H.B8,{isPlain:!0,children:e.purl.map(e=>(0,r.jsx)(Y.c,{children:(0,r.jsx)(a.N_,{to:(0,a.tW)(P.Jh.packageDetails,{packageId:e.uuid}),children:e.purl})},e.uuid))}):null,S(e,"cpes")?(0,r.jsx)(H.B8,{isPlain:!0,children:e.cpe.map(e=>(0,r.jsx)(Y.c,{children:e},e))}):null]})})}))}):null]},e.id))})]})),(0,r.jsx)(ej.n,{idPrefix:"package-table",isTop:!1,paginationProps:v})]})};var eS=l(95285),eA=l.n(eS),ek=l(38914),ew=l(57901),eN=l(59771),eB=l(27875),eE=l(85790),eP=l(65346),eK=l(45969),eC=l(20311),eM=l(64377),eO=l(3652),eF=l(21328);let eI=e=>{let{sbomId:i}=e,{sbom:l,isFetching:d,fetchError:c}=(0,I.rj)(i),{data:{vulnerabilities:o,summary:u},isFetching:h,fetchError:m}=(0,eO.UI)(i),x=s.useMemo(()=>o.filter(e=>"affected"===e.vulnerabilityStatus),[o]),p=s.useMemo(()=>x.map(e=>{let i=e.relatedPackages.flatMap(e=>e.packages).reduce((e,i)=>(e.find(e=>e.id===i.id)||e.push(i),e),[]);return(0,t._)((0,n._)({},e),{summary:{totalPackages:i.length,allPackages:i}})}),[x]),j=(0,eF.f)(p,e=>"".concat(e.vulnerability.identifier,"-").concat(e.vulnerabilityStatus)),b=(0,ev.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:j,isLoading:h,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>{var i,l;return{id:e.vulnerability.identifier,cvss:e.vulnerability.average_score,affectedDependencies:e.summary.totalPackages,published:(null==(i=e.vulnerability)?void 0:i.published)?eA()(e.vulnerability.published).valueOf():0,updated:(null==(l=e.vulnerability)?void 0:l.modified)?eA()(e.vulnerability.modified).valueOf():0}},isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:v,numRenderedColumns:f,propHelpers:{toolbarProps:g,paginationToolbarItemProps:_,paginationProps:y,tableProps:T,getThProps:S,getTrProps:A,getTdProps:k,getExpandedContentTdProps:w},expansionDerivedState:{isCellExpanded:N}}=b;return(0,r.jsxs)(ek.B,{hasGutter:!0,children:[(0,r.jsx)(ew.a,{children:(0,r.jsx)(R.Z,{children:(0,r.jsx)(V.b,{children:(0,r.jsx)(C.a,{isFetching:d||h,fetchError:c,children:(0,r.jsxs)(L.x,{hasGutter:!0,children:[(0,r.jsx)(W.E,{md:6,children:(0,r.jsx)(eP.Y,{vulnerabilitiesSummary:u.vulnerabilityStatus.affected})}),(0,r.jsx)(W.E,{md:6,children:(0,r.jsxs)(X.B,{children:[(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"Name"}),(0,r.jsx)(z.d,{children:null==l?void 0:l.name})]}),(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"Version"}),(0,r.jsx)(z.d,{children:null==l?void 0:l.described_by.map(e=>e.version).join(", ")})]}),(0,r.jsxs)(Z.W,{children:[(0,r.jsx)(J.X,{children:"Creation date"}),(0,r.jsx)(z.d,{children:(0,ei.Yq)(null==l?void 0:l.published)})]})]})})]})})})})}),(0,r.jsxs)(ew.a,{children:[(0,r.jsx)(et.M,(0,t._)((0,n._)({},g),{children:(0,r.jsx)(er.P,{children:(0,r.jsx)(es.T,(0,t._)((0,n._)({},_),{children:(0,r.jsx)(ej.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:y})}))})})),(0,r.jsxs)(ed.X,(0,t._)((0,n._)({},T),{"aria-label":"Vulnerability table",children:[(0,r.jsx)(ec.d,{children:(0,r.jsx)(eo.Tr,{children:(0,r.jsxs)(eb.Ze,(0,t._)((0,n._)({},b),{children:[(0,r.jsx)(eu.Th,(0,n._)({},S({columnKey:"id"}))),(0,r.jsx)(eu.Th,(0,n._)({},S({columnKey:"description"}))),(0,r.jsx)(eu.Th,(0,n._)({},S({columnKey:"cvss"}))),(0,r.jsx)(eu.Th,(0,n._)({},S({columnKey:"affectedDependencies"}))),(0,r.jsx)(eu.Th,(0,n._)({},S({columnKey:"published"}))),(0,r.jsx)(eu.Th,(0,n._)({},S({columnKey:"updated"})))]}))})}),(0,r.jsx)(eb.nJ,{isLoading:h,isError:!!m,isNoData:0===j.length,numRenderedColumns:f,children:null==v?void 0:v.map((e,i)=>{var l,s;return(0,r.jsxs)(eh.N,{isExpanded:N(e),children:[(0,r.jsx)(eo.Tr,(0,t._)((0,n._)({},A({item:e})),{children:(0,r.jsxs)(eb.Oi,(0,t._)((0,n._)({},b),{item:e,rowIndex:i,children:[(0,r.jsx)(em.Td,(0,t._)((0,n._)({width:15,modifier:"breakWord"},k({columnKey:"id"})),{children:(0,r.jsx)(a.N_,{to:(0,a.tW)(P.Jh.vulnerabilityDetails,{vulnerabilityId:e.vulnerability.identifier}),children:e.vulnerability.identifier})})),(0,r.jsx)(eC.R,{children:(i,l)=>(0,r.jsx)(em.Td,(0,t._)((0,n._)({width:35,modifier:"truncate",onFocus:()=>l(!0),onBlur:()=>l(!1),tabIndex:0},k({columnKey:"description"})),{children:(0,r.jsx)(eN.mA,{focused:i,wrapModifier:"truncate",children:e.vulnerability&&(0,r.jsx)(eM.j,{vulnerability:e.vulnerability})})}))}),(0,r.jsx)(em.Td,(0,t._)((0,n._)({width:10},k({columnKey:"cvss"})),{children:(0,r.jsx)(eK.h,{value:(0,eB.U)(e.vulnerability.average_severity),score:e.vulnerability.average_score,showLabel:!0,showScore:!0})})),(0,r.jsx)(em.Td,(0,t._)((0,n._)({width:15,modifier:"truncate"},k({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:i})),{children:e.summary.totalPackages})),(0,r.jsx)(em.Td,(0,t._)((0,n._)({width:10,modifier:"truncate"},k({columnKey:"published"})),{children:(0,ei.Yq)(null==(l=e.vulnerability)?void 0:l.published)})),(0,r.jsx)(em.Td,(0,t._)((0,n._)({width:10,modifier:"truncate"},k({columnKey:"updated"})),{children:(0,ei.Yq)(null==(s=e.vulnerability)?void 0:s.modified)}))]}))})),N(e)?(0,r.jsx)(eo.Tr,{isExpanded:!0,children:(0,r.jsx)(em.Td,(0,t._)((0,n._)({},w({item:e})),{children:(0,r.jsx)(ex.g,{children:N(e,"affectedDependencies")?(0,r.jsxs)(ed.X,{variant:"compact",children:[(0,r.jsx)(ec.d,{children:(0,r.jsxs)(eo.Tr,{children:[(0,r.jsx)(eu.Th,{children:"Type"}),(0,r.jsx)(eu.Th,{children:"Namespace"}),(0,r.jsx)(eu.Th,{children:"Name"}),(0,r.jsx)(eu.Th,{children:"Version"}),(0,r.jsx)(eu.Th,{children:"Path"}),(0,r.jsx)(eu.Th,{children:"Qualifiers"})]})}),(0,r.jsx)(eh.N,{children:e.summary.allPackages.flatMap(e=>e.name&&0===e.purl.length?[{parentName:e.name}]:e.purl.map(i=>({parentName:e.name,purlSummary:i}))).map((e,i)=>{if(e.purlSummary){let i=(0,ei.fe)(e.purlSummary.purl);return(0,r.jsxs)(eo.Tr,{children:[(0,r.jsx)(em.Td,{children:null==i?void 0:i.type}),(0,r.jsx)(em.Td,{children:null==i?void 0:i.namespace}),(0,r.jsx)(em.Td,{children:(0,r.jsx)(a.N_,{to:(0,a.tW)(P.Jh.packageDetails,{packageId:e.purlSummary.uuid}),children:null==i?void 0:i.name})}),(0,r.jsx)(em.Td,{children:null==i?void 0:i.version}),(0,r.jsx)(em.Td,{children:null==i?void 0:i.path}),(0,r.jsx)(em.Td,{children:(null==i?void 0:i.qualifiers)&&(0,r.jsx)(eE.a,{value:null==i?void 0:i.qualifiers})})]},e.purlSummary.uuid)}return(0,r.jsxs)(eo.Tr,{children:[(0,r.jsx)(em.Td,{}),(0,r.jsx)(em.Td,{}),(0,r.jsx)(em.Td,{children:e.parentName}),(0,r.jsx)(em.Td,{}),(0,r.jsx)(em.Td,{}),(0,r.jsx)(em.Td,{})]},"".concat(e.parentName,"-").concat(i,"-name"))})})]}):null})}))}):null]},e._ui_unique_id)})})]})),(0,r.jsx)(ej.n,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:y})]})]})};var eD=l(52673);let eL=()=>{var e,i;let l=(0,a.Zp)(),{pushNotification:D}=s.useContext(M.K),L=(0,P.Lu)("sbomId"),{sbom:W,isFetching:R,fetchError:q}=(0,I.rj)(L),[V,X]=s.useState(!1),Z=()=>{X(!V)},{downloadSBOM:J,downloadSBOMLicenses:z}=(0,O.m)(),[H,Y]=s.useState(!1),{mutate:U,isPending:G}=(0,I.l6)(e=>{Y(!1),D({title:(0,E.B7)(e),variant:"success"}),l("/sboms")},e=>{D({title:(0,E.Ut)(e),variant:"danger"})}),{propHelpers:{getTabsProps:$,getTabProps:Q,getTabContentProps:ee}}=(0,F.tc)({persistenceKeyPrefix:"sd",persistTo:"urlParams",tabKeys:["info","packages","vulnerabilities"]}),ei=s.createRef(),el=s.createRef(),et=s.createRef(),er=s.createRef();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eD.T,{title:null==W?void 0:W.name}),(0,r.jsx)(d.d8,{type:"breadcrumb",children:(0,r.jsxs)(c.Q,{children:[(0,r.jsx)(o.J,{children:(0,r.jsx)(a.N_,{to:P.Jh.sboms,children:"SBOMs"})}),(0,r.jsx)(o.J,{isActive:!0,children:"SBOM details"})]})}),(0,r.jsx)(d.d8,{children:(0,r.jsxs)(u.B,{children:[(0,r.jsx)(h.o,{isFilled:!0,children:(0,r.jsxs)(m.s,{children:[(0,r.jsx)(x.Z,{spacer:{default:"spacerSm"},children:(0,r.jsx)(p.U,{children:(0,r.jsx)(p.U,{component:"h1",children:null!=(i=null!=(e=null==W?void 0:W.name)?e:L)?i:""})})}),(0,r.jsx)(x.Z,{children:(null==W?void 0:W.labels.type)&&(0,r.jsx)(j.J,{color:"blue",children:null==W?void 0:W.labels.type})})]})}),(0,r.jsx)(h.o,{children:W&&(0,r.jsx)(b.m,{isOpen:V,onSelect:()=>X(!1),onOpenChange:e=>X(e),popperProps:{position:"right"},toggle:e=>(0,r.jsx)(v.S3,{ref:e,onClick:Z,isExpanded:V,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,r.jsxs)(f.Q,{children:[(0,r.jsx)(g.t,{onClick:()=>{L&&J(L,(null==W?void 0:W.name)?"".concat(null==W?void 0:W.name,".json"):"".concat(L,".json"))},children:"Download SBOM"},"sbom"),(0,r.jsx)(g.t,{onClick:()=>{L&&z(L)},children:"Download License Report"},"license"),(0,r.jsx)(_.c,{component:"li"},"separator"),(0,r.jsx)(g.t,{onClick:()=>Y(!0),children:"Delete"},"delete")]})})})]})}),(0,r.jsx)(d.d8,{children:(0,r.jsxs)(y.t,(0,t._)((0,n._)({mountOnEnter:!0},$()),{"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,r.jsx)(T.o,(0,t._)((0,n._)({},Q("info")),{title:(0,r.jsx)(S.V,{children:"Info"}),tabContentRef:ei})),(0,r.jsx)(T.o,(0,t._)((0,n._)({},Q("packages")),{title:(0,r.jsx)(S.V,{children:"Packages"}),tabContentRef:el})),(0,r.jsx)(T.o,(0,t._)((0,n._)({},Q("vulnerabilities")),{title:(0,r.jsx)(S.V,{children:"Vulnerabilities"}),tabContentRef:et,actions:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.o,{ref:er,children:(0,r.jsx)(B.Ay,{})}),(0,r.jsx)(k.A,{triggerRef:er,bodyContent:(0,r.jsx)("div",{children:"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed."})})]})}))]}))}),(0,r.jsxs)(d.d8,{children:[(0,r.jsx)(w.J,(0,t._)((0,n._)({},ee("info")),{ref:ei,"aria-label":"Information of the SBOM",children:(0,r.jsx)(C.a,{isFetching:R,fetchError:q,children:W&&(0,r.jsx)(en,{sbom:W})})})),(0,r.jsx)(w.J,(0,t._)((0,n._)({},ee("packages")),{ref:el,"aria-label":"Packages within the SBOM",children:L&&(0,r.jsx)(eT,{sbomId:L})})),(0,r.jsx)(w.J,(0,t._)((0,n._)({},ee("vulnerabilities")),{ref:et,"aria-label":"Vulnerabilities within the SBOM",children:L&&(0,r.jsx)(eI,{sbomId:L})}))]}),(0,r.jsx)(K.T,(0,t._)((0,n._)({},(0,E.zK)(W)),{inProgress:G,titleIconVariant:"warning",isOpen:H,confirmBtnVariant:N.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>Y(!1),onClose:()=>Y(!1),onConfirm:()=>{W&&U(W.id)}}))]})}},33468:function(e,i,l){l.d(i,{Lx:()=>c,Si:()=>o,sl:()=>u});var n=l(32909),t=l(77184),r=l(96002),s=l(86141),a=l(73470);let d="packages",c=function(){var e,i,l;let c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:u,isLoading:h,error:m,refetch:x}=(0,t.I)({queryKey:[d,c],queryFn:()=>(0,s.UD)({client:r.S,query:(0,n._)({},(0,a.kd)(c))}),enabled:!o});return{result:{data:(null==u||null==(e=u.data)?void 0:e.items)||[],total:null!=(l=null==u||null==(i=u.data)?void 0:i.total)?l:0,params:c},isFetching:h,fetchError:m,refetch:x}},o=e=>{let{data:i,isLoading:l,error:n}=(0,t.I)({queryKey:[d,e],queryFn:()=>(0,s.Y0)({client:r.S,path:{key:e}})});return{pkg:null==i?void 0:i.data,isFetching:l,fetchError:n}},u=function(e){var i,l,c;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:u,isLoading:h,error:m,refetch:x}=(0,t.I)({queryKey:[d,"by-sbom",e,o],queryFn:()=>(0,s.Ad)({client:r.S,path:{id:e},query:(0,n._)({},(0,a.kd)(o))})});return{result:{data:(null==u||null==(i=u.data)?void 0:i.items)||[],total:null!=(c=null==u||null==(l=u.data)?void 0:l.total)?c:0,params:o},isFetching:h,fetchError:m,refetch:x}}},21328:function(e,i,l){l.d(i,{f:()=>a});var n=l(32909),t=l(42642),r=l(63696),s=l(98259);let a=(e,i)=>(0,r.useMemo)(()=>e&&0!==e.length?e.map(e=>(0,t._)((0,n._)({},e),{[s.FA]:i(e)})):[],[e,i])},87844:function(e,i,l){l.d(i,{A:()=>n});let n={list:"pf-v6-c-list",listItem:"pf-v6-c-list__item",listItemIcon:"pf-v6-c-list__item-icon",modifiers:{iconLg:"pf-m-icon-lg",plain:"pf-m-plain",inline:"pf-m-inline",bordered:"pf-m-bordered"}}},51380:function(e,i,l){l.d(i,{A:()=>d});let n=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],t=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],r=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],s=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],a=(e,i,l)=>{let n=e;return"string"==typeof i||Array.isArray(i)?n=e.toLocaleString(i,l):(!0===i||void 0!==l)&&(n=e.toLocaleString(void 0,l)),n};function d(e,i){let l;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let d=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?s:r:i.binary?t:n,c=i.space?" ":"";if(i.signed&&0===e)return` 0${c}${d[0]}`;let o=e<0,u=o?"-":i.signed?"+":"";if(o&&(e=-e),void 0!==i.minimumFractionDigits&&(l={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(l={maximumFractionDigits:i.maximumFractionDigits,...l}),e<1)return u+a(e,i.locale,l)+c+d[0];let h=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),d.length-1);return e/=(i.binary?1024:1e3)**h,l||(e=e.toPrecision(3)),u+a(Number(e),i.locale,l)+c+d[h]}}}]);