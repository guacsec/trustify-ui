"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["77"],{20311:function(e,t,i){i.d(t,{R:()=>s});var r=i(62540),l=i(63696);let s=e=>{let{children:t}=e,[i,s]=l.useState(!1);return(0,r.jsx)(r.Fragment,{children:t(i,s)})}},64377:function(e,t,i){i.d(t,{j:()=>l});var r=i(62540);let l=e=>{let{vulnerability:t}=e;return(0,r.jsxs)("p",{children:[t.withdrawn&&(0,r.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})}},12063:function(e,t,i){i.d(t,{f:()=>d});var r=i(32909),l=i(42642),s=i(63696),a=i(31903);let n=(e,t)=>e.sbom.id===t.sbom.id&&e.sbomStatus===t.sbomStatus,o={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0,under_investigation:0}},d=e=>{let{vulnerability:t,isFetching:i,fetchError:d}=(0,a.uN)(e);return{data:s.useMemo(()=>{let e,i;return i=(e=((null==t?void 0:t.advisories)||[]).flatMap(e=>{var t;return(null!=(t=e.sboms)?t:[]).flatMap(t=>Object.entries(t.purl_statuses||{}).map(i=>{let[l,s]=i;return{sbom:(0,r._)({},t),sbomStatus:l,advisory:e,packages:s}}))}).reduce((e,t)=>{let i,s=e.find(e=>n(e,t));if(s)i=[...e.filter(e=>!n(e,s)),(0,l._)((0,r._)({},s),{relatedPackages:[...s.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let r={sbom:t.sbom,sbomStatus:t.sbomStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};i=[...e.slice(),r]}return i},[])).reduce((e,t)=>{let i=t.sbomStatus;return Object.assign(e,{total:e.total+1,sbomStatus:(0,l._)((0,r._)({},e.sbomStatus),{[i]:e.sbomStatus[i]+1})})},(0,r._)({},o)),{sboms:e,summary:i}},[t]),isFetching:i,fetchError:d}}},62517:function(e,t,i){i.d(t,{u:()=>c,y:()=>h});var r=i(32909),l=i(42642),s=i(62540),a=i(63696),n=i(98259);i(21999);var o=i(73470),d=i(31903),u=i(23909);let c=a.createContext({}),h=e=>{let{children:t}=e,i=(0,o.MM)({tableName:"vulnerability",persistenceKeyPrefix:n.rt.vulnerabilities,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Description",severity:"CVSS",published:"Published",sboms:"Impacted SBOMs"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","published","severity"],initialSort:{columnKey:"published",direction:"desc"},isFilterEnabled:!0,filterCategories:[{categoryKey:n._G,title:"Filter text",placeholderText:"Search",type:"search"},{categoryKey:"base_severity",title:"CVSS",placeholderText:"CVSS",type:"multiselect",selectOptions:[{value:"null",label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"published",title:"Published",type:"dateRange"},{categoryKey:"publishedOnly",title:"Published only",type:"toggle",label:"Published only",serverFilterField:"published",getServerFilterValue:()=>["null"],getOperator:e=>(0,u.iw)(null==e?void 0:e[0])?"=":"!=",showOutsideDropdown:!0}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:a,total:h},isFetching:b,fetchError:y}=(0,d.WJ)((0,o.Ng)((0,l._)((0,r._)({},i),{hubSortFieldKeys:{identifier:"id",severity:"base_score",published:"published"}}))),m=(0,o.PB)((0,l._)((0,r._)({},i),{idProperty:"identifier",currentPageItems:a,totalItemCount:h,isLoading:b}));return(0,s.jsx)(c.Provider,{value:{totalItemCount:h,isFetching:b,fetchError:y,tableControls:m},children:t})}},11934:function(e,t,i){i.d(t,{f:()=>k});var r=i(32909),l=i(42642),s=i(62540),a=i(63696),n=i(74343),o=i(26917),d=i(16646),u=i(21758),c=i(40384),h=i(28516),b=i(78517),y=i(59771),m=i(27875),p=i(45969),v=i(93826),f=i(30448),_=i(64377),x=i(52362),g=i(23909),j=i(20311),S=i(6160),w=i(24296),K=i(92107),T=i(12063);let P=e=>{let{vulnerabilityId:t}=e,{data:i,isFetching:r,fetchError:l}=(0,T.f)(t);return(0,s.jsx)(w.a,{isFetching:r,fetchError:l,isFetchingState:(0,s.jsx)(S.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,s.jsx)(K.D,{error:e}),children:i.summary.sbomStatus.affected})};var F=i(62517);let k=()=>{let{isFetching:e,fetchError:t,totalItemCount:i,tableControls:S}=a.useContext(F.u),{numRenderedColumns:w,currentPageItems:K,propHelpers:{paginationProps:T,tableProps:k,getThProps:E,getTrProps:C,getTdProps:I}}=S;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(o.X,(0,l._)((0,r._)({},k),{"aria-label":"Vulnerability table",children:[(0,s.jsx)(d.d,{children:(0,s.jsx)(u.Tr,{children:(0,s.jsxs)(f.Ze,(0,l._)((0,r._)({},S),{children:[(0,s.jsx)(c.Th,(0,r._)({},E({columnKey:"identifier"}))),(0,s.jsx)(c.Th,(0,r._)({},E({columnKey:"title"}))),(0,s.jsx)(c.Th,(0,l._)((0,r._)({},E({columnKey:"severity"})),{info:{tooltip:"The Common Vulnerability Scoring System measuring the severity of security flaws."}})),(0,s.jsx)(c.Th,(0,r._)({},E({columnKey:"published"}))),(0,s.jsx)(c.Th,(0,r._)({},E({columnKey:"sboms"})))]}))})}),(0,s.jsx)(f.nJ,{isLoading:e,isError:!!t,isNoData:0===i,numRenderedColumns:w,children:K.map((e,t)=>(0,s.jsx)(h.N,{children:(0,s.jsx)(u.Tr,(0,l._)((0,r._)({},C({item:e})),{children:(0,s.jsxs)(f.Oi,(0,l._)((0,r._)({},S),{item:e,rowIndex:t,children:[(0,s.jsx)(b.Td,(0,l._)((0,r._)({width:15,modifier:"breakWord"},I({columnKey:"identifier",item:e,rowIndex:t})),{children:(0,s.jsx)(n.k2,{to:(0,n.tW)(x.Jh.vulnerabilityDetails,{vulnerabilityId:e.identifier}),children:e.identifier})})),(0,s.jsx)(j.R,{children:(t,i)=>(0,s.jsx)(b.Td,(0,l._)((0,r._)({width:45,modifier:"truncate",onFocus:()=>i(!0),onBlur:()=>i(!1),tabIndex:0},I({columnKey:"title"})),{children:(0,s.jsx)(y.mA,{focused:t,wrapModifier:"truncate",children:(0,s.jsx)(_.j,{vulnerability:e})})}))}),(0,s.jsx)(b.Td,(0,l._)((0,r._)({width:10},I({columnKey:"severity"})),{children:(0,s.jsx)(p.h,{value:(0,m.U)(e.average_severity),score:e.average_score,showLabel:!0,showScore:!0})})),(0,s.jsx)(b.Td,(0,l._)((0,r._)({width:10},I({columnKey:"published"})),{children:(0,g.Yq)(e.published)})),(0,s.jsx)(b.Td,(0,l._)((0,r._)({width:10},I({columnKey:"sboms",item:e,rowIndex:t})),{children:(0,s.jsx)(P,{vulnerabilityId:e.identifier})}))]}))}))},e.identifier))})]})),(0,s.jsx)(v.n,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:T})]})}},13829:function(e,t,i){i.d(t,{y:()=>b});var r=i(32909),l=i(42642),s=i(62540),a=i(63696),n=i(61360),o=i(35048),d=i(32490),u=i(21999),c=i(93826),h=i(62517);let b=e=>{let{showFilters:t}=e,{tableControls:i}=a.useContext(h.u),{propHelpers:{toolbarProps:b,filterToolbarProps:y,paginationToolbarItemProps:m,paginationProps:p}}=i;return(0,s.jsx)(n.M,(0,l._)((0,r._)({},b),{"aria-label":"vulnerability-toolbar",children:(0,s.jsxs)(o.P,{children:[t&&(0,s.jsx)(u.Us,(0,r._)({},y)),(0,s.jsx)(d.T,(0,l._)((0,r._)({},m),{children:(0,s.jsx)(c.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:p})}))]})}))}},31903:function(e,t,i){i.d(t,{Bi:()=>c,WJ:()=>u,uN:()=>h});var r=i(32909),l=i(77184),s=i(3822),a=i(96002),n=i(86141),o=i(73470);let d="vulnerabilities",u=function(){var e,t,i;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:c,isLoading:h,error:b,refetch:y}=(0,l.I)({queryKey:[d,s],queryFn:()=>(0,n.NI)({client:a.S,query:(0,r._)({},(0,o.kd)(s))}),enabled:!u});return{result:{data:(null==c||null==(e=c.data)?void 0:e.items)||[],total:null!=(i=null==c||null==(t=c.data)?void 0:t.total)?i:0,params:s},isFetching:h,fetchError:b,refetch:y}},c=e=>{var t;let i={ids:e.reduce((e,t,i)=>(i%100==0?e.push([t]):e[e.length-1].push(t),e),[]),dataResolver:async e=>(await (0,n.ns)({client:a.S,body:{purls:e}})).data},r=(0,s.E)({queries:i.ids.map(e=>({queryKey:[d,e],queryFn:()=>i.dataResolver(e),retry:!1}))}),l=r.some(e=>{let{isFetching:t}=e;return t}),o=r.find(e=>{let{error:t}=e;return!!t}),u={};if(!l)for(let e of r.map(e=>{var t;return null!=(t=null==e?void 0:e.data)?t:{}}))for(let[t,i]of Object.entries(e))u[t]=i;return{analysisResponse:u,isFetching:l,fetchError:null!=(t=null==o?void 0:o.error)?t:void 0}},h=e=>{let{data:t,isLoading:i,error:r}=(0,l.I)({queryKey:[d,e],queryFn:()=>(0,n.dZ)({client:a.S,path:{id:e}})});return{vulnerability:null==t?void 0:t.data,isFetching:i,fetchError:r}}}}]);