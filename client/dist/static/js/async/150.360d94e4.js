"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["150"],{97339:function(e,i,r){r.d(i,{a:()=>d});var n=r(59390),t=r(24246),l=r(27378),s=r(90633),a=r(15508),c=r(53315);let d=e=>{var{children:i=null,className:r="","aria-label":o="Breadcrumb",ouiaId:h,ouiaSafe:u=!0}=e,x=(0,n.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let j=(0,c.S$)(d.displayName,h,u);return(0,t.jsx)("nav",Object.assign({},x,{"aria-label":o,className:(0,a.i)(s.Z.breadcrumb,r)},j,{children:(0,t.jsx)("ol",{className:s.Z.breadcrumbList,role:"list",children:l.Children.map(i,(e,i)=>(0,l.isValidElement)(e)?(0,l.cloneElement)(e,{showDivider:i>0}):e)})}))};d.displayName="Breadcrumb"},18091:function(e,i,r){r.d(i,{g:()=>c});var n=r(59390),t=r(24246),l=r(91985),s=r(90633),a=r(15508);let c=e=>{var{children:i=null,className:r="",to:c,isActive:d=!1,isDropdown:o=!1,showDivider:h,target:u,component:x="a",render:j}=e,m=(0,n.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let b=d?"page":void 0,v=(0,a.i)(s.Z.breadcrumbLink,d&&s.Z.modifiers.current);return(0,t.jsxs)("li",Object.assign({},m,{className:(0,a.i)(s.Z.breadcrumbItem,r),children:[h&&(0,t.jsx)("span",{className:s.Z.breadcrumbItemDivider,children:(0,t.jsx)(l.ZP,{})}),"button"===x&&(0,t.jsx)("button",{className:v,"aria-current":b,type:"button",children:i}),o&&(0,t.jsx)("span",{className:(0,a.i)(s.Z.breadcrumbDropdown),children:i}),j&&j({className:v,ariaCurrent:b}),c&&!j&&(0,t.jsx)(x,{href:c,target:u,className:v,"aria-current":b,children:i}),!c&&"button"!==x&&!o&&i]}))};c.displayName="BreadcrumbItem"},51527:function(e,i,r){r.d(i,{e:()=>a});var n=r(59390),t=r(24246),l=r(24416),s=r(15508);let a=e=>{var{children:i,className:r,component:a="div",isFilled:c=!0}=e,d=(0,n.__rest)(e,["children","className","component","isFilled"]);return(0,t.jsx)(a,Object.assign({className:(0,s.i)(l.Z.cardBody,!c&&l.Z.modifiers.noFill,r)},d,{children:i}))};a.displayName="CardBody"},87069:function(e,i,r){r.d(i,{l:()=>d});var n=r(59390),t=r(24246),l=r(27378),s=r(15508),a=r(24416),c=r(31757);let d=e=>{var{children:i,className:r,component:d="div"}=e,o=(0,n.__rest)(e,["children","className","component"]);let{cardId:h}=(0,l.useContext)(c.H),u=h?`${h}-title`:"";return(0,t.jsx)("div",{className:(0,s.i)(a.Z.cardTitle),children:(0,t.jsx)(d,Object.assign({className:(0,s.i)(a.Z.cardTitleText,r),id:u||void 0},o,{children:i}))})};d.displayName="CardTitle"},67761:function(e,i,r){r.d(i,{M:()=>a});var n=r(59390),t=r(24246),l=r(38436),s=r(15508);let a=e=>{var{children:i,className:r,icon:a}=e,c=(0,n.__rest)(e,["children","className","icon"]);return(0,t.jsxs)("dt",Object.assign({className:(0,s.i)(l.Z.descriptionListTerm,r)},c,{children:[a?(0,t.jsx)("span",{className:(0,s.i)(l.Z.descriptionListTermIcon),children:a}):null,(0,t.jsx)("span",{className:(0,s.i)(l.Z.descriptionListText),children:i})]}))};a.displayName="DescriptionListTerm"},26235:function(e,i,r){r.d(i,{ZP:()=>n});let n=(0,r(24329).I)({name:"PenIcon",height:512,width:512,svgPath:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z",yOffset:0,xOffset:0})},37818:function(e,i,r){r.d(i,{u:()=>a});var n=r(24246),t=r(8305),l=r(13754),s=r(39826);let a=e=>e.isFetching?e.isFetchingState||(0,n.jsx)(t.b,{children:(0,n.jsx)(l.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,n.jsx)(s.y,{}):e.children},3586:function(e,i,r){r.d(i,{j:()=>l});var n=r(24246),t=r(27378);let l=e=>{let{children:i}=e,[r,l]=t.useState(!1);return(0,n.jsx)(n.Fragment,{children:i(r,l)})}},24200:function(e,i,r){r.d(i,{G:()=>t});var n=r(24246);let t=e=>{let{vulnerability:i}=e;return(0,n.jsxs)("p",{children:[i.withdrawn&&(0,n.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},2588:function(e,i,r){r.r(i),r.d(i,{default:()=>ed});var n=r(24246),t=r(27378),l=r(65783),s=r(45043),a=r(97339),c=r(18091),d=r(11192),o=r(32591),h=r(34747),u=r(46770),x=r(68802),j=r(70400),m=r(17528),b=r(4075),v=r(27090),f=r(75165),y=r(24787);let p=(0,r(24329).I)({name:"DownloadIcon",height:512,width:512,svgPath:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",yOffset:0,xOffset:0});var g=r(9839),_=r(37818),T=r(73227),N=r(17598),w=r(65872),E=r(87727),F=r(3498),S=r(31757),B=r(87069),C=r(51527),Z=r(30329),P=r(50689),I=r(67761),M=r(81391),D=r(79551),K=r(32489),L=r(90519),O=r(26235),k=r(73827),q=r(63706),V=r(15167);let A=e=>{var i,r;let{advisory:l}=e,[s,a]=t.useState(!1),c=()=>{a(!1)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(E.r,{hasGutter:!0,children:[(0,n.jsx)(F.P,{md:4,children:(0,n.jsxs)(S.Z,{isFullHeight:!0,children:[(0,n.jsx)(B.l,{children:"Overview"}),(0,n.jsx)(C.e,{children:(0,n.jsxs)(Z.o,{children:[(0,n.jsxs)(P.g,{children:[(0,n.jsx)(I.M,{children:"Title"}),(0,n.jsx)(M.b,{children:l.title})]}),(0,n.jsxs)(P.g,{children:[(0,n.jsx)(I.M,{children:"Type"}),(0,n.jsx)(M.b,{children:l.labels.type})]}),(0,n.jsxs)(P.g,{children:[(0,n.jsx)(I.M,{children:"Size"}),(0,n.jsx)(M.b,{children:(0,w.Z)(l.size)})]}),(0,n.jsxs)(P.g,{children:[(0,n.jsxs)(I.M,{children:["Labels ","",(0,n.jsx)(m.zx,{variant:m.Wu.link,size:"sm",icon:(0,n.jsx)(O.ZP,{}),iconPosition:"end",onClick:()=>a(!0),children:"Edit"})]}),(0,n.jsx)(M.b,{children:(0,n.jsx)(S.Z,{isCompact:!0,children:(0,n.jsx)(C.e,{children:l.labels&&(0,n.jsx)(k.C,{defaultIsOpen:!0,value:l.labels})})})})]})]})})]})}),(0,n.jsx)(F.P,{md:4,children:(0,n.jsxs)(S.Z,{isFullHeight:!0,children:[(0,n.jsx)(B.l,{children:"Publisher"}),(0,n.jsx)(C.e,{children:(0,n.jsxs)(Z.o,{children:[(0,n.jsxs)(P.g,{children:[(0,n.jsx)(I.M,{children:"Name"}),(0,n.jsx)(M.b,{children:null==(i=l.issuer)?void 0:i.name})]}),(0,n.jsxs)(P.g,{children:[(0,n.jsx)(I.M,{children:"Contact details"}),(0,n.jsx)(M.b,{children:null==(r=l.issuer)?void 0:r.website})]})]})})]})}),(0,n.jsx)(F.P,{md:4,children:(0,n.jsxs)(S.Z,{isFullHeight:!0,children:[(0,n.jsx)(B.l,{children:"Tracking"}),(0,n.jsx)(C.e,{children:(0,n.jsxs)(Z.o,{children:[(0,n.jsxs)(P.g,{children:[(0,n.jsx)(I.M,{children:"ID"}),(0,n.jsx)(M.b,{children:l.identifier})]}),(0,n.jsxs)(P.g,{children:[(0,n.jsx)(I.M,{children:"Initial release date"}),(0,n.jsx)(M.b,{children:(0,q.p6)(l.published)})]}),(0,n.jsxs)(P.g,{children:[(0,n.jsx)(I.M,{children:"Current release date"}),(0,n.jsx)(M.b,{children:(0,q.p6)(l.modified)})]})]})})]})})]}),(0,n.jsxs)(D.u,{isOpen:s,variant:"medium",title:"Edit labels",onClose:c,children:[(0,n.jsx)(K.x,{title:"Edit labels"}),(0,n.jsx)(L.f,{children:(0,n.jsx)(V.q,{advisory:l,onClose:c})})]})]})};var z=r(79192),R=r(53195),G=r(70715),H=r(40982),Y=r(89226),$=r(4835),W=r(14350),U=r(11165),J=r(89330),Q=r(31423),X=r(94154),ee=r(9905),ei=r(7615),er=r(57524),en=r(3804),et=r(31336),el=r(3586),es=r(24200),ea=r(49988);let ec=e=>{let{isFetching:i,fetchError:r,vulnerabilities:t}=e,s=(0,ea.sz)({tableName:"vulnerability-table",idProperty:"identifier",items:t,isLoading:i,columnNames:{identifier:"ID",title:"Title",discovery:"Discovery",release:"Release",score:"Score",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.identifier}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:a,numRenderedColumns:c,propHelpers:{toolbarProps:d,paginationToolbarItemProps:o,paginationProps:h,tableProps:u,getThProps:x,getTrProps:j,getTdProps:m},expansionDerivedState:{isCellExpanded:b}}=s;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(G.o,(0,R._)((0,z._)({},d),{"aria-label":"vulnerability toolbar",children:(0,n.jsx)(H.c,{children:(0,n.jsx)(Y.E,(0,R._)((0,z._)({},o),{children:(0,n.jsx)(en.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:h})}))})})),(0,n.jsxs)($.i,(0,R._)((0,z._)({},u),{"aria-label":"vulnerability table",children:[(0,n.jsx)(W.h,{children:(0,n.jsx)(U.Tr,{children:(0,n.jsxs)(et.qK,(0,R._)((0,z._)({},s),{children:[(0,n.jsx)(J.Th,(0,z._)({},x({columnKey:"identifier"}))),(0,n.jsx)(J.Th,(0,z._)({},x({columnKey:"title"}))),(0,n.jsx)(J.Th,(0,z._)({},x({columnKey:"discovery"}))),(0,n.jsx)(J.Th,(0,z._)({},x({columnKey:"release"}))),(0,n.jsx)(J.Th,(0,z._)({},x({columnKey:"score"}))),(0,n.jsx)(J.Th,(0,z._)({},x({columnKey:"cwe"})))]}))})}),(0,n.jsx)(et.hp,{isLoading:i,isError:!!r,isNoData:0===t.length,numRenderedColumns:c,children:null==a?void 0:a.map((e,i)=>{var r;return(0,n.jsx)(Q.p,{isExpanded:b(e),children:(0,n.jsx)(U.Tr,(0,R._)((0,z._)({},j({item:e})),{children:(0,n.jsxs)(et.Cx,(0,R._)((0,z._)({},s),{item:e,rowIndex:i,children:[(0,n.jsx)(X.Td,(0,R._)((0,z._)({width:15,modifier:"breakWord"},m({columnKey:"identifier"})),{children:(0,n.jsx)(l.rU,{to:"/vulnerabilities/".concat(e.identifier),children:e.identifier})})),(0,n.jsx)(el.j,{children:(i,r)=>(0,n.jsx)(X.Td,(0,R._)((0,z._)({width:40,modifier:"truncate",onFocus:()=>r(!0),onBlur:()=>r(!1),tabIndex:0},m({columnKey:"title"})),{children:(0,n.jsx)(ee.cE,{focused:i,wrapModifier:"truncate",children:(0,n.jsx)(es.G,{vulnerability:e})})}))}),(0,n.jsx)(X.Td,(0,R._)((0,z._)({width:15},m({columnKey:"discovery"})),{children:(0,q.p6)(e.discovered)})),(0,n.jsx)(X.Td,(0,R._)((0,z._)({width:10,modifier:"truncate"},m({columnKey:"release"})),{children:(0,q.p6)(e.released)})),(0,n.jsx)(X.Td,(0,R._)((0,z._)({width:10,modifier:"truncate"},m({columnKey:"score"})),{children:e.severity&&(0,n.jsx)(er.o,{value:(0,ei.g)(e.severity),score:null!=(r=e.score)?r:null,showLabel:!0,showScore:!0})})),(0,n.jsx)(X.Td,(0,R._)((0,z._)({width:10,modifier:"truncate"},m({columnKey:"cwe"})),{children:e.cwes.join(", ")}))]}))}))},e.identifier)})})]})),(0,n.jsx)(en.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:h})]})},ed=()=>{var e,i;let[r,w]=t.useState(0),E=t.createRef(),F=t.createRef(),S=(0,g.ZX)(g.Uo.ADVISORY_ID),{advisory:B,isFetching:C,fetchError:Z}=(0,N.gw)(S),{downloadAdvisory:P}=(0,T.i)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.NP,{type:"breadcrumb",children:(0,n.jsxs)(a.a,{children:[(0,n.jsx)(c.g,{children:(0,n.jsx)(l.rU,{to:"/advisories",children:"Advisories"})}),(0,n.jsx)(c.g,{isActive:!0,children:"Advisory details"})]})}),(0,n.jsx)(s.NP,{children:(0,n.jsxs)(d.P,{children:[(0,n.jsx)(o.J,{isFilled:!0,children:(0,n.jsxs)(h.k,{children:[(0,n.jsx)(u.B,{spacer:{default:"spacerSm"},children:(0,n.jsxs)(x.V,{children:[(0,n.jsx)(x.V,{component:"h1",children:null!=(i=null!=(e=null==B?void 0:B.document_id)?e:S)?i:""}),(0,n.jsx)(x.V,{component:"p",children:"Advisory detail information"})]})}),(0,n.jsx)(u.B,{children:(null==B?void 0:B.labels.type)&&(0,n.jsx)(j._,{color:"blue",children:null==B?void 0:B.labels.type})})]})}),(0,n.jsx)(o.J,{children:!C&&(0,n.jsx)(m.zx,{variant:"secondary",icon:(0,n.jsx)(p,{}),onClick:()=>{S&&P(S,(null==B?void 0:B.identifier)?"".concat(null==B?void 0:B.identifier,".json"):"".concat(S,".json"))},children:"Download"})})]})}),(0,n.jsx)(s.NP,{children:(0,n.jsxs)(b.m,{mountOnEnter:!0,activeKey:r,onSelect:(e,i)=>{w(i)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,n.jsx)(v.O,{eventKey:0,title:(0,n.jsx)(f.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:E}),(0,n.jsx)(v.O,{eventKey:1,title:(0,n.jsx)(f.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:F})]})}),(0,n.jsxs)(s.NP,{children:[(0,n.jsx)(y.I,{eventKey:0,id:"refTabInfoSection",ref:E,"aria-label":"Information of the Advisory",children:(0,n.jsx)(_.u,{isFetching:C,fetchError:Z,children:B&&(0,n.jsx)(A,{advisory:B})})}),(0,n.jsx)(y.I,{eventKey:1,id:"refVulnerabilitiesSection",ref:F,"aria-label":"Vulnerabilities within the SBOM",hidden:!0,children:(0,n.jsx)(ec,{isFetching:C,fetchError:Z,vulnerabilities:(null==B?void 0:B.vulnerabilities)||[]})})]})]})}},15167:function(e,i,r){r.d(i,{q:()=>c});var n=r(24246),t=r(27378),l=r(24502),s=r(15726),a=r(17598);let c=e=>{let{advisory:i,onClose:r}=e,{pushNotification:c}=t.useContext(s.c),[d,o]=t.useState(""),[h,u]=t.useState(""),{labels:x}=(0,a.VY)(h);t.useEffect(()=>{let e=setTimeout(()=>{u(d)},400);return()=>clearTimeout(e)},[d]);let{mutate:j,isPending:m}=(0,a.sj)(()=>{c({title:"Labels updated for Advisory ".concat(i.document_id),variant:"success"}),r()},e=>{c({title:"Error while updating labels for Advisory ".concat(i.document_id),variant:"danger"})});return(0,n.jsx)(l.M,{title:"Labels of Advisory: ".concat(i.document_id),value:i.labels,isDisabled:m,onSave:e=>{j({id:i.uuid,labels:e})},onClose:r,onInputChange:o,options:x})}},17598:function(e,i,r){r.d(i,{N7:()=>v,VY:()=>b,gw:()=>f,sj:()=>p,tG:()=>y});var n=r(79192),t=r(53195),l=r(70186),s=r(1183),a=r(24038),c=r(68e3),d=r(75503),o=r(50576),h=r(40371),u=r(87017),x=r(49988),j=r(95169);let m="advisories",b=e=>{let{data:i,isLoading:r,error:n,refetch:t}=(0,s.a)({queryKey:[m,"labels",e],queryFn:()=>(0,h.sf)({client:o.L,query:{limit:10,filter_text:e}}),placeholderData:a.Wk});return{labels:(null==i?void 0:i.data)||[],isFetching:r,fetchError:n,refetch:t}},v=function(){var e,i,r;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,x.rm)(a),{q:j}=u,b=(0,l._)(u,["q"]),v=(0,x.Rb)(c),{data:f,isLoading:y,error:p,refetch:g}=(0,s.a)({queryKey:[m,a,v],queryFn:()=>(0,h.A1)({client:o.L,query:(0,t._)((0,n._)({},b),{q:[j,v].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==f||null==(e=f.data)?void 0:e.items)||[],total:null!=(r=null==f||null==(i=f.data)?void 0:i.total)?r:0,params:a},isFetching:y,fetchError:p||null,refetch:g}},f=e=>{let{data:i,isLoading:r,error:n}=(0,s.a)({queryKey:[m,e],queryFn:()=>(0,h.pB)({client:o.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==i?void 0:i.data,isFetching:r,fetchError:n}},y=()=>{let e=(0,c.NL)();return(0,j.V)({parallel:!0,uploadFn:(e,i)=>(0,u.Cu)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},p=(e,i)=>{let r=(0,c.NL)();return(0,d.D)({mutationFn:e=>(0,h.m5)({client:o.L,path:{id:e.id},body:e.labels}),onSuccess:async(i,n)=>{e(),await r.invalidateQueries({queryKey:[m]})},onError:i})}},65872:function(e,i,r){r.d(i,{Z:()=>c});let n=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],t=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],l=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],s=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],a=(e,i,r)=>{let n=e;return"string"==typeof i||Array.isArray(i)?n=e.toLocaleString(i,r):(!0===i||void 0!==r)&&(n=e.toLocaleString(void 0,r)),n};function c(e,i){let r;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let c=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?s:l:i.binary?t:n,d=i.space?" ":"";if(i.signed&&0===e)return` 0${d}${c[0]}`;let o=e<0,h=o?"-":i.signed?"+":"";if(o&&(e=-e),void 0!==i.minimumFractionDigits&&(r={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(r={maximumFractionDigits:i.maximumFractionDigits,...r}),e<1)return h+a(e,i.locale,r)+d+c[0];let u=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),c.length-1);return e/=(i.binary?1024:1e3)**u,r||(e=e.toPrecision(3)),h+a(Number(e),i.locale,r)+d+c[u]}}}]);