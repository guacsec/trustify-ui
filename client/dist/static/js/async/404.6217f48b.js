"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["404"],{32947:function(e,t,a){a.d(t,{A0:()=>c,V4:()=>u,XE:()=>d});var r=a(1811),s=a(24917),n=a(4720),o=a(54178),l=a(37106),i=a(34313);let u={unknown:{name:"Unknown",color:r.P,progressProps:{variant:void 0}},none:{name:"None",color:s.E,progressProps:{variant:void 0}},low:{name:"Low",color:n.c,progressProps:{variant:void 0}},medium:{name:"Medium",color:o.L,progressProps:{variant:"warning"}},high:{name:"High",color:l.H,progressProps:{variant:"danger"}},critical:{name:"Critical",color:i.J,progressProps:{variant:"danger"}}},d=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function c(e){return(t,a)=>d(e(t))-d(e(a))}},7615:function(e,t,a){a.d(t,{g:()=>r});let r=e=>e??"unknown"},87017:function(e,t,a){a.d(t,{Co:()=>c,Cu:()=>u,Hb:()=>d});var r=a(70233),s=a(74502);a(41947);let n="/api",o=`${n}/v2/advisory`,l=`${n}/v2/sbom`,i=e=>{let t="application/json";return e.name.endsWith(".bz2")&&(t="application/json+bzip2"),t},u=(e,t)=>{let a=e.get(s.TB);return r.Z.post(`${o}`,a,{...t,headers:{"Content-Type":i(a)}})},d=(e,t)=>{let a=e.get(s.TB);return r.Z.post(`${l}`,a,{...t,headers:{"Content-Type":i(a)}})},c=e=>r.Z.get(`${l}/${e}/license-export`,{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},37818:function(e,t,a){a.d(t,{u:()=>l});var r=a(24246),s=a(8305),n=a(13754),o=a(39826);let l=e=>e.isFetching?e.isFetchingState||(0,r.jsx)(s.b,{children:(0,r.jsx)(n.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,r.jsx)(o.y,{}):e.children},39826:function(e,t,a){a.d(t,{y:()=>l});var r=a(24246),s=a(10707),n=a(16668),o=a(42160);let l=()=>(0,r.jsx)(s.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:o.ZP,variant:s.IQ.sm,children:(0,r.jsx)(n.B,{children:"There was an error retrieving data. Check your connection and try again."})})},82413:function(e,t,a){a.d(t,{useVulnerabilitiesOfSbom:()=>d,useVulnerabilitiesOfSboms:()=>c});var r=a(27378),s=a(7615),n=a(43959);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,l={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},i={vulnerabilityStatus:{affected:{...l},fixed:{...l},not_affected:{...l},known_not_affected:{...l}}},u=e=>{let t=e.flatMap(e=>(e.status??[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))).reduce((e,t)=>{let a,r=e.find(e=>o(e,t));if(r)a=[...e.filter(e=>!o(e,r)),{...r,relatedPackages:[...r.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];else{let r={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};a=[...e.slice(),r]}return a},[]),a=t.reduce((e,t)=>{let a=t.vulnerabilityStatus,r=(0,s.g)(t.vulnerability.average_severity),n=e.vulnerabilityStatus[a];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[a]:{total:n.total+1,severities:{...n.severities,[r]:n.severities[r]+1}}}})},{...i});return{vulnerabilities:t,summary:a}},d=e=>{let{advisories:t,isFetching:a,fetchError:s}=(0,n.useFetchSbomsAdvisory)(e);return{data:r.useMemo(()=>u(t||[]),[t]),isFetching:a,fetchError:s}},c=e=>{let{advisories:t,isFetching:a,fetchError:s}=(0,n.useFetchSbomsAdvisoryBatch)(e);return{data:r.useMemo(()=>(t??[]).map(e=>u(e||[])),[t]),isFetching:a,fetchError:s}}},95169:function(e,t,a){a.d(t,{V:()=>d});var r=a(27378),s=a(74502),n=a(70233);let o="cancelled",l=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),i=(e,t)=>{switch(t.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),status:"queued",cancelFn:t.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),progress:t.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),status:"complete",response:t.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),status:"complete",error:t.payload.error,wasCancelled:t.payload.error?.message===o})};case"removeUpload":{let a=new Map(e.uploads);return a.delete(t.payload.file),{...e,uploads:a}}default:throw Error()}},u=()=>({uploads:new Map}),d=e=>{let{parallel:t,uploadFn:a,onSuccess:l,onError:d}=e,[c,p]=r.useReducer(i,u());return{uploads:c.uploads,handleUpload:e=>{let r=[];for(let t=0;t<e.length;t++){let a=e[t],i=new FormData;i.set(s.TB,a);let u=n.Z.CancelToken.source(),c={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{let t=e.total??1;p({type:"updateUploadProgress",payload:{file:a,progress:Math.round(e.loaded/t*100)}})},cancelToken:u.token};p({type:"queueUpload",payload:{file:a,cancelFn:u}});let y={formData:i,config:c,thenFn:e=>{p({type:"finishUploadSuccessfully",payload:{file:a,response:e}}),l&&l(e,a)},catchFn:e=>{p({type:"finishUploadWithError",payload:{file:a,error:e}}),e.message!==o&&d&&d(e,a)}};r.push(y)}if(t)for(let e of r)a(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else r.reduce(async(e,t)=>(await e,a(t.formData,t.config).then(t.thenFn).catch(t.catchFn)),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(o)},handleRemoveUpload:e=>{p({type:"removeUpload",payload:{file:e}})}}}},43959:function(e,t,a){a.d(t,{useFetchSBOMById:()=>y,useFetchSBOMs:()=>p,useFetchSbomsAdvisory:()=>f,useFetchSbomsAdvisoryBatch:()=>g,useFetchSbomsByPackageId:()=>v,useUploadSBOM:()=>h});var r=a(1183),s=a(68e3),n=a(16072),o=a(50576),l=a(40371),i=a(95169),u=a(87017),d=a(47169);let c="sboms",p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:a,isLoading:s,error:n,refetch:i}=(0,r.useQuery)({queryKey:[c,e],queryFn:()=>(0,l.Wp)({client:o.L,query:{...(0,d.rm)(e)}}),enabled:!t});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e??e},isFetching:s,fetchError:n,refetch:i}},y=e=>{let{data:t,isLoading:a,error:s}=(0,r.useQuery)({queryKey:[c,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,l._Q)({client:o.L,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:a,fetchError:s}},h=()=>{let e=(0,s.NL)();return(0,i.V)({parallel:!0,uploadFn:(e,t)=>(0,u.Hb)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[c]})}})},v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:a,isLoading:s,error:n,refetch:i}=(0,r.useQuery)({queryKey:["SBOMsQueryKeysss","by-package",e,t],queryFn:()=>(0,l.DU)({client:o.L,query:{purl:e,...(0,d.rm)(t)}})});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:t??t},isFetching:s,fetchError:n,refetch:i}},f=e=>{let{data:t,isLoading:a,error:s}=(0,r.useQuery)({queryKey:[c,e,"advisory"],queryFn:()=>(0,l.NU)({client:o.L,path:{id:e}})});return{advisories:t?.data||[],isFetching:a,fetchError:s}},g=e=>{let t=(0,n.h)({queries:e.map(e=>({queryKey:[c,e,"advisory"],queryFn:()=>(0,l.NU)({client:o.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return t?.data||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}}}}]);