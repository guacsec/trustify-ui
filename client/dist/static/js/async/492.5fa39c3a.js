"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["492"],{69876:function(e,t,l){l.d(t,{D:()=>a});var r=l(24246),i=l(70400);let a=e=>{let{value:t}=e;return(0,r.jsx)(r.Fragment,{children:Object.entries(t).map(e=>{let[t,l]=e;return(0,r.jsx)(i._,{isCompact:!0,children:"".concat(t,"=").concat(l)},"".concat(t,"=").concat(l))})})}},31373:function(e,t,l){l.d(t,{H:()=>d});var r=l(79192),i=l(53195),a=l(27378),n=l(7615),s=l(59015);let u=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,o={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:(0,r._)({},o),fixed:(0,r._)({},o),not_affected:(0,r._)({},o),known_not_affected:(0,r._)({},o)}},d=e=>{let{pkg:t,isFetching:l,fetchError:o}=(0,s.ZA)(e);return{data:a.useMemo(()=>(e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>{let l=(0,n.g)(t.average_severity);return{vulnerability:(0,i._)((0,r._)({},t.vulnerability),{average_severity:l,average_score:t.average_score}),vulnerabilityStatus:t.status,advisory:e}})}).reduce((e,t)=>{let l,a=e.find(e=>u(e,t));if(a)l=[...e.filter(e=>!u(e,a)),(0,i._)((0,r._)({},a),{relatedSboms:[...a.relatedSboms,{advisory:t.advisory}]})];else{let r={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};l=[...e.slice(),r]}return l},[]),l=t.reduce((e,t)=>{let l=t.vulnerabilityStatus,a=t.vulnerability.average_severity,n=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,i._)((0,r._)({},e.vulnerabilityStatus),{[l]:{total:n.total+1,severities:(0,i._)((0,r._)({},n.severities),{[a]:n.severities[a]+1})}})})},(0,r._)({},c));return{vulnerabilities:t,summary:l}})((null==t?void 0:t.advisories)||[]),[t]),isFetching:l,fetchError:o}}},96308:function(e,t,l){l.d(t,{n:()=>o});var r=l(24246),i=l(11797),a=l(37818),n=l(42573),s=l(49304),u=l(31373);let o=e=>{let{packageId:t}=e,{data:l,isFetching:o,fetchError:c}=(0,u.H)(t);return(0,r.jsx)(a.u,{isFetching:o,fetchError:c,isFetchingState:(0,r.jsx)(i.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,r.jsx)(n.C,{error:e}),children:(0,r.jsx)(s.u,{severities:l.summary.vulnerabilityStatus.affected.severities})})}},33384:function(e,t,l){l.d(t,{a:()=>v,u:()=>p});var r=l(79192),i=l(53195),a=l(24246),n=l(27378),s=l(74502),u=l(14629),o=l(49988),c=l(59015),d=l(63706);let v=n.createContext({}),p=e=>{let{children:t}=e,l=(0,o.vZ)({tableName:"packages",persistenceKeyPrefix:s.yq.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:s.L4,title:"Filter text",placeholderText:"Search",type:u.vA.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:u.vA.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:u.vA.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:p,total:h},isFetching:m,fetchError:y}=(0,c.fF)((0,o.QO)((0,i._)((0,r._)({},l),{hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}}))),_=n.useMemo(()=>p.map(e=>(0,i._)((0,r._)({},e),{decomposedPurl:(0,d.qX)(e.purl)})),[p]),b=(0,o.KC)((0,i._)((0,r._)({},l),{idProperty:"uuid",currentPageItems:_,totalItemCount:h,isLoading:m}));return(0,a.jsx)(v.Provider,{value:{totalItemCount:h,isFetching:m,fetchError:y,tableControls:b},children:t})}},75778:function(e,t,l){l.d(t,{L:()=>x});var r=l(79192),i=l(53195),a=l(24246),n=l(27378),s=l(65783),u=l(4835),o=l(14350),c=l(11165),d=l(89330),v=l(31423),p=l(94154),h=l(69876),m=l(3804),y=l(31336),_=l(96308),b=l(33384);let x=()=>{let{isFetching:e,fetchError:t,totalItemCount:l,tableControls:x}=n.useContext(b.a),{numRenderedColumns:f,currentPageItems:g,propHelpers:{paginationProps:j,tableProps:K,getThProps:P,getTrProps:T,getTdProps:S}}=x;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u.i,(0,i._)((0,r._)({},K),{"aria-label":"Package table",children:[(0,a.jsx)(o.h,{children:(0,a.jsx)(c.Tr,{children:(0,a.jsxs)(y.qK,(0,i._)((0,r._)({},x),{children:[(0,a.jsx)(d.Th,(0,r._)({},P({columnKey:"name"}))),(0,a.jsx)(d.Th,(0,r._)({},P({columnKey:"namespace"}))),(0,a.jsx)(d.Th,(0,r._)({},P({columnKey:"version"}))),(0,a.jsx)(d.Th,(0,r._)({},P({columnKey:"type"}))),(0,a.jsx)(d.Th,(0,r._)({},P({columnKey:"path"}))),(0,a.jsx)(d.Th,(0,r._)({},P({columnKey:"qualifiers"}))),(0,a.jsx)(d.Th,(0,r._)({},P({columnKey:"vulnerabilities"})))]}))})}),(0,a.jsx)(y.hp,{isLoading:e,isError:!!t,isNoData:0===l,numRenderedColumns:f,children:g.map((e,t)=>{var l,n,u,o,d,m,b;return(0,a.jsx)(v.p,{children:(0,a.jsx)(c.Tr,(0,i._)((0,r._)({},T({item:e})),{children:(0,a.jsxs)(y.Cx,(0,i._)((0,r._)({},x),{item:e,rowIndex:t,children:[(0,a.jsx)(p.Td,(0,i._)((0,r._)({width:15,modifier:"breakWord"},S({columnKey:"name"})),{children:(0,a.jsx)(s.OL,{to:"/packages/".concat(e.uuid),children:e.decomposedPurl?null==(l=e.decomposedPurl)?void 0:l.name:e.purl})})),(0,a.jsx)(p.Td,(0,i._)((0,r._)({width:15,modifier:"truncate"},S({columnKey:"namespace"})),{children:null==(n=e.decomposedPurl)?void 0:n.namespace})),(0,a.jsx)(p.Td,(0,i._)((0,r._)({width:10,modifier:"truncate"},S({columnKey:"version"})),{children:null==(u=e.decomposedPurl)?void 0:u.version})),(0,a.jsx)(p.Td,(0,i._)((0,r._)({width:10,modifier:"truncate"},S({columnKey:"type"})),{children:null==(o=e.decomposedPurl)?void 0:o.type})),(0,a.jsx)(p.Td,(0,i._)((0,r._)({width:10,modifier:"truncate"},S({columnKey:"path"})),{children:null==(d=e.decomposedPurl)?void 0:d.path})),(0,a.jsx)(p.Td,(0,i._)((0,r._)({width:20},S({columnKey:"qualifiers"})),{children:(null==(m=e.decomposedPurl)?void 0:m.qualifiers)&&(0,a.jsx)(h.D,{value:null==(b=e.decomposedPurl)?void 0:b.qualifiers})})),(0,a.jsx)(p.Td,(0,i._)((0,r._)({width:20},S({columnKey:"vulnerabilities"})),{children:(0,a.jsx)(_.n,{packageId:e.uuid})}))]}))}))},e.uuid)})})]})),(0,a.jsx)(m.p,{idPrefix:"package-table",isTop:!1,paginationProps:j})]})}},39305:function(e,t,l){l.d(t,{v:()=>p});var r=l(79192),i=l(53195),a=l(24246),n=l(27378),s=l(70715),u=l(40982),o=l(89226),c=l(14629),d=l(3804),v=l(33384);let p=e=>{let{showFilters:t}=e,{tableControls:l}=n.useContext(v.a),{propHelpers:{toolbarProps:p,filterToolbarProps:h,paginationToolbarItemProps:m,paginationProps:y}}=l;return(0,a.jsx)(s.o,(0,i._)((0,r._)({},p),{"aria-label":"package-toolbar",children:(0,a.jsxs)(u.c,{children:[t&&(0,a.jsx)(c.Ki,(0,r._)({},h)),(0,a.jsx)(o.E,(0,i._)((0,r._)({},m),{children:(0,a.jsx)(d.p,{idPrefix:"package-table",isTop:!0,paginationProps:y})}))]})}))}},59015:function(e,t,l){l.d(t,{D4:()=>d,ZA:()=>c,fF:()=>o});var r=l(79192),i=l(1183),a=l(50576),n=l(40371),s=l(49988);let u="packages",o=function(){var e,t,l;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:d,isLoading:v,error:p,refetch:h}=(0,i.a)({queryKey:[u,o],queryFn:()=>(0,n.tj)({client:a.L,query:(0,r._)({},(0,s.rm)(o))}),enabled:!c});return{result:{data:(null==d||null==(e=d.data)?void 0:e.items)||[],total:null!=(l=null==d||null==(t=d.data)?void 0:t.total)?l:0,params:o},isFetching:v,fetchError:p,refetch:h}},c=e=>{let{data:t,isLoading:l,error:r}=(0,i.a)({queryKey:[u,e],queryFn:()=>(0,n.BK)({client:a.L,path:{key:e}})});return{pkg:null==t?void 0:t.data,isFetching:l,fetchError:r}},d=function(e){var t,l,o;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d,isLoading:v,error:p,refetch:h}=(0,i.a)({queryKey:[u,"by-sbom",e,c],queryFn:()=>(0,n.Pg)({client:a.L,path:{id:e},query:(0,r._)({},(0,s.rm)(c))})});return{result:{data:(null==d||null==(t=d.data)?void 0:t.items)||[],total:null!=(o=null==d||null==(l=d.data)?void 0:l.total)?o:0,params:c},isFetching:v,fetchError:p,refetch:h}}}}]);