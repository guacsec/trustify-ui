"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["305"],{97339:function(e,t,r){r.d(t,{a:()=>c});var i=r(59390),s=r(24246),a=r(27378),n=r(90633),l=r(15508),o=r(53315);let c=e=>{var{children:t=null,className:r="","aria-label":d="Breadcrumb",ouiaId:u,ouiaSafe:h=!0}=e,p=(0,i.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let b=(0,o.S$)(c.displayName,u,h);return(0,s.jsx)("nav",Object.assign({},p,{"aria-label":d,className:(0,l.i)(n.Z.breadcrumb,r)},b,{children:(0,s.jsx)("ol",{className:n.Z.breadcrumbList,role:"list",children:a.Children.map(t,(e,t)=>(0,a.isValidElement)(e)?(0,a.cloneElement)(e,{showDivider:t>0}):e)})}))};c.displayName="Breadcrumb"},18091:function(e,t,r){r.d(t,{g:()=>o});var i=r(59390),s=r(24246),a=r(91985),n=r(90633),l=r(15508);let o=e=>{var{children:t=null,className:r="",to:o,isActive:c=!1,isDropdown:d=!1,showDivider:u,target:h,component:p="a",render:b}=e,f=(0,i.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let m=c?"page":void 0,v=(0,l.i)(n.Z.breadcrumbLink,c&&n.Z.modifiers.current);return(0,s.jsxs)("li",Object.assign({},f,{className:(0,l.i)(n.Z.breadcrumbItem,r),children:[u&&(0,s.jsx)("span",{className:n.Z.breadcrumbItemDivider,children:(0,s.jsx)(a.ZP,{})}),"button"===p&&(0,s.jsx)("button",{className:v,"aria-current":m,type:"button",children:t}),d&&(0,s.jsx)("span",{className:(0,l.i)(n.Z.breadcrumbDropdown),children:t}),b&&b({className:v,ariaCurrent:m}),o&&!b&&(0,s.jsx)(p,{href:o,target:h,className:v,"aria-current":m,children:t}),!o&&"button"!==p&&!d&&t]}))};o.displayName="BreadcrumbItem"},27317:function(e,t,r){r.d(t,{K:()=>l});var i=r(59390),s=r(24246),a=r(33625),n=r(15508);let l=e=>{var{hasGutter:t=!1,className:r="",children:l=null,component:o="div"}=e,c=(0,i.__rest)(e,["hasGutter","className","children","component"]);return(0,s.jsx)(o,Object.assign({},c,{className:(0,n.i)(a.Z.stack,t&&a.Z.modifiers.gutter,r),children:l}))};l.displayName="Stack"},93095:function(e,t,r){r.d(t,{v:()=>l});var i=r(59390),s=r(24246),a=r(33625),n=r(15508);let l=e=>{var{isFilled:t=!1,className:r="",children:l=null,component:o="div"}=e,c=(0,i.__rest)(e,["isFilled","className","children","component"]);return(0,s.jsx)(o,Object.assign({},c,{className:(0,n.i)(a.Z.stackItem,t&&a.Z.modifiers.fill,r),children:l}))};l.displayName="StackItem"},35676:function(e,t,r){r.d(t,{ZP:()=>i});let i=(0,r(24329).I)({name:"ShieldAltIcon",height:512,width:512,svgPath:"M466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256.1 446.3l-.1-381 175.9 73.3c-3.3 151.4-82.1 261.1-175.8 307.7z",yOffset:0,xOffset:0})},34313:function(e,t,r){r.d(t,{J:()=>i});let i={name:"--pf-t--global--icon--color--severity--critical--default",value:"#b1380b",var:"var(--pf-t--global--icon--color--severity--critical--default)"}},37106:function(e,t,r){r.d(t,{H:()=>i});let i={name:"--pf-t--global--icon--color--severity--important--default",value:"#ca6c0f",var:"var(--pf-t--global--icon--color--severity--important--default)"}},4720:function(e,t,r){r.d(t,{c:()=>i});let i={name:"--pf-t--global--icon--color--severity--minor--default",value:"#707070",var:"var(--pf-t--global--icon--color--severity--minor--default)"}},54178:function(e,t,r){r.d(t,{L:()=>i});let i={name:"--pf-t--global--icon--color--severity--moderate--default",value:"#dca614",var:"var(--pf-t--global--icon--color--severity--moderate--default)"}},24917:function(e,t,r){r.d(t,{E:()=>i});let i={name:"--pf-t--global--icon--color--severity--none--default",value:"#4394e5",var:"var(--pf-t--global--icon--color--severity--none--default)"}},1811:function(e,t,r){r.d(t,{P:()=>i});let i={name:"--pf-t--global--icon--color--severity--undefined--default",value:"#c7c7c7",var:"var(--pf-t--global--icon--color--severity--undefined--default)"}},32947:function(e,t,r){r.d(t,{A0:()=>u,V4:()=>c,XE:()=>d});var i=r(1811),s=r(24917),a=r(4720),n=r(54178),l=r(37106),o=r(34313);let c={unknown:{name:"Unknown",color:i.P,progressProps:{variant:void 0}},none:{name:"None",color:s.E,progressProps:{variant:void 0}},low:{name:"Low",color:a.c,progressProps:{variant:void 0}},medium:{name:"Medium",color:n.L,progressProps:{variant:"warning"}},high:{name:"High",color:l.H,progressProps:{variant:"danger"}},critical:{name:"Critical",color:o.J,progressProps:{variant:"danger"}}},d=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function u(e){return(t,r)=>d(e(t))-d(e(r))}},7615:function(e,t,r){r.d(t,{g:()=>i});let i=e=>e??"unknown"},87017:function(e,t,r){r.d(t,{Co:()=>u,Cu:()=>c,Hb:()=>d});var i=r(70233),s=r(74502);r(41947);let a="/api",n=`${a}/v2/advisory`,l=`${a}/v2/sbom`,o=e=>{let t="application/json";return e.name.endsWith(".bz2")&&(t="application/json+bzip2"),t},c=(e,t)=>{let r=e.get(s.TB);return i.Z.post(`${n}`,r,{...t,headers:{"Content-Type":o(r)}})},d=(e,t)=>{let r=e.get(s.TB);return i.Z.post(`${l}`,r,{...t,headers:{"Content-Type":o(r)}})},u=e=>i.Z.get(`${l}/${e}/license-export`,{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},37818:function(e,t,r){r.d(t,{u:()=>l});var i=r(24246),s=r(8305),a=r(13754),n=r(39826);let l=e=>e.isFetching?e.isFetchingState||(0,i.jsx)(s.b,{children:(0,i.jsx)(a.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,i.jsx)(n.y,{}):e.children},69876:function(e,t,r){r.d(t,{D:()=>a});var i=r(24246),s=r(70400);let a=e=>{let{value:t}=e;return(0,i.jsx)(i.Fragment,{children:Object.entries(t).map(e=>{let[t,r]=e;return(0,i.jsx)(s._,{isCompact:!0,children:`${t}=${r}`},`${t}=${r}`)})})}},57524:function(e,t,r){r.d(t,{o:()=>c});var i=r(24246),s=r(34747),a=r(46770),n=r(2499),l=r(35676),o=r(32947);let c=e=>{let{value:t,score:r,showScore:c,showLabel:d}=e,u=o.V4[t],h=u.name;return(0,i.jsxs)(s.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,i.jsx)(a.B,{children:d?(0,i.jsx)(l.ZP,{color:u.color.value}):(0,i.jsx)(n.u,{content:h,children:(0,i.jsx)(l.ZP,{color:u.color.value})})}),d&&(0,i.jsx)(a.B,{children:h}),c&&null!==r&&(0,i.jsxs)(a.B,{children:["(",Math.round(10*r)/10,")"]})]})}},3804:function(e,t,r){r.d(t,{p:()=>a});var i=r(24246),s=r(27230);let a=e=>{let{paginationProps:t,isTop:r,isCompact:a=!1,idPrefix:n=""}=e;return(0,i.jsx)(s.t,{id:`${n?`${n}-`:""}pagination-${r?"top":"bottom"}`,variant:r?s.a.top:s.a.bottom,isCompact:a,...t,widgetId:"pagination-id"})}},39826:function(e,t,r){r.d(t,{y:()=>l});var i=r(24246),s=r(10707),a=r(16668),n=r(42160);let l=()=>(0,i.jsx)(s.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:n.ZP,variant:s.IQ.sm,children:(0,i.jsx)(a.B,{children:"There was an error retrieving data. Check your connection and try again."})})},31336:function(e,t,r){r.d(t,{hp:()=>f,qK:()=>v,Cx:()=>y});var i=r(24246),s=r(8305),a=r(13754),n=r(31423),l=r(11165),o=r(94154),c=r(39826),d=r(10707),u=r(16668),h=r(22119);let p=e=>{let{title:t,description:r}=e;return(0,i.jsx)(d.ub,{titleText:t,headingLevel:"h4",icon:h.ZP,variant:d.IQ.sm,children:r&&(0,i.jsx)(u.B,{children:r})})},b=()=>(0,i.jsx)(p,{title:"No data available",description:"No data available to be shown here."}),f=e=>{let{numRenderedColumns:t,isLoading:r=!1,isError:d=!1,isNoData:u=!1,errorEmptyState:h=null,noDataEmptyState:p=null,children:f}=e;return(0,i.jsx)(i.Fragment,{children:r?(0,i.jsx)(n.p,{children:(0,i.jsx)(l.Tr,{children:(0,i.jsx)(o.Td,{colSpan:t,children:(0,i.jsx)(s.b,{children:(0,i.jsx)(a.$,{size:"xl"})})})})}):d?(0,i.jsx)(n.p,{"aria-label":"Table error",children:(0,i.jsx)(l.Tr,{children:(0,i.jsx)(o.Td,{colSpan:t,children:(0,i.jsx)(s.b,{children:h||(0,i.jsx)(c.y,{})})})})}):u?(0,i.jsx)(n.p,{"aria-label":"Table error",children:(0,i.jsx)(l.Tr,{children:(0,i.jsx)(o.Td,{colSpan:t,children:(0,i.jsx)(s.b,{children:p||(0,i.jsx)(b,{})})})})}):f})};var m=r(89330);let v=e=>{let{numColumnsBeforeData:t,numColumnsAfterData:r,children:s}=e;return(0,i.jsxs)(i.Fragment,{children:[Array(t).fill(null).map((e,t)=>(0,i.jsx)(m.Th,{screenReaderText:`before-data-${t}`},t)),s,Array(r).fill(null).map((e,t)=>(0,i.jsx)(m.Th,{screenReaderText:`after-data-${t}`},t))]})},y=e=>{let{isExpansionEnabled:t=!1,expandableVariant:r,isSelectionEnabled:s=!1,propHelpers:{getSingleExpandButtonTdProps:a,getSelectCheckboxTdProps:n},item:l,rowIndex:c,children:d}=e;return(0,i.jsxs)(i.Fragment,{children:[t&&"single"===r?(0,i.jsx)(o.Td,{...a({item:l,rowIndex:c})}):null,s?(0,i.jsx)(o.Td,{...n({item:l,rowIndex:c})}):null,d]})}},3586:function(e,t,r){r.d(t,{j:()=>a});var i=r(24246),s=r(27378);let a=e=>{let{children:t}=e,[r,a]=s.useState(!1);return(0,i.jsx)(i.Fragment,{children:t(r,a)})}},24200:function(e,t,r){r.d(t,{G:()=>s});var i=r(24246);let s=e=>{let{vulnerability:t}=e;return(0,i.jsxs)("p",{children:[t.withdrawn&&(0,i.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})}},31373:function(e,t,r){r.d(t,{H:()=>d});var i=r(27378),s=r(7615),a=r(59015);let n=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,l={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:{...l},fixed:{...l},not_affected:{...l},known_not_affected:{...l}}},c=e=>{let t=e.flatMap(e=>(e.status??[]).map(t=>{let r=(0,s.g)(t.average_severity);return{vulnerability:{...t.vulnerability,average_severity:r,average_score:t.average_score},vulnerabilityStatus:t.status,advisory:e}})).reduce((e,t)=>{let r,i=e.find(e=>n(e,t));if(i)r=[...e.filter(e=>!n(e,i)),{...i,relatedSboms:[...i.relatedSboms,{advisory:t.advisory}]}];else{let i={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};r=[...e.slice(),i]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,i=t.vulnerability.average_severity,s=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:s.total+1,severities:{...s.severities,[i]:s.severities[i]+1}}}})},{...o});return{vulnerabilities:t,summary:r}},d=e=>{let{pkg:t,isFetching:r,fetchError:s}=(0,a.ZA)(e);return{data:i.useMemo(()=>c(t?.advisories||[]),[t]),isFetching:r,fetchError:s}}},95169:function(e,t,r){r.d(t,{V:()=>d});var i=r(27378),s=r(74502),a=r(70233);let n="cancelled",l=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),o=(e,t)=>{switch(t.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),status:"queued",cancelFn:t.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),progress:t.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),status:"complete",response:t.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),status:"complete",error:t.payload.error,wasCancelled:t.payload.error?.message===n})};case"removeUpload":{let r=new Map(e.uploads);return r.delete(t.payload.file),{...e,uploads:r}}default:throw Error()}},c=()=>({uploads:new Map}),d=e=>{let{parallel:t,uploadFn:r,onSuccess:l,onError:d}=e,[u,h]=i.useReducer(o,c());return{uploads:u.uploads,handleUpload:e=>{let i=[];for(let t=0;t<e.length;t++){let r=e[t],o=new FormData;o.set(s.TB,r);let c=a.Z.CancelToken.source(),u={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{let t=e.total??1;h({type:"updateUploadProgress",payload:{file:r,progress:Math.round(e.loaded/t*100)}})},cancelToken:c.token};h({type:"queueUpload",payload:{file:r,cancelFn:c}});let p={formData:o,config:u,thenFn:e=>{h({type:"finishUploadSuccessfully",payload:{file:r,response:e}}),l&&l(e,r)},catchFn:e=>{h({type:"finishUploadWithError",payload:{file:r,error:e}}),e.message!==n&&d&&d(e,r)}};i.push(p)}if(t)for(let e of i)r(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else i.reduce(async(e,t)=>(await e,r(t.formData,t.config).then(t.thenFn).catch(t.catchFn)),Promise.resolve())},handleCancelUpload:e=>{u.uploads.get(e)?.cancelFn?.cancel(n)},handleRemoveUpload:e=>{h({type:"removeUpload",payload:{file:e}})}}}},47939:function(e,t,r){r.r(t),r.d(t,{default:()=>Y});var i=r(24246),s=r(27378),a=r(65783),n=r(45043),l=r(97339),o=r(18091),c=r(27317),d=r(93095),u=r(68802),h=r(34747),p=r(46770),b=r(4075),f=r(27090),m=r(75165),v=r(31762),y=r(99),g=r(24787),x=r(12621),j=r(9839),S=r(37818),w=r(69876),T=r(59015),E=r(63706),F=r(70715),P=r(40982),k=r(89226),C=r(4835),q=r(14350),_=r(11165),K=r(89330),O=r(31423),R=r(94154),N=r(74502),M=r(72603),Z=r(3804),U=r(31336),I=r(47169),L=r(22048),$=r(43959);let B=e=>{let{purl:t}=e,r=(0,I.vZ)({tableName:"sboms",persistenceKeyPrefix:N.yq.sboms_by_package,columnNames:{name:"Name",version:"Version",supplier:"Supplier"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:M.vA.search}]}),{result:{data:s,total:n},isFetching:l,fetchError:o}=(0,$.Oh)(t,(0,I.QO)({...r,hubSortFieldKeys:{name:"name"}})),c=(0,I.KC)({...r,idProperty:"id",currentPageItems:s,totalItemCount:n,isLoading:l,selectionState:(0,L.U)({items:s,isEqual:(e,t)=>e.id===t.id})}),{numRenderedColumns:d,currentPageItems:u,propHelpers:{toolbarProps:h,paginationToolbarItemProps:p,paginationProps:b,tableProps:f,getThProps:m,getTrProps:v,getTdProps:y}}=c;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(F.o,{...h,children:(0,i.jsx)(P.c,{children:(0,i.jsx)(k.E,{...p,children:(0,i.jsx)(Z.p,{idPrefix:"sbom-table",isTop:!0,paginationProps:b})})})}),(0,i.jsxs)(C.i,{...f,"aria-label":"SBOM table",children:[(0,i.jsx)(q.h,{children:(0,i.jsx)(_.Tr,{children:(0,i.jsxs)(U.qK,{...c,children:[(0,i.jsx)(K.Th,{...m({columnKey:"name"})}),(0,i.jsx)(K.Th,{...m({columnKey:"version"})}),(0,i.jsx)(K.Th,{...m({columnKey:"supplier"})})]})})}),(0,i.jsx)(U.hp,{isLoading:l,isError:!!o,isNoData:0===n,numRenderedColumns:d,children:u?.map(e=>(0,i.jsx)(O.p,{children:(0,i.jsxs)(_.Tr,{...v({item:e}),children:[(0,i.jsx)(R.Td,{width:35,modifier:"breakWord",...y({columnKey:"name"}),children:(0,i.jsx)(a.rU,{to:`/sboms/${e.id}`,children:e.name})}),(0,i.jsx)(R.Td,{width:15,modifier:"truncate",...y({columnKey:"version"}),children:e.described_by.map(e=>e.version).join(", ")}),(0,i.jsx)(R.Td,{width:50,modifier:"truncate",...y({columnKey:"supplier"}),children:e.suppliers.join(", ")})]})},e.id))})]}),(0,i.jsx)(Z.p,{idPrefix:"sbom-table",isTop:!1,paginationProps:b})]})};var Q=r(27693),D=r.n(Q),V=r(9905),A=r(32947),H=r(57524),z=r(3586),W=r(24200),X=r(31373),J=r(41135);let G=e=>{let{packageId:t}=e,{data:{vulnerabilities:r},isFetching:n,fetchError:l}=(0,X.H)(t),o=s.useMemo(()=>r.filter(e=>"affected"===e.vulnerabilityStatus),[r]),c=(0,J.T)(o,e=>`${e.vulnerability.identifier}-${e.vulnerabilityStatus}`),d=(0,I.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:c,isLoading:n,columnNames:{identifier:"ID",description:"Description",severity:"CVSS",published:"Date published"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier","severity","published"],getSortValues:e=>({identifier:e.vulnerability.identifier,severity:e.vulnerability?.average_severity?(0,A.XE)(e.vulnerability?.average_severity):0,published:e.vulnerability?.published?D()(e.vulnerability?.published).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:u,numRenderedColumns:h,propHelpers:{toolbarProps:p,paginationToolbarItemProps:b,paginationProps:f,tableProps:m,getThProps:v,getTrProps:y,getTdProps:g},expansionDerivedState:{isCellExpanded:x}}=d;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(F.o,{...p,children:(0,i.jsx)(P.c,{children:(0,i.jsx)(k.E,{...b,children:(0,i.jsx)(Z.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:f})})})}),(0,i.jsxs)(C.i,{...m,"aria-label":"vulnerability table",children:[(0,i.jsx)(q.h,{children:(0,i.jsx)(_.Tr,{children:(0,i.jsxs)(U.qK,{...d,children:[(0,i.jsx)(K.Th,{...v({columnKey:"identifier"})}),(0,i.jsx)(K.Th,{...v({columnKey:"description"})}),(0,i.jsx)(K.Th,{...v({columnKey:"severity"})}),(0,i.jsx)(K.Th,{...v({columnKey:"published"})})]})})}),(0,i.jsx)(U.hp,{isLoading:n,isError:!!l,isNoData:0===c.length,numRenderedColumns:h,children:u?.map((e,t)=>(0,i.jsx)(O.p,{isExpanded:x(e),children:(0,i.jsx)(_.Tr,{...y({item:e}),children:(0,i.jsxs)(U.Cx,{...d,item:e,rowIndex:t,children:[(0,i.jsx)(R.Td,{width:15,modifier:"breakWord",...g({columnKey:"identifier"}),children:(0,i.jsx)(a.rU,{to:`/vulnerabilities/${e.vulnerability.identifier}`,children:e.vulnerability.identifier})}),(0,i.jsx)(z.j,{children:(t,r)=>(0,i.jsx)(R.Td,{width:60,modifier:"truncate",onFocus:()=>r(!0),onBlur:()=>r(!1),tabIndex:0,...g({columnKey:"description"}),children:(0,i.jsx)(V.cE,{focused:t,wrapModifier:"truncate",children:e.vulnerability&&(0,i.jsx)(W.G,{vulnerability:e.vulnerability})})})}),(0,i.jsx)(R.Td,{width:15,...g({columnKey:"severity"}),children:e.vulnerability?.average_severity&&(0,i.jsx)(H.o,{value:e.vulnerability.average_severity,score:e.vulnerability.average_score,showLabel:!0,showScore:!0})}),(0,i.jsx)(R.Td,{width:10,modifier:"truncate",...g({columnKey:"published"}),children:(0,E.p6)(e.vulnerability?.published)})]})})},e._ui_unique_id))})]}),(0,i.jsx)(Z.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:f})]})},Y=()=>{let e=(0,j.ZX)(j.Uo.PACKAGE_ID),{pkg:t,isFetching:r,fetchError:F}=(0,T.ZA)(e),P=s.useMemo(()=>t?(0,E.qX)(t.purl):void 0,[t]),[k,C]=s.useState(0),q=s.createRef(),_=s.createRef(),K=s.createRef();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.NP,{type:"breadcrumb",children:(0,i.jsxs)(l.a,{children:[(0,i.jsx)(o.g,{children:(0,i.jsx)(a.rU,{to:"/packages",children:"Packages"})}),(0,i.jsx)(o.g,{isActive:!0,children:"Package details"})]})}),(0,i.jsx)(n.NP,{children:(0,i.jsxs)(c.K,{children:[(0,i.jsx)(d.v,{children:(0,i.jsx)(u.V,{children:(0,i.jsx)(u.V,{component:"h1",children:P?.name??e??""})})}),(0,i.jsx)(d.v,{children:(0,i.jsxs)(h.k,{children:[(0,i.jsxs)(p.B,{spacer:{default:"spacerSm"},children:[(0,i.jsxs)("p",{children:["version: ",P?.version]})," "]}),(0,i.jsx)(p.B,{children:P?.qualifiers&&(0,i.jsx)(w.D,{value:P?.qualifiers})})]})})]})}),(0,i.jsx)(n.NP,{children:(0,i.jsxs)(b.m,{mountOnEnter:!0,activeKey:k,onSelect:(e,t)=>{C(t)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,i.jsx)(f.O,{eventKey:0,title:(0,i.jsx)(m.T,{children:"Vulnerabilities"}),tabContentId:"refTabVulnerabilitiesSection",tabContentRef:q}),(0,i.jsx)(f.O,{eventKey:1,title:(0,i.jsx)(m.T,{children:"SBOMs using package"}),actions:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.b,{ref:K,children:(0,i.jsx)(x.ZP,{})}),(0,i.jsx)(y.J,{bodyContent:(0,i.jsx)("div",{children:"A list of SBOMs using this package."}),triggerRef:K})]}),tabContentId:"refTabSbomsSection",tabContentRef:_})]})}),(0,i.jsxs)(n.NP,{children:[(0,i.jsx)(g.I,{eventKey:0,id:"refTabVulnerabilitiesSection",ref:q,"aria-label":"Vulnerabilities of the Package",children:e&&(0,i.jsx)(G,{packageId:e})}),(0,i.jsx)(g.I,{eventKey:1,id:"refTabSbomsSection",ref:_,"aria-label":"SBOMs using the Package",hidden:!0,children:(0,i.jsx)(S.u,{isFetching:r,fetchError:F,children:t?.purl&&(0,i.jsx)(B,{purl:t.purl})})})]})]})}},59015:function(e,t,r){r.d(t,{D4:()=>d,ZA:()=>c,fF:()=>o});var i=r(1183),s=r(50576),a=r(40371),n=r(47169);let l="packages",o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:o,error:c,refetch:d}=(0,i.a)({queryKey:[l,e],queryFn:()=>(0,a.tj)({client:s.L,query:{...(0,n.rm)(e)}}),enabled:!t});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e},isFetching:o,fetchError:c,refetch:d}},c=e=>{let{data:t,isLoading:r,error:n}=(0,i.a)({queryKey:[l,e],queryFn:()=>(0,a.BK)({client:s.L,path:{key:e}})});return{pkg:t?.data,isFetching:r,fetchError:n}},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:o,error:c,refetch:d}=(0,i.a)({queryKey:[l,"by-sbom",e,t],queryFn:()=>(0,a.Pg)({client:s.L,path:{id:e},query:{...(0,n.rm)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t},isFetching:o,fetchError:c,refetch:d}}},43959:function(e,t,r){r.d(t,{Fz:()=>h,KQ:()=>m,Oh:()=>f,km:()=>b,p4:()=>p,uz:()=>v});var i=r(1183),s=r(68e3),a=r(16072),n=r(50576),l=r(40371),o=r(95169),c=r(87017),d=r(47169);let u="sboms",h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:s,error:a,refetch:o}=(0,i.a)({queryKey:[u,e],queryFn:()=>(0,l.Wp)({client:n.L,query:{...(0,d.rm)(e)}}),enabled:!t});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e??e},isFetching:s,fetchError:a,refetch:o}},p=e=>{let{data:t,isLoading:r,error:s}=(0,i.a)({queryKey:[u,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,l._Q)({client:n.L,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:r,fetchError:s}},b=()=>{let e=(0,s.NL)();return(0,o.V)({parallel:!0,uploadFn:(e,t)=>(0,c.Hb)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[u]})}})},f=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:s,error:a,refetch:o}=(0,i.a)({queryKey:["SBOMsQueryKeysss","by-package",e,t],queryFn:()=>(0,l.DU)({client:n.L,query:{purl:e,...(0,d.rm)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t??t},isFetching:s,fetchError:a,refetch:o}},m=e=>{let{data:t,isLoading:r,error:s}=(0,i.a)({queryKey:[u,e,"advisory"],queryFn:()=>(0,l.NU)({client:n.L,path:{id:e}})});return{advisories:t?.data||[],isFetching:r,fetchError:s}},v=e=>{let t=(0,a.h)({queries:e.map(e=>({queryKey:[u,e,"advisory"],queryFn:()=>(0,l.NU)({client:n.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return t?.data||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}}},41135:function(e,t,r){r.d(t,{T:()=>a});var i=r(27378),s=r(74502);let a=(e,t)=>(0,i.useMemo)(()=>e&&0!==e.length?e.map(e=>({...e,[s.nM]:t(e)})):[],[e,t])},33625:function(e,t,r){r.d(t,{Z:()=>i});let i={modifiers:{fill:"pf-m-fill",gutter:"pf-m-gutter"},stack:"pf-v6-l-stack",stackItem:"pf-v6-l-stack__item"}},16072:function(e,t,r){r.d(t,{h:()=>m});var i=r(27378),s=r(83484),a=r(7246),n=r(82418),l=r(24038);function o(e,t){return e.filter(e=>!t.includes(e))}var c=class extends n.l{#e;#t;#r;#i;#s;#a;#n;#l;#o=[];constructor(e,t,r){super(),this.#e=e,this.#i=r,this.#r=[],this.#s=[],this.#t=[],this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.#s.forEach(e=>{e.subscribe(t=>{this.#c(e,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#s.forEach(e=>{e.destroy()})}setQueries(e,t){this.#r=e,this.#i=t,s.Vr.batch(()=>{let e=this.#s,t=this.#d(this.#r);this.#o=t,t.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions));let r=t.map(e=>e.observer),i=r.map(e=>e.getCurrentResult()),s=r.some((t,r)=>t!==e[r]);(e.length!==r.length||s)&&(this.#s=r,this.#t=i,this.hasListeners()&&(o(e,r).forEach(e=>{e.destroy()}),o(r,e).forEach(e=>{e.subscribe(t=>{this.#c(e,t)})}),this.#u()))})}getCurrentResult(){return this.#t}getQueries(){return this.#s.map(e=>e.getCurrentQuery())}getObservers(){return this.#s}getOptimisticResult(e,t){let r=this.#d(e),i=r.map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions));return[i,e=>this.#h(e??i,t),()=>this.#p(i,r)]}#p(e,t){return t.map((r,i)=>{let s=e[i];return r.defaultedQueryOptions.notifyOnChangeProps?s:r.observer.trackResult(s,e=>{t.forEach(t=>{t.observer.trackProp(e)})})})}#h(e,t){return t?(this.#a&&this.#t===this.#l&&t===this.#n||(this.#n=t,this.#l=this.#t,this.#a=(0,l.Q$)(this.#a,t(e))),this.#a):e}#d(e){let t=new Map(this.#s.map(e=>[e.options.queryHash,e])),r=[];return e.forEach(e=>{let i=this.#e.defaultQueryOptions(e),s=t.get(i.queryHash);s?r.push({defaultedQueryOptions:i,observer:s}):r.push({defaultedQueryOptions:i,observer:new a.z(this.#e,i)})}),r}#c(e,t){let r=this.#s.indexOf(e);-1!==r&&(this.#t=function(e,t,r){let i=e.slice(0);return i[t]=r,i}(this.#t,r,t),this.#u())}#u(){if(this.hasListeners()){let e=this.#a,t=this.#p(this.#t,this.#o);e!==this.#h(t,this.#i?.combine)&&s.Vr.batch(()=>{this.listeners.forEach(e=>{e(this.#t)})})}}},d=r(68e3),u=r(12675),h=r(73687),p=r(80484),b=r(76720),f=r(73253);function m({queries:e,...t},r){let n=(0,d.NL)(r),l=(0,u.S)(),o=(0,h._)(),m=i.useMemo(()=>e.map(e=>{let t=n.defaultQueryOptions(e);return t._optimisticResults=l?"isRestoring":"optimistic",t}),[e,n,l]);m.forEach(e=>{(0,b.A8)(e),(0,p.pf)(e,o)}),(0,p.JN)(o);let[v]=i.useState(()=>new c(n,m,t)),[y,g,x]=v.getOptimisticResult(m,t.combine),j=!l&&!1!==t.subscribed;i.useSyncExternalStore(i.useCallback(e=>j?v.subscribe(s.Vr.batchCalls(e)):f.Z,[v,j]),()=>v.getCurrentResult(),()=>v.getCurrentResult()),i.useEffect(()=>{v.setQueries(m,t)},[m,t,v]);let S=y.some((e,t)=>(0,b.SB)(m[t],e))?y.flatMap((e,t)=>{let r=m[t];if(r){let t=new a.z(n,r);if((0,b.SB)(r,e))return(0,b.j8)(r,t,o);(0,b.Z$)(e,l)&&(0,b.j8)(r,t,o)}return[]}):[];if(S.length>0)throw Promise.all(S);let w=y.find((e,t)=>{let r=m[t];return r&&(0,p.KJ)({result:e,errorResetBoundary:o,throwOnError:r.throwOnError,query:n.getQueryCache().get(r.queryHash),suspense:r.suspense})});if(w?.error)throw w.error;return g(x())}}}]);