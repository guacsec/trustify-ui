"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["245"],{32947:function(e,t,r){r.d(t,{A0:()=>g,V4:()=>y,W:()=>x,XE:()=>m,nE:()=>f});var a=r(91566),l=r(839),n=r(73657),i=r(20644),s=r(89502),o=r(7596),c=r(1811),d=r(24917),u=r(4720),h=r(54178),p=r(37106),v=r(34313);let y={unknown:{name:"Unknown",color:c.P,progressProps:{variant:void 0},icon:a.M$},none:{name:"None",color:d.E,progressProps:{variant:void 0},icon:l.f6},low:{name:"Low",color:u.c,progressProps:{variant:void 0},icon:n._$},medium:{name:"Medium",color:h.L,progressProps:{variant:"warning"},icon:i.zI},high:{name:"High",color:p.H,progressProps:{variant:"danger"},icon:s.E2},critical:{name:"Critical",color:v.J,progressProps:{variant:"danger"},icon:o.ki}},m=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function g(e){return(t,r)=>m(e(t))-m(e(r))}let x=e=>{let{key:t,value:r}=e;return"".concat(r?"".concat(t,"=").concat(r):"".concat(t))},f=e=>{let[t,r]=e.split("=");return{key:t,value:null!=r?r:""}}},7615:function(e,t,r){r.d(t,{g:()=>a});let a=e=>null!=e?e:"unknown"},87017:function(e,t,r){r.d(t,{Co:()=>p,Cu:()=>u,Hb:()=>h});var a=r(79192),l=r(53195),n=r(70233),i=r(74502);r(41947);let s="/api",o="".concat(s,"/v2/advisory"),c="".concat(s,"/v2/sbom"),d=e=>{let t="application/json";return e.name.endsWith(".bz2")&&(t="application/json+bzip2"),t},u=(e,t)=>{let r=e.get(i.TB);return n.Z.post("".concat(o),r,(0,l._)((0,a._)({},t),{headers:{"Content-Type":d(r)}}))},h=(e,t)=>{let r=e.get(i.TB);return n.Z.post("".concat(c),r,(0,l._)((0,a._)({},t),{headers:{"Content-Type":d(r)}}))},p=e=>n.Z.get("".concat(c,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},37818:function(e,t,r){r.d(t,{u:()=>s});var a=r(24246),l=r(8305),n=r(13754),i=r(39826);let s=e=>e.isFetching?e.isFetchingState||(0,a.jsx)(l.b,{children:(0,a.jsx)(n.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,a.jsx)(i.y,{}):e.children},68057:function(e,t,r){r.d(t,{V:()=>s});var a=r(24246),l=r(27378),n=r(63763),i=r(32947);let s=e=>{let{vulnerabilitiesSummary:t}=e,r=l.useMemo(()=>Object.keys(t.severities).map(e=>{let r=t.severities[e],a=i.V4[e];return{severity:e,count:r,label:a.name,color:a.color.value}}).sort((0,i.A0)(e=>e.severity)).reverse(),[t]);return(0,a.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,a.jsx)(n.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:"".concat(t.total),subTitle:"Total vulnerabilities",width:350,legendData:r.map(e=>{let{label:t,count:r}=e;return{name:"".concat(t,": ").concat(r)}}),data:r.map(e=>{let{label:t,count:r}=e;return{x:t,y:r}}),labels:e=>{let{datum:t}=e;return"".concat(t.x,": ").concat(t.y)},colorScale:r.map(e=>{let{color:t}=e;return t})})})}},39826:function(e,t,r){r.d(t,{y:()=>s});var a=r(24246),l=r(10707),n=r(16668),i=r(42160);let s=()=>(0,a.jsx)(l.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:i.ZP,variant:l.IQ.sm,children:(0,a.jsx)(n.B,{children:"There was an error retrieving data. Check your connection and try again."})})},82413:function(e,t,r){r.d(t,{A:()=>h,I:()=>p});var a=r(79192),l=r(53195),n=r(27378),i=r(7615),s=r(43959);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},d={vulnerabilityStatus:{affected:(0,a._)({},c),fixed:(0,a._)({},c),not_affected:(0,a._)({},c),known_not_affected:(0,a._)({},c)}},u=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let r,n=e.find(e=>o(e,t));if(n)r=[...e.filter(e=>!o(e,n)),(0,l._)((0,a._)({},n),{relatedPackages:[...n.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};r=[...e.slice(),a]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,n=(0,i.g)(t.vulnerability.average_severity),s=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:(0,l._)((0,a._)({},e.vulnerabilityStatus),{[r]:{total:s.total+1,severities:(0,l._)((0,a._)({},s.severities),{[n]:s.severities[n]+1})}})})},(0,a._)({},d));return{vulnerabilities:t,summary:r}},h=e=>{let{advisories:t,isFetching:r,fetchError:a}=(0,s.KQ)(e);return{data:n.useMemo(()=>u(t||[]),[t]),isFetching:r,fetchError:a}},p=e=>{let{advisories:t,isFetching:r,fetchError:a}=(0,s.uz)(e);return{data:n.useMemo(()=>(null!=t?t:[]).map(e=>u(e||[])),[t]),isFetching:r,fetchError:a}}},95169:function(e,t,r){r.d(t,{V:()=>u});var a=r(79192),l=r(53195),n=r(27378),i=r(74502),s=r(70233);let o="cancelled",c=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),d=(e,t)=>{switch(t.type){case"queueUpload":return(0,l._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,l._)((0,a._)({},e.uploads.get(t.payload.file)||c()),{status:"queued",cancelFn:t.payload.cancelFn}))});case"updateUploadProgress":return(0,l._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,l._)((0,a._)({},e.uploads.get(t.payload.file)||c()),{progress:t.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,l._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,l._)((0,a._)({},e.uploads.get(t.payload.file)||c()),{status:"complete",response:t.payload.response}))});case"finishUploadWithError":var r;return(0,l._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,l._)((0,a._)({},e.uploads.get(t.payload.file)||c()),{status:"complete",error:t.payload.error,wasCancelled:(null==(r=t.payload.error)?void 0:r.message)===o}))});case"removeUpload":{let r=new Map(e.uploads);return r.delete(t.payload.file),(0,l._)((0,a._)({},e),{uploads:r})}default:throw Error()}},u=e=>{let{parallel:t,uploadFn:r,onSuccess:a,onError:l}=e,[c,u]=n.useReducer(d,{uploads:new Map});return{uploads:c.uploads,handleUpload:e=>{let n=[];for(let t=0;t<e.length;t++){let r=e[t],c=new FormData;c.set(i.TB,r);let d=s.Z.CancelToken.source(),h={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var t;let a=null!=(t=e.total)?t:1;u({type:"updateUploadProgress",payload:{file:r,progress:Math.round(e.loaded/a*100)}})},cancelToken:d.token};u({type:"queueUpload",payload:{file:r,cancelFn:d}});let p={formData:c,config:h,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:r,response:e}}),a&&a(e,r)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:r,error:e}}),e.message!==o&&l&&l(e,r)}};n.push(p)}if(t)for(let e of n)r(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else n.reduce(async(e,t)=>(await e,r(t.formData,t.config).then(t.thenFn).catch(t.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var t,r;null==(r=c.uploads.get(e))||null==(t=r.cancelFn)||t.cancel(o)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},21629:function(e,t,r){r.r(t),r.d(t,{default:()=>ep});var a=r(24246),l=r(45043),n=r(27317),i=r(93095),s=r(14935),o=r(65783),c=r(74485),d=r(76228),u=r(57518),h=r(24216),p=r(13864),v=r(78531),y=r(44870),m=r(93591),g=r(31757),x=r(87069),f=r(51527),j=r(87727),b=r(3498),F=r(68802),_=r(10707),w=r(16668),k=r(30329),S=r(50689),q=r(67761),E=r(81391),P=r(32947),C=r(37818),M=r(82413),L=r(17598),O=r(43959),T=r(63706);let K=[{severity:"critical"},{severity:"high"},{severity:"medium"},{severity:"low"},{severity:"none"},{severity:"unknown"}],B=()=>{var e,t,r,l,B,U;let V=(0,s.s0)(),{result:{data:N,total:D},isFetching:I,fetchError:W}=(0,O.Fz)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),{data:A,isFetching:Q,fetchError:z}=(0,M.I)(N.map(e=>e.id)),Z=A.map(e=>e.summary.vulnerabilityStatus.affected.total).every(e=>0===e),H=(e,t)=>"".concat(" ".repeat(t+1)).concat(e.name),{result:{data:R,total:G},isFetching:$,fetchError:Y}=(0,L.N7)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}});return(0,a.jsxs)(g.Z,{children:[(0,a.jsx)(x.l,{children:"Dashboard"}),(0,a.jsx)(f.e,{children:(0,a.jsxs)(j.r,{children:[(0,a.jsx)(b.P,{md:6,children:(0,a.jsx)(C.u,{isFetching:I||Q,fetchError:W||z.some(e=>!!e),children:(0,a.jsxs)(n.K,{hasGutter:!0,children:[(0,a.jsx)(i.v,{children:(0,a.jsx)(F.V,{children:"Below is a summary of Vulnerability status for the last 10 ingested SBOMs. To view the details, click on an SBOM name. You can also select up to 4 SBOMs to watch."})}),(0,a.jsx)(i.v,{children:N.length>0?(0,a.jsx)("div",{style:{height:320},children:(0,a.jsxs)(c.k,{ariaDesc:"SBOM summary status",domainPadding:{x:[30,25]},legendData:K.map(e=>({name:P.V4[e.severity].name})),legendPosition:"bottom-left",height:375,name:"sbom-summary-status",padding:{bottom:75,left:330,right:50,top:50},themeColor:d.n.multiOrdered,width:700,legendComponent:(0,a.jsx)(u.Q,{y:10,x:200,colorScale:K.map(e=>P.V4[e.severity].color.value)}),children:[(0,a.jsx)(h.C,{label:"Products",axisLabelComponent:(0,a.jsx)(p.D,{dx:0,x:15,y:140}),tickLabelComponent:(0,a.jsx)(p.D,{className:"pf-v6-c-button pf-m-link pf-m-inline",style:[{fill:"#0066cc"}],events:{onClick:e=>{let t=e.target.innerHTML,r=N.find((e,r)=>H(e,r)===t);r&&V("/sboms/".concat(r.id))}}})}),(0,a.jsx)(h.C,{dependentAxis:!0,showGrid:!0,tickValues:Z?[1,2,3,4,5,6,7,8,9,10]:void 0,label:"Vulnerabilities by Severity",fixLabelOverlap:!0}),(0,a.jsx)(v.K,{horizontal:!0,colorScale:K.map(e=>P.V4[e.severity].color.value),children:K.map(e=>{let t=P.V4[e.severity];return(0,a.jsx)(y.B,{labelComponent:(0,a.jsx)(m.h,{constrainToVisibleArea:!0}),data:A.map((r,a)=>{let{summary:{vulnerabilityStatus:{affected:l}}}=r,n=N[a],i=e.severity,s=l.severities[i];return{x:H(n,a),y:s,label:"".concat(t.name,": ").concat(s)}})},e.severity)})})]})}):(0,a.jsx)(_.ub,{headingLevel:"h4",titleText:"There is nothing here yet",variant:_.IQ.xs,children:(0,a.jsx)(w.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to see your overview."})})})]})})}),(0,a.jsx)(b.P,{md:6,children:(0,a.jsx)(C.u,{isFetching:$||I,fetchError:Y||W,children:(0,a.jsxs)(j.r,{hasGutter:!0,children:[(0,a.jsx)(b.P,{md:6,children:(0,a.jsx)(k.o,{children:(0,a.jsxs)(S.g,{children:[(0,a.jsx)(q.M,{children:"Last SBOM ingested"}),(0,a.jsx)(E.b,{children:(0,a.jsxs)(n.K,{children:[(0,a.jsx)(i.v,{children:(0,T.o0)(null==N||null==(e=N[0])?void 0:e.ingested)}),(0,a.jsx)(i.v,{children:(0,a.jsx)(o.rU,{to:"/sboms/".concat(null==N||null==(t=N[0])?void 0:t.id),children:null==N||null==(r=N[0])?void 0:r.name})})]})})]})})}),(0,a.jsx)(b.P,{md:6,children:(0,a.jsx)(k.o,{children:(0,a.jsxs)(S.g,{children:[(0,a.jsx)(q.M,{children:"Total SBOMs"}),(0,a.jsx)(E.b,{children:D})]})})}),(0,a.jsx)(b.P,{md:6,children:(0,a.jsx)(k.o,{children:(0,a.jsxs)(S.g,{children:[(0,a.jsx)(q.M,{children:"Last Advisory ingested"}),(0,a.jsx)(E.b,{children:(0,a.jsxs)(n.K,{children:[(0,a.jsx)(i.v,{children:(0,T.o0)(null==R||null==(l=R[0])?void 0:l.ingested)}),(0,a.jsx)(i.v,{children:(0,a.jsx)(o.rU,{to:"/advisories/".concat(null==R||null==(B=R[0])?void 0:B.uuid),children:null==R||null==(U=R[0])?void 0:U.document_id})})]})})]})})}),(0,a.jsx)(b.P,{md:6,children:(0,a.jsx)(k.o,{children:(0,a.jsxs)(S.g,{children:[(0,a.jsx)(q.M,{children:"Total Advisories"}),(0,a.jsx)(E.b,{children:G})]})})})]})})})]})})]})};var U=r(27378),V=r(8305),N=r(13754),D=r(79192),I=r(53195),W=r(15726),A=r(1183),Q=r(68e3),z=r(75503),Z=r(50576),H=r(40371);let R="watched-sboms",G="dashboard",$=U.createContext({}),Y=e=>{let{children:t}=e,{pushNotification:r}=U.useContext(W.c),{sboms:l,isFetching:n,fetchError:i}=(()=>{let{data:e,isLoading:t,error:r}=(0,A.a)({queryKey:[G,R],queryFn:async()=>{try{return(await (0,H.JM)({client:Z.L,path:{key:R}})).data}catch(e){if(404===e.status)return{sbom1Id:null,sbom2Id:null,sbom3Id:null,sbom4Id:null}}}});return{sboms:e,isFetching:t,fetchError:r}})(),{mutate:s}=((e,t)=>{let r=(0,Q.NL)();return(0,z.D)({mutationFn:e=>(0,H.yu)({client:Z.L,path:{key:R},body:e}),onSuccess:async(t,a)=>{e(),await r.invalidateQueries({queryKey:[G,R]})},onError:t})})(()=>{},e=>{r({title:"Error while updating the user preferences",variant:"danger"})});return(0,a.jsx)($.Provider,{value:{sboms:l,isFetching:n,fetchError:i,patch:(e,t)=>{s((0,I._)((0,D._)({},l),{[e]:t}))}},children:t})};var J=r(46039),X=r(18037),ee=r(24620),et=r(9426),er=r(32050),ea=r(99589),el=r(17528),en=r(32623),ei=r(42364),es=r(29765),eo=r(21843),ec=r(68057);let ed=e=>{let{sbomId:t}=e,{data:r,isFetching:l,fetchError:n}=(0,M.A)(t);return(0,a.jsx)(C.u,{isFetching:l,fetchError:n,children:(0,a.jsx)(ec.V,{vulnerabilitiesSummary:r.summary.vulnerabilityStatus.affected})})},eu=e=>{let{fieldName:t,sbomId:r}=e,{patch:l}=U.useContext($),s=U.useRef(),[c,d]=U.useState(""),[u,h]=U.useState("");U.useEffect(()=>{let e=setTimeout(()=>{h(c)},500);return()=>clearTimeout(e)},[c]);let[p,v]=U.useState(!1),{sbom:y,isFetching:m,fetchError:j}=(0,O.p4)(null!=r?r:void 0),{result:{data:b}}=(0,O.Fz)({filters:[{field:"",operator:"~",value:u}],page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),F=()=>{v(!1)},k=()=>{v(!p)},S=()=>{p?c||F():v(!0)},q=(e,t)=>{d(t)},E=()=>{var e;d(""),null==s||null==(e=s.current)||e.focus()};return(0,a.jsxs)(g.Z,{isFullHeight:!0,children:[(0,a.jsxs)(C.u,{isFetching:m,fetchError:j,children:[y&&(0,a.jsx)(x.l,{className:eo.Z.textBreakWord,children:null==y?void 0:y.name}),(0,a.jsx)(f.e,{children:r?(0,a.jsxs)(n.K,{children:[(0,a.jsx)(i.v,{isFilled:!0,children:(0,a.jsx)(ed,{sbomId:r})}),(0,a.jsx)(i.v,{children:(0,a.jsx)(o.rU,{to:"/sboms/".concat(r),children:"View Details"})})]}):(0,a.jsx)(_.ub,{headingLevel:"h4",titleText:"There is nothing here yet",variant:_.IQ.xs,children:(0,a.jsx)(w.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to change the SBOMs you would like to track."})})})]}),(0,a.jsx)(J.e,{children:(0,a.jsx)(X.P,{shouldFocusFirstItemOnOpen:!1,isOpen:p,onSelect:(e,r)=>{r&&l(t,r),F()},onOpenChange:e=>{e||F()},toggle:e=>(0,a.jsx)(ee.O_,{ref:e,variant:"typeahead",onClick:k,isExpanded:p,isFullWidth:!0,children:(0,a.jsxs)(et.W,{isPlain:!0,children:[(0,a.jsx)(er.v,{autoComplete:"off",value:c,onClick:S,onChange:q,innerRef:s,isExpanded:p,placeholder:"Select a new SBOM to watch"}),(0,a.jsx)(ea.t,(0,I._)((0,D._)({},c?{}:{style:{display:"none"}}),{children:(0,a.jsx)(el.zx,{icon:(0,a.jsx)(es.ZP,{"aria-hidden":!0}),variant:"plain",onClick:E,"aria-label":"Clear input value"})}))]})}),children:(0,a.jsx)(en.E,{children:b.map(e=>(0,a.jsx)(ei.$,{value:e.id,children:e.name},e.id))})})})]})},eh=()=>{let{sboms:e,isFetching:t,fetchError:r}=U.useContext($);return(0,a.jsx)(C.u,{isFetching:t,fetchError:r,isFetchingState:(0,a.jsx)(j.r,{hasGutter:!0,children:Array.from([,,,,].keys()).map(e=>(0,a.jsx)(b.P,{md:3,children:(0,a.jsx)(g.Z,{children:(0,a.jsx)(f.e,{children:(0,a.jsx)(V.b,{children:(0,a.jsx)(N.$,{})})})})},e))}),children:(0,a.jsx)(j.r,{hasGutter:!0,children:e&&Object.entries(e).map(e=>{let[t,r]=e;return(0,a.jsx)(b.P,{md:3,children:(0,a.jsx)(eu,{fieldName:t,sbomId:r})},"".concat(t,":").concat(r))})})})},ep=()=>(0,a.jsx)(l.NP,{hasBodyWrapper:!1,children:(0,a.jsxs)(n.K,{hasGutter:!0,children:[(0,a.jsx)(i.v,{children:(0,a.jsx)(B,{})}),(0,a.jsx)(i.v,{children:(0,a.jsx)(Y,{children:(0,a.jsx)(eh,{})})})]})})},17598:function(e,t,r){r.d(t,{N7:()=>g,VY:()=>m,gw:()=>x,sj:()=>j,tG:()=>f});var a=r(79192),l=r(53195),n=r(70186),i=r(1183),s=r(24038),o=r(68e3),c=r(75503),d=r(50576),u=r(40371),h=r(87017),p=r(49988),v=r(95169);let y="advisories",m=e=>{let{data:t,isLoading:r,error:a,refetch:l}=(0,i.a)({queryKey:[y,"labels",e],queryFn:()=>(0,u.sf)({client:d.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a,refetch:l}},g=function(){var e,t,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=(0,p.rm)(s),{q:v}=h,m=(0,n._)(h,["q"]),g=(0,p.Rb)(o),{data:x,isLoading:f,error:j,refetch:b}=(0,i.a)({queryKey:[y,s,g],queryFn:()=>(0,u.A1)({client:d.L,query:(0,l._)((0,a._)({},m),{q:[v,g].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==x||null==(e=x.data)?void 0:e.items)||[],total:null!=(r=null==x||null==(t=x.data)?void 0:t.total)?r:0,params:s},isFetching:f,fetchError:j||null,refetch:b}},x=e=>{let{data:t,isLoading:r,error:a}=(0,i.a)({queryKey:[y,e],queryFn:()=>(0,u.pB)({client:d.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==t?void 0:t.data,isFetching:r,fetchError:a}},f=()=>{let e=(0,o.NL)();return(0,v.V)({parallel:!0,uploadFn:(e,t)=>(0,h.Cu)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[y]})}})},j=(e,t)=>{let r=(0,o.NL)();return(0,c.D)({mutationFn:e=>(0,u.m5)({client:d.L,path:{id:e.id},body:e.labels}),onSuccess:async(t,a)=>{e(),await r.invalidateQueries({queryKey:[y]})},onError:t})}},43959:function(e,t,r){r.d(t,{Fz:()=>x,KQ:()=>_,Oh:()=>F,i5:()=>g,km:()=>j,p4:()=>f,qi:()=>k,t9:()=>b,uz:()=>w});var a=r(79192),l=r(53195),n=r(70186),i=r(1183),s=r(24038),o=r(68e3),c=r(75503),d=r(16072),u=r(50576),h=r(40371),p=r(95169),v=r(87017),y=r(49988);let m="sboms",g=e=>{let{data:t,isLoading:r,error:a,refetch:l}=(0,i.a)({queryKey:[m,"labels",e],queryFn:()=>(0,h.mh)({client:u.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a,refetch:l}},x=function(){var e,t,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=(0,y.rm)(s),{q:p}=d,v=(0,n._)(d,["q"]),g=(0,y.Rb)(o),{data:x,isLoading:f,error:j,refetch:b}=(0,i.a)({queryKey:[m,s,g],queryFn:()=>(0,h.Wp)({client:u.L,query:(0,l._)((0,a._)({},v),{q:[p,g].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==x||null==(e=x.data)?void 0:e.items)||[],total:null!=(r=null==x||null==(t=x.data)?void 0:t.total)?r:0,params:s},isFetching:f,fetchError:j,refetch:b}},f=e=>{let{data:t,isLoading:r,error:a}=(0,i.a)({queryKey:[m,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,h._Q)({client:u.L,path:{id:e}}),enabled:void 0!==e});return{sbom:null==t?void 0:t.data,isFetching:r,fetchError:a}},j=()=>{let e=(0,o.NL)();return(0,p.V)({parallel:!0,uploadFn:(e,t)=>(0,v.Hb)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},b=(e,t)=>{let r=(0,o.NL)();return(0,c.D)({mutationFn:e=>(0,h.zx)({client:u.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[m]})},onError:t})},F=function(e){var t,r,l;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:s,isLoading:o,error:c,refetch:d}=(0,i.a)({queryKey:[m,"by-package",e,n],queryFn:()=>(0,h.DU)({client:u.L,query:(0,a._)({purl:e},(0,y.rm)(n))})});return{result:{data:(null==s||null==(t=s.data)?void 0:t.items)||[],total:null!=(l=null==s||null==(r=s.data)?void 0:r.total)?l:0,params:n},isFetching:o,fetchError:c,refetch:d}},_=e=>{let{data:t,isLoading:r,error:a}=(0,i.a)({queryKey:[m,e,"advisory"],queryFn:()=>(0,h.NU)({client:u.L,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a}},w=e=>{let t=(0,d.h)({queries:e.map(e=>({queryKey:[m,e,"advisory"],queryFn:()=>(0,h.NU)({client:u.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},k=e=>{let{data:t,isLoading:r,error:a}=(0,i.a)({queryKey:[m,e,"license-ids"],queryFn:()=>(0,h.J4)({client:u.L,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a}}}}]);