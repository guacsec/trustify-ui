"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["77"],{20311:function(e,t,i){i.d(t,{R:()=>l});var r=i(62540),s=i(63696);let l=e=>{let{children:t}=e,[i,l]=s.useState(!1);return(0,r.jsx)(r.Fragment,{children:t(i,l)})}},64377:function(e,t,i){i.d(t,{j:()=>s});var r=i(62540);let s=e=>{let{vulnerability:t}=e;return(0,r.jsxs)("p",{children:[t.withdrawn&&(0,r.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})}},12063:function(e,t,i){i.d(t,{f:()=>d});var r=i(32909),s=i(42642),l=i(63696),a=i(31903);let n=(e,t)=>e.sbom.id===t.sbom.id&&e.sbomStatus===t.sbomStatus,o={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0,under_investigation:0}},d=e=>{let{vulnerability:t,isFetching:i,fetchError:d}=(0,a.uN)(e);return{data:l.useMemo(()=>{let e,i;return i=(e=((null==t?void 0:t.advisories)||[]).flatMap(e=>{var t;return(null!=(t=e.sboms)?t:[]).flatMap(t=>Object.entries(t.purl_statuses||{}).map(i=>{let[s,l]=i;return{sbom:(0,r._)({},t),sbomStatus:s,advisory:e,packages:l}}))}).reduce((e,t)=>{let i,l=e.find(e=>n(e,t));if(l)i=[...e.filter(e=>!n(e,l)),(0,s._)((0,r._)({},l),{relatedPackages:[...l.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let r={sbom:t.sbom,sbomStatus:t.sbomStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};i=[...e.slice(),r]}return i},[])).reduce((e,t)=>{let i=t.sbomStatus;return Object.assign(e,{total:e.total+1,sbomStatus:(0,s._)((0,r._)({},e.sbomStatus),{[i]:e.sbomStatus[i]+1})})},(0,r._)({},o)),{sboms:e,summary:i}},[t]),isFetching:i,fetchError:d}}},62517:function(e,t,i){i.d(t,{u:()=>c,y:()=>b});var r=i(32909),s=i(42642),l=i(62540),a=i(63696),n=i(98259);i(21999);var o=i(73470),d=i(31903),u=i(23909);let c=a.createContext({}),b=e=>{let{children:t}=e,i=(0,o.MM)({tableName:"vulnerability",persistenceKeyPrefix:n.rt.vulnerabilities,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Description",severity:"CVSS",published:"Published",sboms:"Impacted SBOMs"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","published","severity"],initialSort:{columnKey:"published",direction:"desc"},isFilterEnabled:!0,filterCategories:[{categoryKey:n._G,title:"Filter text",placeholderText:"Search",type:"search"},{categoryKey:"base_severity",title:"CVSS",placeholderText:"CVSS",type:"multiselect",selectOptions:[{value:n.b6,label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"published",title:"Published",type:"dateRange"},{categoryKey:"publishedOnly",title:"Published only",type:"toggle",label:"Published only",serverFilterField:"published",getServerFilterValue:()=>[n.b6],getOperator:e=>(0,u.iw)(null==e?void 0:e[0])?"=":"!=",showOutsideDropdown:!0}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:a,total:b},isFetching:h,fetchError:m}=(0,d.WJ)((0,o.Ng)((0,s._)((0,r._)({},i),{hubSortFieldKeys:{identifier:"id",severity:"base_score",published:"published"}}))),y=(0,o.PB)((0,s._)((0,r._)({},i),{idProperty:"identifier",currentPageItems:a,totalItemCount:b,isLoading:h}));return(0,l.jsx)(c.Provider,{value:{totalItemCount:b,isFetching:h,fetchError:m,tableControls:y},children:t})}},11934:function(e,t,i){i.d(t,{f:()=>C});var r=i(32909),s=i(42642),l=i(62540),a=i(63696),n=i(74343),o=i(26917),d=i(16646),u=i(21758),c=i(40384),b=i(28516),h=i(78517),m=i(59771),y=i(27875),p=i(45969),_=i(93826),x=i(30448),f=i(64377),v=i(67458),j=i(23909),g=i(20311),S=i(6160),w=i(24296),T=i(92107),P=i(12063);let K=e=>{let{vulnerabilityId:t}=e,{data:i,isFetching:r,fetchError:s}=(0,P.f)(t);return(0,l.jsx)(w.a,{isFetching:r,fetchError:s,isFetchingState:(0,l.jsx)(S.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,l.jsx)(T.D,{error:e}),children:i.summary.sbomStatus.affected})};var k=i(62517);let C=()=>{let{isFetching:e,fetchError:t,totalItemCount:i,tableControls:S}=a.useContext(k.u),{numRenderedColumns:w,currentPageItems:T,propHelpers:{paginationProps:P,tableProps:C,getThProps:F,getTrProps:E,getTdProps:M}}=S;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(o.X,(0,s._)((0,r._)({},C),{"aria-label":"Vulnerability table",children:[(0,l.jsx)(d.d,{children:(0,l.jsx)(u.Tr,{children:(0,l.jsxs)(x.Ze,(0,s._)((0,r._)({},S),{children:[(0,l.jsx)(c.Th,(0,r._)({},F({columnKey:"identifier"}))),(0,l.jsx)(c.Th,(0,r._)({},F({columnKey:"title"}))),(0,l.jsx)(c.Th,(0,s._)((0,r._)({},F({columnKey:"severity"})),{info:{tooltip:"The Common Vulnerability Scoring System measuring the severity of security flaws."}})),(0,l.jsx)(c.Th,(0,r._)({},F({columnKey:"published"}))),(0,l.jsx)(c.Th,(0,r._)({},F({columnKey:"sboms"})))]}))})}),(0,l.jsx)(x.nJ,{isLoading:e,isError:!!t,isNoData:0===i,numRenderedColumns:w,children:T.map((e,t)=>(0,l.jsx)(b.N,{children:(0,l.jsx)(u.Tr,(0,s._)((0,r._)({},E({item:e})),{children:(0,l.jsxs)(x.Oi,(0,s._)((0,r._)({},S),{item:e,rowIndex:t,children:[(0,l.jsx)(h.Td,(0,s._)((0,r._)({width:15,modifier:"breakWord"},M({columnKey:"identifier",item:e,rowIndex:t})),{children:(0,l.jsx)(n.k2,{to:(0,n.tW)(v.Jh.vulnerabilityDetails,{vulnerabilityId:e.identifier}),children:e.identifier})})),(0,l.jsx)(g.R,{children:(t,i)=>(0,l.jsx)(h.Td,(0,s._)((0,r._)({width:45,modifier:"truncate",onFocus:()=>i(!0),onBlur:()=>i(!1),tabIndex:0},M({columnKey:"title"})),{children:(0,l.jsx)(m.mA,{focused:t,wrapModifier:"truncate",children:(0,l.jsx)(f.j,{vulnerability:e})})}))}),(0,l.jsx)(h.Td,(0,s._)((0,r._)({width:10},M({columnKey:"severity"})),{children:(0,l.jsx)(p.h,{value:(0,y.U)(e.average_severity),score:e.average_score,showLabel:!0,showScore:!0})})),(0,l.jsx)(h.Td,(0,s._)((0,r._)({width:10},M({columnKey:"published"})),{children:(0,j.Yq)(e.published)})),(0,l.jsx)(h.Td,(0,s._)((0,r._)({width:10},M({columnKey:"sboms",item:e,rowIndex:t})),{children:(0,l.jsx)(K,{vulnerabilityId:e.identifier})}))]}))}))},e.identifier))})]})),(0,l.jsx)(_.n,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:P})]})}},13829:function(e,t,i){i.d(t,{y:()=>h});var r=i(32909),s=i(42642),l=i(62540),a=i(63696),n=i(61360),o=i(35048),d=i(32490),u=i(21999),c=i(93826),b=i(62517);let h=e=>{let{showFilters:t}=e,{tableControls:i}=a.useContext(b.u),{propHelpers:{toolbarProps:h,filterToolbarProps:m,paginationToolbarItemProps:y,paginationProps:p}}=i;return(0,l.jsx)(n.M,(0,s._)((0,r._)({},h),{"aria-label":"vulnerability-toolbar",children:(0,l.jsxs)(o.P,{children:[t&&(0,l.jsx)(u.Us,(0,r._)({},m)),(0,l.jsx)(d.T,(0,s._)((0,r._)({},y),{children:(0,l.jsx)(c.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:p})}))]})}))}}}]);