"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["738"],{71284:function(e,t,r){r.d(t,{Cb:()=>_,Kb:()=>y,Sx:()=>x,hs:()=>g,m4:()=>m,pJ:()=>b,xh:()=>T});var a=r(88741),n=r(99111),i=r(22134),l=r(57822),s=r(32635),o=r(1734),d=r(84249),c=r(95283),u=r(52040),p=r(44240),h=r(43967),v=r(36808);let y={unknown:{name:"Unknown",color:d.o,progressProps:{variant:void 0},icon:a.ZP},none:{name:"None",color:c.q,progressProps:{variant:void 0},icon:n.VQ},low:{name:"Low",color:u.b,progressProps:{variant:void 0},icon:i.g8},medium:{name:"Medium",color:p.B,progressProps:{variant:"warning"},icon:l.Yc},high:{name:"High",color:h.e,progressProps:{variant:"danger"},icon:s.Fc},critical:{name:"Critical",color:v.d,progressProps:{variant:"danger"},icon:o.id}},b={fixed:{name:"Fixed",color:"blue"},not_affected:{name:"Not affected",color:"green"},known_not_affected:{name:"Known not affected",color:"green"},under_investigation:{name:"Under investigation",color:"yellow"},affected:{name:"Affected",color:"red"}},f=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function x(e){return(t,r)=>f(e(t))-f(e(r))}let m=e=>{let{key:t,value:r}=e;return"".concat(r?"".concat(t,"=").concat(r):"".concat(t))},_=e=>{let[t,r]=e.split("=");return{key:t,value:null!=r?r:""}},j=e=>{if(!e)return 0;switch(e){case"3.1":return 1;case"3.0":return 2;case"4.0":return 3;case"2.0":return 4;default:return 0}};function g(e){return(t,r)=>j(e(t))-j(e(r))}let T=e=>0===e.length?null:[...e].sort(g(e=>e.type))[0]},27875:function(e,t,r){r.d(t,{U:()=>a});let a=e=>null!=e?e:"unknown"},81895:function(e,t,r){r.d(t,{J4:()=>p,SP:()=>h,Z3:()=>v,hP:()=>u});var a=r(32909),n=r(42642),i=r(46165),l=r(98259);r(56161);let s="/api",o="".concat(s,"/v2/advisory"),d="".concat(s,"/v2/sbom"),c=e=>{let t="application/json";return e.name.endsWith(".bz2")&&(t="application/json+bzip2"),t},u=(e,t)=>{let r=e.get(l.fs);return i.A.post("".concat(o),r,(0,n._)((0,a._)({},t),{headers:{"Content-Type":c(r)}}))},p=(e,t)=>{let r=e.get(l.fs);return i.A.post("".concat(d),r,(0,n._)((0,a._)({},t),{headers:{"Content-Type":c(r)}}))},h=(e,t)=>{let r=e.get(l.fs);return i.A.post("/api/v2/ui/extract-sbom-purls",r,(0,n._)((0,a._)({},t),{headers:{"Content-Type":c(r)}}))},v=e=>i.A.get("".concat(d,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},24296:function(e,t,r){r.d(t,{a:()=>s});var a=r(62540),n=r(59394),i=r(81595),l=r(40554);let s=e=>e.isFetching?e.isFetchingState||(0,a.jsx)(n.a,{children:(0,a.jsx)(i.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,a.jsx)(l.q,{}):e.children},85790:function(e,t,r){r.d(t,{a:()=>i});var a=r(62540),n=r(69548);let i=e=>{let{value:t}=e;return(0,a.jsx)(a.Fragment,{children:Object.entries(t).map(e=>{let[t,r]=e;return(0,a.jsx)(n.J,{isCompact:!0,children:"".concat(t,"=").concat(r)},"".concat(t,"=").concat(r))})})}},45969:function(e,t,r){r.d(t,{h:()=>d});var a=r(62540),n=r(28338),i=r(70045),l=r(2057),s=r(29508),o=r(71284);let d=e=>{let{value:t,score:r,showScore:d,showLabel:c}=e,u=o.Kb[t],p=u.name,h=u.icon;return(0,a.jsxs)(n.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,a.jsx)(i.Z,{children:c?(0,a.jsx)(l.I,{children:(0,a.jsx)(h,{color:u.color.var})}):(0,a.jsx)(s.m,{content:p,children:(0,a.jsx)(l.I,{children:(0,a.jsx)(h,{color:u.color.var})})})}),c&&(0,a.jsx)(i.Z,{children:p}),d&&null!==r&&(0,a.jsxs)(i.Z,{children:["(",Math.round(10*r)/10,")"]})]})}},93826:function(e,t,r){r.d(t,{n:()=>s});var a=r(32909),n=r(42642),i=r(62540),l=r(56682);let s=e=>{let{paginationProps:t,isTop:r,isCompact:s=!1,idPrefix:o=""}=e;return(0,i.jsx)(l.d,(0,n._)((0,a._)({id:"".concat(o?"".concat(o,"-"):"","pagination-").concat(r?"top":"bottom"),variant:r?l.A.top:l.A.bottom,isCompact:s},t),{widgetId:"pagination-id"}))}},40554:function(e,t,r){r.d(t,{q:()=>s});var a=r(62540),n=r(48655),i=r(92411),l=r(60087);let s=()=>(0,a.jsx)(n.pp,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:l.Ay,variant:n.s$.sm,children:(0,a.jsx)(i.h,{children:"There was an error retrieving data. Check your connection and try again."})})},30448:function(e,t,r){r.d(t,{Ze:()=>f,nJ:()=>y,Oi:()=>m});var a=r(62540),n=r(59394),i=r(81595),l=r(28516),s=r(21758),o=r(78517),d=r(40554),c=r(48655),u=r(92411),p=r(28469);let h=e=>{let{title:t,description:r}=e;return(0,a.jsx)(c.pp,{titleText:t,headingLevel:"h4",icon:p.Ay,variant:c.s$.sm,children:r&&(0,a.jsx)(u.h,{children:r})})},v=()=>(0,a.jsx)(h,{title:"No data available",description:"No data available to be shown here."}),y=e=>{let{numRenderedColumns:t,isLoading:r=!1,isError:c=!1,isNoData:u=!1,errorEmptyState:p=null,noDataEmptyState:h=null,children:y}=e;return(0,a.jsx)(a.Fragment,{children:r?(0,a.jsx)(l.N,{"aria-label":"Table loading",children:(0,a.jsx)(s.Tr,{children:(0,a.jsx)(o.Td,{colSpan:t,children:(0,a.jsx)(n.a,{children:(0,a.jsx)(i.y,{size:"xl"})})})})}):c?(0,a.jsx)(l.N,{"aria-label":"Table error",children:(0,a.jsx)(s.Tr,{children:(0,a.jsx)(o.Td,{colSpan:t,children:(0,a.jsx)(n.a,{children:p||(0,a.jsx)(d.q,{})})})})}):u?(0,a.jsx)(l.N,{"aria-label":"Table empty",children:(0,a.jsx)(s.Tr,{children:(0,a.jsx)(o.Td,{colSpan:t,children:(0,a.jsx)(n.a,{children:h||(0,a.jsx)(v,{})})})})}):y})};var b=r(40384);let f=e=>{let{numColumnsBeforeData:t,numColumnsAfterData:r,children:n}=e;return(0,a.jsxs)(a.Fragment,{children:[Array(t).fill(null).map((e,t)=>(0,a.jsx)(b.Th,{screenReaderText:"before-data-".concat(t)},t)),n,Array(r).fill(null).map((e,t)=>(0,a.jsx)(b.Th,{screenReaderText:"after-data-".concat(t)},t))]})};var x=r(32909);let m=e=>{let{isExpansionEnabled:t=!1,expandableVariant:r,getSelectCheckboxTdProps:n,propHelpers:{getSingleExpandButtonTdProps:i},item:l,rowIndex:s,children:d}=e;return(0,a.jsxs)(a.Fragment,{children:[t&&"single"===r?(0,a.jsx)(o.Td,(0,x._)({},i({item:l,rowIndex:s}))):null,n?(0,a.jsx)(o.Td,(0,x._)({},n({item:l,rowIndex:s}))):null,d]})}},20311:function(e,t,r){r.d(t,{R:()=>i});var a=r(62540),n=r(63696);let i=e=>{let{children:t}=e,[r,i]=n.useState(!1);return(0,a.jsx)(a.Fragment,{children:t(r,i)})}},64377:function(e,t,r){r.d(t,{j:()=>n});var a=r(62540);let n=e=>{let{vulnerability:t}=e;return(0,a.jsxs)("p",{children:[t.withdrawn&&(0,a.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})}},35913:function(e,t,r){r.d(t,{$:()=>h,G:()=>p});var a=r(32909),n=r(42642),i=r(63696),l=r(27875),s=r(33468);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,d={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:(0,a._)({},d),fixed:(0,a._)({},d),not_affected:(0,a._)({},d),known_not_affected:(0,a._)({},d),under_investigation:(0,a._)({},d)}},u=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>{let r=(0,l.U)(t.average_severity);return{vulnerability:(0,n._)((0,a._)({},t.vulnerability),{average_severity:r,average_score:t.average_score}),vulnerabilityStatus:t.status,advisory:e}})}).reduce((e,t)=>{let r,i=e.find(e=>o(e,t));if(i)r=[...e.filter(e=>!o(e,i)),(0,n._)((0,a._)({},i),{relatedSboms:[...i.relatedSboms,{advisory:t.advisory}]})];else{let a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};r=[...e.slice(),a]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,i=t.vulnerability.average_severity,l=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:(0,n._)((0,a._)({},e.vulnerabilityStatus),{[r]:{total:l.total+1,severities:(0,n._)((0,a._)({},l.severities),{[i]:l.severities[i]+1})}})})},(0,a._)({},c));return{vulnerabilities:t,summary:r}},p=e=>{let{pkg:t,isFetching:r,fetchError:a}=(0,s.Si)(e);return{data:i.useMemo(()=>u((null==t?void 0:t.advisories)||[]),[t]),isFetching:r,fetchError:a}},h=e=>({data:i.useMemo(()=>u((null==e?void 0:e.advisories)||[]),[e])})},49325:function(e,t,r){r.d(t,{tc:()=>s});var a=r(32909),n=r(42642),i=r(31550),l=r(73470);let s=e=>{let t=(e=>{var t;let{persistTo:r="state",persistenceKeyPrefix:n}=e,s=null!=(t=e.defaultActiveTab)?t:{tabKey:e.tabKeys[0]},[o,d]=(0,i.u)((0,a._)({isEnabled:!0,defaultValue:s,persistenceKeyPrefix:n},"urlParams"===r?{persistTo:r,keys:["activeTab"],serialize:e=>({activeTab:(null==e?void 0:e.tabKey)||null}),deserialize:e=>e.activeTab?{tabKey:e.activeTab}:null}:"localStorage"===r||"sessionStorage"===r?{persistTo:r,key:"tab"}:(0,l.xG)(r)?{persistTo:"provider",serialize:r.write,deserialize:()=>r.read()}:{persistTo:"state"}));return{activeTab:o,setActiveTab:d}})(e),r=(e=>{let{tabState:t}=e;return{isTabActive:e=>{var r;return e===(null==(r=t.activeTab)?void 0:r.tabKey)},setActiveTab:e=>{t.setActiveTab({tabKey:e})}}})({tabState:t});return(0,n._)((0,a._)({},e),{state:t,derivedState:r,propHelpers:{getTabsProps:()=>{var e;return{activeKey:null==(e=t.activeTab)?void 0:e.tabKey,onSelect:(e,t)=>{r.setActiveTab(t)}}},getTabProps:e=>({eventKey:e,tabContentId:"".concat(e,"-tab-section")}),getTabContentProps:e=>({id:"".concat(e,"-tab-section"),eventKey:e,hidden:!r.isTabActive(e)})}})}},93531:function(e,t,r){r.d(t,{v:()=>u});var a=r(32909),n=r(42642),i=r(63696),l=r(98259),s=r(46165);let o="cancelled",d=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),c=(e,t)=>{switch(t.type){case"queueUpload":return(0,n._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,n._)((0,a._)({},e.uploads.get(t.payload.file)||d()),{status:"queued",cancelFn:t.payload.cancelFn}))});case"updateUploadProgress":return(0,n._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,n._)((0,a._)({},e.uploads.get(t.payload.file)||d()),{progress:t.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,n._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,n._)((0,a._)({},e.uploads.get(t.payload.file)||d()),{status:"complete",response:t.payload.response}))});case"finishUploadWithError":var r;return(0,n._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,n._)((0,a._)({},e.uploads.get(t.payload.file)||d()),{status:"complete",error:t.payload.error,wasCancelled:(null==(r=t.payload.error)?void 0:r.message)===o}))});case"removeUpload":{let r=new Map(e.uploads);return r.delete(t.payload.file),(0,n._)((0,a._)({},e),{uploads:r})}default:throw Error()}},u=e=>{let{parallel:t,uploadFn:r,onSuccess:a,onError:n}=e,[d,u]=i.useReducer(c,{uploads:new Map});return{uploads:d.uploads,handleUpload:e=>{let i=[];for(let t=0;t<e.length;t++){let r=e[t],d=new FormData;d.set(l.fs,r);let c=s.A.CancelToken.source(),p={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var t;let a=null!=(t=e.total)?t:1;u({type:"updateUploadProgress",payload:{file:r,progress:Math.round(e.loaded/a*100)}})},cancelToken:c.token};u({type:"queueUpload",payload:{file:r,cancelFn:c}});let h={formData:d,config:p,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:r,response:e}}),a&&a(e,r)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:r,error:e}}),e.message!==o&&n&&n(e,r)}};i.push(h)}if(t)for(let e of i)r(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else i.reduce(async(e,t)=>(await e,r(t.formData,t.config).then(t.thenFn).catch(t.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var t,r;null==(r=d.uploads.get(e))||null==(t=r.cancelFn)||t.cancel(o)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},77870:function(e,t,r){r.r(t),r.d(t,{default:()=>ee});var a=r(32909),n=r(42642),i=r(62540),l=r(63696),s=r(74343),o=r(68430),d=r(98261),c=r(75530),u=r(38914),p=r(57901),h=r(42957),v=r(28338),y=r(70045),b=r(40989),f=r(60423),x=r(40111),m=r(70414),_=r(66542),j=r(93472),g=r(8210),T=r(52424),S=r(24296),w=r(85790),F=r(49325),q=r(33468),K=r(23909),P=r(61360),E=r(35048),k=r(32490),C=r(26917),A=r(16646),M=r(21758),I=r(40384),U=r(28516),N=r(78517);r(21999);var R=r(93826),D=r(30448),J=r(98259),O=r(73470),B=r(30111);let L=e=>{let{purl:t}=e,r=(0,O.MM)({tableName:"sboms",persistenceKeyPrefix:J.rt.sboms_by_package,columnNames:{name:"Name",version:"Version",supplier:"Supplier"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:"search"}]}),{result:{data:l,total:o},isFetching:d,fetchError:c}=(0,B.Qr)(t,(0,O.Ng)((0,n._)((0,a._)({},r),{hubSortFieldKeys:{name:"name"}}))),u=(0,O.PB)((0,n._)((0,a._)({},r),{idProperty:"id",currentPageItems:l,totalItemCount:o,isLoading:d})),{numRenderedColumns:p,currentPageItems:h,propHelpers:{toolbarProps:v,paginationToolbarItemProps:y,paginationProps:b,tableProps:f,getThProps:x,getTrProps:m,getTdProps:_}}=u;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(P.M,(0,n._)((0,a._)({},v),{"aria-label":"SBOM toolbar",children:(0,i.jsx)(E.P,{children:(0,i.jsx)(k.T,(0,n._)((0,a._)({},y),{children:(0,i.jsx)(R.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:b})}))})})),(0,i.jsxs)(C.X,(0,n._)((0,a._)({},f),{"aria-label":"SBOM table",children:[(0,i.jsx)(A.d,{children:(0,i.jsx)(M.Tr,{children:(0,i.jsxs)(D.Ze,(0,n._)((0,a._)({},u),{children:[(0,i.jsx)(I.Th,(0,a._)({},x({columnKey:"name"}))),(0,i.jsx)(I.Th,(0,a._)({},x({columnKey:"version"}))),(0,i.jsx)(I.Th,(0,a._)({},x({columnKey:"supplier"})))]}))})}),(0,i.jsx)(D.nJ,{isLoading:d,isError:!!c,isNoData:0===o,numRenderedColumns:p,children:null==h?void 0:h.map(e=>(0,i.jsx)(U.N,{children:(0,i.jsxs)(M.Tr,(0,n._)((0,a._)({},m({item:e})),{children:[(0,i.jsx)(N.Td,(0,n._)((0,a._)({width:35,modifier:"breakWord"},_({columnKey:"name"})),{children:(0,i.jsx)(s.N_,{to:(0,s.tW)(T.Jh.sbomDetails,{sbomId:e.id}),children:e.name})})),(0,i.jsx)(N.Td,(0,n._)((0,a._)({width:15,modifier:"truncate"},_({columnKey:"version"})),{children:e.described_by.map(e=>e.version).join(", ")})),(0,i.jsx)(N.Td,(0,n._)((0,a._)({width:50,modifier:"truncate"},_({columnKey:"supplier"})),{children:e.suppliers.join(", ")}))]}))},e.id))})]})),(0,i.jsx)(R.n,{idPrefix:"sbom-table",isTop:!1,paginationProps:b})]})};var Z=r(95285),V=r.n(Z),z=r(59771),Q=r(45969),W=r(20311),H=r(64377),X=r(35913),Y=r(21328);let $=e=>{let{packageId:t}=e,{data:{vulnerabilities:r},isFetching:o,fetchError:d}=(0,X.G)(t),c=l.useMemo(()=>r.filter(e=>"affected"===e.vulnerabilityStatus),[r]),u=(0,Y.f)(c,e=>"".concat(e.vulnerability.identifier,"-").concat(e.vulnerabilityStatus)),p=(0,O.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:u,isLoading:o,columnNames:{identifier:"ID",description:"Description",severity:"CVSS",published:"Date published"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier","severity","published"],getSortValues:e=>{var t,r,a;return{identifier:e.vulnerability.identifier,severity:(null==(t=e.vulnerability)?void 0:t.average_score)||0,published:(null==(r=e.vulnerability)?void 0:r.published)?V()(null==(a=e.vulnerability)?void 0:a.published).valueOf():0}},isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:h,numRenderedColumns:v,propHelpers:{toolbarProps:y,paginationToolbarItemProps:b,paginationProps:f,tableProps:x,getThProps:m,getTrProps:_,getTdProps:j},expansionDerivedState:{isCellExpanded:g}}=p;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(P.M,(0,n._)((0,a._)({},y),{"aria-label":"vulnerability toolbar",children:(0,i.jsx)(E.P,{children:(0,i.jsx)(k.T,(0,n._)((0,a._)({},b),{children:(0,i.jsx)(R.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:f})}))})})),(0,i.jsxs)(C.X,(0,n._)((0,a._)({},x),{"aria-label":"vulnerability table",children:[(0,i.jsx)(A.d,{children:(0,i.jsx)(M.Tr,{children:(0,i.jsxs)(D.Ze,(0,n._)((0,a._)({},p),{children:[(0,i.jsx)(I.Th,(0,a._)({},m({columnKey:"identifier"}))),(0,i.jsx)(I.Th,(0,a._)({},m({columnKey:"description"}))),(0,i.jsx)(I.Th,(0,a._)({},m({columnKey:"severity"}))),(0,i.jsx)(I.Th,(0,a._)({},m({columnKey:"published"})))]}))})}),(0,i.jsx)(D.nJ,{isLoading:o,isError:!!d,isNoData:0===u.length,numRenderedColumns:v,children:null==h?void 0:h.map((e,t)=>{var r,l;return(0,i.jsx)(U.N,{isExpanded:g(e),children:(0,i.jsx)(M.Tr,(0,n._)((0,a._)({},_({item:e})),{children:(0,i.jsxs)(D.Oi,(0,n._)((0,a._)({},p),{item:e,rowIndex:t,children:[(0,i.jsx)(N.Td,(0,n._)((0,a._)({width:15,modifier:"breakWord"},j({columnKey:"identifier"})),{children:(0,i.jsx)(s.N_,{to:(0,s.tW)(T.Jh.vulnerabilityDetails,{vulnerabilityId:e.vulnerability.identifier}),children:e.vulnerability.identifier})})),(0,i.jsx)(W.R,{children:(t,r)=>(0,i.jsx)(N.Td,(0,n._)((0,a._)({width:60,modifier:"truncate",onFocus:()=>r(!0),onBlur:()=>r(!1),tabIndex:0},j({columnKey:"description"})),{children:(0,i.jsx)(z.mA,{focused:t,wrapModifier:"truncate",children:e.vulnerability&&(0,i.jsx)(H.j,{vulnerability:e.vulnerability})})}))}),(0,i.jsx)(N.Td,(0,n._)((0,a._)({width:15},j({columnKey:"severity"})),{children:(null==(r=e.vulnerability)?void 0:r.average_severity)&&(0,i.jsx)(Q.h,{value:e.vulnerability.average_severity,score:e.vulnerability.average_score,showLabel:!0,showScore:!0})})),(0,i.jsx)(N.Td,(0,n._)((0,a._)({width:10,modifier:"truncate"},j({columnKey:"published"})),{children:(0,K.Yq)(null==(l=e.vulnerability)?void 0:l.published)}))]}))}))},e._ui_unique_id)})})]})),(0,i.jsx)(R.n,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:f})]})};var G=r(52673);let ee=()=>{var e,t;let r=(0,T.Lu)("packageId"),{pkg:P,isFetching:E,fetchError:k}=(0,q.Si)(r),C=l.useMemo(()=>P?(0,K.fe)(P.purl):void 0,[P]),{propHelpers:{getTabsProps:A,getTabProps:M,getTabContentProps:I}}=(0,F.tc)({persistenceKeyPrefix:"pd",persistTo:"urlParams",tabKeys:["vulnerabilities","sboms"]}),U=l.createRef(),N=l.createRef(),R=l.createRef();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(G.T,{title:null==C?void 0:C.name}),(0,i.jsx)(o.d8,{type:"breadcrumb",children:(0,i.jsxs)(d.Q,{children:[(0,i.jsx)(c.J,{children:(0,i.jsx)(s.N_,{to:T.Jh.packages,children:"Packages"})}),(0,i.jsx)(c.J,{isActive:!0,children:"Package details"})]})}),(0,i.jsx)(o.d8,{children:(0,i.jsxs)(u.B,{children:[(0,i.jsx)(p.a,{children:(0,i.jsx)(h.U,{children:(0,i.jsx)(h.U,{component:"h1",children:null!=(t=null!=(e=null==C?void 0:C.name)?e:r)?t:""})})}),(0,i.jsx)(p.a,{children:(0,i.jsxs)(v.s,{children:[(0,i.jsxs)(y.Z,{spacer:{default:"spacerSm"},children:[(0,i.jsxs)("p",{children:["version: ",null==C?void 0:C.version]})," "]}),(0,i.jsx)(y.Z,{children:(null==C?void 0:C.qualifiers)&&(0,i.jsx)(w.a,{value:null==C?void 0:C.qualifiers})})]})})]})}),(0,i.jsx)(o.d8,{children:(0,i.jsxs)(b.t,(0,n._)((0,a._)({mountOnEnter:!0},A()),{"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,i.jsx)(f.o,(0,n._)((0,a._)({},M("vulnerabilities")),{title:(0,i.jsx)(x.V,{children:"Vulnerabilities"}),tabContentRef:U})),(0,i.jsx)(f.o,(0,n._)((0,a._)({},M("sboms")),{title:(0,i.jsx)(x.V,{children:"SBOMs using package"}),actions:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m.o,{ref:R,children:(0,i.jsx)(g.Ay,{})}),(0,i.jsx)(_.A,{bodyContent:(0,i.jsx)("div",{children:"A list of SBOMs using this package."}),triggerRef:R})]}),tabContentRef:N}))]}))}),(0,i.jsxs)(o.d8,{children:[(0,i.jsx)(j.J,(0,n._)((0,a._)({},I("vulnerabilities")),{ref:U,"aria-label":"Vulnerabilities of the Package",children:r&&(0,i.jsx)($,{packageId:r})})),(0,i.jsx)(j.J,(0,n._)((0,a._)({},I("sboms")),{ref:N,"aria-label":"SBOMs using the Package",children:(0,i.jsx)(S.a,{isFetching:E,fetchError:k,children:(null==P?void 0:P.purl)&&(0,i.jsx)(L,{purl:P.purl})})}))]})]})}},33468:function(e,t,r){r.d(t,{Lx:()=>d,Si:()=>c,sl:()=>u});var a=r(32909),n=r(77184),i=r(96002),l=r(86141),s=r(73470);let o="packages",d=function(){var e,t,r;let d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:u,isLoading:p,error:h,refetch:v}=(0,n.I)({queryKey:[o,d],queryFn:()=>(0,l.UD)({client:i.S,query:(0,a._)({},(0,s.kd)(d))}),enabled:!c});return{result:{data:(null==u||null==(e=u.data)?void 0:e.items)||[],total:null!=(r=null==u||null==(t=u.data)?void 0:t.total)?r:0,params:d},isFetching:p,fetchError:h,refetch:v}},c=e=>{let{data:t,isLoading:r,error:a}=(0,n.I)({queryKey:[o,e],queryFn:()=>(0,l.Y0)({client:i.S,path:{key:e}})});return{pkg:null==t?void 0:t.data,isFetching:r,fetchError:a}},u=function(e){var t,r,d;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:u,isLoading:p,error:h,refetch:v}=(0,n.I)({queryKey:[o,"by-sbom",e,c],queryFn:()=>(0,l.Ad)({client:i.S,path:{id:e},query:(0,a._)({},(0,s.kd)(c))})});return{result:{data:(null==u||null==(t=u.data)?void 0:t.items)||[],total:null!=(d=null==u||null==(r=u.data)?void 0:r.total)?d:0,params:c},isFetching:p,fetchError:h,refetch:v}}},30111:function(e,t,r){r.d(t,{DH:()=>S,Qr:()=>T,_P:()=>f,bj:()=>F,cF:()=>g,i$:()=>x,l6:()=>_,rj:()=>m,sn:()=>j,zY:()=>w});var a=r(32909),n=r(42642),i=r(72610),l=r(77184),s=r(59722),o=r(62603),d=r(90130),c=r(3822),u=r(96002),p=r(86141),h=r(93531),v=r(81895),y=r(73470);let b="sboms",f=e=>{let{data:t,isLoading:r,error:a,refetch:n}=(0,l.I)({queryKey:[b,"labels",e],queryFn:()=>(0,p.Dw)({client:u.S,query:{limit:10,filter_text:e}}),placeholderData:s.rX});return{labels:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a,refetch:n}},x=function(){var e,t,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=(0,y.kd)(s),{q:h}=c,v=(0,i._)(c,["q"]),f=(0,y.Er)(o),{data:x,isLoading:m,error:_,refetch:j}=(0,l.I)({queryKey:[b,s,f],queryFn:()=>(0,p.z1)({client:u.S,query:(0,n._)((0,a._)({},v),{q:[h,f].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==x||null==(e=x.data)?void 0:e.items)||[],total:null!=(r=null==x||null==(t=x.data)?void 0:t.total)?r:0,params:s},isFetching:m,fetchError:_,refetch:j}},m=(e,t,r)=>{let{data:a,isLoading:n,error:i}=(0,l.I)({queryKey:[b,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,p.a7)({client:u.S,path:{id:e}}),enabled:!!e,refetchInterval:t,retry:r});return{sbom:null==a?void 0:a.data,isFetching:n,fetchError:i}},_=(e,t)=>{let r=(0,o.jE)();return(0,d.n)({mutationFn:async e=>(await (0,p.bS)({client:u.S,path:{id:e}})).data,onSuccess:async(t,a)=>{e(t,a),await r.invalidateQueries({queryKey:[b]}),r.removeQueries({queryKey:[b,a]})},onError:async e=>{t(e),await r.invalidateQueries({queryKey:[b]})}})},j=()=>{let e=(0,o.jE)();return(0,h.v)({parallel:!0,uploadFn:(e,t)=>(0,v.J4)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[b]})}})},g=(e,t)=>{let r=(0,o.jE)();return(0,d.n)({mutationFn:e=>(0,p.aB)({client:u.S,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[b]})},onError:t})},T=function(e){var t,r,n;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:s,isLoading:o,error:d,refetch:c}=(0,l.I)({queryKey:[b,"by-package",e,i],queryFn:()=>(0,p.m9)({client:u.S,query:(0,a._)({purl:e},(0,y.kd)(i))})});return{result:{data:(null==s||null==(t=s.data)?void 0:t.items)||[],total:null!=(n=null==s||null==(r=s.data)?void 0:r.total)?n:0,params:i},isFetching:o,fetchError:d,refetch:c}},S=e=>{let{data:t,isLoading:r,error:a}=(0,l.I)({queryKey:[b,e,"advisory"],queryFn:()=>(0,p.bj)({client:u.S,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a}},w=e=>{let t=(0,c.E)({queries:e.map(e=>({queryKey:[b,e,"advisory"],queryFn:()=>(0,p.bj)({client:u.S,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},F=e=>{let{data:t,isLoading:r,error:a}=(0,l.I)({queryKey:[b,e,"license-ids"],queryFn:()=>(0,p.ZV)({client:u.S,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a}}},21328:function(e,t,r){r.d(t,{f:()=>s});var a=r(32909),n=r(42642),i=r(63696),l=r(98259);let s=(e,t)=>(0,i.useMemo)(()=>e&&0!==e.length?e.map(e=>(0,n._)((0,a._)({},e),{[l.FA]:t(e)})):[],[e,t])}}]);