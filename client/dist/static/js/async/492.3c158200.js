"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["492"],{69876:function(e,t,r){r.d(t,{D:()=>l});var i=r(24246),a=r(70400);let l=e=>{let{value:t}=e;return(0,i.jsx)(i.Fragment,{children:Object.entries(t).map(e=>{let[t,r]=e;return(0,i.jsx)(a._,{isCompact:!0,children:`${t}=${r}`},`${t}=${r}`)})})}},31373:function(e,t,r){r.d(t,{H:()=>o});var i=r(27378),a=r(7615),l=r(59015);let s=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,n={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},u={vulnerabilityStatus:{affected:{...n},fixed:{...n},not_affected:{...n},known_not_affected:{...n}}},c=e=>{let t=e.flatMap(e=>(e.status??[]).map(t=>{let r=(0,a.g)(t.average_severity);return{vulnerability:{...t.vulnerability,average_severity:r,average_score:t.average_score},vulnerabilityStatus:t.status,advisory:e}})).reduce((e,t)=>{let r,i=e.find(e=>s(e,t));if(i)r=[...e.filter(e=>!s(e,i)),{...i,relatedSboms:[...i.relatedSboms,{advisory:t.advisory}]}];else{let i={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};r=[...e.slice(),i]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,i=t.vulnerability.average_severity,a=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:a.total+1,severities:{...a.severities,[i]:a.severities[i]+1}}}})},{...u});return{vulnerabilities:t,summary:r}},o=e=>{let{pkg:t,isFetching:r,fetchError:a}=(0,l.ZA)(e);return{data:i.useMemo(()=>c(t?.advisories||[]),[t]),isFetching:r,fetchError:a}}},96308:function(e,t,r){r.d(t,{n:()=>c});var i=r(24246),a=r(11797),l=r(37818),s=r(42573),n=r(49304),u=r(31373);let c=e=>{let{packageId:t}=e,{data:r,isFetching:c,fetchError:o}=(0,u.H)(t);return(0,i.jsx)(l.u,{isFetching:c,fetchError:o,isFetchingState:(0,i.jsx)(a.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,i.jsx)(s.C,{error:e}),children:(0,i.jsx)(n.u,{severities:r.summary.vulnerabilityStatus.affected.severities})})}},33384:function(e,t,r){r.d(t,{a:()=>o,u:()=>d});var i=r(24246),a=r(27378),l=r(74502),s=r(14629),n=r(49988),u=r(59015),c=r(63706);let o=a.createContext({}),d=e=>{let{children:t}=e,r=(0,n.vZ)({tableName:"packages",persistenceKeyPrefix:l.yq.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:l.L4,title:"Filter text",placeholderText:"Search",type:s.vA.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:s.vA.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:s.vA.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:d,total:p},isFetching:h,fetchError:m}=(0,u.fF)((0,n.QO)({...r,hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}})),v=a.useMemo(()=>d.map(e=>({...e,decomposedPurl:(0,c.qX)(e.purl)})),[d]),y=(0,n.KC)({...r,idProperty:"uuid",currentPageItems:v,totalItemCount:p,isLoading:h});return(0,i.jsx)(o.Provider,{value:{totalItemCount:p,isFetching:h,fetchError:m,tableControls:y},children:t})}},75778:function(e,t,r){r.d(t,{L:()=>x});var i=r(24246),a=r(27378),l=r(65783),s=r(4835),n=r(14350),u=r(11165),c=r(89330),o=r(31423),d=r(94154),p=r(69876),h=r(3804),m=r(31336),v=r(96308),y=r(33384);let x=()=>{let{isFetching:e,fetchError:t,totalItemCount:r,tableControls:x}=a.useContext(y.a),{numRenderedColumns:b,currentPageItems:f,propHelpers:{paginationProps:j,tableProps:g,getThProps:K,getTrProps:P,getTdProps:T}}=x;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.i,{...g,"aria-label":"Package table",children:[(0,i.jsx)(n.h,{children:(0,i.jsx)(u.Tr,{children:(0,i.jsxs)(m.qK,{...x,children:[(0,i.jsx)(c.Th,{...K({columnKey:"name"})}),(0,i.jsx)(c.Th,{...K({columnKey:"namespace"})}),(0,i.jsx)(c.Th,{...K({columnKey:"version"})}),(0,i.jsx)(c.Th,{...K({columnKey:"type"})}),(0,i.jsx)(c.Th,{...K({columnKey:"path"})}),(0,i.jsx)(c.Th,{...K({columnKey:"qualifiers"})}),(0,i.jsx)(c.Th,{...K({columnKey:"vulnerabilities"})})]})})}),(0,i.jsx)(m.hp,{isLoading:e,isError:!!t,isNoData:0===r,numRenderedColumns:b,children:f.map((e,t)=>(0,i.jsx)(o.p,{children:(0,i.jsx)(u.Tr,{...P({item:e}),children:(0,i.jsxs)(m.Cx,{...x,item:e,rowIndex:t,children:[(0,i.jsx)(d.Td,{width:15,modifier:"breakWord",...T({columnKey:"name"}),children:(0,i.jsx)(l.OL,{to:`/packages/${e.uuid}`,children:e.decomposedPurl?e.decomposedPurl?.name:e.purl})}),(0,i.jsx)(d.Td,{width:15,modifier:"truncate",...T({columnKey:"namespace"}),children:e.decomposedPurl?.namespace}),(0,i.jsx)(d.Td,{width:10,modifier:"truncate",...T({columnKey:"version"}),children:e.decomposedPurl?.version}),(0,i.jsx)(d.Td,{width:10,modifier:"truncate",...T({columnKey:"type"}),children:e.decomposedPurl?.type}),(0,i.jsx)(d.Td,{width:10,modifier:"truncate",...T({columnKey:"path"}),children:e.decomposedPurl?.path}),(0,i.jsx)(d.Td,{width:20,...T({columnKey:"qualifiers"}),children:e.decomposedPurl?.qualifiers&&(0,i.jsx)(p.D,{value:e.decomposedPurl?.qualifiers})}),(0,i.jsx)(d.Td,{width:20,...T({columnKey:"vulnerabilities"}),children:(0,i.jsx)(v.n,{packageId:e.uuid})})]})})},e.uuid))})]}),(0,i.jsx)(h.p,{idPrefix:"package-table",isTop:!1,paginationProps:j})]})}},39305:function(e,t,r){r.d(t,{v:()=>d});var i=r(24246),a=r(27378),l=r(70715),s=r(40982),n=r(89226),u=r(14629),c=r(3804),o=r(33384);let d=e=>{let{showFilters:t}=e,{tableControls:r}=a.useContext(o.a),{propHelpers:{toolbarProps:d,filterToolbarProps:p,paginationToolbarItemProps:h,paginationProps:m}}=r;return(0,i.jsx)(l.o,{...d,children:(0,i.jsxs)(s.c,{children:[t&&(0,i.jsx)(u.Ki,{...p}),(0,i.jsx)(n.E,{...h,children:(0,i.jsx)(c.p,{idPrefix:"package-table",isTop:!0,paginationProps:m})})]})})}},59015:function(e,t,r){r.d(t,{D4:()=>o,ZA:()=>c,fF:()=>u});var i=r(1183),a=r(50576),l=r(40371),s=r(49988);let n="packages",u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:u,error:c,refetch:o}=(0,i.a)({queryKey:[n,e],queryFn:()=>(0,l.tj)({client:a.L,query:{...(0,s.rm)(e)}}),enabled:!t});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e},isFetching:u,fetchError:c,refetch:o}},c=e=>{let{data:t,isLoading:r,error:s}=(0,i.a)({queryKey:[n,e],queryFn:()=>(0,l.BK)({client:a.L,path:{key:e}})});return{pkg:t?.data,isFetching:r,fetchError:s}},o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:u,error:c,refetch:o}=(0,i.a)({queryKey:[n,"by-sbom",e,t],queryFn:()=>(0,l.Pg)({client:a.L,path:{id:e},query:{...(0,s.rm)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t},isFetching:u,fetchError:c,refetch:o}}}}]);