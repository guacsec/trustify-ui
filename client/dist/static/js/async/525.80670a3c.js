"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["525"],{61992:function(e,t,l){l.r(t),l.d(t,{default:()=>eE});var r,i=l(32909),s=l(42642),n=l(62540),a=l(63696),o=l(68430),c=l(61360),d=l(35048),u=l(56918),p=l(42957),h=l(32490),x=l(98259),y=l(74343),j=l(5530),g=l(69548),f=l(39757),v=l(90280),b=l(65841),m=l(81595),C=l(58780),k=l(34952),S=l(27800),A=l(46173),_=l(99134),F=l(33468),w=l(30111),O=l(31903);let R=e=>(0,n.jsx)(y.N_,{to:e.navLink,style:{textDecoration:"none"},children:(0,n.jsxs)(j.D,{itemId:e.id,description:e.description,children:[e.title," ",(0,n.jsx)(g.J,{color:e.typeColor,children:e.type})]})},e.id),E=e=>{let{onChangeSearch:t}=e,{tableControls:l}=a.useContext(A.L),[r,s]=a.useState(""),[o,c]=a.useState(!1);a.useEffect(()=>{var e;let t=null==(e=l.filterState.filterValues[x._G])?void 0:e[0];s(null!=t?t:"")},[l.filterState]);let[d,u]=(0,S.Q3)(r,500);a.useEffect(()=>{u(r)},[u,r]);let{isFetching:p,list:h}=function(e,t){let l={filters:[{field:x._G,operator:"~",value:e}],page:{pageNumber:1,itemsPerPage:5}},{isFetching:r,result:{data:s}}=(0,_.VH)((0,i._)({},l),[],t),{isFetching:n,result:{data:a}}=(0,F.Lx)((0,i._)({},l),t),{isFetching:o,result:{data:c}}=(0,w.i$)((0,i._)({},l),[],t),{isFetching:d,result:{data:u}}=(0,O.WJ)((0,i._)({},l),t),p=s.map(e=>{var t;return{id:"advisory-".concat(e.uuid),title:e.document_id,description:null==(t=e.title)?void 0:t.substring(0,75),navLink:"/advisories/".concat(e.uuid),type:"Advisory",typeColor:"blue"}}),h=a.map(e=>({id:"package-".concat(e.uuid),title:e.purl,navLink:"/packages/".concat(e.uuid),type:"Package",typeColor:"teal"})),y=c.map(e=>({id:"sbom-".concat(e.id),title:e.name,description:e.suppliers.join(", "),navLink:"/sboms/".concat(e.id),type:"SBOM",typeColor:"purple"})),j=u.map(e=>{var t;return{id:"vulnerability-".concat(e.identifier),title:e.identifier,description:null==(t=e.description)?void 0:t.substring(0,75),navLink:"/vulnerabilities/".concat(e.identifier),type:"Vulnerability",typeColor:"orange"}}),g=e.toLowerCase();return{isFetching:r||n||o||d,list:[...j,...y,...p,...h].sort((e,t)=>{var l,r;return(null==(l=e.title)?void 0:l.includes(g))?-1:(null==(r=t.title)?void 0:r.includes(g))?1:(e.description||"").toLowerCase().indexOf(g)-(t.description||"").toLowerCase().indexOf(g)})}}(d,!o),[y,g]=a.useState(!1),E=a.useRef(null),V=a.useRef(null);a.useEffect(()=>{let e=e=>{var t,l,r;if(y&&E.current&&E.current===e.target)if("Escape"===e.key)g(!1),E.current.focus();else if("ArrowDown"===e.key||"ArrowUp"===e.key){let t=null==(l=V.current)?void 0:l.querySelector("li > button:not(:disabled)");t&&(null==t||t.focus()),e.preventDefault()}else("Tab"===e.key||"Enter"===e.key||"Space"===e.key)&&(g(!1),("Enter"===e.key||"Space"===e.key)&&e.preventDefault());else y&&(null==(t=V.current)?void 0:t.contains(e.target))&&"Tab"===e.key&&(e.preventDefault(),g(!1),null==(r=E.current)||r.focus())},t=e=>{y&&V&&V.current&&!V.current.contains(e.target)&&g(!1)};return window.addEventListener("keydown",e),window.addEventListener("click",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("click",t)}},[y]);let D=(0,n.jsx)(f.W,{ref:V,style:{width:"450px",maxHeight:"450px",overflow:"scroll",overflowX:"hidden",overflowY:"auto"},children:(0,n.jsx)(v.r,{children:(0,n.jsx)(b.c,{children:p?(0,n.jsx)(j.D,{itemId:"loading",children:(0,n.jsx)(m.y,{size:"sm"})}):h.map(R)})})}),T=(0,n.jsx)(C.D,{placeholder:"Search for an SBOM, Package, Advisory, or Vulnerability",value:r,onChange:(e,t)=>{""!==t&&E&&E.current&&E.current.contains(document.activeElement)?g(!0):g(!1),s(t),c(!0)},onClear:()=>{s("")},onSearch:()=>{t(r)},onKeyDown:e=>{if(e.key&&"Enter"!==e.key)return},ref:E,id:"autocomplete-search",style:{width:500}});return(0,n.jsx)(k.N,{trigger:T,triggerRef:E,popper:D,popperRef:V,isVisible:y&&h.length>0||p,enableFlip:!1,appendTo:()=>document.querySelector("#autocomplete-search")})};var V=l(27889),D=l(13701),T=l(62517);function I(e,t){return{Component:e,props:t}}let K=(r=[I(A.c,{}),I(D.a,{}),I(T.y,{}),I(V.r,{})],e=>{let{children:t}=e,l=(0,n.jsx)(n.Fragment,{children:t});return r.reduceRight((e,t)=>{let{Component:l,props:r={}}=t;return(0,n.jsx)(l,(0,s._)((0,i._)({},r),{children:e}),e.key)},l)});var L=l(54518),P=l(48281),M=l(17327),B=l(71603),Y=l(40989),G=l(60423),N=l(40111),z=l(15157),H=l(2057),W=l(70414),$=l(66542),U=l(8210),q=l(88508),J=l(38914),Q=l(57901),X=l(24773),Z=l(72610);l(21999);var ee=l(66091);let et=e=>{let{category:t,filterValue:l,setFilterValue:r,isDisabled:i=!1}=e,s=a.useRef(new Map);a.useEffect(()=>{for(let e of t.selectOptions)s.current.set(e.value,e)},[t.selectOptions]);let[o,c]=a.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);a.useEffect(()=>{c(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]);let d=e=>{var t;return{id:e.value,name:null!=(t=e.label)?t:e.value}};return(0,n.jsx)(ee.I,{showChips:!0,isDisabled:i,options:o.map(d),selections:null==l?void 0:l.map(e=>{let t=s.current.get(e);return t?d(t):{id:e,name:e}}),onChange:e=>{r(e.map(e=>e.id))},noResultsMessage:"No search results",placeholderText:t.placeholderText,searchInputAriaLabel:"select-autocomplete-listbox",onSearchChange:t.onInputValueChange})};var el=l(23909),er=l(84631);let ei=e=>{let{category:t,filterValue:l,setFilterValue:r,isDisabled:i=!1}=e,[s,o]=a.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);return a.useEffect(()=>{o(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]),(0,n.jsx)(er.j,{showChips:!0,isDisabled:i,options:s.map(e=>{var t;return{id:e.value,name:null!=(t=e.label)?t:e.value}}),selections:null==l?void 0:l.map(e=>({id:e,name:e})),onChange:e=>{r(e.map(e=>(0,el.AA)(e.name)))},noResultsMessage:"No search results",placeholderText:t.placeholderText,searchInputAriaLabel:"select-autocomplete-listbox",onSearchChange:t.onInputValueChange})};var es=l(58365);let en=e=>{let{category:t,filterValue:l,setFilterValue:r}=e,[i,s]=a.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);a.useEffect(()=>{s(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]);let o=Array.isArray(i)?i:Object.values(i).flat();return(0,n.jsx)(n.Fragment,{children:o.map((e,i)=>{let{label:s,value:a}=e;return(0,n.jsx)(es.S,{id:"checkbox-".concat(i,"-").concat(t.categoryKey),isLabelWrapped:!0,label:s,isChecked:null==l?void 0:l.includes(a),onChange:()=>{a&&"No results"!==a&&r((null==l?void 0:l.includes(a))?l.filter(e=>e!==a):l?[...l,a]:[a])}},s)})})};var ea=l(78109),eo=l(75484),ec=l(40360),ed=l(38360),eu=l(83200);let ep=e=>{let{filterValue:t,setFilterValue:l,isDisabled:r=!1}=e,[i,s]=(0,a.useState)(),[o,c]=(0,a.useState)();return a.useEffect(()=>{if(null==t?void 0:t[0]){let[e,l]=(0,eu.P1)(null==t?void 0:t[0]);s(e.toDate()),c(l.toDate())}else s(void 0),c(void 0)},[t]),(0,n.jsxs)(eo.l,{children:[(0,n.jsx)(ec.g,{role:"group",isInline:!0,label:"From",children:(0,n.jsx)(ed.l,{value:i?(0,eu.ak)(i):"",dateFormat:eu.ak,dateParse:eu.sy,onChange:(e,t)=>{(0,eu.Fz)(t)&&(s((0,eu.sy)(t)),c(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"Invalid date",appendTo:document.body,isDisabled:r})}),(0,n.jsx)(ec.g,{role:"group",isInline:!0,label:"To",children:(0,n.jsx)(ed.l,{value:o?(0,eu.ak)(o):"",onChange:(e,t)=>{if((0,eu.Fz)(t)){let e=(0,eu.sy)(t);c(e);let r=(0,eu.Kg)(i,e);r&&l([r])}},isDisabled:r||!(0,ea.v)(i),dateFormat:eu.ak,dateParse:eu.sy,invalidFormatText:"Invalid date",rangeStart:i,validators:[e=>i&&(0,ea.v)(i)&&e>=i?"":'The "to" date must be after the "from" date'],"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})})]})};var eh=l(10562);let ex=e=>{let{category:t,filterValue:l,setFilterValue:r,isDisabled:i=!1}=e;return(0,n.jsx)(n.Fragment,{children:t.selectOptions.map((e,s)=>{let{label:a,value:o}=e,c=(null==l?void 0:l.includes(o))||!1;return(0,n.jsx)(eh.s,{isDisabled:i,id:"radio-".concat(s),name:"radio",isLabelWrapped:!0,label:a,isChecked:c,onChange:()=>{r(t.selectOptions.find(e=>{let{value:t}=e;return t===o})?[o]:null)}},a)})})};var ey=l(58897),ej=l(13135),eg=l(51463);let ef=e=>{let{category:t,filterValue:l,setFilterValue:r,isNumeric:i,isDisabled:s=!1}=e,[o,c]=a.useState((null==l?void 0:l[0])||"");a.useEffect(()=>{c((null==l?void 0:l[0])||"")},[l]);let d=()=>{let e=o.trim();r(e?[e.replace(/\s+/g," ")]:[])},u="".concat(t.categoryKey,"-input");return(0,n.jsxs)(ey.M,{children:[(0,n.jsx)(ej.ks,{name:u,type:i?"number":"search",onChange:(e,t)=>c(t),"aria-label":"".concat(t.title," filter"),value:o,placeholder:t.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||d()},isDisabled:s}),(0,n.jsx)(X.$n,{icon:(0,n.jsx)(eg.Ay,{}),variant:X.Ak.control,"aria-label":"search button for search input",onClick:d,isDisabled:s})]})},ev=e=>{let{category:t,filterValue:l,setFilterValue:r,isDisabled:i=!1}=e;return(0,n.jsx)(es.S,{id:"filter-control-".concat(t.categoryKey),label:t.label,isChecked:(0,el.iw)(null==l?void 0:l[0]),onChange:(e,t)=>{t?r([String(!0)]):r(null)},isDisabled:i})},eb=e=>{var{category:t}=e,l=(0,Z._)(e,["category"]);return"select"===t.type?(0,n.jsx)(ex,(0,i._)({category:t},l)):"search"===t.type||"numsearch"===t.type?(0,n.jsx)(ef,(0,i._)({category:t,isNumeric:"numsearch"===t.type},l)):"multiselect"===t.type?(0,n.jsx)(en,(0,i._)({category:t},l)):"asyncMultiselect"===t.type?(0,n.jsx)(et,(0,i._)({category:t},l)):"dateRange"===t.type?(0,n.jsx)(ep,(0,i._)({category:t},l)):"autocompleteLabel"===t.type?(0,n.jsx)(ei,(0,i._)({category:t},l)):"toggle"===t.type?(0,n.jsx)(ev,(0,i._)({category:t},l)):null},em=e=>{let{filterCategories:t,filterValues:l,setFilterValues:r,isDisabled:a=!1,omitFilterCategoryKeys:o=[]}=e;return(0,n.jsxs)(J.B,{hasGutter:!0,children:[(0,n.jsx)(Q.a,{children:(0,n.jsx)(X.$n,{variant:"link",isInline:!0,onClick:()=>{let e=t.filter(e=>void 0===o.find(t=>t===e.categoryKey)).reduce((e,t)=>(e[t.categoryKey]=void 0,e),{});r((0,i._)({},l,e))},children:"Clear all filters"})}),t.filter(e=>void 0===o.find(t=>t===e.categoryKey)).map(e=>(0,n.jsx)(Q.a,{children:(0,n.jsxs)(J.B,{hasGutter:!0,children:[(0,n.jsx)(Q.a,{children:(0,n.jsx)(p.U,{component:"h4",children:e.title})}),(0,n.jsx)(Q.a,{children:(0,n.jsx)(eb,{category:e,filterValue:l[e.categoryKey],setFilterValue:t=>r((0,s._)((0,i._)({},l),{[e.categoryKey]:t})),isDisabled:a,isSidebar:!0})})]})},e.categoryKey))]})};var eC=l(41484),ek=l(5193),eS=l(66005),eA=l(22549),e_=l(74466),eF=l(75725),ew=l(11934),eO=l(13829);let eR=e=>{let{filterPanelProps:t,sbomTable:l,sbomTotalCount:r,packageTable:s,packageTotalCount:o,vulnerabilityTable:c,vulnerabilityTotalCount:d,advisoryTable:u,advisoryTotalCount:p,isFetchingPackages:h,isFetchingSboms:x,isFetchingVulnerabilities:y,isFetchingAdvisories:j}=e,[g,f]=a.useState(0),{sbomFilterPanelProps:v,packageFilterPanelProps:b,vulnerabilityFilterPanelProps:m,advisoryFilterPanelProps:C}=t,k=a.createRef(),S=a.createRef(),A=a.createRef(),_=a.createRef();return(0,n.jsxs)(L.B,{hasGutter:!0,children:[(0,n.jsx)(P.o,{children:(0,n.jsx)(M.Z,{isFullHeight:!0,children:(0,n.jsx)(B.b,{style:{width:241},children:0===g?(0,n.jsx)(em,(0,i._)({omitFilterCategoryKeys:[""]},v)):1===g?(0,n.jsx)(em,(0,i._)({omitFilterCategoryKeys:[""]},b)):2===g?(0,n.jsx)(em,(0,i._)({omitFilterCategoryKeys:[""]},m)):3===g?(0,n.jsx)(em,(0,i._)({omitFilterCategoryKeys:[""]},C)):null})})}),(0,n.jsx)(P.o,{isFilled:!0,children:(0,n.jsxs)(Y.t,{mountOnEnter:!0,isBox:!0,activeKey:g,onSelect:(e,t)=>{f(t)},"aria-label":"Tabs",role:"region",children:[(0,n.jsxs)(G.o,{eventKey:0,title:(0,n.jsxs)(N.V,{children:["SBOMs","  ",(0,n.jsx)(z.E,{screenReaderText:"Search Result Count",children:x?(0,n.jsx)(H.I,{size:"sm",children:(0,n.jsx)(q.Ay,{})}):r})]}),actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W.o,{"aria-label":"SBOM help popover",ref:k,children:(0,n.jsx)(U.Ay,{})}),(0,n.jsx)($.A,{bodyContent:(0,n.jsx)("div",{children:"A list of ingested Software Bill of Materials (SBOM) documents."}),position:"right",triggerRef:k})]}),children:[(0,n.jsx)(eF.r,{}),null!=l?l:(0,n.jsx)(e_.Y,{})]}),(0,n.jsxs)(G.o,{eventKey:1,title:(0,n.jsxs)(N.V,{children:["Packages","  ",(0,n.jsx)(z.E,{screenReaderText:"Search Result Count",children:h?(0,n.jsx)(H.I,{size:"sm",children:(0,n.jsx)(q.Ay,{})}):o})]}),actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W.o,{"aria-label":"Package help popover",ref:S,children:(0,n.jsx)(U.Ay,{})}),(0,n.jsx)($.A,{bodyContent:(0,n.jsx)("div",{children:"A list of packages along with the count of vulnerabilities."}),position:"right",triggerRef:S})]}),children:[(0,n.jsx)(eA.I,{}),null!=s?s:(0,n.jsx)(eS.N,{})]}),(0,n.jsxs)(G.o,{eventKey:2,title:(0,n.jsxs)(N.V,{children:["Vulnerabilities","  ",(0,n.jsx)(z.E,{screenReaderText:"Search Result Count",children:y?(0,n.jsx)(H.I,{size:"sm",children:(0,n.jsx)(q.Ay,{})}):d})]}),actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W.o,{"aria-label":"Vulnerability help popover",ref:A,children:(0,n.jsx)(U.Ay,{})}),(0,n.jsx)($.A,{bodyContent:(0,n.jsx)("div",{children:"A list of publicly known Common Vulnerabilities and Exposures (CVE)."}),position:"right",triggerRef:A})]}),children:[(0,n.jsx)(eO.y,{}),null!=c?c:(0,n.jsx)(ew.f,{})]}),(0,n.jsxs)(G.o,{eventKey:3,title:(0,n.jsxs)(N.V,{children:["Advisories","  ",(0,n.jsx)(z.E,{screenReaderText:"Advisory Result Count",children:j?(0,n.jsx)(H.I,{size:"sm",children:(0,n.jsx)(q.Ay,{})}):p})]}),actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W.o,{"aria-label":"Advisory help popover",ref:_,children:(0,n.jsx)(U.Ay,{})}),(0,n.jsx)($.A,{bodyContent:(0,n.jsx)("div",{children:"A list of available advisories."}),position:"right",triggerRef:_})]}),children:[(0,n.jsx)(ek.F,{}),null!=u?u:(0,n.jsx)(eC.q,{})]})]})})]})},eE=e=>{let{searchBodyOverride:t}=e;return(0,n.jsx)(K,{children:(0,n.jsx)(eV,{searchBodyOverride:t})})},eV=e=>{let{searchBodyOverride:t}=e,{tableControls:l}=a.useContext(A.L),{tableControls:r}=a.useContext(D.Y),{tableControls:y}=a.useContext(T.u),{tableControls:j}=a.useContext(V.R),{isFetching:g,totalItemCount:f,tableControls:{propHelpers:{filterPanelProps:v}}}=a.useContext(A.L),{isFetching:b,totalItemCount:m,tableControls:{propHelpers:{filterPanelProps:C}}}=a.useContext(D.Y),{isFetching:k,totalItemCount:S,tableControls:{propHelpers:{filterPanelProps:_}}}=a.useContext(T.u),{isFetching:F,totalItemCount:w,tableControls:{propHelpers:{filterPanelProps:O}}}=a.useContext(V.R),R=(0,n.jsx)(eR,{filterPanelProps:{advisoryFilterPanelProps:O,packageFilterPanelProps:C,sbomFilterPanelProps:v,vulnerabilityFilterPanelProps:_},packageTotalCount:m,sbomTotalCount:f,vulnerabilityTotalCount:S,advisoryTotalCount:w,isFetchingPackages:b,isFetchingSboms:g,isFetchingVulnerabilities:k,isFetchingAdvisories:F});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.d8,{hasBodyWrapper:!1,children:(0,n.jsx)(c.M,{isStatic:!0,children:(0,n.jsxs)(d.P,{children:[(0,n.jsx)(u.$,{align:{default:"alignStart"},children:(0,n.jsx)(p.U,{children:(0,n.jsx)(p.U,{component:"h1",children:"Search Results"})})}),(0,n.jsx)(u.$,{variant:"action-group-plain",align:{default:"alignEnd"},children:(0,n.jsx)(u.$,{visibility:{default:"visible"},children:(0,n.jsx)(h.T,{children:(0,n.jsx)(E,{onChangeSearch:e=>{void 0!==e&&(l.filterState.setFilterValues((0,s._)((0,i._)({},l.filterState.filterValues),{[x._G]:[e]})),r.filterState.setFilterValues((0,s._)((0,i._)({},r.filterState.filterValues),{[x._G]:[e]})),y.filterState.setFilterValues((0,s._)((0,i._)({},y.filterState.filterValues),{[x._G]:[e]})),j.filterState.setFilterValues((0,s._)((0,i._)({},j.filterState.filterValues),{[x._G]:[e]})))}})})})})]})})}),(0,n.jsx)(o.d8,{hasBodyWrapper:!1,children:t||R})]})}}}]);