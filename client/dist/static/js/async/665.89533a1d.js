"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["665"],{69876:function(e,t,r){r.d(t,{D:()=>i});var a=r(24246),l=r(70400);let i=e=>{let{value:t}=e;return(0,a.jsx)(a.Fragment,{children:Object.entries(t).map(e=>{let[t,r]=e;return(0,a.jsx)(l._,{isCompact:!0,children:`${t}=${r}`},`${t}=${r}`)})})}},57524:function(e,t,r){r.d(t,{o:()=>u});var a=r(24246),l=r(34747),i=r(46770),s=r(64766),n=r(2499),c=r(32947);let u=e=>{let{value:t,score:r,showScore:u,showLabel:d}=e,o=c.V4[t],h=o.name,p=o.icon;return(0,a.jsxs)(l.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,a.jsx)(i.B,{children:d?(0,a.jsx)(s.J,{children:(0,a.jsx)(p,{color:o.color.value})}):(0,a.jsx)(n.u,{content:h,children:(0,a.jsx)(s.J,{children:(0,a.jsx)(p,{color:o.color.value})})})}),d&&(0,a.jsx)(i.B,{children:h}),u&&null!==r&&(0,a.jsxs)(i.B,{children:["(",Math.round(10*r)/10,")"]})]})}},3804:function(e,t,r){r.d(t,{p:()=>i});var a=r(24246),l=r(27230);let i=e=>{let{paginationProps:t,isTop:r,isCompact:i=!1,idPrefix:s=""}=e;return(0,a.jsx)(l.t,{id:`${s?`${s}-`:""}pagination-${r?"top":"bottom"}`,variant:r?l.a.top:l.a.bottom,isCompact:i,...t,widgetId:"pagination-id"})}},42573:function(e,t,r){r.d(t,{C:()=>i});var a=r(24246),l=r(70400);let i=e=>{let{error:t}=e;return(0,a.jsxs)(l._,{color:"red",children:[t.status," Error"]})}},31336:function(e,t,r){r.d(t,{hp:()=>m,qK:()=>j,Cx:()=>y});var a=r(24246),l=r(8305),i=r(13754),s=r(31423),n=r(11165),c=r(94154),u=r(39826),d=r(10707),o=r(16668),h=r(22119);let p=e=>{let{title:t,description:r}=e;return(0,a.jsx)(d.ub,{titleText:t,headingLevel:"h4",icon:h.ZP,variant:d.IQ.sm,children:r&&(0,a.jsx)(o.B,{children:r})})},x=()=>(0,a.jsx)(p,{title:"No data available",description:"No data available to be shown here."}),m=e=>{let{numRenderedColumns:t,isLoading:r=!1,isError:d=!1,isNoData:o=!1,errorEmptyState:h=null,noDataEmptyState:p=null,children:m}=e;return(0,a.jsx)(a.Fragment,{children:r?(0,a.jsx)(s.p,{children:(0,a.jsx)(n.Tr,{children:(0,a.jsx)(c.Td,{colSpan:t,children:(0,a.jsx)(l.b,{children:(0,a.jsx)(i.$,{size:"xl"})})})})}):d?(0,a.jsx)(s.p,{"aria-label":"Table error",children:(0,a.jsx)(n.Tr,{children:(0,a.jsx)(c.Td,{colSpan:t,children:(0,a.jsx)(l.b,{children:h||(0,a.jsx)(u.y,{})})})})}):o?(0,a.jsx)(s.p,{"aria-label":"Table error",children:(0,a.jsx)(n.Tr,{children:(0,a.jsx)(c.Td,{colSpan:t,children:(0,a.jsx)(l.b,{children:p||(0,a.jsx)(x,{})})})})}):m})};var v=r(89330);let j=e=>{let{numColumnsBeforeData:t,numColumnsAfterData:r,children:l}=e;return(0,a.jsxs)(a.Fragment,{children:[Array(t).fill(null).map((e,t)=>(0,a.jsx)(v.Th,{screenReaderText:`before-data-${t}`},t)),l,Array(r).fill(null).map((e,t)=>(0,a.jsx)(v.Th,{screenReaderText:`after-data-${t}`},t))]})},y=e=>{let{isExpansionEnabled:t=!1,expandableVariant:r,getSelectCheckboxTdProps:l,propHelpers:{getSingleExpandButtonTdProps:i},item:s,rowIndex:n,children:u}=e;return(0,a.jsxs)(a.Fragment,{children:[t&&"single"===r?(0,a.jsx)(c.Td,{...i({item:s,rowIndex:n})}):null,l?(0,a.jsx)(c.Td,{...l({item:s,rowIndex:n})}):null,u]})}},49304:function(e,t,r){r.d(t,{u:()=>d});var a=r(24246),l=r(34747),i=r(46770),s=r(25138),n=r(87445),c=r(32947),u=r(57524);let d=e=>{let{severities:t}=e,r=Object.values(t).reduce((e,t)=>e+t,0);return(0,a.jsxs)(l.k,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,a.jsx)(i.B,{style:{minWidth:15,textAlign:n.F2},children:r}),(0,a.jsx)(s.i,{orientation:{default:"vertical"}}),(0,a.jsx)(i.B,{children:(0,a.jsx)(l.k,{children:Object.entries(t).filter(e=>{let[t,r]=e;return r>0}).sort((0,c.A0)(e=>{let[t,r]=e;return t})).reverse().map(e=>{let[t,r]=e;return(0,a.jsx)(i.B,{spacer:{default:"spacerXs"},children:(0,a.jsxs)(l.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,a.jsx)(i.B,{children:(0,a.jsx)(u.o,{value:t,score:null})}),(0,a.jsx)(i.B,{children:r})]})},t)})})})]})}},31373:function(e,t,r){r.d(t,{useVulnerabilitiesOfPackage:()=>d});var a=r(27378),l=r(7615),i=r(59015);let s=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,n={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:{...n},fixed:{...n},not_affected:{...n},known_not_affected:{...n}}},u=e=>{let t=e.flatMap(e=>(e.status??[]).map(t=>{let r=(0,l.g)(t.average_severity);return{vulnerability:{...t.vulnerability,average_severity:r,average_score:t.average_score},vulnerabilityStatus:t.status,advisory:e}})).reduce((e,t)=>{let r,a=e.find(e=>s(e,t));if(a)r=[...e.filter(e=>!s(e,a)),{...a,relatedSboms:[...a.relatedSboms,{advisory:t.advisory}]}];else{let a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};r=[...e.slice(),a]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,a=t.vulnerability.average_severity,l=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:l.total+1,severities:{...l.severities,[a]:l.severities[a]+1}}}})},{...c});return{vulnerabilities:t,summary:r}},d=e=>{let{pkg:t,isFetching:r,fetchError:l}=(0,i.useFetchPackageById)(e);return{data:a.useMemo(()=>u(t?.advisories||[]),[t]),isFetching:r,fetchError:l}}},33384:function(e,t,r){r.d(t,{a:()=>d,u:()=>o});var a=r(24246),l=r(27378),i=r(74502),s=r(72603),n=r(49988),c=r(59015),u=r(63706);let d=l.createContext({}),o=e=>{let{children:t}=e,r=(0,n.vZ)({tableName:"packages",persistenceKeyPrefix:i.yq.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:i.L4,title:"Filter text",placeholderText:"Search",type:s.vA.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:s.vA.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:s.vA.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:o,total:h},isFetching:p,fetchError:x}=(0,c.useFetchPackages)((0,n.QO)({...r,hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}})),m=l.useMemo(()=>o.map(e=>({...e,decomposedPurl:(0,u.qX)(e.purl)})),[o]),v=(0,n.KC)({...r,idProperty:"uuid",currentPageItems:m,totalItemCount:h,isLoading:p});return(0,a.jsx)(d.Provider,{value:{totalItemCount:h,isFetching:p,fetchError:x,tableControls:v},children:t})}},88466:function(e,t,r){r.d(t,{L:()=>T});var a=r(24246),l=r(27378),i=r(65783),s=r(4835),n=r(14350),c=r(11165),u=r(89330),d=r(31423),o=r(94154),h=r(69876),p=r(3804),x=r(31336),m=r(11797),v=r(37818),j=r(42573),y=r(49304),f=r(31373);let b=e=>{let{packageId:t}=e,{data:r,isFetching:l,fetchError:i}=(0,f.useVulnerabilitiesOfPackage)(t);return(0,a.jsx)(v.u,{isFetching:l,fetchError:i,isFetchingState:(0,a.jsx)(m.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,a.jsx)(j.C,{error:e}),children:(0,a.jsx)(y.u,{severities:r.summary.vulnerabilityStatus.affected.severities})})};var g=r(33384);let T=()=>{let{isFetching:e,fetchError:t,totalItemCount:r,tableControls:m}=l.useContext(g.a),{numRenderedColumns:v,currentPageItems:j,propHelpers:{paginationProps:y,tableProps:f,getThProps:T,getTrProps:P,getTdProps:k}}=m;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.i,{...f,"aria-label":"Package table",children:[(0,a.jsx)(n.h,{children:(0,a.jsx)(c.Tr,{children:(0,a.jsxs)(x.qK,{...m,children:[(0,a.jsx)(u.Th,{...T({columnKey:"name"})}),(0,a.jsx)(u.Th,{...T({columnKey:"namespace"})}),(0,a.jsx)(u.Th,{...T({columnKey:"version"})}),(0,a.jsx)(u.Th,{...T({columnKey:"type"})}),(0,a.jsx)(u.Th,{...T({columnKey:"path"})}),(0,a.jsx)(u.Th,{...T({columnKey:"qualifiers"})}),(0,a.jsx)(u.Th,{...T({columnKey:"vulnerabilities"})})]})})}),(0,a.jsx)(x.hp,{isLoading:e,isError:!!t,isNoData:0===r,numRenderedColumns:v,children:j.map((e,t)=>(0,a.jsx)(d.p,{children:(0,a.jsx)(c.Tr,{...P({item:e}),children:(0,a.jsxs)(x.Cx,{...m,item:e,rowIndex:t,children:[(0,a.jsx)(o.Td,{width:15,modifier:"breakWord",...k({columnKey:"name"}),children:(0,a.jsx)(i.OL,{to:`/packages/${e.uuid}`,children:e.decomposedPurl?e.decomposedPurl?.name:e.purl})}),(0,a.jsx)(o.Td,{width:15,modifier:"truncate",...k({columnKey:"namespace"}),children:e.decomposedPurl?.namespace}),(0,a.jsx)(o.Td,{width:10,modifier:"truncate",...k({columnKey:"version"}),children:e.decomposedPurl?.version}),(0,a.jsx)(o.Td,{width:10,modifier:"truncate",...k({columnKey:"type"}),children:e.decomposedPurl?.type}),(0,a.jsx)(o.Td,{width:10,modifier:"truncate",...k({columnKey:"path"}),children:e.decomposedPurl?.path}),(0,a.jsx)(o.Td,{width:20,...k({columnKey:"qualifiers"}),children:e.decomposedPurl?.qualifiers&&(0,a.jsx)(h.D,{value:e.decomposedPurl?.qualifiers})}),(0,a.jsx)(o.Td,{width:20,...k({columnKey:"vulnerabilities"}),children:(0,a.jsx)(b,{packageId:e.uuid})})]})})},e.uuid))})]}),(0,a.jsx)(p.p,{idPrefix:"package-table",isTop:!1,paginationProps:y})]})}},39305:function(e,t,r){r.d(t,{v:()=>o});var a=r(24246),l=r(27378),i=r(70715),s=r(40982),n=r(89226),c=r(72603),u=r(3804),d=r(33384);let o=e=>{let{showFilters:t}=e,{tableControls:r}=l.useContext(d.a),{propHelpers:{toolbarProps:o,filterToolbarProps:h,paginationToolbarItemProps:p,paginationProps:x}}=r;return(0,a.jsx)(i.o,{...o,children:(0,a.jsxs)(s.c,{children:[t&&(0,a.jsx)(c.Ki,{...h}),(0,a.jsx)(n.E,{...p,children:(0,a.jsx)(u.p,{idPrefix:"package-table",isTop:!0,paginationProps:x})})]})})}},59015:function(e,t,r){r.d(t,{useFetchPackageById:()=>u,useFetchPackages:()=>c,useFetchPackagesBySbomId:()=>d});var a=r(1183),l=r(50576),i=r(40371),s=r(49988);let n="packages",c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:c,error:u,refetch:d}=(0,a.useQuery)({queryKey:[n,e],queryFn:()=>(0,i.tj)({client:l.L,query:{...(0,s.rm)(e)}}),enabled:!t});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e},isFetching:c,fetchError:u,refetch:d}},u=e=>{let{data:t,isLoading:r,error:s}=(0,a.useQuery)({queryKey:[n,e],queryFn:()=>(0,i.BK)({client:l.L,path:{key:e}})});return{pkg:t?.data,isFetching:r,fetchError:s}},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:c,error:u,refetch:d}=(0,a.useQuery)({queryKey:[n,"by-sbom",e,t],queryFn:()=>(0,i.Pg)({client:l.L,path:{id:e},query:{...(0,s.rm)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t},isFetching:c,fetchError:u,refetch:d}}}}]);