"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["525"],{49325:function(e,t,l){l.d(t,{tc:()=>n});var r=l(32909),i=l(42642),s=l(31550),a=l(73470);let n=e=>{let t=(e=>{var t;let{persistTo:l="state",persistenceKeyPrefix:i}=e,n=null!=(t=e.defaultActiveTab)?t:{tabKey:e.tabKeys[0]},[o,c]=(0,s.u)((0,r._)({isEnabled:!0,defaultValue:n,persistenceKeyPrefix:i},"urlParams"===l?{persistTo:l,keys:["activeTab"],serialize:e=>({activeTab:(null==e?void 0:e.tabKey)||null}),deserialize:e=>e.activeTab?{tabKey:e.activeTab}:null}:"localStorage"===l||"sessionStorage"===l?{persistTo:l,key:"tab"}:(0,a.xG)(l)?{persistTo:"provider",serialize:l.write,deserialize:()=>l.read()}:{persistTo:"state"}));return{activeTab:o,setActiveTab:c}})(e),l=(e=>{let{tabState:t}=e;return{isTabActive:e=>{var l;return e===(null==(l=t.activeTab)?void 0:l.tabKey)},setActiveTab:e=>{t.setActiveTab({tabKey:e})}}})({tabState:t});return(0,i._)((0,r._)({},e),{state:t,derivedState:l,propHelpers:{getTabsProps:()=>{var e;return{activeKey:null==(e=t.activeTab)?void 0:e.tabKey,onSelect:(e,t)=>{l.setActiveTab(t)}}},getTabProps:e=>({eventKey:e,tabContentId:"".concat(e,"-tab-section")}),getTabContentProps:e=>({id:"".concat(e,"-tab-section"),eventKey:e,hidden:!l.isTabActive(e)})}})}},61992:function(e,t,l){l.r(t),l.d(t,{default:()=>eK});var r,i=l(32909),s=l(42642),a=l(62540),n=l(63696),o=l(68430),c=l(61360),d=l(35048),u=l(56918),p=l(42957),h=l(32490),x=l(98259),y=l(74343),v=l(5530),g=l(69548),j=l(39757),b=l(90280),f=l(65841),m=l(81595),C=l(58780),_=l(34952),k=l(27800),S=l(46173),A=l(99134),T=l(33468),F=l(30111),w=l(31903);let O=e=>(0,a.jsx)(y.N_,{to:e.navLink,style:{textDecoration:"none"},children:(0,a.jsxs)(v.D,{itemId:e.id,description:e.description,children:[e.title," ",(0,a.jsx)(g.J,{color:e.typeColor,children:e.type})]})},e.id),E=e=>{let{onChangeSearch:t}=e,{tableControls:l}=n.useContext(S.L),[r,s]=n.useState(""),[o,c]=n.useState(!1);n.useEffect(()=>{var e;let t=null==(e=l.filterState.filterValues[x._G])?void 0:e[0];s(null!=t?t:"")},[l.filterState]);let[d,u]=(0,k.Q3)(r,500);n.useEffect(()=>{u(r)},[u,r]);let{isFetching:p,list:h}=function(e,t){let l={filters:[{field:x._G,operator:"~",value:e}],page:{pageNumber:1,itemsPerPage:5}},{isFetching:r,result:{data:s}}=(0,A.VH)((0,i._)({},l),[],t),{isFetching:a,result:{data:n}}=(0,T.Lx)((0,i._)({},l),t),{isFetching:o,result:{data:c}}=(0,F.i$)((0,i._)({},l),[],t),{isFetching:d,result:{data:u}}=(0,w.WJ)((0,i._)({},l),t),p=s.map(e=>{var t;return{id:"advisory-".concat(e.uuid),title:e.document_id,description:null==(t=e.title)?void 0:t.substring(0,75),navLink:"/advisories/".concat(e.uuid),type:"Advisory",typeColor:"blue"}}),h=n.map(e=>({id:"package-".concat(e.uuid),title:e.purl,navLink:"/packages/".concat(e.uuid),type:"Package",typeColor:"teal"})),y=c.map(e=>({id:"sbom-".concat(e.id),title:e.name,description:e.suppliers.join(", "),navLink:"/sboms/".concat(e.id),type:"SBOM",typeColor:"purple"})),v=u.map(e=>{var t;return{id:"vulnerability-".concat(e.identifier),title:e.identifier,description:null==(t=e.description)?void 0:t.substring(0,75),navLink:"/vulnerabilities/".concat(e.identifier),type:"Vulnerability",typeColor:"orange"}}),g=e.toLowerCase();return{isFetching:r||a||o||d,list:[...v,...y,...p,...h].sort((e,t)=>{var l,r;return(null==(l=e.title)?void 0:l.includes(g))?-1:(null==(r=t.title)?void 0:r.includes(g))?1:(e.description||"").toLowerCase().indexOf(g)-(t.description||"").toLowerCase().indexOf(g)})}}(d,!o),[y,g]=n.useState(!1),E=n.useRef(null),R=n.useRef(null);n.useEffect(()=>{let e=e=>{var t,l,r;if(y&&E.current&&E.current===e.target)if("Escape"===e.key)g(!1),E.current.focus();else if("ArrowDown"===e.key||"ArrowUp"===e.key){let t=null==(l=R.current)?void 0:l.querySelector("li > button:not(:disabled)");t&&(null==t||t.focus()),e.preventDefault()}else("Tab"===e.key||"Enter"===e.key||"Space"===e.key)&&(g(!1),("Enter"===e.key||"Space"===e.key)&&e.preventDefault());else y&&(null==(t=R.current)?void 0:t.contains(e.target))&&"Tab"===e.key&&(e.preventDefault(),g(!1),null==(r=E.current)||r.focus())},t=e=>{y&&R&&R.current&&!R.current.contains(e.target)&&g(!1)};return window.addEventListener("keydown",e),window.addEventListener("click",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("click",t)}},[y]);let K=(0,a.jsx)(j.W,{ref:R,style:{width:"450px",maxHeight:"450px",overflow:"scroll",overflowX:"hidden",overflowY:"auto"},children:(0,a.jsx)(b.r,{children:(0,a.jsx)(f.c,{children:p?(0,a.jsx)(v.D,{itemId:"loading",children:(0,a.jsx)(m.y,{size:"sm"})}):h.map(O)})})}),P=(0,a.jsx)(C.D,{placeholder:"Search for an SBOM, Package, Advisory, or Vulnerability",value:r,onChange:(e,t)=>{""!==t&&E&&E.current&&E.current.contains(document.activeElement)?g(!0):g(!1),s(t),c(!0)},onClear:()=>{s("")},onSearch:()=>{t(r)},onKeyDown:e=>{if(e.key&&"Enter"!==e.key)return},ref:E,id:"autocomplete-search",style:{width:500}});return(0,a.jsx)(_.N,{trigger:P,triggerRef:E,popper:K,popperRef:R,isVisible:y&&h.length>0||p,enableFlip:!1,appendTo:()=>document.querySelector("#autocomplete-search")})};var R=l(27889),K=l(13701),P=l(62517);function V(e,t){return{Component:e,props:t}}let D=(r=[V(S.c,{}),V(K.a,{}),V(P.y,{}),V(R.r,{})],e=>{let{children:t}=e,l=(0,a.jsx)(a.Fragment,{children:t});return r.reduceRight((e,t)=>{let{Component:l,props:r={}}=t;return(0,a.jsx)(l,(0,s._)((0,i._)({},r),{children:e}),e.key)},l)});var I=l(54518),L=l(48281),M=l(17327),B=l(71603),Y=l(40989),z=l(60423),G=l(40111),H=l(15157),N=l(2057),W=l(70414),$=l(66542),U=l(8210),q=l(88508),J=l(38914),Q=l(57901),X=l(24773),Z=l(72610);l(21999);var ee=l(66091);let et=e=>{let{category:t,filterValue:l,setFilterValue:r,isDisabled:i=!1}=e,s=n.useRef(new Map);n.useEffect(()=>{for(let e of t.selectOptions)s.current.set(e.value,e)},[t.selectOptions]);let[o,c]=n.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);n.useEffect(()=>{c(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]);let d=e=>{var t;return{id:e.value,name:null!=(t=e.label)?t:e.value}};return(0,a.jsx)(ee.I,{showChips:!0,isDisabled:i,options:o.map(d),selections:null==l?void 0:l.map(e=>{let t=s.current.get(e);return t?d(t):{id:e,name:e}}),onChange:e=>{r(e.map(e=>e.id))},noResultsMessage:"No search results",placeholderText:t.placeholderText,searchInputAriaLabel:"select-autocomplete-listbox",onSearchChange:t.onInputValueChange})};var el=l(23909),er=l(84631);let ei=e=>{let{category:t,filterValue:l,setFilterValue:r,isDisabled:i=!1}=e,[s,o]=n.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);return n.useEffect(()=>{o(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]),(0,a.jsx)(er.j,{showChips:!0,isDisabled:i,options:s.map(e=>{var t;return{id:e.value,name:null!=(t=e.label)?t:e.value}}),selections:null==l?void 0:l.map(e=>({id:e,name:e})),onChange:e=>{r(e.map(e=>(0,el.AA)(e.name)))},noResultsMessage:"No search results",placeholderText:t.placeholderText,searchInputAriaLabel:"select-autocomplete-listbox",onSearchChange:t.onInputValueChange})};var es=l(58365);let ea=e=>{let{category:t,filterValue:l,setFilterValue:r}=e,[i,s]=n.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);n.useEffect(()=>{s(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]);let o=Array.isArray(i)?i:Object.values(i).flat();return(0,a.jsx)(a.Fragment,{children:o.map((e,i)=>{let{label:s,value:n}=e;return(0,a.jsx)(es.S,{id:"checkbox-".concat(i,"-").concat(t.categoryKey),isLabelWrapped:!0,label:s,isChecked:null==l?void 0:l.includes(n),onChange:()=>{n&&"No results"!==n&&r((null==l?void 0:l.includes(n))?l.filter(e=>e!==n):l?[...l,n]:[n])}},s)})})};var en=l(78109),eo=l(75484),ec=l(40360),ed=l(38360),eu=l(83200);let ep=e=>{let{filterValue:t,setFilterValue:l,isDisabled:r=!1}=e,[i,s]=(0,n.useState)(),[o,c]=(0,n.useState)();return n.useEffect(()=>{if(null==t?void 0:t[0]){let[e,l]=(0,eu.P1)(null==t?void 0:t[0]);s(e.toDate()),c(l.toDate())}else s(void 0),c(void 0)},[t]),(0,a.jsxs)(eo.l,{children:[(0,a.jsx)(ec.g,{role:"group",isInline:!0,label:"From",children:(0,a.jsx)(ed.l,{value:i?(0,eu.ak)(i):"",dateFormat:eu.ak,dateParse:eu.sy,onChange:(e,t)=>{(0,eu.Fz)(t)&&(s((0,eu.sy)(t)),c(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"Invalid date",appendTo:document.body,isDisabled:r})}),(0,a.jsx)(ec.g,{role:"group",isInline:!0,label:"To",children:(0,a.jsx)(ed.l,{value:o?(0,eu.ak)(o):"",onChange:(e,t)=>{if((0,eu.Fz)(t)){let e=(0,eu.sy)(t);c(e);let r=(0,eu.Kg)(i,e);r&&l([r])}},isDisabled:r||!(0,en.v)(i),dateFormat:eu.ak,dateParse:eu.sy,invalidFormatText:"Invalid date",rangeStart:i,validators:[e=>i&&(0,en.v)(i)&&e>=i?"":'The "to" date must be after the "from" date'],"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})})]})};var eh=l(10562);let ex=e=>{let{category:t,filterValue:l,setFilterValue:r,isDisabled:i=!1}=e;return(0,a.jsx)(a.Fragment,{children:t.selectOptions.map((e,s)=>{let{label:n,value:o}=e,c=(null==l?void 0:l.includes(o))||!1;return(0,a.jsx)(eh.s,{isDisabled:i,id:"radio-".concat(s),name:"radio",isLabelWrapped:!0,label:n,isChecked:c,onChange:()=>{r(t.selectOptions.find(e=>{let{value:t}=e;return t===o})?[o]:null)}},n)})})};var ey=l(58897),ev=l(13135),eg=l(51463);let ej=e=>{let{category:t,filterValue:l,setFilterValue:r,isNumeric:i,isDisabled:s=!1}=e,[o,c]=n.useState((null==l?void 0:l[0])||"");n.useEffect(()=>{c((null==l?void 0:l[0])||"")},[l]);let d=()=>{let e=o.trim();r(e?[e.replace(/\s+/g," ")]:[])},u="".concat(t.categoryKey,"-input");return(0,a.jsxs)(ey.M,{children:[(0,a.jsx)(ev.ks,{name:u,type:i?"number":"search",onChange:(e,t)=>c(t),"aria-label":"".concat(t.title," filter"),value:o,placeholder:t.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||d()},isDisabled:s}),(0,a.jsx)(X.$n,{icon:(0,a.jsx)(eg.Ay,{}),variant:X.Ak.control,"aria-label":"search button for search input",onClick:d,isDisabled:s})]})},eb=e=>{let{category:t,filterValue:l,setFilterValue:r,isDisabled:i=!1}=e;return(0,a.jsx)(es.S,{id:"filter-control-".concat(t.categoryKey),label:t.label,isChecked:(0,el.iw)(null==l?void 0:l[0]),onChange:(e,t)=>{t?r([String(!0)]):r(null)},isDisabled:i})},ef=e=>{var{category:t}=e,l=(0,Z._)(e,["category"]);return"select"===t.type?(0,a.jsx)(ex,(0,i._)({category:t},l)):"search"===t.type||"numsearch"===t.type?(0,a.jsx)(ej,(0,i._)({category:t,isNumeric:"numsearch"===t.type},l)):"multiselect"===t.type?(0,a.jsx)(ea,(0,i._)({category:t},l)):"asyncMultiselect"===t.type?(0,a.jsx)(et,(0,i._)({category:t},l)):"dateRange"===t.type?(0,a.jsx)(ep,(0,i._)({category:t},l)):"autocompleteLabel"===t.type?(0,a.jsx)(ei,(0,i._)({category:t},l)):"toggle"===t.type?(0,a.jsx)(eb,(0,i._)({category:t},l)):null},em=e=>{let{filterCategories:t,filterValues:l,setFilterValues:r,isDisabled:n=!1,omitFilterCategoryKeys:o=[]}=e;return(0,a.jsxs)(J.B,{hasGutter:!0,children:[(0,a.jsx)(Q.a,{children:(0,a.jsx)(X.$n,{variant:"link",isInline:!0,onClick:()=>{let e=t.filter(e=>void 0===o.find(t=>t===e.categoryKey)).reduce((e,t)=>(e[t.categoryKey]=void 0,e),{});r((0,i._)({},l,e))},children:"Clear all filters"})}),t.filter(e=>void 0===o.find(t=>t===e.categoryKey)).map(e=>(0,a.jsx)(Q.a,{children:(0,a.jsxs)(J.B,{hasGutter:!0,children:[(0,a.jsx)(Q.a,{children:(0,a.jsx)(p.U,{component:"h4",children:e.title})}),(0,a.jsx)(Q.a,{children:(0,a.jsx)(ef,{category:e,filterValue:l[e.categoryKey],setFilterValue:t=>r((0,s._)((0,i._)({},l),{[e.categoryKey]:t})),isDisabled:n,isSidebar:!0})})]})},e.categoryKey))]})};var eC=l(49325),e_=l(41484),ek=l(5193),eS=l(66005),eA=l(22549),eT=l(74466),eF=l(75725),ew=l(11934),eO=l(13829);let eE=e=>{let{filterPanelProps:t,sbomTable:l,sbomTotalCount:r,packageTable:o,packageTotalCount:c,vulnerabilityTable:d,vulnerabilityTotalCount:u,advisoryTable:p,advisoryTotalCount:h,isFetchingPackages:x,isFetchingSboms:y,isFetchingVulnerabilities:v,isFetchingAdvisories:g}=e,{sbomFilterPanelProps:j,packageFilterPanelProps:b,vulnerabilityFilterPanelProps:f,advisoryFilterPanelProps:m}=t,{propHelpers:{getTabsProps:C,getTabProps:_},derivedState:{isTabActive:k}}=(0,eC.tc)({persistenceKeyPrefix:"sp",persistTo:"urlParams",tabKeys:["sboms","packages","vulnerabilities","advisories"]}),S=n.createRef(),A=n.createRef(),T=n.createRef(),F=n.createRef();return(0,a.jsxs)(I.B,{hasGutter:!0,children:[(0,a.jsx)(L.o,{children:(0,a.jsx)(M.Z,{isFullHeight:!0,children:(0,a.jsx)(B.b,{style:{width:241},children:k("sboms")?(0,a.jsx)(em,(0,i._)({omitFilterCategoryKeys:[""]},j)):k("packages")?(0,a.jsx)(em,(0,i._)({omitFilterCategoryKeys:[""]},b)):k("vulnerabilities")?(0,a.jsx)(em,(0,i._)({omitFilterCategoryKeys:[""]},f)):k("advisories")?(0,a.jsx)(em,(0,i._)({omitFilterCategoryKeys:[""]},m)):null})})}),(0,a.jsx)(L.o,{isFilled:!0,children:(0,a.jsxs)(Y.t,(0,s._)((0,i._)({mountOnEnter:!0,isBox:!0},C()),{"aria-label":"Tabs",role:"region",children:[(0,a.jsxs)(z.o,(0,s._)((0,i._)({},_("sboms")),{title:(0,a.jsxs)(G.V,{children:["SBOMs","  ",(0,a.jsx)(H.E,{screenReaderText:"Search Result Count",children:y?(0,a.jsx)(N.I,{size:"sm",children:(0,a.jsx)(q.Ay,{})}):r})]}),actions:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.o,{"aria-label":"SBOM help popover",ref:S,children:(0,a.jsx)(U.Ay,{})}),(0,a.jsx)($.A,{bodyContent:(0,a.jsx)("div",{children:"A list of ingested Software Bill of Materials (SBOM) documents."}),position:"right",triggerRef:S})]}),children:[(0,a.jsx)(eF.r,{}),null!=l?l:(0,a.jsx)(eT.Y,{})]})),(0,a.jsxs)(z.o,(0,s._)((0,i._)({},_("packages")),{title:(0,a.jsxs)(G.V,{children:["Packages","  ",(0,a.jsx)(H.E,{screenReaderText:"Search Result Count",children:x?(0,a.jsx)(N.I,{size:"sm",children:(0,a.jsx)(q.Ay,{})}):c})]}),actions:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.o,{"aria-label":"Package help popover",ref:A,children:(0,a.jsx)(U.Ay,{})}),(0,a.jsx)($.A,{bodyContent:(0,a.jsx)("div",{children:"A list of packages along with the count of vulnerabilities."}),position:"right",triggerRef:A})]}),children:[(0,a.jsx)(eA.I,{}),null!=o?o:(0,a.jsx)(eS.N,{})]})),(0,a.jsxs)(z.o,(0,s._)((0,i._)({},_("vulnerabilities")),{title:(0,a.jsxs)(G.V,{children:["Vulnerabilities","  ",(0,a.jsx)(H.E,{screenReaderText:"Search Result Count",children:v?(0,a.jsx)(N.I,{size:"sm",children:(0,a.jsx)(q.Ay,{})}):u})]}),actions:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.o,{"aria-label":"Vulnerability help popover",ref:T,children:(0,a.jsx)(U.Ay,{})}),(0,a.jsx)($.A,{bodyContent:(0,a.jsx)("div",{children:"A list of publicly known Common Vulnerabilities and Exposures (CVE)."}),position:"right",triggerRef:T})]}),children:[(0,a.jsx)(eO.y,{}),null!=d?d:(0,a.jsx)(ew.f,{})]})),(0,a.jsxs)(z.o,(0,s._)((0,i._)({},_("advisories")),{title:(0,a.jsxs)(G.V,{children:["Advisories","  ",(0,a.jsx)(H.E,{screenReaderText:"Advisory Result Count",children:g?(0,a.jsx)(N.I,{size:"sm",children:(0,a.jsx)(q.Ay,{})}):h})]}),actions:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.o,{"aria-label":"Advisory help popover",ref:F,children:(0,a.jsx)(U.Ay,{})}),(0,a.jsx)($.A,{bodyContent:(0,a.jsx)("div",{children:"A list of available advisories."}),position:"right",triggerRef:F})]}),children:[(0,a.jsx)(ek.F,{}),null!=p?p:(0,a.jsx)(e_.q,{})]}))]}))})]})};var eR=l(52673);let eK=e=>{let{searchBodyOverride:t}=e;return(0,a.jsx)(D,{children:(0,a.jsx)(eP,{searchBodyOverride:t})})},eP=e=>{let{searchBodyOverride:t}=e,{tableControls:l}=n.useContext(S.L),{tableControls:r}=n.useContext(K.Y),{tableControls:y}=n.useContext(P.u),{tableControls:v}=n.useContext(R.R),{isFetching:g,totalItemCount:j,tableControls:{propHelpers:{filterPanelProps:b}}}=n.useContext(S.L),{isFetching:f,totalItemCount:m,tableControls:{propHelpers:{filterPanelProps:C}}}=n.useContext(K.Y),{isFetching:_,totalItemCount:k,tableControls:{propHelpers:{filterPanelProps:A}}}=n.useContext(P.u),{isFetching:T,totalItemCount:F,tableControls:{propHelpers:{filterPanelProps:w}}}=n.useContext(R.R),O=(0,a.jsx)(eE,{filterPanelProps:{advisoryFilterPanelProps:w,packageFilterPanelProps:C,sbomFilterPanelProps:b,vulnerabilityFilterPanelProps:A},packageTotalCount:m,sbomTotalCount:j,vulnerabilityTotalCount:k,advisoryTotalCount:F,isFetchingPackages:f,isFetchingSboms:g,isFetchingVulnerabilities:_,isFetchingAdvisories:T});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eR.T,{title:"Search"}),(0,a.jsx)(o.d8,{hasBodyWrapper:!1,children:(0,a.jsx)(c.M,{isStatic:!0,children:(0,a.jsxs)(d.P,{children:[(0,a.jsx)(u.$,{align:{default:"alignStart"},children:(0,a.jsx)(p.U,{children:(0,a.jsx)(p.U,{component:"h1",children:"Search Results"})})}),(0,a.jsx)(u.$,{variant:"action-group-plain",align:{default:"alignEnd"},children:(0,a.jsx)(u.$,{visibility:{default:"visible"},children:(0,a.jsx)(h.T,{children:(0,a.jsx)(E,{onChangeSearch:e=>{void 0!==e&&(l.filterState.setFilterValues((0,s._)((0,i._)({},l.filterState.filterValues),{[x._G]:[e]})),r.filterState.setFilterValues((0,s._)((0,i._)({},r.filterState.filterValues),{[x._G]:[e]})),y.filterState.setFilterValues((0,s._)((0,i._)({},y.filterState.filterValues),{[x._G]:[e]})),v.filterState.setFilterValues((0,s._)((0,i._)({},v.filterState.filterValues),{[x._G]:[e]})))}})})})})]})})}),(0,a.jsx)(o.d8,{hasBodyWrapper:!1,children:t||O})]})}}}]);