"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["577"],{24296:function(e,t,l){l.d(t,{a:()=>r});var n=l(62540),i=l(59394),a=l(81595),s=l(40554);let r=e=>e.isFetching?e.isFetchingState||(0,n.jsx)(i.a,{children:(0,n.jsx)(a.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,n.jsx)(s.q,{}):e.children},92107:function(e,t,l){l.d(t,{D:()=>a});var n=l(62540),i=l(69548);let a=e=>{let{error:t}=e;return(0,n.jsxs)(i.J,{color:"red",children:[t.status," Error"]})}},15461:function(e,t,l){l.d(t,{n:()=>d});var n=l(62540),i=l(28338),a=l(70045),s=l(7261),r=l(86099),o=l(71284),c=l(45969);let d=e=>{let{severities:t}=e,l=Object.values(t).reduce((e,t)=>e+t,0);return(0,n.jsxs)(i.s,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,n.jsx)(a.Z,{"aria-label":"total",style:{minWidth:15,textAlign:r.pG},children:l}),(0,n.jsx)(s.c,{orientation:{default:"vertical"}}),(0,n.jsx)(a.Z,{children:(0,n.jsx)(i.s,{children:Object.entries(t).filter(e=>{let[t,l]=e;return l>0}).sort((0,o.Sx)(e=>{let[t,l]=e;return t})).reverse().map(e=>{let[t,l]=e;return(0,n.jsx)(a.Z,{spacer:{default:"spacerXs"},children:(0,n.jsxs)(i.s,{"aria-label":t,spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,n.jsx)(a.Z,{children:(0,n.jsx)(c.h,{value:t,score:null})}),(0,n.jsx)(a.Z,{children:l})]})},t)})})})]})}},3652:function(e,t,l){l.d(t,{RQ:()=>d,UI:()=>p,nm:()=>h});var n=l(32909),i=l(42642),a=l(63696),s=l(27875),r=l(30111);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},d={vulnerabilityStatus:{affected:(0,n._)({},c),fixed:(0,n._)({},c),not_affected:(0,n._)({},c),known_not_affected:(0,n._)({},c),under_investigation:(0,n._)({},c)}},u=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let l,a=e.find(e=>o(e,t));if(a){let s=e.filter(e=>!o(e,a)),r=a.vulnerability.average_score>t.vulnerability.average_score?a:t;l=[...s,(0,i._)((0,n._)({},r),{relatedPackages:[...a.relatedPackages,{advisory:t.advisory,packages:t.packages}]})]}else{let n={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};l=[...e.slice(),n]}return l},[]),l=t.reduce((e,t)=>{let l=t.vulnerabilityStatus,a=(0,s.U)(t.vulnerability.average_severity),r=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,i._)((0,n._)({},e.vulnerabilityStatus),{[l]:{total:r.total+1,severities:(0,i._)((0,n._)({},r.severities),{[a]:r.severities[a]+1})}})})},(0,n._)({},d));return{vulnerabilities:t,summary:l}},p=e=>{let{advisories:t,isFetching:l,fetchError:n}=(0,r.DH)(e);return{data:a.useMemo(()=>u(t||[]),[t]),isFetching:l,fetchError:n}},h=e=>{let{advisories:t,isFetching:l,fetchError:n}=(0,r.zY)(e);return{data:a.useMemo(()=>(null!=t?t:[]).map(e=>u(e||[])),[t]),isFetching:l,fetchError:n}}},98345:function(e,t,l){l.d(t,{f:()=>o});var n=l(62540),i=l(63696),a=l(91242),s=l(4392),r=l(30111);let o=e=>{let{sbom:t,onClose:l}=e,{pushNotification:o}=i.useContext(s.K),[c,d]=i.useState(""),[u,p]=i.useState("");i.useEffect(()=>{let e=setTimeout(()=>{p(c)},400);return()=>clearTimeout(e)},[c]);let{labels:h}=(0,r._P)(u),{mutate:m,isPending:b}=(0,r.cF)(()=>{o({title:"Labels updated for SBOM ".concat(t.name),variant:"success"}),l()},e=>{o({title:"Error while updating labels for SBOM ".concat(t.name),variant:"danger"})});return(0,n.jsx)(a.e,{title:"Labels of SBOM: ".concat(t.name),value:t.labels,isDisabled:b,onSave:e=>{m({id:t.id,labels:e})},onClose:l,onInputChange:d,options:h})}},57184:function(e,t,l){l.d(t,{L:()=>m,c:()=>b});var n=l(32909),i=l(42642),a=l(62540),s=l(63696),r=l(27800),o=l(98259),c=l(71284);function d(e,t,l){return 0===l.length?[]:t.filter(t=>l.some(l=>e(t,l)))}l(21999);var u=l(73470),p=l(97773),h=l(30111);let m=s.createContext({}),b=e=>{var t;let{isBulkSelectionEnabled:l,children:b}=e,[x,g]=s.useState(""),[v]=(0,r.Q3)(x,400),{labels:f}=(0,h._P)(v),[j,y]=s.useState(""),[_]=(0,r.Q3)(j,400),{result:{data:S}}=(0,p.K)({filters:[{field:o._G,operator:"~",value:_}],sort:{field:"license",direction:"asc"},page:{pageNumber:1,itemsPerPage:10}}),C=(0,u.MM)({tableName:"sbom",persistenceKeyPrefix:o.rt.sboms,persistTo:"urlParams",columnNames:{name:"Name",version:"Version",supplier:"Supplier",labels:"Labels",published:"Created on",packages:"Dependencies",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","published"],isFilterEnabled:!0,filterCategories:[{categoryKey:o._G,title:"Filter text",placeholderText:"Search",type:"search"},{categoryKey:"published",title:"Created on",type:"dateRange"},{categoryKey:"labels",title:"Label",type:"autocompleteLabel",placeholderText:"Filter results by label",selectOptions:f.map(e=>{let t=(0,c.m4)({key:e.key,value:e.value});return{value:t,label:t}}),onInputValueChange:g},{categoryKey:"license",title:"License",type:"asyncMultiselect",placeholderText:"Filter results by license",selectOptions:S.map(e=>({value:e.license,label:e.license})),onInputValueChange:y}],isExpansionEnabled:!1,isSelectionEnabled:l}),{result:{data:k,total:T},isFetching:E,fetchError:I}=(0,h.i$)((0,u.Ng)((0,i._)((0,n._)({},C),{hubSortFieldKeys:{name:"name",published:"published"}})),(null!=(t=C.filterState.filterValues.labels)?t:[]).map(e=>(0,c.Cb)(e))),P=(0,u.PB)((0,i._)((0,n._)({},C),{idProperty:"id",currentPageItems:k,totalItemCount:T,isLoading:E})),K=(e=>{var t;let{isEqual:l=(e,t)=>e===t,items:n,filteredItems:i,currentPageItems:a,initialSelected:r}=e,o=null!=(t=null!=n?n:i)?t:a,{selectedItems:c,areAllSelected:u,isItemSelected:p,selectItems:h,selectOnly:m,selectAll:b}=(e=>{let{items:t,initialSelected:l=[],isEqual:n=(e,t)=>e===t}=e,[i,a]=s.useState(d(n,t,l)),r=s.useCallback(e=>i.some(t=>n(e,t)),[n,i]),o=s.useCallback((e,l)=>{let s=d(n,t,e),r=i.filter(e=>!s.some(t=>n(e,t)));l?a([...r,...s]):a(r)},[n,t,i]),c=s.useCallback(e=>{a(d(n,t,e))},[n,t]),u=s.useCallback(function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return a(e?t:[])},[t]),p=s.useMemo(()=>i.length===t.length&&i.every(e=>t.some(t=>n(e,t))),[i,t,n]);return{selectedItems:s.useMemo(()=>0===i.length?[]:p?t:t.filter(r),[p,r,t,i]),isItemSelected:r,areAllSelected:p,selectItems:o,selectOnly:c,selectAll:u}})({items:o,isEqual:l,initialSelected:r}),x={areAllSelected:u,itemCounts:{selected:c.length,page:a.length,filtered:i?i.length:void 0,totalItems:o.length},onSelectNone:()=>b(!1),onSelectCurrentPage:()=>m(a),onSelectAllFiltered:i?()=>m(i):void 0,onSelectAll:n?()=>b(!0):void 0};return{selectedItems:c,propHelpers:{toolbarBulkSelectorProps:x,getSelectCheckboxTdProps:e=>{let{item:t,rowIndex:l}=e;return{select:{rowIndex:l,onSelect:(e,l)=>{h([t],l)},isSelected:p(t)}}}}}})({isEqual:(e,t)=>e.id===t.id,filteredItems:P.filteredItems,currentPageItems:P.currentPageItems});return(0,a.jsx)(m.Provider,{value:{totalItemCount:T,isFetching:E,fetchError:I,tableControls:P,bulkSelection:{isEnabled:!!l,controls:K}},children:b})}},74466:function(e,t,l){l.d(t,{Y:()=>N});var n=l(32909),i=l(42642),a=l(62540),s=l(63696),r=l(74343),o=l(38927),c=l(80057),d=l(13021),u=l(24773),p=l(26917),h=l(16646),m=l(21758),b=l(40384),x=l(28516),g=l(78517),v=l(62101),f=l(71284),j=l(89705),y=l(12852),_=l(4392),S=l(93826),C=l(30448),k=l(98259),T=l(99528),E=l(30111),I=l(67458),P=l(23909),K=l(98345),w=l(6160),F=l(24296),O=l(92107),L=l(15461),M=l(3652);let D=e=>{let{sbomId:t}=e,{data:l,isFetching:n,fetchError:i}=(0,M.UI)(t);return(0,a.jsx)(F.a,{isFetching:n,fetchError:i,isFetchingState:(0,a.jsx)(w.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,a.jsx)(O.D,{error:e}),children:(0,a.jsx)(L.n,{severities:l.summary.vulnerabilityStatus.affected.severities})})};var B=l(57184);let N=()=>{let{pushNotification:e}=s.useContext(_.K),{isFetching:t,fetchError:l,totalItemCount:w,tableControls:F,bulkSelection:{isEnabled:O,controls:L}}=s.useContext(B.L),[M,N]=s.useState(null),Z=null!==M,{numRenderedColumns:A,currentPageItems:U,propHelpers:{paginationProps:V,tableProps:q,getThProps:H,getTrProps:G,getTdProps:J},expansionDerivedState:{isCellExpanded:Q},filterState:{filterValues:W,setFilterValues:R}}=F,{selectedItems:X,propHelpers:{getSelectCheckboxTdProps:Y}}=L,{downloadSBOM:$,downloadSBOMLicenses:z}=(0,T.m)(),ee=()=>{N(null)},[et,el]=s.useState(null),{mutate:en,isPending:ei}=(0,E.l6)(t=>{el(null),e({title:(0,k.B7)(t),variant:"success"})},t=>{e({title:(0,k.Ut)(t),variant:"danger"})});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(p.X,(0,i._)((0,n._)({},q),{"aria-label":"sbom-table",children:[(0,a.jsx)(h.d,{children:(0,a.jsx)(m.Tr,{children:(0,a.jsxs)(C.Ze,(0,i._)((0,n._)({},F),{children:[(0,a.jsx)(b.Th,(0,n._)({},H({columnKey:"name"}))),(0,a.jsx)(b.Th,(0,n._)({},H({columnKey:"version"}))),(0,a.jsx)(b.Th,(0,n._)({},H({columnKey:"supplier"}))),(0,a.jsx)(b.Th,(0,n._)({},H({columnKey:"labels"}))),(0,a.jsx)(b.Th,(0,n._)({},H({columnKey:"published"}))),(0,a.jsx)(b.Th,(0,n._)({},H({columnKey:"packages"}))),(0,a.jsx)(b.Th,(0,n._)({},H({columnKey:"vulnerabilities"})))]}))})}),(0,a.jsx)(C.nJ,{isLoading:t,isError:!!l,isNoData:0===w,numRenderedColumns:A,children:U.map((e,t)=>(0,a.jsx)(x.N,{isExpanded:Q(e),children:(0,a.jsx)(m.Tr,(0,i._)((0,n._)({},G({item:e})),{children:(0,a.jsxs)(C.Oi,(0,i._)((0,n._)({},F),{getSelectCheckboxTdProps:O?Y:void 0,item:e,rowIndex:t,children:[(0,a.jsx)(g.Td,(0,i._)((0,n._)({width:20,modifier:"breakWord"},J({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t})),{children:(0,a.jsx)(r.k2,{to:(0,r.tW)(I.Jh.sbomDetails,{sbomId:e.id}),children:e.name})})),(0,a.jsx)(g.Td,(0,i._)((0,n._)({width:10,modifier:"truncate"},J({columnKey:"version"})),{children:e.described_by.map(e=>e.version).filter(e=>e).join(", ")})),(0,a.jsx)(g.Td,(0,i._)((0,n._)({width:10,modifier:"truncate"},J({columnKey:"supplier"})),{children:e.suppliers.join(", ")})),(0,a.jsx)(g.Td,(0,i._)((0,n._)({width:20,modifier:"truncate"},J({columnKey:"labels"})),{children:(0,a.jsx)(y.g,{value:e.labels,onClick:e=>{let{key:t,value:l}=e,a=(0,f.m4)({key:t,value:l}),s=W.labels;if(!(null==s?void 0:s.includes(a))){let e=s?[...s,a]:[a];R((0,i._)((0,n._)({},W),{labels:e}))}}})})),(0,a.jsx)(g.Td,(0,i._)((0,n._)({width:10,modifier:"truncate"},J({columnKey:"published"})),{children:(0,P.Yq)(e.published)})),(0,a.jsx)(g.Td,(0,i._)((0,n._)({width:10},J({columnKey:"packages"})),{children:e.number_of_packages})),(0,a.jsx)(g.Td,(0,i._)((0,n._)({width:20},J({columnKey:"vulnerabilities"})),{children:(0,a.jsx)(D,{sbomId:e.id})})),(0,a.jsx)(g.Td,{isActionCell:!0,children:(0,a.jsx)(v.G,{items:[{title:"Edit labels",onClick:()=>{N(e)}},{isSeparator:!0},{title:"Download SBOM",onClick:()=>{$(e.id,"".concat(e.name,".json"))}},{title:"Download License Report",onClick:()=>{z(e.id)}},{isSeparator:!0},{title:"Delete",onClick:()=>{el(e)}}]})})]}))}))},e.id))})]})),(0,a.jsx)(S.n,{idPrefix:"sbom-table",isTop:!1,paginationProps:V}),(0,a.jsxs)(o.a,{isOpen:Z,variant:"medium",onClose:ee,children:[(0,a.jsx)(c.r,{title:"Edit labels"}),(0,a.jsx)(d.c,{children:M&&(0,a.jsx)(K.f,{sbom:M,onClose:ee})})]}),(0,a.jsx)(j.T,(0,i._)((0,n._)({},(0,k.zK)(et)),{inProgress:ei,titleIconVariant:"warning",isOpen:!!et,confirmBtnVariant:u.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>el(null),onClose:()=>el(null),onConfirm:()=>{et&&en(et.id)}}))]})}},11717:function(e,t,l){l.d(t,{r:()=>C});var n=l(32909),i=l(42642),a=l(62540),s=l(63696),r=l(74343),o=l(61360),c=l(35048),d=l(32490),u=l(24773),p=l(84818),h=l(21999),m=l(90717),b=l(96526),x=l(52993),g=l(98399);let v=e=>{let{dropdownItems:t,ariaLabel:l}=e,[n,i]=(0,s.useState)(!1);return(0,a.jsx)(m.m,{popperProps:{position:"right"},isOpen:n,onOpenChange:e=>i(e),shouldFocusToggleOnSelect:!0,toggle:e=>(0,a.jsx)(b.S3,{ref:e,isExpanded:n,onClick:()=>i(!n),variant:"plain","aria-label":l||"Table toolbar actions kebab toggle",isDisabled:!t||0===t.length,children:(0,a.jsx)(g.Ay,{"aria-hidden":"true"})}),children:(0,a.jsx)(x.Q,{children:t})})};var f=l(93826),j=l(17200);let y=e=>{let{areAllSelected:t,itemCounts:{totalItems:l,filtered:n,page:i,selected:r},onSelectNone:o,onSelectCurrentPage:c,onSelectAllFiltered:u,onSelectAll:h}=e,[g,v]=(0,s.useState)(!1),f=e=>()=>{e(),v(!1)},y=(0,s.useMemo)(()=>!!t&&l>0||0!==r&&null,[t,l,r]),_=[(0,a.jsx)(p.t,{onClick:f(o),"data-action":"none",component:"button",children:"Select none (0 items)"},"select-none"),(0,a.jsxs)(p.t,{onClick:f(c),"data-action":"page",component:"button",children:["Select page (",i," items)"]},"select-page"),void 0!==u&&(0,a.jsxs)(p.t,{onClick:f(u),"data-action":"all",component:"button",children:["Select all filtered (",n," items)"]},"select-all-filtered"),void 0!==h&&(0,a.jsxs)(p.t,{onClick:f(h),"data-action":"all",component:"button",children:["Select all (",l,")"]},"select-all")].filter(Boolean);return(0,a.jsx)(d.T,{children:(0,a.jsx)(m.m,{isOpen:g,onOpenChange:e=>v(e),toggle:e=>(0,a.jsx)(b.S3,{isDisabled:0===l,ref:e,onClick:()=>v(!g),splitButtonItems:[(0,a.jsx)(j.l,{id:"bulk-selected-items-checkbox","aria-label":"Select page",onChange:e=>{e?c():o()},isChecked:y,children:0===r?"":"Selected ".concat(r)},"bulk-select-checkbox")]}),children:(0,a.jsx)(x.Q,{children:_})})})};var _=l(67458),S=l(57184);let C=e=>{let{showFilters:t,showActions:l}=e,m=(0,r.Zp)(),{tableControls:b,bulkSelection:{isEnabled:x,controls:g}}=s.useContext(S.L),{propHelpers:{toolbarProps:j,filterToolbarProps:C,paginationToolbarItemProps:k,paginationProps:T}}=b,{propHelpers:{toolbarBulkSelectorProps:E}}=g;return(0,a.jsx)(o.M,(0,i._)((0,n._)({},j),{"aria-label":"sbom-toolbar",children:(0,a.jsxs)(c.P,{children:[x&&(0,a.jsx)(y,(0,n._)({},E)),t&&(0,a.jsx)(h.Us,(0,n._)({},C)),l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.T,{children:(0,a.jsx)(u.$n,{variant:"primary",children:"Create group"})}),(0,a.jsx)(d.T,{children:(0,a.jsx)(u.$n,{variant:"secondary",isDisabled:!0,children:"Add to group"})}),(0,a.jsx)(d.T,{children:(0,a.jsx)(v,{ariaLabel:"SBOM actions",dropdownItems:[(0,a.jsx)(p.t,{component:"button",onClick:()=>m(_.Jh.sbomUpload),children:"Upload SBOM"},"upload-sbom"),(0,a.jsx)(p.t,{component:"button",onClick:()=>m(_.Jh.sbomScan),children:"Generate vulnerability report"},"scan-sbom")]})})]}),(0,a.jsx)(d.T,(0,i._)((0,n._)({},k),{children:(0,a.jsx)(f.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:T})}))]})}))}},97773:function(e,t,l){l.d(t,{K:()=>o});var n=l(32909),i=l(77184),a=l(96002),s=l(86141),r=l(73470);let o=function(){var e,t,l;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:d,isLoading:u,error:p,refetch:h}=(0,i.I)({queryKey:["licenses",o],queryFn:()=>(0,s.Zy)({client:a.S,query:(0,n._)({},(0,r.kd)(o))}),enabled:!c});return{result:{data:(null==d||null==(e=d.data)?void 0:e.items)||[],total:null!=(l=null==d||null==(t=d.data)?void 0:t.total)?l:0,params:o},isFetching:u,fetchError:p,refetch:h}}}}]);