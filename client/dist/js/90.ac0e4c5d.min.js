"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[90],{16177:(e,t,l)=>{l.d(t,{a:()=>r});var n=l(63696),a=l(93962);const r=({value:e})=>n.createElement(n.Fragment,null,Object.entries(e).map((([e,t],l)=>n.createElement(a.J,{key:l,isCompact:!0},`${e}=${t}`))))},23560:(e,t,l)=>{l.d(t,{j:()=>a});var n=l(63696);const a=({vulnerability:e})=>n.createElement("p",null,e.withdrawn&&n.createElement("em",null,"Rejected:Â "),e.title||e.description)},14671:(e,t,l)=>{l.r(t),l.d(t,{default:()=>Ee});var n=l(63696),a=l(68430),r=l(54518),i=l(48281),c=l(28338),m=l(70045),o=l(1180),u=l(72785),s=l(93962),d=l(77635),E=l(16459),p=l(71592),b=l(40111),h=l(70414),g=l(69673),f=l(10015),y=l(48783),v=l(8210),T=l(80876),P=l(24417),C=l(91271),x=l(91728),S=l(70028),K=l(76072),k=l(97299),I=l(17327),w=l(64361),F=l(71603),_=l(65753),$=l(24974),N=l(21639),V=l(3939),B=l(34066);const M=({sbom:e})=>n.createElement(K.x,{hasGutter:!0},n.createElement(k.E,{md:4},n.createElement(I.Z,{isFullHeight:!0},n.createElement(w.Z,null,"Metadata"),n.createElement(F.b,null,n.createElement(_.B,null,n.createElement($.W,null,n.createElement(N.X,null,"Name"),n.createElement(V.d,null,e.name)),n.createElement($.W,null,n.createElement(N.X,null,"Namespace"),n.createElement(V.d,null,e.document_id)))))),n.createElement(k.E,{md:4},n.createElement(I.Z,{isFullHeight:!0},n.createElement(w.Z,null,"Creation"),n.createElement(F.b,null,n.createElement(_.B,null,n.createElement($.W,null,n.createElement(N.X,null,"Created"),n.createElement(V.d,null,(0,B.Yq)(e.published))),n.createElement($.W,null,n.createElement(N.X,null,"License List Version"),n.createElement(V.d,null,e.data_licenses.join(", "))),n.createElement($.W,null,n.createElement(N.X,null,"Creator"),n.createElement(V.d,null,e.authors)))))),n.createElement(k.E,{md:4},n.createElement(I.Z,{isFullHeight:!0},n.createElement(w.Z,null,"Statistics"),n.createElement(F.b,null,n.createElement(_.B,null,n.createElement($.W,null,n.createElement(N.X,null,"Size"),n.createElement(V.d,null,(0,S.A)(e.size))),n.createElement($.W,null,n.createElement(N.X,null,"Packages"),n.createElement(V.d,null,e.number_of_packages)))))));var X=l(49348),O=l(20653),R=l(35048),q=l(4433),W=l(94279),Z=l(16172),D=l(341),j=l(40319),A=l(16646),J=l(9425),L=l(77819),H=l(28516),Y=l(3629),G=l(38139),U=l(87043),z=l(16177),Q=l(1349),ee=l(62520),te=l(70611),le=l(17993);const ne=({sbomId:e})=>{const{result:{data:t},isFetching:l,fetchError:a}=(0,le.sl)(e,{page:{pageNumber:1,itemsPerPage:0}}),r=(0,n.useMemo)((()=>t.flatMap((e=>e.purl)).map((e=>({...e,decomposedPurl:(0,B.fe)(e.purl)})))),[t]),i=(0,te.vY)({tableName:"package-table",idProperty:"uuid",items:r,isLoading:l,columnNames:{name:"Name",version:"Version",qualifiers:"Qualifiers"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","version"],getSortValues:e=>({name:`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`,version:e.version.version}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter tex",type:U.RJ.search,placeholderText:"Filter",getItemValue:e=>`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`||""}],isExpansionEnabled:!0,expandableVariant:"single"}),{currentPageItems:o,numRenderedColumns:u,propHelpers:{toolbarProps:d,filterToolbarProps:E,paginationToolbarItemProps:p,paginationProps:b,tableProps:h,getThProps:g,getTrProps:f,getTdProps:y,getExpandedContentTdProps:v},expansionDerivedState:{isCellExpanded:T}}=i;return n.createElement(n.Fragment,null,n.createElement(O.M,{...d},n.createElement(R.P,null,n.createElement(U.Us,{showFiltersSideBySide:!0,...E}),n.createElement(q.T,{...p},n.createElement(Q.n,{idPrefix:"package-table",isTop:!0,paginationProps:b})))),n.createElement(j.X,{...h,"aria-label":"Package table"},n.createElement(A.d,null,n.createElement(J.Tr,null,n.createElement(ee.Ze,{...i},n.createElement(L.Th,{...g({columnKey:"name"})}),n.createElement(L.Th,{...g({columnKey:"version"})}),n.createElement(L.Th,{...g({columnKey:"qualifiers"})})))),n.createElement(ee.nJ,{isLoading:l,isError:!!a,isNoData:0===r?.length,numRenderedColumns:u},o?.map(((e,t)=>n.createElement(H.N,{key:e.uuid},n.createElement(J.Tr,{...f({item:e})},n.createElement(ee.Oi,{...i,item:e,rowIndex:t},n.createElement(Y.Td,{width:30,...y({columnKey:"name"})},n.createElement(c.s,null,n.createElement(m.Z,{spacer:{default:"spacerSm"}},`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`),n.createElement(m.Z,null,n.createElement(s.J,{isCompact:!0,color:"blue"},e.decomposedPurl?.type)))),n.createElement(Y.Td,{width:20,...y({columnKey:"version"})},e.decomposedPurl?.version),n.createElement(Y.Td,{width:50,...y({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&n.createElement(z.a,{value:e.decomposedPurl?.qualifiers})))),T(e)?n.createElement(J.Tr,{isExpanded:!0},n.createElement(Y.Td,null),n.createElement(Y.Td,{...v({item:e}),className:D.A.pyLg},n.createElement(G.g,null,n.createElement(_.B,{columnModifier:{default:"3Col"}},n.createElement($.W,null,n.createElement(N.X,null,"Packages"),n.createElement(V.d,null,n.createElement(W.B8,null,n.createElement(Z.c,null,n.createElement(X.N_,{to:`/packages/${e.uuid}`},e.purl))))),n.createElement($.W,null,n.createElement(N.X,null,"Base package"),n.createElement(V.d,null,e.base.purl)),n.createElement($.W,null,n.createElement(N.X,null,"Versions"),n.createElement(V.d,null,n.createElement(W.B8,null,n.createElement(Z.c,null,e.version.version)))))))):null))))),n.createElement(Q.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:b}))};var ae=l(51257),re=l(38914),ie=l(57901),ce=l(55399),me=l(52302),oe=l(23560),ue=l(89101),se=l(15311);const de=({sbomId:e})=>{const{sbom:t,isFetching:l,fetchError:a}=(0,x.rj)(e),{vulnerabilities:r,summary:i,isFetching:c,fetchError:m}=(0,ue.U)(e),o=(0,se.f)(r,(e=>`${e.vulnerabilityId}-${e.advisory.identifier}-${e.advisory.uuid}`)),u=(0,te.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:o,isLoading:c,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id"],isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:s,numRenderedColumns:d,propHelpers:{toolbarProps:E,filterToolbarProps:p,paginationToolbarItemProps:b,paginationProps:h,tableProps:g,getThProps:f,getTrProps:y,getTdProps:v,getExpandedContentTdProps:T},expansionDerivedState:{isCellExpanded:C}}=u,S=n.useMemo((()=>Object.keys(i.severities).map((e=>{const t=e,l=i.severities[t],n=ce.Kb[t];return{severity:t,count:l,label:n.name,color:n.color.value}})).sort((0,ce.Sx)((e=>e.severity)))),[i]);return n.createElement(n.Fragment,null,n.createElement(re.B,{hasGutter:!0},n.createElement(ie.a,null,n.createElement(I.Z,null,n.createElement(F.b,null,n.createElement(P.a,{isFetching:c||l},n.createElement(K.x,{hasGutter:!0},n.createElement(k.E,{md:6},n.createElement("div",{style:{height:"230px",width:"350px"}},n.createElement(ae.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${i.total}`,subTitle:"Total vulnerabilities",width:350,legendData:S.map((({label:e,count:t})=>({name:`${e}: ${t}`}))),data:S.map((({label:e,count:t})=>({x:e,y:t}))),labels:({datum:e})=>`${e.x}: ${e.y}`,colorScale:S.map((({color:e})=>e))}))),n.createElement(k.E,{md:6},n.createElement(_.B,null,n.createElement($.W,null,n.createElement(N.X,null,"Name"),n.createElement(V.d,null,t?.name)),n.createElement($.W,null,n.createElement(N.X,null,"Version"),n.createElement(V.d,null,t?.described_by.map((e=>e.version)).join(", "))),n.createElement($.W,null,n.createElement(N.X,null,"Creation date"),n.createElement(V.d,null,(0,B.Yq)(t?.published)))))))))),n.createElement(ie.a,null,n.createElement(O.M,{...E},n.createElement(R.P,null,n.createElement(q.T,{...b},n.createElement(Q.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:h})))),n.createElement(j.X,{...g,"aria-label":"Vulnerability table"},n.createElement(A.d,null,n.createElement(J.Tr,null,n.createElement(ee.Ze,{...u},n.createElement(L.Th,{...f({columnKey:"id"})}),n.createElement(L.Th,{...f({columnKey:"description"})}),n.createElement(L.Th,{...f({columnKey:"cvss"})}),n.createElement(L.Th,{...f({columnKey:"affectedDependencies"})}),n.createElement(L.Th,{...f({columnKey:"published"})}),n.createElement(L.Th,{...f({columnKey:"updated"})})))),n.createElement(ee.nJ,{isLoading:c,isError:!!m,isNoData:0===o.length,numRenderedColumns:d},s?.map(((e,t)=>n.createElement(H.N,{key:e._ui_unique_id,isExpanded:C(e)},n.createElement(J.Tr,{...y({item:e})},n.createElement(ee.Oi,{...u,item:e,rowIndex:t},n.createElement(Y.Td,{width:15,...v({columnKey:"id"})},n.createElement(X.N_,{to:`/vulnerabilities/${e.vulnerabilityId}`},e.vulnerabilityId)),n.createElement(Y.Td,{width:35,modifier:"truncate",...v({columnKey:"description"})},e.vulnerability&&n.createElement(oe.j,{vulnerability:e.vulnerability})),n.createElement(Y.Td,{width:10,...v({columnKey:"cvss"})},e.vulnerability?.average_severity&&n.createElement(me.h,{value:e.vulnerability.average_severity})),n.createElement(Y.Td,{width:15,modifier:"truncate",...v({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:t})},e.packages.length),n.createElement(Y.Td,{width:10,modifier:"truncate",...v({columnKey:"published"})},(0,B.Yq)(e.vulnerability?.published)),n.createElement(Y.Td,{width:10,modifier:"truncate",...v({columnKey:"updated"})},(0,B.Yq)(e.vulnerability?.modified)))),C(e)?n.createElement(J.Tr,{isExpanded:!0},n.createElement(Y.Td,{...T({item:e})},n.createElement(G.g,null,C(e,"affectedDependencies")?n.createElement(n.Fragment,null,n.createElement(j.X,{variant:"compact"},n.createElement(A.d,null,n.createElement(J.Tr,null,n.createElement(L.Th,null,"Type"),n.createElement(L.Th,null,"Namespace"),n.createElement(L.Th,null,"Name"),n.createElement(L.Th,null,"Version"),n.createElement(L.Th,null,"Path"),n.createElement(L.Th,null,"Qualifiers"))),n.createElement(H.N,null,e.packages.flatMap((e=>e.purl)).map(((e,t)=>{const l=(0,B.fe)(e.purl);return n.createElement(J.Tr,{key:t},n.createElement(Y.Td,null,l?.type),n.createElement(Y.Td,null,l?.namespace),n.createElement(Y.Td,null,l?.name),n.createElement(Y.Td,null,l?.version),n.createElement(Y.Td,null,l?.path),n.createElement(Y.Td,null,l?.qualifiers&&n.createElement(z.a,{value:l?.qualifiers})))}))))):null))):null))))),n.createElement(Q.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:h}))))},Ee=()=>{const[e,t]=n.useState(0),l=n.createRef(),S=n.createRef(),K=n.createRef(),k=n.createRef(),I=(0,T.Lu)(T.vO.SBOM_ID),{sbom:w,isFetching:F,fetchError:_}=(0,x.rj)(I),{downloadSBOM:$}=(0,C.m)();return n.createElement(n.Fragment,null,n.createElement(a.d8,{variant:"light"},n.createElement(r.B,null,n.createElement(i.o,{isFilled:!0},n.createElement(c.s,null,n.createElement(m.Z,{spacer:{default:"spacerSm"}},n.createElement(o.n,null,n.createElement(u.E,{component:"h1"},w?.name??I??""))),n.createElement(m.Z,null,w?.labels.type&&n.createElement(s.J,{color:"blue"},w?.labels.type)))),n.createElement(i.o,null,!F&&n.createElement(d.$n,{variant:"secondary",icon:n.createElement(y.Ay,null),onClick:()=>{I&&$(I,w?.name?`${w?.name}.json`:`${I}.json`)}},"Download")))),n.createElement(a.d8,{type:"nav"},n.createElement(E.t,{mountOnEnter:!0,activeKey:e,onSelect:(e,l)=>{t(l)},"aria-label":"Tabs that contain the SBOM information",role:"region"},n.createElement(p.o,{eventKey:0,title:n.createElement(b.V,null,"Info"),tabContentId:"refTabInfoSection",tabContentRef:l}),n.createElement(p.o,{eventKey:1,title:n.createElement(b.V,null,"Packages"),tabContentId:"refTabPackagesSection",tabContentRef:S}),n.createElement(p.o,{eventKey:2,title:n.createElement(b.V,null,"Vulnerabilities"),tabContentId:"refVulnerabilitiesSection",tabContentRef:K,actions:n.createElement(n.Fragment,null,n.createElement(h.o,{ref:k},n.createElement(v.Ay,null)),n.createElement(g.A,{triggerRef:k,bodyContent:n.createElement("div",null,"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed.")}))}))),n.createElement(a.d8,null,n.createElement(f.J,{eventKey:0,id:"refTabInfoSection",ref:l,"aria-label":"Information of the SBOM"},n.createElement(P.a,{isFetching:F,fetchError:_},w&&n.createElement(M,{sbom:w}))),n.createElement(f.J,{eventKey:1,id:"refTabPackagesSection",ref:S,"aria-label":"Packages within the SBOM",hidden:!0},I&&n.createElement(ne,{sbomId:I})),n.createElement(f.J,{eventKey:2,id:"refVulnerabilitiesSection",ref:K,"aria-label":"Vulnerabilities within the SBOM",hidden:!0},I&&n.createElement(de,{sbomId:I}))))}},15311:(e,t,l)=>{l.d(t,{f:()=>r});var n=l(63696),a=l(86820);const r=(e,t)=>(0,n.useMemo)((()=>e&&0!==e.length?e.map((e=>({...e,[a.FA]:t(e)}))):[]),[e,t])}}]);
//# sourceMappingURL=90.ac0e4c5d.min.js.map