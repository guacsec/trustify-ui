"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[982],{17327:(e,t,i)=>{i.d(t,{E:()=>s,Z:()=>d});var l=i(34629),a=i(63696),n=i(41775),r=i(62634),c=i(1850);const s=a.createContext({cardId:"",registerTitleId:()=>{},isExpanded:!1,isClickable:!1,isSelectable:!1,isSelected:!1,isClicked:!1,isDisabled:!1}),d=e=>{var{children:t,id:i="",className:o,component:m="div",isCompact:u=!1,isSelectable:f=!1,isClickable:b=!1,isDisabled:p=!1,isSelectableRaised:E=!1,isSelected:h=!1,isClicked:v=!1,isDisabledRaised:g=!1,isFlat:y=!1,isExpanded:A=!1,isRounded:_=!1,isLarge:T=!1,isFullHeight:S=!1,isPlain:C=!1,ouiaId:I,ouiaSafe:k=!0,hasSelectableInput:F=!1,selectableInputAriaLabel:x,onSelectableInputChange:B=()=>{}}=e,P=(0,l.__rest)(e,["children","id","className","component","isCompact","isSelectable","isClickable","isDisabled","isSelectableRaised","isSelected","isClicked","isDisabledRaised","isFlat","isExpanded","isRounded","isLarge","isFullHeight","isPlain","ouiaId","ouiaSafe","hasSelectableInput","selectableInputAriaLabel","onSelectableInputChange"]);const w=m,R=(0,c.iK)(d.displayName,I,k),[D,N]=a.useState(""),[K,L]=a.useState();u&&T&&(console.warn("Card: Cannot use isCompact with isLarge. Defaulting to isCompact"),T=!1);const H=a.useRef(!1);return a.useEffect((()=>{x?L({"aria-label":x}):D?L({"aria-labelledby":D}):F&&!H.current&&(L({}),console.warn("If no CardTitle component is passed as a child of Card the selectableInputAriaLabel prop must be passed"))}),[F,x,D]),a.createElement(s.Provider,{value:{cardId:i,registerTitleId:e=>{N(e),H.current=!!e},isExpanded:A,isClickable:b,isSelectable:f,isSelected:h,isClicked:v,isDisabled:p,hasSelectableInput:F}},F&&a.createElement("input",Object.assign({className:"pf-v5-screen-reader",id:`${i}-input`},K,{type:"checkbox",checked:h,onChange:e=>B(e,i),disabled:g,tabIndex:-1})),a.createElement(w,Object.assign({id:i,className:(0,r.A)(n.A.card,u&&n.A.modifiers.compact,A&&n.A.modifiers.expanded,y&&n.A.modifiers.flat,_&&n.A.modifiers.rounded,T&&n.A.modifiers.displayLg,S&&n.A.modifiers.fullHeight,C&&n.A.modifiers.plain,g?(0,r.A)(n.A.modifiers.nonSelectableRaised):E?(0,r.A)(n.A.modifiers.selectableRaised,h&&n.A.modifiers.selectedRaised):f&&b?(0,r.A)(n.A.modifiers.selectable,n.A.modifiers.clickable,(h||v)&&n.A.modifiers.current):f?(0,r.A)(n.A.modifiers.selectable,h&&n.A.modifiers.selected):b?(0,r.A)(n.A.modifiers.clickable,v&&n.A.modifiers.current):"",p&&n.A.modifiers.disabled,o),tabIndex:E?"0":void 0},P,R),t))};d.displayName="Card"},71603:(e,t,i)=>{i.d(t,{b:()=>c});var l=i(34629),a=i(63696),n=i(41775),r=i(62634);const c=e=>{var{children:t,className:i,component:c="div",isFilled:s=!0}=e,d=(0,l.__rest)(e,["children","className","component","isFilled"]);const o=c;return a.createElement(o,Object.assign({className:(0,r.A)(n.A.cardBody,!s&&n.A.modifiers.noFill,i)},d),t)};c.displayName="CardBody"},64361:(e,t,i)=>{i.d(t,{Z:()=>s});var l=i(34629),a=i(63696),n=i(62634),r=i(41775),c=i(17327);const s=e=>{var{children:t,className:i,component:s="div"}=e,d=(0,l.__rest)(e,["children","className","component"]);const{cardId:o,registerTitleId:m}=a.useContext(c.E),u=s,f=o?`${o}-title`:"";return a.useEffect((()=>(m(f),()=>m(""))),[m,f]),a.createElement("div",{className:(0,n.A)(r.A.cardTitle)},a.createElement(u,Object.assign({className:(0,n.A)(r.A.cardTitleText,i),id:f||void 0},d),t))};s.displayName="CardTitle"},48783:(e,t,i)=>{i.d(t,{Ay:()=>l});const l=(0,i(32791).w)({name:"DownloadIcon",height:512,width:512,svgPath:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",yOffset:0,xOffset:0})},99439:(e,t,i)=>{i.r(t),i.d(t,{default:()=>j});var l=i(63696),a=i(68430),n=i(54518),r=i(48281),c=i(1180),s=i(72785),d=i(77635),o=i(16459),m=i(71592),u=i(40111),f=i(10015),b=i(48783),p=i(80876),E=i(24417),h=i(91271),v=i(69935),g=i(70028),y=i(76072),A=i(97299),_=i(17327),T=i(64361),S=i(71603),C=i(65753),I=i(24974),k=i(21639),F=i(3939),x=i(11848),B=i(34066);const P=({advisory:e})=>l.createElement(y.x,{hasGutter:!0},l.createElement(A.E,{md:4},l.createElement(_.Z,{isFullHeight:!0},l.createElement(T.Z,null,"Overview"),l.createElement(S.b,null,l.createElement(C.B,null,l.createElement(I.W,null,l.createElement(k.X,null,"Title"),l.createElement(F.d,null,e.title)),l.createElement(I.W,null,l.createElement(k.X,null,"Type"),l.createElement(F.d,null,e.labels.type)),l.createElement(I.W,null,l.createElement(k.X,null,"Aggregate Severity"),l.createElement(F.d,null,e.average_severity&&l.createElement(x.h,{value:e.average_severity}))),l.createElement(I.W,null,l.createElement(k.X,null,"Size"),l.createElement(F.d,null,(0,g.A)(e.size))))))),l.createElement(A.E,{md:4},l.createElement(_.Z,{isFullHeight:!0},l.createElement(T.Z,null,"Publisher"),l.createElement(S.b,null,l.createElement(C.B,null,l.createElement(I.W,null,l.createElement(k.X,null,"Name"),l.createElement(F.d,null,e.issuer?.name)),l.createElement(I.W,null,l.createElement(k.X,null,"Contact details"),l.createElement(F.d,null,e.issuer?.website)))))),l.createElement(A.E,{md:4},l.createElement(_.Z,{isFullHeight:!0},l.createElement(T.Z,null,"Tracking"),l.createElement(S.b,null,l.createElement(C.B,null,l.createElement(I.W,null,l.createElement(k.X,null,"ID"),l.createElement(F.d,null,e.identifier)),l.createElement(I.W,null,l.createElement(k.X,null,"Initial release date"),l.createElement(F.d,null,(0,B.Yq)(e.published))),l.createElement(I.W,null,l.createElement(k.X,null,"Current release date"),l.createElement(F.d,null,(0,B.Yq)(e.modified))))))));var w=i(49348),R=i(20653),D=i(35048),N=i(4433),K=i(40319),L=i(16646),H=i(9425),M=i(77819),O=i(28516),Z=i(3629),Y=i(1349),V=i(62520),q=i(23560),X=i(70611);const $=({isFetching:e,fetchError:t,vulnerabilities:i})=>{const a=(0,X.vY)({tableName:"vulnerability-table",idProperty:"identifier",items:i,isLoading:e,columnNames:{identifier:"ID",title:"Title",discovery:"Discovery",release:"Release",score:"Score",cwe:"Score"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:[],getSortValues:e=>({}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:n,numRenderedColumns:r,propHelpers:{toolbarProps:c,filterToolbarProps:s,paginationToolbarItemProps:d,paginationProps:o,tableProps:m,getThProps:u,getTrProps:f,getTdProps:b},expansionDerivedState:{isCellExpanded:p}}=a;return l.createElement(l.Fragment,null,l.createElement(R.M,{...c},l.createElement(D.P,null,l.createElement(N.T,{...d},l.createElement(Y.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:o})))),l.createElement(K.X,{...m,"aria-label":"vulnerability table"},l.createElement(L.d,null,l.createElement(H.Tr,null,l.createElement(V.Ze,{...a},l.createElement(M.Th,{...u({columnKey:"identifier"})}),l.createElement(M.Th,{...u({columnKey:"title"})}),l.createElement(M.Th,{...u({columnKey:"discovery"})}),l.createElement(M.Th,{...u({columnKey:"release"})}),l.createElement(M.Th,{...u({columnKey:"score"})}),l.createElement(M.Th,{...u({columnKey:"cwe"})})))),l.createElement(V.nJ,{isLoading:e,isError:!!t,isNoData:0===i.length,numRenderedColumns:r},n?.map(((e,t)=>l.createElement(O.N,{key:e.identifier,isExpanded:p(e)},l.createElement(H.Tr,{...f({item:e})},l.createElement(V.Oi,{...a,item:e,rowIndex:t},l.createElement(Z.Td,{width:15,...b({columnKey:"identifier"})},l.createElement(w.N_,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),l.createElement(Z.Td,{width:40,modifier:"truncate",...b({columnKey:"title"})},l.createElement(q.j,{vulnerability:e})),l.createElement(Z.Td,{width:15,...b({columnKey:"discovery"})},(0,B.Yq)(e.discovered)),l.createElement(Z.Td,{width:10,modifier:"truncate",...b({columnKey:"release"})},(0,B.Yq)(e.released)),l.createElement(Z.Td,{width:10,modifier:"truncate",...b({columnKey:"score"})},e.severity&&l.createElement(x.h,{value:e.severity})),l.createElement(Z.Td,{width:10,modifier:"truncate",...b({columnKey:"cwe"})},e.cwes.join(", "))))))))),l.createElement(Y.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:o}))},j=()=>{const[e,t]=l.useState(0),i=l.createRef(),g=l.createRef(),y=(0,p.Lu)(p.vO.ADVISORY_ID),{advisory:A,isFetching:_,fetchError:T}=(0,v.vy)(y),{downloadAdvisory:S}=(0,h.m)();return l.createElement(l.Fragment,null,l.createElement(a.d8,{variant:"light"},l.createElement(n.B,null,l.createElement(r.o,{isFilled:!0},l.createElement(c.n,null,l.createElement(s.E,{component:"h1"},A?.document_id??y??""),l.createElement(s.E,{component:"p"},"Advisory detail information"))),l.createElement(r.o,null,!_&&l.createElement(d.$n,{variant:"secondary",icon:l.createElement(b.Ay,null),onClick:()=>{y&&S(y,A?.identifier?`${A?.identifier}.json`:`${y}.json`)}},"Download")))),l.createElement(a.d8,{type:"nav"},l.createElement(o.t,{mountOnEnter:!0,activeKey:e,onSelect:(e,i)=>{t(i)},"aria-label":"Tabs that contain the SBOM information",role:"region"},l.createElement(m.o,{eventKey:0,title:l.createElement(u.V,null,"Info"),tabContentId:"refTabInfoSection",tabContentRef:i}),l.createElement(m.o,{eventKey:1,title:l.createElement(u.V,null,"Vulnerabilities"),tabContentId:"refVulnerabilitiesSection",tabContentRef:g}))),l.createElement(a.d8,null,l.createElement(f.J,{eventKey:0,id:"refTabInfoSection",ref:i,"aria-label":"Information of the Advisory"},l.createElement(E.a,{isFetching:_,fetchError:T},A&&l.createElement(P,{advisory:A}))),l.createElement(f.J,{eventKey:1,id:"refVulnerabilitiesSection",ref:g,"aria-label":"Vulnerabilities within the SBOM",hidden:!0},l.createElement($,{isFetching:_,fetchError:T,vulnerabilities:A?.vulnerabilities||[]}))))}},69935:(e,t,i)=>{i.d(t,{VH:()=>m,Yu:()=>f,vy:()=>u});var l=i(39155),a=i(3715),n=i(77347),r=i(40752),c=i(81230),s=i(70611),d=i(24808);const o="advisories",m=(e={},t=!1)=>{const{data:i,isLoading:a,error:c,refetch:d}=(0,l.I)({queryKey:[o,e],queryFn:()=>(0,r.YM)({client:n.S,query:{...(0,s.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:i?.data?.items||[],total:i?.data?.total??0,params:e??e},isFetching:a,fetchError:c||null,refetch:d}},u=e=>{const{data:t,isLoading:i,error:a}=(0,l.I)({queryKey:[o,e],queryFn:()=>(0,r.ai)({client:n.S,path:{key:e}}),enabled:void 0!==e});return{advisory:t?.data,isFetching:i,fetchError:a}},f=()=>{const e=(0,a.jE)();return(0,d.v)({parallel:!0,uploadFn:(e,t)=>(0,c.hP)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[o]})}})}},41775:(e,t,i)=>{i.d(t,{A:()=>l});const l={card:"pf-v5-c-card",cardActions:"pf-v5-c-card__actions",cardBody:"pf-v5-c-card__body",cardExpandableContent:"pf-v5-c-card__expandable-content",cardFooter:"pf-v5-c-card__footer",cardHeader:"pf-v5-c-card__header",cardHeaderMain:"pf-v5-c-card__header-main",cardHeaderToggle:"pf-v5-c-card__header-toggle",cardHeaderToggleIcon:"pf-v5-c-card__header-toggle-icon",cardSelectableActions:"pf-v5-c-card__selectable-actions",cardSrInput:"pf-v5-c-card__sr-input",cardTitle:"pf-v5-c-card__title",cardTitleText:"pf-v5-c-card__title-text",check:"pf-v5-c-check",checkInput:"pf-v5-c-check__input",checkLabel:"pf-v5-c-check__label",dirRtl:"pf-v5-m-dir-rtl",divider:"pf-v5-c-divider",modifiers:{selectable:"pf-m-selectable",clickable:"pf-m-clickable",selected:"pf-m-selected",current:"pf-m-current",disabled:"pf-m-disabled",hoverableRaised:"pf-m-hoverable-raised",selectableRaised:"pf-m-selectable-raised",nonSelectableRaised:"pf-m-non-selectable-raised",selectedRaised:"pf-m-selected-raised",compact:"pf-m-compact",displayLg:"pf-m-display-lg",flat:"pf-m-flat",plain:"pf-m-plain",rounded:"pf-m-rounded",expanded:"pf-m-expanded",fullHeight:"pf-m-full-height",toggleRight:"pf-m-toggle-right",noOffset:"pf-m-no-offset",noFill:"pf-m-no-fill"},radio:"pf-v5-c-radio",radioInput:"pf-v5-c-radio__input",radioLabel:"pf-v5-c-radio__label",themeDark:"pf-v5-theme-dark"}},70028:(e,t,i)=>{i.d(t,{A:()=>s});const l=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],a=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],n=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],r=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],c=(e,t,i)=>{let l=e;return"string"==typeof t||Array.isArray(t)?l=e.toLocaleString(t,i):!0!==t&&void 0===i||(l=e.toLocaleString(void 0,i)),l};function s(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);const i=(t={bits:!1,binary:!1,space:!0,...t}).bits?t.binary?r:n:t.binary?a:l,s=t.space?" ":"";if(t.signed&&0===e)return` 0${s}${i[0]}`;const d=e<0,o=d?"-":t.signed?"+":"";let m;if(d&&(e=-e),void 0!==t.minimumFractionDigits&&(m={minimumFractionDigits:t.minimumFractionDigits}),void 0!==t.maximumFractionDigits&&(m={maximumFractionDigits:t.maximumFractionDigits,...m}),e<1)return o+c(e,t.locale,m)+s+i[0];const u=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),i.length-1);return e/=(t.binary?1024:1e3)**u,m||(e=e.toPrecision(3)),o+c(Number(e),t.locale,m)+s+i[u]}}}]);
//# sourceMappingURL=982.c3c6b315.min.js.map