"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[53],{55399:(e,t,l)=>{l.d(t,{K:()=>s,S:()=>m});var r=l(44304),n=l(19174),a=l(53820),i=l(8742),c=l(53359);const s={none:{name:"None",shieldIconColor:r.p,progressProps:{variant:void 0}},low:{name:"Low",shieldIconColor:n.n,progressProps:{variant:void 0}},medium:{name:"Medium",shieldIconColor:a.H,progressProps:{variant:"warning"}},high:{name:"High",shieldIconColor:i.u,progressProps:{variant:"danger"}},critical:{name:"Critical",shieldIconColor:c.c,progressProps:{variant:"danger"}}},o=e=>{switch(e){case"low":return 1;case"medium":return 2;case"high":return 3;case"critical":return 4;default:return 0}};function m(e){return(t,l)=>o(e(t))-o(e(l))}},80254:(e,t,l)=>{l.d(t,{V:()=>o});var r=l(63696),n=l(34066),a=l(65753),i=l(24974),c=l(21639),s=l(3939);const o=({advisory:e,excludedFields:t=[],descriptionListProps:l})=>r.createElement(a.B,{...l},!t.includes("title")&&r.createElement(i.W,null,r.createElement(c.X,null,"Title"),r.createElement(s.d,null,e.title)),!t.includes("published")&&r.createElement(i.W,null,r.createElement(c.X,null,"Published"),r.createElement(s.d,null,(0,n.Yq)(e.published))),!t.includes("modified")&&r.createElement(i.W,null,r.createElement(c.X,null,"Modified"),r.createElement(s.d,null,(0,n.Yq)(e.modified))),!t.includes("withdrawn")&&r.createElement(i.W,null,r.createElement(c.X,null,"Withdrawn"),r.createElement(s.d,null,(0,n.Yq)(e.withdrawn))))},88112:(e,t,l)=>{l.d(t,{N:()=>s});var r=l(63696),n=l(65753),a=l(24974),i=l(21639),c=l(3939);const s=({value:e})=>r.createElement(n.B,null,r.createElement(a.W,null,r.createElement(i.X,null,"Name"),r.createElement(c.d,null,e.issuer?.name)),r.createElement(a.W,null,r.createElement(i.X,null,"Website"),r.createElement(c.d,null,e.issuer?.website)))},85278:(e,t,l)=>{l.d(t,{x:()=>h});var r=l(63696),n=l(33364),a=l(77635),i=l(38914),c=l(57901),s=l(40360),o=l(23546),m=l(891),d=l(46721),u=l(76072),E=l(97299),v=l(23857);const h=({resourceName:e,value:t,onSave:l,onClose:h})=>{const[p,y]=r.useState(""),[g,b]=r.useState(""),[f,w]=r.useState(Object.entries(t).sort((([e],[t])=>t.localeCompare(e)))),C=()=>{if(!p||!g)return;const e=f.filter((([e])=>e!==p));w([...e,[p,g]]),y(""),b("")};return r.createElement(n.a,{isOpen:!0,variant:n.d.small,title:"Edit labels",onClose:h,actions:[r.createElement(a.$n,{key:"Save",variant:"primary",onClick:()=>{const e=f.reduce(((e,[t,l])=>({...e,[t]:l})),{});l(e)}},"Save"),r.createElement(a.$n,{key:"cancel",variant:"link",onClick:h},"Cancel")],ouiaId:"BasicModal"},r.createElement(i.B,{hasGutter:!0},r.createElement(c.a,null,"Labels help you organize and select resources. Adding labels below will let you query for objects that have similar, overlapping or dissimilar labels."),r.createElement(c.a,null,r.createElement("div",{className:"pf-v5-c-form"},r.createElement(s.g,{label:`Labels for ${e}`},r.createElement(o.o,{className:"pf-v5-c-form-control",style:{padding:10,minHeight:10},defaultIsOpen:!0,numLabels:10},f.map((([e,t],l)=>r.createElement(m.J,{key:l,color:"blue",onClose:()=>{const e=[...f];e.splice(l,1),w(e)}},`${e}=${t}`))))))),r.createElement(c.a,null,r.createElement(d.l,{onSubmit:e=>{C(),e.preventDefault()}},r.createElement(u.x,{hasGutter:!0},r.createElement(E.E,{md:5},r.createElement(s.g,{label:"Key",isRequired:!0,fieldId:"key"},r.createElement(v.ks,{isRequired:!0,type:"text",id:"key",name:"key",value:p,onChange:(e,t)=>y(t)}))),r.createElement(E.E,{md:5},r.createElement(s.g,{label:"Value",isRequired:!0,fieldId:"value"},r.createElement(v.ks,{isRequired:!0,type:"text",id:"value",name:"value",value:g,onChange:(e,t)=>b(t)}))),r.createElement(E.E,{md:2},r.createElement(s.g,{label:"Action"},r.createElement(a.$n,{type:"submit",variant:a.Ak.secondary,onClick:C},"Add"))))))))}},24417:(e,t,l)=>{l.d(t,{a:()=>c});var r=l(63696),n=l(59394),a=l(23338),i=l(75855);const c=e=>e.isFetching?r.createElement(n.a,null,r.createElement(a.y,null)):e.fetchError?r.createElement(i.q,null):e.children},52302:(e,t,l)=>{l.d(t,{h:()=>o});var r=l(63696),n=l(28338),a=l(70045),i=l(85310),c=l(93914),s=l(55399);const o=({value:e,hideLabel:t})=>{const l=s.K[e],o=e.charAt(0).toUpperCase()+e.slice(1);return r.createElement(n.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},r.createElement(a.Z,null,t?r.createElement(i.m,{content:o},r.createElement(c.Ay,{color:l.shieldIconColor.value})):r.createElement(c.Ay,{color:l.shieldIconColor.value})),!t&&r.createElement(a.Z,null,o))}},23713:(e,t,l)=>{l.d(t,{m:()=>a});var r=l(81230),n=l(22249);const a=()=>({downloadAdvisory:(e,t)=>{(0,r.yZ)(e).then((l=>{(0,n.saveAs)(new Blob([l.data]),t||`${e}.json`)}))},downloadCVE:(e,t)=>{(0,r.J8)(e).then((l=>{(0,n.saveAs)(new Blob([l.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,r.Ix)(e).then((l=>{(0,n.saveAs)(new Blob([l.data]),t||`${e}.json`)}))}})},33872:(e,t,l)=>{l.r(t),l.d(t,{default:()=>H});var r=l(63696),n=l(49348),a=l(2620),i=l(68430),c=l(98261),s=l(75530),o=l(48783),m=l(80876),d=l(24417),u=l(52302),E=l(69935),v=l(47883);l(22671);const h=({source:e,isFetching:t,fetchError:l,height:n="sizeToFit"})=>{const[a,i]=r.useMemo((()=>e?"object"==typeof e?[JSON.stringify(e,null,2),v.T.json]:"string"==typeof e?[e,v.T.plaintext]:["Not supported format",v.T.plaintext]:[e,void 0]),[e]);return r.createElement(r.Fragment,null,r.createElement(d.a,{isFetching:t,fetchError:l},a&&r.createElement(v.B,{isDarkTheme:!0,isLineNumbersVisible:!0,isReadOnly:!0,isMinimapVisible:!0,isLanguageLabelVisible:!0,code:a??"",language:i,height:n})))},p=({advisoryId:e,height:t="sizeToFit"})=>{const{source:l,isFetching:n,fetchError:a}=(0,E.qF)(e);return r.createElement(r.Fragment,null,r.createElement(h,{source:l,isFetching:n,fetchError:a,height:t}))};var y=l(23713),g=l(38914),b=l(57901),f=l(76072),w=l(97299),C=l(17327),T=l(64361),I=l(71603),F=l(65753),k=l(24974),P=l(21639),K=l(3939),S=l(77635),N=l(40360),q=l(10410),A=l(80254),x=l(88112),L=l(85278),B=l(94279),O=l(16172),V=l(20061);const j=({value:e})=>r.createElement(B.B8,{isPlain:!0},e.map(((e,t)=>r.createElement(O.c,{key:t},r.createElement(V.Ck,{isReadOnly:!0,hoverTip:"Copy",clickTip:"Copied"},e)))));var W=l(67837),$=l(50705);const R=({advisory:e})=>{const{pushNotification:t}=r.useContext($.K),[l,n]=r.useState(!1),{mutate:a}=(0,E.uJ)((()=>{}),(e=>{t({title:"Error while updating labels",variant:"danger"})}));return r.createElement(r.Fragment,null,r.createElement(g.B,{hasGutter:!0},r.createElement(b.a,null,r.createElement(f.x,{hasGutter:!0},r.createElement(w.E,{md:4},r.createElement(C.Z,{isFullHeight:!0},r.createElement(T.Z,null,"General view"),r.createElement(I.b,null,r.createElement(A.V,{advisory:e})))),r.createElement(w.E,{md:4},r.createElement(C.Z,{isFullHeight:!0},r.createElement(T.Z,null,"Issuer"),r.createElement(I.b,null,r.createElement(x.N,{value:e})))),r.createElement(w.E,{md:4},r.createElement(C.Z,{isFullHeight:!0},r.createElement(T.Z,null,"System"),r.createElement(I.b,null,r.createElement(F.B,null,r.createElement(k.W,null,r.createElement(P.X,null,"Hashes"),r.createElement(K.d,null,e.hashes&&r.createElement(j,{value:e.hashes}))),r.createElement(k.W,null,r.createElement(P.X,null,"Labels ","",r.createElement(S.$n,{variant:S.Ak.link,size:"sm",icon:r.createElement(q.Ay,null),iconPosition:"end",onClick:()=>n(!0)},"Edit")),r.createElement(K.d,null,r.createElement("div",{className:"pf-v5-c-form"},r.createElement(N.g,null,r.createElement("div",{className:"pf-v5-c-form-control",style:{padding:10}},e.labels&&r.createElement(W.g,{defaultIsOpen:!0,value:e.labels}))))))))))))),l&&r.createElement(L.x,{resourceName:e.identifier,value:e.labels??{},onSave:t=>{(t=>{a({...e,labels:t})})(t),n(!1)},onClose:()=>n(!1)}))};var _=l(32343);const H=()=>{const e=(0,m.Lu)(m.vO.ADVISORY_ID),{advisory:t,isFetching:l,fetchError:v}=(0,E.vy)(e),{downloadAdvisory:h}=(0,y.m)();return r.createElement(r.Fragment,null,r.createElement(i.d8,{variant:"light"},r.createElement(a.A,{breadcrumbs:r.createElement(c.Q,null,r.createElement(s.J,{key:"advisories"},r.createElement(n.N_,{to:"/advisories"},"Advisories")),r.createElement(s.J,{isActive:!0},"Advisory details")),actionButtons:[{children:r.createElement(r.Fragment,null,r.createElement(o.Ay,null)," Download"),variant:"secondary",onClick:()=>{e&&h(e,`${t?.identifier}.json`)}}],pageHeading:{title:t?.identifier??"",label:t?.average_severity?{children:r.createElement(u.h,{value:t.average_severity}),isCompact:!0}:void 0},tabs:[{eventKey:"overview",title:"Overview",children:r.createElement("div",{className:"pf-v5-u-m-md"},r.createElement(d.a,{isFetching:l,fetchError:v},t&&r.createElement(R,{advisory:t})))},{eventKey:"vulnerabilities",title:"Vulnerabilities",children:r.createElement("div",{className:"pf-v5-u-m-md"},r.createElement(d.a,{isFetching:l,fetchError:v},r.createElement(_.j,{enableToolbar:!0,vulnerabilities:t?.vulnerabilities||[]})))},{eventKey:"source",title:"Source",children:r.createElement("div",{className:"pf-v5-u-m-md"},e&&r.createElement(p,{advisoryId:e,height:"645px"}))}]})))}},32343:(e,t,l)=>{l.d(t,{j:()=>C});var r=l(63696),n=l(49348),a=l(95285),i=l.n(a),c=l(20653),s=l(35048),o=l(4433),m=l(85578),d=l(16646),u=l(31065),E=l(77819),v=l(28516),h=l(3629),p=l(33273),y=l(52302),g=l(1349),b=l(62520),f=l(70611),w=l(34066);const C=({enableToolbar:e,variant:t,vulnerabilities:l})=>{const a=(0,f.vY)({variant:t,tableName:"vulnerability-table",idProperty:"identifier",items:l,columnNames:{identifier:"Identifier",title:"Title",severity:"Severity",discovered:"Discovered",released:"Released",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier","discovered","released"],getSortValues:e=>({identifier:e?.identifier||"",discovered:e.discovered?i()(e.discovered).valueOf():0,released:e.released?i()(e.released).valueOf():0}),isPaginationEnabled:!0,isExpansionEnabled:!1,isFilterEnabled:!0,filterCategories:[{categoryKey:"id",title:"ID",type:p.RJ.search,placeholderText:"Search by ID...",getItemValue:e=>e.identifier||""}]}),{currentPageItems:C,numRenderedColumns:T,propHelpers:{toolbarProps:I,filterToolbarProps:F,paginationToolbarItemProps:k,paginationProps:P,tableProps:K,getThProps:S,getTrProps:N,getTdProps:q}}=a;return r.createElement(r.Fragment,null,e&&r.createElement(c.M,{...I},r.createElement(s.P,null,r.createElement(p.Us,{showFiltersSideBySide:!0,...F}),r.createElement(o.T,{...k},r.createElement(g.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:P})))),r.createElement(m.X,{...K,"aria-label":"Vulnerability table"},r.createElement(d.d,null,r.createElement(u.Tr,null,r.createElement(b.Ze,{...a},r.createElement(E.Th,{...S({columnKey:"identifier"})}),r.createElement(E.Th,{...S({columnKey:"title"})}),r.createElement(E.Th,{...S({columnKey:"severity"})}),r.createElement(E.Th,{...S({columnKey:"discovered"})}),r.createElement(E.Th,{...S({columnKey:"released"})}),r.createElement(E.Th,{...S({columnKey:"cwe"})})))),r.createElement(b.nJ,{isLoading:!1,isError:void 0,isNoData:0===l.length,numRenderedColumns:T},C?.map(((e,t)=>r.createElement(v.N,{key:e.identifier},r.createElement(u.Tr,{...N({item:e})},r.createElement(b.Oi,{...a,item:e,rowIndex:t},r.createElement(h.Td,{width:15,...q({columnKey:"identifier"})},r.createElement(n.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),r.createElement(h.Td,{width:40,modifier:"truncate",...q({columnKey:"title"})},e.title||e.description),r.createElement(h.Td,{width:15,...q({columnKey:"severity"})},r.createElement(y.h,{value:e.severity})),r.createElement(h.Td,{width:10,...q({columnKey:"discovered"})},(0,w.Yq)(e.discovered)),r.createElement(h.Td,{width:10,...q({columnKey:"released"})},(0,w.Yq)(e.released)),r.createElement(h.Td,{width:10,...q({columnKey:"cwe"})},e.cwe)))))))),r.createElement(g.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:P}))}},69935:(e,t,l)=>{l.d(t,{VH:()=>o,Yu:()=>u,qF:()=>d,uJ:()=>E,vy:()=>m});var r=l(7616),n=l(3715),a=l(26667),i=l(81230),c=l(24808);const s="advisories",o=(e={},t=!1)=>{const{data:l,isLoading:n,error:a,refetch:c}=(0,r.I)({queryKey:[s,e],queryFn:()=>(0,i.uK)(e),refetchInterval:!t&&5e3});return{result:{data:l?.data||[],total:l?.total??0,params:l?.params??e},isFetching:n,fetchError:a,refetch:c}},m=e=>{const{data:t,isLoading:l,error:n}=(0,r.I)({queryKey:[s,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,i.wJ)(e),enabled:void 0!==e});return{advisory:t,isFetching:l,fetchError:n}},d=e=>{const{data:t,isLoading:l,error:n}=(0,r.I)({queryKey:[s,e,"source"],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,i.N2)(e),enabled:void 0!==e});return{source:t,isFetching:l,fetchError:n}},u=()=>{const e=(0,n.jE)();return(0,c.v)({parallel:!0,uploadFn:(e,t)=>(0,i.hP)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[s]})}})},E=(e,t)=>{const l=(0,n.jE)();return(0,a.n)({mutationFn:e=>(0,i._e)(e.uuid,e.labels??{}),onSuccess:(t,r)=>{e(),l.invalidateQueries({queryKey:[s]})},onError:t})}}}]);
//# sourceMappingURL=53.9e8c0a90.min.js.map