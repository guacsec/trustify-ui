"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[586],{13506:(e,t,a)=>{a.d(t,{T:()=>i});var l=a(63696),r=a(77635),n=a(33364);const i=({isOpen:e,title:t,titleIconVariant:a,message:i,confirmBtnLabel:o,cancelBtnLabel:s,inProgress:c,confirmBtnVariant:m,onClose:u,onConfirm:d,onCancel:E})=>{const p=l.createElement(r.$n,{id:"confirm-dialog-button",key:"confirm","aria-label":"confirm",variant:m,isDisabled:c,onClick:d},o),y=E?l.createElement(r.$n,{key:"cancel",id:"confirm-cancel-button","aria-label":"cancel",variant:r.Ak.link,isDisabled:c,onClick:E},s):void 0;return l.createElement(n.a,{id:"confirm-dialog",variant:n.d.small,title:t,titleIconVariant:a,isOpen:e,onClose:u,"aria-label":"Confirm dialog",actions:E?[p,y]:[p]},i)}},28644:(e,t,a)=>{a.d(t,{n:()=>m});var l=a(63696),r=a(28338),n=a(70045),i=a(9369),o=a(86099),s=a(55399),c=a(52302);const m=({severities:e})=>{const t=Object.values(e).reduce(((e,t)=>e+t),0);return l.createElement(r.s,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},l.createElement(n.Z,{style:{minWidth:15,textAlign:o.pG}},t),l.createElement(i.c,{orientation:{default:"vertical"}}),l.createElement(n.Z,null,l.createElement(r.s,null,Object.entries(e).filter((([e,t])=>t>0)).sort((0,s.Sx)((([e,t])=>e))).reverse().map((([e,t],a)=>l.createElement(n.Z,{key:a,spacer:{default:"spacerXs"}},l.createElement(r.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},l.createElement(n.Z,null,l.createElement(c.h,{value:e,hideLabel:!0})),l.createElement(n.Z,null,t))))))))}},91271:(e,t,a)=>{a.d(t,{m:()=>i});var l=a(22249),r=a(77347),n=a(40752);const i=()=>({downloadAdvisory:(e,t)=>{(0,n.Mu)({client:r.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,l.saveAs)(new Blob([a.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,n.K0)({client:r.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,l.saveAs)(new Blob([a.data]),t||`${e}.json`)}))}})},4878:(e,t,a)=>{a.d(t,{r:()=>s});var l=a(63696),r=a(77347),n=a(40752),i=a(91728);const o={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},s=e=>{const{advisories:t,isFetching:a,fetchError:s}=(0,i.DH)(e),[c,m]=l.useState([]),[u,d]=l.useState(new Map),[E,p]=l.useState(!1);l.useEffect((()=>{if(0===t.length)return;const e=(t??[]).flatMap((e=>(e.status??[]).map((t=>({vulnerabilityId:t.vulnerability_id,status:t.status,packages:t.packages||[],advisory:{...e}}))))).filter((e=>"affected"===e.status)).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]);m(e),p(!0),Promise.all(e.map((async e=>(await(0,n.wk)({client:r.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),a=new Map;t.forEach((e=>{a.set(e.identifier,e)})),d(a),p(!1)}))}),[t]);const y=l.useMemo((()=>c.map((e=>({...e,vulnerability:u.get(e.vulnerabilityId)})))),[c,u]),h=l.useMemo((()=>y.reduce(((e,t)=>{if(t.vulnerability?.average_severity){const a=t.vulnerability?.average_severity;return{...e,total:e.total+1,severities:{...e.severities,[a]:e.severities[a]+1}}}return e}),o)),[y]);return{isFetching:a||E,fetchError:s,vulnerabilities:y,summary:h}}},7602:(e,t,a)=>{a.d(t,{R:()=>c,r:()=>m});var l=a(63696),r=a(87043),n=a(86820),i=a(70611),o=a(5098),s=a(69935);const c=l.createContext({}),m=({children:e})=>{const t=(0,i.MM)({tableName:"advisory",persistenceKeyPrefix:n.rt.advisories,columnNames:{identifier:"ID",title:"Title",severity:"Aggregated Severity",modified:"Revision",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","severity","modified"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:r.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"modified",title:"Revision",type:r.RJ.dateRange}],isExpansionEnabled:!1}),{result:{data:a,total:m},isFetching:u,fetchError:d}=(0,s.VH)((0,i.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score",modified:"modified"}})),E=(0,i.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:m,isLoading:u,selectionState:(0,o.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return l.createElement(c.Provider,{value:{totalItemCount:m,isFetching:u,fetchError:d,tableControls:E}},e)}},7123:(e,t,a)=>{a.d(t,{q:()=>f});var l=a(63696),r=a(49348),n=a(85578),i=a(16646),o=a(31065),s=a(77819),c=a(28516),m=a(3629),u=a(62101),d=a(50705),E=a(1349),p=a(62520),y=a(91271),h=a(52302),g=a(28644),v=a(34066),b=a(7602);const f=({})=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:f}=l.useContext(b.R),{pushNotification:C}=l.useContext(d.K),{numRenderedColumns:T,currentPageItems:P,propHelpers:{paginationProps:x,tableProps:K,getThProps:S,getTrProps:F,getTdProps:w},expansionDerivedState:{isCellExpanded:I}}=f,{downloadAdvisory:k}=(0,y.m)();return l.createElement(l.Fragment,null,l.createElement(n.X,{...K,"aria-label":"advisory-table"},l.createElement(i.d,null,l.createElement(o.Tr,null,l.createElement(p.Ze,{...f},l.createElement(s.Th,{...S({columnKey:"identifier"})}),l.createElement(s.Th,{...S({columnKey:"title"})}),l.createElement(s.Th,{...S({columnKey:"severity"})}),l.createElement(s.Th,{...S({columnKey:"modified"})}),l.createElement(s.Th,{...S({columnKey:"vulnerabilities"})})))),l.createElement(p.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:T},P.map(((e,t)=>{const a=e.vulnerabilities.reduce(((e,t)=>({...e,[t.severity]:e[t.severity]+1})),{critical:0,high:0,medium:0,low:0,none:0});return l.createElement(c.N,{key:e.identifier,isExpanded:I(e)},l.createElement(o.Tr,{...F({item:e})},l.createElement(p.Oi,{...f,item:e,rowIndex:t},l.createElement(m.Td,{width:15,...w({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},l.createElement(r.k2,{to:`/advisories/${e.uuid}`},e.identifier)),l.createElement(m.Td,{width:40,modifier:"truncate",...w({columnKey:"title"})},e.title),l.createElement(m.Td,{width:15,modifier:"truncate",...w({columnKey:"severity"})},l.createElement(h.h,{value:e.average_severity})),l.createElement(m.Td,{width:10,...w({columnKey:"modified"})},(0,v.Yq)(e.modified)),l.createElement(m.Td,{width:20,...w({columnKey:"vulnerabilities"})},l.createElement(g.n,{severities:a})),l.createElement(m.Td,{isActionCell:!0},l.createElement(u.G,{items:[{title:"Download",onClick:()=>{k(e.uuid,`${e.identifier}.json`)}}]})))))})))),l.createElement(E.n,{idPrefix:"advisory-table",isTop:!1,isCompact:!0,paginationProps:x}))}},30426:(e,t,a)=>{a.d(t,{Y:()=>m,a:()=>u});var l=a(63696),r=a(87043),n=a(86820),i=a(70611),o=a(5098),s=a(17993),c=a(34066);const m=l.createContext({}),u=({children:e})=>{const t=(0,i.MM)({tableName:"packages",persistenceKeyPrefix:n.rt.packages,columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:r.RJ.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:r.RJ.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:a,total:u},isFetching:d,fetchError:E}=(0,s.Lx)((0,i.Ng)({...t,hubSortFieldKeys:{}})),p=l.useMemo((()=>a.map((e=>({...e,decomposedPurl:(0,c.fe)(e.purl)})))),[a]),y=(0,i.PB)({...t,idProperty:"uuid",currentPageItems:p,totalItemCount:u,isLoading:d,selectionState:(0,o.$)({items:p,isEqual:(e,t)=>e.uuid===t.uuid})});return l.createElement(m.Provider,{value:{totalItemCount:u,isFetching:d,fetchError:E,tableControls:y}},e)}},67475:(e,t,a)=>{a.d(t,{N:()=>x});var l=a(63696),r=a(49348),n=a(85578),i=a(16646),o=a(31065),s=a(77819),c=a(28516),m=a(3629),u=a(16177),d=a(1349),E=a(62520),p=a(1459),y=a(891),h=a(24417),g=a(28644),v=a(77347),b=a(40752),f=a(17993);const C={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},T=({packageId:e})=>{const{summary:t,isFetching:a,fetchError:r}=(e=>{const{pkg:t,isFetching:a,fetchError:r}=(0,f.Si)(e),[n,i]=l.useState([]),[o,s]=l.useState(new Map),[c,m]=l.useState(!1);l.useEffect((()=>{if(!t||0===t.advisories.length)return;const e=(t?.advisories??[]).flatMap((e=>(e.status??[]).map((t=>({vulnerabilityId:t.vulnerability.identifier,status:t.status,advisory:e}))))).filter((e=>"affected"===e.status)).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]);i(e),m(!0),Promise.all(e.map((async e=>(await(0,b.wk)({client:v.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),a=new Map;t.forEach((e=>{a.set(e.identifier,e)})),s(a),m(!1)}))}),[t]);const u=l.useMemo((()=>n.map((e=>({...e,vulnerability:o.get(e.vulnerabilityId)})))),[n,o]),d=l.useMemo((()=>u.reduce(((e,t)=>{if(t.vulnerability?.average_severity){const a=t.vulnerability?.average_severity;return{...e,total:e.total+1,severities:{...e.severities,[a]:e.severities[a]+1}}}return e}),C)),[u]);return{isFetching:a||c,fetchError:r,vulnerabilities:u,summary:d}})(e);return l.createElement(h.a,{isFetching:a,fetchError:r,isFetchingState:l.createElement(p.E,{screenreaderText:"Loading contents"}),fetchErrorState:l.createElement(y.J,{color:"red"},"Error")},l.createElement(g.n,{severities:t.severities}))};var P=a(30426);const x=()=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:p}=l.useContext(P.Y),{numRenderedColumns:y,currentPageItems:h,propHelpers:{paginationProps:g,tableProps:v,getThProps:b,getTrProps:f,getTdProps:C},expansionDerivedState:{isCellExpanded:x}}=p;return l.createElement(l.Fragment,null,l.createElement(n.X,{...v,"aria-label":"Package table"},l.createElement(i.d,null,l.createElement(o.Tr,null,l.createElement(E.Ze,{...p},l.createElement(s.Th,{...b({columnKey:"name"})}),l.createElement(s.Th,{...b({columnKey:"namespace"})}),l.createElement(s.Th,{...b({columnKey:"version"})}),l.createElement(s.Th,{...b({columnKey:"type"})}),l.createElement(s.Th,{...b({columnKey:"path"})}),l.createElement(s.Th,{...b({columnKey:"qualifiers"})}),l.createElement(s.Th,{...b({columnKey:"vulnerabilities"})})))),l.createElement(E.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:y},h.map(((e,t)=>l.createElement(c.N,{key:e.uuid},l.createElement(o.Tr,{...f({item:e})},l.createElement(E.Oi,{...p,item:e,rowIndex:t},l.createElement(m.Td,{width:15,...C({columnKey:"name"})},l.createElement(r.k2,{to:`/packages/${e.uuid}`},e.decomposedPurl?e.decomposedPurl?.name:e.purl)),l.createElement(m.Td,{width:15,modifier:"truncate",...C({columnKey:"namespace"})},e.decomposedPurl?.namespace),l.createElement(m.Td,{width:10,modifier:"truncate",...C({columnKey:"version"})},e.decomposedPurl?.version),l.createElement(m.Td,{width:10,modifier:"truncate",...C({columnKey:"type"})},e.decomposedPurl?.type),l.createElement(m.Td,{width:10,modifier:"truncate",...C({columnKey:"path"})},e.decomposedPurl?.path),l.createElement(m.Td,{width:20,...C({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&l.createElement(u.a,{value:e.decomposedPurl?.qualifiers})),l.createElement(m.Td,{width:20,...C({columnKey:"vulnerabilities"})},l.createElement(T,{packageId:e.uuid}))))))))),l.createElement(d.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:g}))}},36390:(e,t,a)=>{a.d(t,{L:()=>c,c:()=>m});var l=a(63696),r=a(87043),n=a(86820),i=a(70611),o=a(5098),s=a(91728);const c=l.createContext({}),m=({children:e})=>{const t=(0,i.MM)({tableName:"sbom",persistenceKeyPrefix:n.rt.sboms,columnNames:{name:"Name",version:"Version",supplier:"Supplier",published:"Created on",packages:"Dependencies",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","published"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"published",title:"Created on",type:r.RJ.dateRange}],isExpansionEnabled:!1}),{result:{data:a,total:m},isFetching:u,fetchError:d}=(0,s.i$)((0,i.Ng)({...t,hubSortFieldKeys:{name:"name",published:"published"}})),E=(0,i.PB)({...t,idProperty:"id",currentPageItems:a,totalItemCount:m,isLoading:u,selectionState:(0,o.$)({items:a,isEqual:(e,t)=>e.id===t.id})});return l.createElement(c.Provider,{value:{totalItemCount:m,isFetching:u,fetchError:d,tableControls:E}},e)}},59013:(e,t,a)=>{a.d(t,{Y:()=>I});var l=a(63696),r=a(49348),n=a(77635),i=a(85578),o=a(16646),s=a(31065),c=a(77819),m=a(28516),u=a(3629),d=a(62101),E=a(13506),p=a(50705),y=a(17993);const h=({sbomId:e})=>{const{result:{total:t}}=(0,y.sl)(e,{page:{pageNumber:1,itemsPerPage:1}});return l.createElement(l.Fragment,null,t)};var g=a(1349),v=a(62520),b=a(91271),f=a(91728),C=a(34066),T=a(1459),P=a(891),x=a(24417),K=a(28644),S=a(4878);const F=({sbomId:e})=>{const{summary:t,isFetching:a,fetchError:r}=(0,S.r)(e);return l.createElement(x.a,{isFetching:a,fetchError:r,isFetchingState:l.createElement(T.E,{screenreaderText:"Loading contents"}),fetchErrorState:l.createElement(P.J,{color:"red"},"Error")},l.createElement(K.n,{severities:t.severities}))};var w=a(36390);const I=({})=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:y}=l.useContext(w.L),{pushNotification:T}=l.useContext(p.K),[P,x]=l.useState(null),[K,S]=l.useState(null),{mutate:I}=(0,f.l6)((e=>{T({title:`The SBOM ${e.name} was deleted`,variant:"success"})}),(e=>{T({title:"Error occurred while deleting the SBOM",variant:"danger"})})),{numRenderedColumns:k,currentPageItems:M,propHelpers:{paginationProps:R,tableProps:D,getThProps:V,getTrProps:N,getTdProps:A},expansionDerivedState:{isCellExpanded:O}}=y,{downloadSBOM:B}=(0,b.m)();return l.createElement(l.Fragment,null,l.createElement(i.X,{...D,"aria-label":"sbom-table"},l.createElement(o.d,null,l.createElement(s.Tr,null,l.createElement(v.Ze,{...y},l.createElement(c.Th,{...V({columnKey:"name"})}),l.createElement(c.Th,{...V({columnKey:"version"})}),l.createElement(c.Th,{...V({columnKey:"supplier"})}),l.createElement(c.Th,{...V({columnKey:"published"})}),l.createElement(c.Th,{...V({columnKey:"packages"})}),l.createElement(c.Th,{...V({columnKey:"vulnerabilities"})})))),l.createElement(v.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:k},M.map(((e,t)=>l.createElement(m.N,{key:e.id,isExpanded:O(e)},l.createElement(s.Tr,{...N({item:e})},l.createElement(v.Oi,{...y,item:e,rowIndex:t},l.createElement(u.Td,{width:25,...A({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t})},l.createElement(r.k2,{to:`/sboms/${e.id}`},e.name)),l.createElement(u.Td,{width:15,modifier:"truncate",...A({columnKey:"version"})},e.described_by.map((e=>e.version)).filter((e=>e)).join(", ")),l.createElement(u.Td,{width:20,modifier:"truncate",...A({columnKey:"supplier"})},e.authors.join(", ")),l.createElement(u.Td,{width:10,...A({columnKey:"published"})},(0,C.Yq)(e.published)),l.createElement(u.Td,{width:10,...A({columnKey:"packages"})},l.createElement(h,{sbomId:e.id})),l.createElement(u.Td,{width:20,...A({columnKey:"vulnerabilities"})},l.createElement(F,{sbomId:e.id})),l.createElement(u.Td,{isActionCell:!0},l.createElement(d.G,{items:[{title:"Download",onClick:()=>{B(e.id,`${e.name}.json`)}},{title:"Delete",onClick:()=>{return t=e,x("delete"),void S(t);var t}}]}))))))))),l.createElement(g.n,{idPrefix:"sbom-table",isTop:!1,isCompact:!0,paginationProps:R}),l.createElement(E.T,{title:`Delete ${K?.name}`,titleIconVariant:"warning",isOpen:"delete"===P,message:"Are you sure you want to delete this SBOM? This action cannot be undone.","aria-label":"Delete SBOM",confirmBtnVariant:n.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>x(null),onClose:()=>x(null),onConfirm:()=>{K&&I(K.id),x(null)}}))}},98436:(e,t,a)=>{a.r(t),a.d(t,{default:()=>te});var l=a(63696),r=a(23665),n=a(68430),i=a(20653),o=a(35048),s=a(56918),c=a(1180),m=a(72785),u=a(4433),d=a(65991),E=a(76072),p=a(97299),y=a(17327),h=a(71603),g=a(87294),v=a(71592),b=a(40111),f=a(79893),C=a(70414),T=a(8210),P=a(38914),x=a(57901),K=a(77635),S=a(87043),F=a(58897),w=a(23857),I=a(51463);const k=({category:e,filterValue:t,setFilterValue:a,isNumeric:r,isDisabled:n=!1})=>{const[i,o]=l.useState(t?.[0]||"");l.useEffect((()=>{o(t?.[0]||"")}),[t]);const s=()=>{const e=i.trim();a(e?[e.replace(/\s+/g," ")]:[])},c=`${e.categoryKey}-input`;return l.createElement(F.M,null,l.createElement(w.ks,{name:c,id:"search-input",type:r?"number":"search",onChange:(e,t)=>o(t),"aria-label":`${e.title} filter`,value:i,placeholder:e.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||s()},isDisabled:n}),l.createElement(K.$n,{variant:K.Ak.control,id:"search-button","aria-label":"search button for search input",onClick:s,isDisabled:n},l.createElement(I.Ay,null)))};var M=a(11493);const R=({category:e,filterValue:t,setFilterValue:a,isDisabled:r=!1})=>l.createElement(l.Fragment,null,e.selectOptions.map((({label:n,value:i,optionProps:o={}},s)=>{const c=t?.includes(i)||!1;return l.createElement(M.s,{isDisabled:r,key:s,id:`radio-${s}`,name:"radio",isLabelWrapped:!0,label:n,isChecked:c,onChange:()=>{(t=>{const l=(r=t,e.selectOptions.find((({value:e})=>e===r)));var r;a(l?[t]:null)})(i)}})})));var D=a(58365);const V=({category:e,filterValue:t,setFilterValue:a,isDisabled:r=!1})=>{const[n,i]=l.useState(Array.isArray(e.selectOptions)?e.selectOptions:[]);l.useEffect((()=>{i(Array.isArray(e.selectOptions)?e.selectOptions:[])}),[e.selectOptions]);const o=Array.isArray(n)?n:Object.values(n).flatMap((e=>e));return l.createElement(l.Fragment,null,o.map((({label:r,value:n,optionProps:i={}},o)=>l.createElement(D.S,{key:o,id:`checkbox-${o}-${e.categoryKey}`,isLabelWrapped:!0,label:r,isChecked:t?.includes(n),onChange:()=>{(e=>{if(e&&"No results"!==e){let l;l=t&&t.includes(e)?t.filter((t=>t!==e)):t?[...t,e]:[e],a(l)}})(n)}}))))};var N=a(46721),A=a(40360),O=a(86282),B=a(78109),L=a(66341);const $=({category:e,filterValue:t,setFilterValue:a,isDisabled:r=!1})=>{const n=t??[],[i,o]=(n?.filter((e=>(0,L.Ce)((0,L.P1)(e)))),(0,l.useState)()),[s,c]=(0,l.useState)();return l.useEffect((()=>{if(t?.[0]){const[e,a]=(0,L.P1)(t?.[0]);o(e.toDate()),c(a.toDate())}else o(void 0),c(void 0)}),[t]),l.createElement(N.l,null,l.createElement(A.g,{role:"group",isInline:!0,label:"From"},l.createElement(O.l,{value:i?(0,L.ak)(i):"",dateFormat:L.ak,dateParse:L.sy,onChange:(e,t)=>{(0,L.Fz)(t)&&(o((0,L.sy)(t)),c(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:r})),l.createElement(A.g,{role:"group",isInline:!0,label:"To"},l.createElement(O.l,{value:s?(0,L.ak)(s):"",onChange:(e,t)=>{if((0,L.Fz)(t)){const e=(0,L.sy)(t);c(e);const l=(0,L.Kg)(i,e);l&&a([l])}},isDisabled:r||!(0,B.v)(i),dateFormat:L.ak,dateParse:L.sy,invalidFormatText:"",rangeStart:i,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})))},q=({category:e,...t})=>e.type===S.RJ.select?l.createElement(R,{category:e,...t}):e.type===S.RJ.search||e.type===S.RJ.numsearch?l.createElement(k,{category:e,isNumeric:e.type===S.RJ.numsearch,...t}):e.type===S.RJ.multiselect?l.createElement(V,{category:e,...t}):e.type===S.RJ.dateRange?l.createElement($,{category:e,...t}):null,J=({filterCategories:e,filterValues:t,setFilterValues:a,isDisabled:r=!1,omitFilterCategoryKeys:n=[]})=>l.createElement(l.Fragment,null,l.createElement(P.B,{hasGutter:!0},l.createElement(x.a,null,l.createElement(K.$n,{variant:"link",isInline:!0,onClick:()=>{const l=e.filter((e=>void 0===n.find((t=>t===e.categoryKey)))).reduce(((e,t)=>({...e,[t.categoryKey]:void 0})),{});a({...t,...l})}},"Clear all filters")),e.filter((e=>void 0===n.find((t=>t===e.categoryKey)))).map((e=>l.createElement(x.a,{key:e.categoryKey},l.createElement(P.B,{hasGutter:!0},l.createElement(x.a,null,l.createElement(c.n,null,l.createElement(m.E,{component:"h4"},e.title))),l.createElement(x.a,null,l.createElement(q,{category:e,filterValue:t[e.categoryKey],setFilterValue:l=>((e,l)=>a({...t,[e.categoryKey]:l}))(e,l),isDisabled:r,isSidebar:!0}))))))));var Y=a(30426),_=a(36390),H=a(14310),W=a(7602);function Z(e,t){return{Component:e,props:t}}const X=[Z(_.c,{}),Z(Y.a,{}),Z(H.y,{}),Z(W.r,{})],j=(G=X,({children:e})=>{const t=l.createElement(l.Fragment,null,e);return G.reduceRight(((e,{Component:t,props:a={}})=>l.createElement(t,{...a},e)),t)});var G,z=a(67475),Q=a(59013),U=a(1159),ee=a(7123);const te=()=>l.createElement(j,null,l.createElement(ae,null)),ae=()=>{const{tableControls:e}=l.useContext(_.L),{tableControls:t}=l.useContext(Y.Y),{tableControls:a}=l.useContext(H.u),{tableControls:P}=l.useContext(W.R),{totalItemCount:x,tableControls:{propHelpers:{filterPanelProps:K}}}=l.useContext(_.L),{totalItemCount:S,tableControls:{propHelpers:{filterPanelProps:F}}}=l.useContext(Y.Y),{totalItemCount:w,tableControls:{propHelpers:{filterPanelProps:I}}}=l.useContext(H.u),{totalItemCount:k,tableControls:{propHelpers:{filterPanelProps:M}}}=l.useContext(W.R),[R,D]=l.useState(""),[V,N]=l.useState(0),A=l.createRef();return l.createElement(l.Fragment,null,l.createElement(n.d8,{variant:n.zC.light},l.createElement(i.M,{isStatic:!0},l.createElement(o.P,null,l.createElement(s.$,{align:{default:"alignLeft"}},l.createElement(c.n,null,l.createElement(m.E,{component:"h1"},"Search"))),l.createElement(s.$,{variant:"icon-button-group",align:{default:"alignRight"}},l.createElement(s.$,{visibility:{default:"hidden",lg:"visible"}},l.createElement(u.T,{widths:{default:"500px"}},l.createElement(d.D,{placeholder:"Search for an SBOM, Package, or Vulnerability",value:R,onChange:(e,t)=>(e=>{D(e)})(t),onClear:()=>{D("")},onKeyDown:l=>{l.key&&"Enter"!==l.key||(e.filterState.setFilterValues({...e.filterState.filterValues,"":[R]}),t.filterState.setFilterValues({...t.filterState.filterValues,"":[R]}),a.filterState.setFilterValues({...a.filterState.filterValues,"":[R]}),P.filterState.setFilterValues({...P.filterState.filterValues,"":[R]}))}}))))))),l.createElement(n.d8,null,l.createElement(E.x,{hasGutter:!0},l.createElement(p.E,{md:2},l.createElement(y.Z,{isFullHeight:!0},l.createElement(h.b,null,0===V?l.createElement(J,{omitFilterCategoryKeys:[""],...K}):1===V?l.createElement(J,{omitFilterCategoryKeys:[""],...F}):2===V?l.createElement(J,{omitFilterCategoryKeys:[""],...I}):3===V?l.createElement(J,{omitFilterCategoryKeys:[""],...M}):null))),l.createElement(p.E,{md:10},l.createElement(g.t,{isBox:!0,activeKey:V,onSelect:(e,t)=>{N(t)},"aria-label":"Tabs",role:"region"},l.createElement(v.o,{eventKey:0,title:l.createElement(b.V,null,"SBOMs","  ",l.createElement(f.E,{screenReaderText:"Search Result Count"},x)),actions:l.createElement(l.Fragment,null,l.createElement(C.o,{"aria-label":"SBOM help popover",ref:A},l.createElement(T.Ay,null)),(O=A,l.createElement(r.A,{bodyContent:l.createElement("div",null,"Software Bill of Materials for Products and Containers."),position:"right",triggerRef:O})))},l.createElement(Q.Y,null)),l.createElement(v.o,{eventKey:1,title:l.createElement(b.V,null,"Packages","  ",l.createElement(f.E,{screenReaderText:"Search Result Count"},S))},l.createElement(z.N,null)),l.createElement(v.o,{eventKey:2,title:l.createElement(b.V,null,"Vulnerabilities","  ",l.createElement(f.E,{screenReaderText:"Search Result Count"},w))},l.createElement(U.fk,null)),l.createElement(v.o,{eventKey:3,title:l.createElement(b.V,null,"Advisories","  ",l.createElement(f.E,{screenReaderText:"Advisory Result Count"},w))},l.createElement(ee.q,null)))))));var O}},14310:(e,t,a)=>{a.d(t,{u:()=>c,y:()=>m});var l=a(63696),r=a(87043),n=a(86820),i=a(70611),o=a(5098),s=a(74932);const c=l.createContext({}),m=({children:e})=>{const t=(0,i.MM)({tableName:"vulnerability",persistenceKeyPrefix:n.rt.vulnerabilities,columnNames:{identifier:"Name",title:"Description",severity:"CVSS",published:"Published",packages:"Packages",sboms:"SBOMs"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"average_severity",title:"CVSS",placeholderText:"CVSS",type:r.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:a,total:m},isFetching:u,fetchError:d}=(0,s.WJ)((0,i.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score"}})),E=(0,i.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:m,isLoading:u,selectionState:(0,o.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return l.createElement(c.Provider,{value:{totalItemCount:m,isFetching:u,fetchError:d,tableControls:E}},e)}},1159:(e,t,a)=>{a.d(t,{fk:()=>R});var l=a(63696),r=a(49348),n=a(76072),i=a(97299),o=a(17327),s=a(64361),c=a(71603),m=a(65753),u=a(24974),d=a(21639),E=a(3939),p=a(85578),y=a(16646),h=a(31065),g=a(77819),v=a(28516),b=a(3629),f=a(62101),C=a(38139),T=a(24417),P=a(50705),x=a(52302),K=a(1349),S=a(62520),F=a(74932),w=a(34066),I=a(70400),k=a(65636),M=a(14310);const R=()=>{const{pushNotification:e}=l.useContext(P.K),{isFetching:t,fetchError:a,totalItemCount:T,tableControls:I}=l.useContext(M.u),k=(0,F.o5)((t=>{e({title:`The Vulnerability ${t.identifier} was deleted`,variant:"danger"})}),(t=>{e({title:"Error occurred while deleting the vulnerability",variant:"danger"})})),{numRenderedColumns:R,currentPageItems:N,propHelpers:{paginationProps:A,tableProps:O,getThProps:B,getTrProps:L,getTdProps:$,getExpandedContentTdProps:q},expansionDerivedState:{isCellExpanded:J}}=I;return l.createElement(l.Fragment,null,l.createElement(p.X,{...O,"aria-label":"Vulnerability table"},l.createElement(y.d,null,l.createElement(h.Tr,null,l.createElement(S.Ze,{...I},l.createElement(g.Th,{...B({columnKey:"identifier"})}),l.createElement(g.Th,{...B({columnKey:"title"})}),l.createElement(g.Th,{...B({columnKey:"severity"})}),l.createElement(g.Th,{...B({columnKey:"published"})}),l.createElement(g.Th,{...B({columnKey:"packages"})}),l.createElement(g.Th,{...B({columnKey:"sboms"})})))),l.createElement(S.nJ,{isLoading:t,isError:!!a,isNoData:0===T,numRenderedColumns:R},N.map(((e,t)=>l.createElement(v.N,{key:e.identifier,isExpanded:J(e)},l.createElement(h.Tr,{...L({item:e})},l.createElement(S.Oi,{...I,item:e,rowIndex:t},l.createElement(b.Td,{width:15,...$({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},l.createElement(r.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),l.createElement(b.Td,{width:45,modifier:"truncate",...$({columnKey:"title"})},e.title||e.description),l.createElement(b.Td,{width:10,...$({columnKey:"severity"})},e.average_severity&&l.createElement(x.h,{value:e.average_severity})),l.createElement(b.Td,{width:10,...$({columnKey:"published"})},(0,w.Yq)(e.published)),l.createElement(b.Td,{width:10,modifier:"truncate",...$({columnKey:"packages",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"Packages"),l.createElement(b.Td,{width:10,modifier:"truncate",...$({columnKey:"sboms",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"SBOMs"),l.createElement(b.Td,{isActionCell:!0},l.createElement(f.G,{items:[{title:"Delete",onClick:()=>k.mutate(e.identifier)}]})))),J(e)?l.createElement(h.Tr,{isExpanded:!0},l.createElement(b.Td,{...q({item:e})},l.createElement(C.g,null,l.createElement("div",{className:"pf-v5-u-m-md"},J(e,"identifier")?l.createElement(l.Fragment,null,l.createElement(n.x,{hasGutter:!0},l.createElement(i.E,{md:8},l.createElement(o.Z,{isFullHeight:!0,isCompact:!0},l.createElement(s.Z,null,"General view"),l.createElement(c.b,null,l.createElement(m.B,{columnModifier:{default:"2Col"}},l.createElement(u.W,null,l.createElement(d.X,null,"Published"),l.createElement(E.d,null,(0,w.Yq)(e.published))),l.createElement(u.W,null,l.createElement(d.X,null,"Modified"),l.createElement(E.d,null,(0,w.Yq)(e.modified))),l.createElement(u.W,null,l.createElement(d.X,null,"Released"),l.createElement(E.d,null,(0,w.Yq)(e.released))),l.createElement(u.W,null,l.createElement(d.X,null,"Withdrawn"),l.createElement(E.d,null,(0,w.Yq)(e.withdrawn))))))),l.createElement(i.E,{md:4},l.createElement(o.Z,{isFullHeight:!0,isCompact:!0},l.createElement(s.Z,null,"Additional info"),l.createElement(c.b,null,l.createElement(m.B,null,l.createElement(u.W,null,l.createElement(d.X,null,"CWE"),l.createElement(E.d,null,"item.cwe")),l.createElement(u.W,null,l.createElement(d.X,null,"Non normative"),l.createElement(E.d,null,e.normative?"Yes":"No")))))))):null,J(e,"packages")?l.createElement(l.Fragment,null,l.createElement(D,{vulnerabilityId:e.identifier})):null,J(e,"sboms")?l.createElement(l.Fragment,null,l.createElement(V,{vulnerabilityId:e.identifier})):null)))):null))))),l.createElement(K.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:A}))},D=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:a,fetchError:r}=(0,F.uN)(e);return l.createElement(T.a,{isFetching:a,fetchError:r},l.createElement(I.n,{variant:"compact",initialItemsPerPage:5,advisories:t?.advisories??[]}))},V=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:a,fetchError:r}=(0,F.uN)(e);return l.createElement(T.a,{isFetching:a,fetchError:r},l.createElement(k.m,{variant:"compact",advisories:t?.advisories??[]}))}},17993:(e,t,a)=>{a.d(t,{Lx:()=>s,Si:()=>c,sl:()=>m});var l=a(7616),r=a(77347),n=a(40752),i=a(70611);const o="packages",s=(e={},t=!1)=>{const{data:a,isLoading:s,error:c,refetch:m}=(0,l.I)({queryKey:[o,e],queryFn:()=>(0,n.UD)({client:r.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e},isFetching:s,fetchError:c,refetch:m}},c=e=>{const{data:t,isLoading:a,error:i}=(0,l.I)({queryKey:[o,e],queryFn:()=>(0,n.Y0)({client:r.S,path:{key:e}})});return{pkg:t?.data,isFetching:a,fetchError:i}},m=(e,t={})=>{const{data:a,isLoading:s,error:c,refetch:m}=(0,l.I)({queryKey:[o,"by-sbom",e,t],queryFn:()=>(0,n.Ad)({client:r.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:t},isFetching:s,fetchError:c,refetch:m}}}}]);
//# sourceMappingURL=586.deca3e06.min.js.map