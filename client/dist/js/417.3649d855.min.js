"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[417],{93962:(e,t,n)=>{n.d(t,{J:()=>F});var a=n(34629),l=n(63696);const r="pf-v5-c-label__content",i="pf-m-compact",c="pf-m-blue",s="pf-m-green",o="pf-m-orange",m="pf-m-red",u="pf-m-purple",d="pf-m-cyan",E="pf-m-gold",p="pf-m-outline",b="pf-m-overflow",f="pf-m-editable-active",v="pf-m-disabled",g="pf-m-editable";var y=n(77635),h=n(26615),P=n(62634),T=n(53025),k=n(99847);const S="--pf-v5-c-label__text--MaxWidth",C={blue:c,cyan:d,green:s,orange:o,purple:u,red:m,gold:E,grey:""},F=e=>{var{children:t,className:n="",color:c="grey",variant:s="filled",isCompact:o=!1,isDisabled:m=!1,isEditable:u=!1,editableProps:d,textMaxWidth:E,tooltipPosition:F,icon:x,onClose:_,onClick:N,onEditCancel:B,onEditComplete:A,closeBtn:I,closeBtnAriaLabel:w,closeBtnProps:M,href:K,isOverflowLabel:L,render:O}=e,q=(0,a.__rest)(e,["children","className","color","variant","isCompact","isDisabled","isEditable","editableProps","textMaxWidth","tooltipPosition","icon","onClose","onClick","onEditCancel","onEditComplete","closeBtn","closeBtnAriaLabel","closeBtnProps","href","isOverflowLabel","render"]);const[D,j]=(0,l.useState)(!1),[$,R]=(0,l.useState)(t),V=l.useRef(),W=l.useRef();l.useEffect((()=>(document.addEventListener("mousedown",X),document.addEventListener("keydown",Z),()=>{document.removeEventListener("mousedown",X),document.removeEventListener("keydown",Z)}))),l.useEffect((()=>{N&&K?console.warn("Link labels cannot have onClick passed, this results in invalid HTML. Please remove either the href or onClick prop."):N&&u&&console.warn("Editable labels cannot have onClick passed, clicking starts the label edit process. Please remove either the isEditable or onClick prop.")}),[N,K,u]);const X=e=>{D&&W&&W.current&&!W.current.contains(e.target)&&(W.current.value&&A&&A(e,W.current.value),j(!1))},Z=e=>{var n,a;const l=e.key;if((D||V&&V.current&&V.current.contains(e.target))&&(!D||W&&W.current&&W.current.contains(e.target))&&(!D||"Enter"!==l&&"Tab"!==l||(e.preventDefault(),e.stopImmediatePropagation(),W.current.value&&A&&A(e,W.current.value),j(!1),null===(n=null==V?void 0:V.current)||void 0===n||n.focus()),D&&"Escape"===l&&(e.preventDefault(),e.stopImmediatePropagation(),W.current.value&&(W.current.value=t,B&&B(e,t)),j(!1),null===(a=null==V?void 0:V.current)||void 0===a||a.focus()),!D&&"Enter"===l)){e.preventDefault(),e.stopImmediatePropagation(),j(!0);const t=e.target,n=document.createRange(),a=window.getSelection();n.selectNodeContents(t),n.collapse(!1),a.removeAllRanges(),a.addRange(n)}},Y=(K||N)&&m,H=l.createElement(y.$n,Object.assign({type:"button",variant:"plain",onClick:_,"aria-label":w||`Close ${t}`},Y&&{isDisabled:!0},M),l.createElement(T.Ay,null)),z=l.createElement("span",{className:(0,P.A)("pf-v5-c-label__actions")},I||H),J=l.createRef(),G=l.useRef(),[Q,U]=l.useState(!1);(0,k.E)((()=>{const e=u?V:J;D||U(e.current&&e.current.offsetWidth<e.current.scrollWidth)}),[D]);const ee=l.createElement(l.Fragment,null,x&&l.createElement("span",{className:(0,P.A)("pf-v5-c-label__icon")},x),l.createElement("span",Object.assign({ref:J,className:(0,P.A)("pf-v5-c-label__text")},E&&{style:{[S]:E}}),t));l.useEffect((()=>{D&&W&&W.current&&W.current.focus()}),[W,D]);let te="span";K?te="a":(u||N&&!L)&&(te="button");const ne={type:"button",onClick:N},ae="button"===te,le=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({className:(0,P.A)(r)},Q&&{tabIndex:0}),K&&{href:K}),K&&m&&{onClick:e=>e.preventDefault()}),ae&&ne),u&&Object.assign({ref:V,onClick:e=>{j(!0),e.stopPropagation()}},d)),Y&&ae&&{disabled:!0}),Y&&K&&{tabIndex:-1,"aria-disabled":!0});let re=l.createElement(te,Object.assign({},le),ee);O?re=l.createElement(l.Fragment,null,Q&&l.createElement(h.m,{triggerRef:G,content:t,position:F}),O({className:r,content:ee,componentRef:G})):Q&&(re=l.createElement(h.m,{content:t,position:F},re));const ie=L?"button":"span";return l.createElement(ie,Object.assign({},q,{className:(0,P.A)("pf-v5-c-label",Y&&v,C[c],"outline"===s&&p,L&&b,o&&i,u&&g,D&&f,n),onClick:L?N:void 0},"button"===ie&&{type:"button"}),!D&&re,!D&&_&&z,D&&l.createElement("input",Object.assign({className:(0,P.A)(r),type:"text",id:"editable-input",ref:W,value:$,onChange:()=>{R(W.current.value)}},d)))};F.displayName="Label"},94279:(e,t,n)=>{n.d(t,{B8:()=>m});var a,l,r,i=n(34629),c=n(63696),s=n(38740),o=n(62634);!function(e){e.number="1",e.lowercaseLetter="a",e.uppercaseLetter="A",e.lowercaseRomanNumber="i",e.uppercaseRomanNumber="I"}(a||(a={})),function(e){e.inline="inline"}(l||(l={})),function(e){e.ol="ol",e.ul="ul"}(r||(r={}));const m=e=>{var{className:t="",children:n=null,variant:l=null,isBordered:m=!1,isPlain:u=!1,iconSize:d="default",type:E=a.number,ref:p=null,component:b=r.ul}=e,f=(0,i.__rest)(e,["className","children","variant","isBordered","isPlain","iconSize","type","ref","component"]);return b===r.ol?c.createElement("ol",Object.assign({ref:p,type:E},u&&{role:"list"},f,{className:(0,o.A)(s.A.list,l&&s.A.modifiers[l],m&&s.A.modifiers.bordered,u&&s.A.modifiers.plain,d&&"large"===d&&s.A.modifiers.iconLg,t)}),n):c.createElement("ul",Object.assign({ref:p},u&&{role:"list"},f,{className:(0,o.A)(s.A.list,l&&s.A.modifiers[l],m&&s.A.modifiers.bordered,u&&s.A.modifiers.plain,d&&"large"===d&&s.A.modifiers.iconLg,t)}),n)};m.displayName="List"},16172:(e,t,n)=>{n.d(t,{c:()=>c});var a=n(34629),l=n(63696),r=n(38740),i=n(62634);const c=e=>{var{icon:t=null,children:n=null}=e,c=(0,a.__rest)(e,["icon","children"]);return l.createElement("li",Object.assign({className:(0,i.A)(t&&r.A.listItem)},c),t&&l.createElement("span",{className:(0,i.A)(r.A.listItemIcon)},t),n)};c.displayName="ListItem"},48783:(e,t,n)=>{n.d(t,{Ay:()=>a});const a=(0,n(32791).w)({name:"DownloadIcon",height:512,width:512,svgPath:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",yOffset:0,xOffset:0})},38139:(e,t,n)=>{n.d(t,{g:()=>c});var a=n(34629),l=n(63696),r=n(62634),i=n(89863);const c=e=>{var{children:t=null}=e,n=(0,a.__rest)(e,["children"]);return l.createElement("div",Object.assign({},n,{className:(0,r.A)(i.A.tableExpandableRowContent)}),t)};c.displayName="ExpandableRowContent"},16177:(e,t,n)=>{n.d(t,{a:()=>r});var a=n(63696),l=n(93962);const r=({value:e})=>a.createElement(a.Fragment,null,Object.entries(e).map((([e,t],n)=>a.createElement(l.J,{key:n,isCompact:!0},`${e}=${t}`))))},27473:(e,t,n)=>{n.d(t,{Y:()=>i});var a=n(63696),l=n(18045),r=n(55399);const i=({vulnerabilitiesSummary:e})=>{const t=a.useMemo((()=>Object.keys(e.severities).map((t=>{const n=t,a=e.severities[n],l=r.Kb[n];return{severity:n,count:a,label:l.name,color:l.color.value}})).sort((0,r.Sx)((e=>e.severity)))),[e]);return a.createElement("div",{style:{height:"230px",maxWidth:"350px"}},a.createElement(l.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${e.total}`,subTitle:"Total vulnerabilities",width:350,legendData:t.map((({label:e,count:t})=>({name:`${e}: ${t}`}))),data:t.map((({label:e,count:t})=>({x:e,y:t}))),labels:({datum:e})=>`${e.x}: ${e.y}`,colorScale:t.map((({color:e})=>e))}))}},89101:(e,t,n)=>{n.d(t,{U:()=>o,n:()=>m});var a=n(63696),l=n(91728);const r=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,i={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:{...i},fixed:{...i},not_affected:{...i},known_not_affected:{...i}}},s=e=>{const t=e.flatMap((e=>(e.status??[]).map((t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))).reduce(((e,t)=>{const n=e.find((e=>r(e,t)));if(n)return[...e.filter((e=>!r(e,n))),{...n,relatedPackages:[...n.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];{const n={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};return[...e,n]}}),[]))),n=t.reduce(((e,t)=>{const n=t.vulnerabilityStatus,a=t.vulnerability.average_severity,l=e.vulnerabilityStatus[n];return{...e,vulnerabilityStatus:{...e.vulnerabilityStatus,[n]:{total:l.total+1,severities:{...l.severities,[a]:l.severities[a]+1}}}}}),c);return{vulnerabilities:t,summary:n}},o=e=>{const{advisories:t,isFetching:n,fetchError:r}=(0,l.DH)(e);return{data:a.useMemo((()=>s(t||[])),[t]),isFetching:n,fetchError:r}},m=e=>{const{advisories:t,isFetching:n,fetchError:r}=(0,l.zY)(e);return{data:a.useMemo((()=>(t??[]).map((e=>s(e||[])))),[t]),isFetching:n,fetchError:r}}},14671:(e,t,n)=>{n.r(t),n.d(t,{default:()=>be});var a=n(63696),l=n(68430),r=n(54518),i=n(48281),c=n(28338),s=n(70045),o=n(1180),m=n(72785),u=n(93962),d=n(77635),E=n(16459),p=n(71592),b=n(40111),f=n(70414),v=n(69673),g=n(10015),y=n(48783),h=n(8210),P=n(80876),T=n(24417),k=n(91271),S=n(91728),C=n(70028),F=n(76072),x=n(97299),_=n(17327),N=n(64361),B=n(71603),A=n(65753),I=n(24974),w=n(21639),M=n(3939),K=n(94279),L=n(16172),O=n(34066);const q=({sbom:e})=>a.createElement(F.x,{hasGutter:!0},a.createElement(x.E,{md:4},a.createElement(_.Z,{isFullHeight:!0},a.createElement(N.Z,null,"Metadata"),a.createElement(B.b,null,a.createElement(A.B,null,a.createElement(I.W,null,a.createElement(w.X,null,"Name"),a.createElement(M.d,null,e.name)),a.createElement(I.W,null,a.createElement(w.X,null,"Namespace"),a.createElement(M.d,null,e.document_id)),a.createElement(I.W,null,a.createElement(w.X,null,"Data License"),a.createElement(M.d,null,e.data_licenses.join(", "))))))),a.createElement(x.E,{md:4},a.createElement(_.Z,{isFullHeight:!0},a.createElement(N.Z,null,"Creation"),a.createElement(B.b,null,a.createElement(A.B,null,a.createElement(I.W,null,a.createElement(w.X,null,"Created"),a.createElement(M.d,null,(0,O.Yq)(e.published))),a.createElement(I.W,null,a.createElement(w.X,null,"Creator"),a.createElement(M.d,null,e.authors)))))),a.createElement(x.E,{md:4},a.createElement(_.Z,{isFullHeight:!0},a.createElement(N.Z,null,"Statistics"),a.createElement(B.b,null,a.createElement(A.B,null,a.createElement(I.W,null,a.createElement(w.X,null,"Size"),a.createElement(M.d,null,(0,C.A)(e.size))),a.createElement(I.W,null,a.createElement(w.X,null,"Packages"),a.createElement(M.d,null,e.number_of_packages)))))),a.createElement(x.E,{md:12},a.createElement(_.Z,{isFullHeight:!0},a.createElement(N.Z,null,"Package"),a.createElement(B.b,null,a.createElement(A.B,null,a.createElement(I.W,null,a.createElement(w.X,null,"Name"),a.createElement(M.d,null,e.name)),a.createElement(I.W,null,a.createElement(w.X,null,"Version"),a.createElement(M.d,null,e.described_by.map((e=>e.version)).join(", "))),a.createElement(I.W,null,a.createElement(w.X,null,"External References"),a.createElement(M.d,null,a.createElement(K.B8,null,e.described_by.flatMap((e=>e.cpe)).map(((e,t)=>a.createElement(L.c,{key:t},e))),a.createElement(L.c,null,e.described_by.flatMap((e=>e.purl)).map((e=>e.purl)))))))))));var D=n(49348),j=n(20653),$=n(35048),R=n(4433),V=n(341),W=n(40319),X=n(16646),Z=n(9425),Y=n(77819),H=n(28516),z=n(3629),J=n(38139),G=n(87043),Q=n(16177),U=n(1349),ee=n(62520),te=n(70611),ne=n(17993);const ae=({sbomId:e})=>{const{result:{data:t},isFetching:n,fetchError:l}=(0,ne.sl)(e,{page:{pageNumber:1,itemsPerPage:0}}),r=(0,a.useMemo)((()=>t.flatMap((e=>e.purl)).map((e=>({...e,decomposedPurl:(0,O.fe)(e.purl)})))),[t]),i=(0,te.vY)({tableName:"package-table",idProperty:"uuid",items:r,isLoading:n,columnNames:{name:"Name",version:"Version",qualifiers:"Qualifiers"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","version"],getSortValues:e=>({name:`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`,version:e.version.version}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter tex",type:G.RJ.search,placeholderText:"Filter",getItemValue:e=>`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`||""}],isExpansionEnabled:!0,expandableVariant:"single"}),{currentPageItems:o,numRenderedColumns:m,propHelpers:{toolbarProps:d,filterToolbarProps:E,paginationToolbarItemProps:p,paginationProps:b,tableProps:f,getThProps:v,getTrProps:g,getTdProps:y,getExpandedContentTdProps:h},expansionDerivedState:{isCellExpanded:P}}=i;return a.createElement(a.Fragment,null,a.createElement(j.M,{...d},a.createElement($.P,null,a.createElement(G.Us,{showFiltersSideBySide:!0,...E}),a.createElement(R.T,{...p},a.createElement(U.n,{idPrefix:"package-table",isTop:!0,paginationProps:b})))),a.createElement(W.X,{...f,"aria-label":"Package table"},a.createElement(X.d,null,a.createElement(Z.Tr,null,a.createElement(ee.Ze,{...i},a.createElement(Y.Th,{...v({columnKey:"name"})}),a.createElement(Y.Th,{...v({columnKey:"version"})}),a.createElement(Y.Th,{...v({columnKey:"qualifiers"})})))),a.createElement(ee.nJ,{isLoading:n,isError:!!l,isNoData:0===r?.length,numRenderedColumns:m},o?.map(((e,t)=>a.createElement(H.N,{key:e.uuid},a.createElement(Z.Tr,{...g({item:e})},a.createElement(ee.Oi,{...i,item:e,rowIndex:t},a.createElement(z.Td,{width:30,...y({columnKey:"name"})},a.createElement(c.s,null,a.createElement(s.Z,{spacer:{default:"spacerSm"}},`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`),a.createElement(s.Z,null,a.createElement(u.J,{isCompact:!0,color:"blue"},e.decomposedPurl?.type)))),a.createElement(z.Td,{width:20,...y({columnKey:"version"})},e.decomposedPurl?.version),a.createElement(z.Td,{width:50,...y({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&a.createElement(Q.a,{value:e.decomposedPurl?.qualifiers})))),P(e)?a.createElement(Z.Tr,{isExpanded:!0},a.createElement(z.Td,null),a.createElement(z.Td,{...h({item:e}),className:V.A.pyLg},a.createElement(J.g,null,a.createElement(A.B,{columnModifier:{default:"3Col"}},a.createElement(I.W,null,a.createElement(w.X,null,"Packages"),a.createElement(M.d,null,a.createElement(K.B8,null,a.createElement(L.c,null,a.createElement(D.N_,{to:`/packages/${e.uuid}`},e.purl))))),a.createElement(I.W,null,a.createElement(w.X,null,"Base package"),a.createElement(M.d,null,e.base.purl)),a.createElement(I.W,null,a.createElement(w.X,null,"Versions"),a.createElement(M.d,null,a.createElement(K.B8,null,a.createElement(L.c,null,e.version.version)))))))):null))))),a.createElement(U.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:b}))};var le=n(95285),re=n.n(le),ie=n(38914),ce=n(57901),se=n(55399),oe=n(27473),me=n(11848),ue=n(23560),de=n(89101),Ee=n(15311);const pe=({sbomId:e})=>{const{sbom:t,isFetching:n,fetchError:l}=(0,S.rj)(e),{data:{vulnerabilities:r,summary:i},isFetching:c,fetchError:s}=(0,de.U)(e),o=a.useMemo((()=>r.filter((e=>"affected"===e.vulnerabilityStatus))),[r]),m=a.useMemo((()=>o.map((e=>{const t=e.relatedPackages.flatMap((e=>e.packages));return{...e,summary:{totalPackages:t.length,allPackages:t}}}))),[o]),u=(0,Ee.f)(m,(e=>`${e.vulnerability.identifier}-${e.vulnerabilityStatus}`)),d=(0,te.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:u,isLoading:c,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>({id:e.vulnerability.identifier,cvss:(0,se.YT)(e.vulnerability.average_severity),affectedDependencies:e.summary.totalPackages,published:e.vulnerability?.published?re()(e.vulnerability.published).valueOf():0,updated:e.vulnerability?.modified?re()(e.vulnerability.modified).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:E,numRenderedColumns:p,propHelpers:{toolbarProps:b,filterToolbarProps:f,paginationToolbarItemProps:v,paginationProps:g,tableProps:y,getThProps:h,getTrProps:P,getTdProps:k,getExpandedContentTdProps:C},expansionDerivedState:{isCellExpanded:N}}=d;return a.createElement(a.Fragment,null,a.createElement(ie.B,{hasGutter:!0},a.createElement(ce.a,null,a.createElement(_.Z,null,a.createElement(B.b,null,a.createElement(T.a,{isFetching:n||c,fetchError:l},a.createElement(F.x,{hasGutter:!0},a.createElement(x.E,{md:6},a.createElement(oe.Y,{vulnerabilitiesSummary:i.vulnerabilityStatus.affected})),a.createElement(x.E,{md:6},a.createElement(A.B,null,a.createElement(I.W,null,a.createElement(w.X,null,"Name"),a.createElement(M.d,null,t?.name)),a.createElement(I.W,null,a.createElement(w.X,null,"Version"),a.createElement(M.d,null,t?.described_by.map((e=>e.version)).join(", "))),a.createElement(I.W,null,a.createElement(w.X,null,"Creation date"),a.createElement(M.d,null,(0,O.Yq)(t?.published)))))))))),a.createElement(ce.a,null,a.createElement(j.M,{...b},a.createElement($.P,null,a.createElement(R.T,{...v},a.createElement(U.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:g})))),a.createElement(W.X,{...y,"aria-label":"Vulnerability table"},a.createElement(X.d,null,a.createElement(Z.Tr,null,a.createElement(ee.Ze,{...d},a.createElement(Y.Th,{...h({columnKey:"id"})}),a.createElement(Y.Th,{...h({columnKey:"description"})}),a.createElement(Y.Th,{...h({columnKey:"cvss"})}),a.createElement(Y.Th,{...h({columnKey:"affectedDependencies"})}),a.createElement(Y.Th,{...h({columnKey:"published"})}),a.createElement(Y.Th,{...h({columnKey:"updated"})})))),a.createElement(ee.nJ,{isLoading:c,isError:!!s,isNoData:0===u.length,numRenderedColumns:p},E?.map(((e,t)=>a.createElement(H.N,{key:e._ui_unique_id,isExpanded:N(e)},a.createElement(Z.Tr,{...P({item:e})},a.createElement(ee.Oi,{...d,item:e,rowIndex:t},a.createElement(z.Td,{width:15,...k({columnKey:"id"})},a.createElement(D.N_,{to:`/vulnerabilities/${e.vulnerability.identifier}`},e.vulnerability.identifier)),a.createElement(z.Td,{width:35,modifier:"truncate",...k({columnKey:"description"})},e.vulnerability&&a.createElement(ue.j,{vulnerability:e.vulnerability})),a.createElement(z.Td,{width:10,...k({columnKey:"cvss"})},e.vulnerability.average_severity&&a.createElement(me.h,{value:e.vulnerability.average_severity})),a.createElement(z.Td,{width:15,modifier:"truncate",...k({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:t})},e.summary.totalPackages),a.createElement(z.Td,{width:10,modifier:"truncate",...k({columnKey:"published"})},(0,O.Yq)(e.vulnerability?.published)),a.createElement(z.Td,{width:10,modifier:"truncate",...k({columnKey:"updated"})},(0,O.Yq)(e.vulnerability?.modified)))),N(e)?a.createElement(Z.Tr,{isExpanded:!0},a.createElement(z.Td,{...C({item:e})},a.createElement(J.g,null,N(e,"affectedDependencies")?a.createElement(a.Fragment,null,a.createElement(W.X,{variant:"compact"},a.createElement(X.d,null,a.createElement(Z.Tr,null,a.createElement(Y.Th,null,"Type"),a.createElement(Y.Th,null,"Namespace"),a.createElement(Y.Th,null,"Name"),a.createElement(Y.Th,null,"Version"),a.createElement(Y.Th,null,"Path"),a.createElement(Y.Th,null,"Qualifiers"))),a.createElement(H.N,null,e.summary.allPackages.flatMap((e=>e.name&&0==e.purl.length?[{parentName:e.name}]:e.purl.map((t=>({...t,parentName:e.name}))))).map(((e,t)=>{if(e.purlSummary){const n=(0,O.fe)(e.purlSummary.purl);return a.createElement(Z.Tr,{key:`${t}-purl`},a.createElement(z.Td,null,n?.type),a.createElement(z.Td,null,n?.namespace),a.createElement(z.Td,null,a.createElement(D.N_,{to:`/packages/${e.purlSummary.uuid}`},n?.name)),a.createElement(z.Td,null,n?.version),a.createElement(z.Td,null,n?.path),a.createElement(z.Td,null,n?.qualifiers&&a.createElement(Q.a,{value:n?.qualifiers})))}return a.createElement(Z.Tr,{key:`${t}-name`},a.createElement(z.Td,null),a.createElement(z.Td,null),a.createElement(z.Td,null,e.parentName),a.createElement(z.Td,null),a.createElement(z.Td,null),a.createElement(z.Td,null))}))))):null))):null))))),a.createElement(U.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:g}))))},be=()=>{const[e,t]=a.useState(0),n=a.createRef(),C=a.createRef(),F=a.createRef(),x=a.createRef(),_=(0,P.Lu)(P.vO.SBOM_ID),{sbom:N,isFetching:B,fetchError:A}=(0,S.rj)(_),{downloadSBOM:I}=(0,k.m)();return a.createElement(a.Fragment,null,a.createElement(l.d8,{variant:"light"},a.createElement(r.B,null,a.createElement(i.o,{isFilled:!0},a.createElement(c.s,null,a.createElement(s.Z,{spacer:{default:"spacerSm"}},a.createElement(o.n,null,a.createElement(m.E,{component:"h1"},N?.name??_??""))),a.createElement(s.Z,null,N?.labels.type&&a.createElement(u.J,{color:"blue"},N?.labels.type)))),a.createElement(i.o,null,!B&&a.createElement(d.$n,{variant:"secondary",icon:a.createElement(y.Ay,null),onClick:()=>{_&&I(_,N?.name?`${N?.name}.json`:`${_}.json`)}},"Download")))),a.createElement(l.d8,{type:"nav"},a.createElement(E.t,{mountOnEnter:!0,activeKey:e,onSelect:(e,n)=>{t(n)},"aria-label":"Tabs that contain the SBOM information",role:"region"},a.createElement(p.o,{eventKey:0,title:a.createElement(b.V,null,"Info"),tabContentId:"refTabInfoSection",tabContentRef:n}),a.createElement(p.o,{eventKey:1,title:a.createElement(b.V,null,"Packages"),tabContentId:"refTabPackagesSection",tabContentRef:C}),a.createElement(p.o,{eventKey:2,title:a.createElement(b.V,null,"Vulnerabilities"),tabContentId:"refVulnerabilitiesSection",tabContentRef:F,actions:a.createElement(a.Fragment,null,a.createElement(f.o,{ref:x},a.createElement(h.Ay,null)),a.createElement(v.A,{triggerRef:x,bodyContent:a.createElement("div",null,"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed.")}))}))),a.createElement(l.d8,null,a.createElement(g.J,{eventKey:0,id:"refTabInfoSection",ref:n,"aria-label":"Information of the SBOM"},a.createElement(T.a,{isFetching:B,fetchError:A},N&&a.createElement(q,{sbom:N}))),a.createElement(g.J,{eventKey:1,id:"refTabPackagesSection",ref:C,"aria-label":"Packages within the SBOM",hidden:!0},_&&a.createElement(ae,{sbomId:_})),a.createElement(g.J,{eventKey:2,id:"refVulnerabilitiesSection",ref:F,"aria-label":"Vulnerabilities within the SBOM",hidden:!0},_&&a.createElement(pe,{sbomId:_}))))}},17993:(e,t,n)=>{n.d(t,{Lx:()=>s,Si:()=>o,sl:()=>m});var a=n(39155),l=n(77347),r=n(40752),i=n(70611);const c="packages",s=(e={},t=!1)=>{const{data:n,isLoading:s,error:o,refetch:m}=(0,a.I)({queryKey:[c,e],queryFn:()=>(0,r.UD)({client:l.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:e},isFetching:s,fetchError:o,refetch:m}},o=e=>{const{data:t,isLoading:n,error:i}=(0,a.I)({queryKey:[c,e],queryFn:()=>(0,r.Y0)({client:l.S,path:{key:e}})});return{pkg:t?.data,isFetching:n,fetchError:i}},m=(e,t={})=>{const{data:n,isLoading:s,error:o,refetch:m}=(0,a.I)({queryKey:[c,"by-sbom",e,t],queryFn:()=>(0,r.Ad)({client:l.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:t},isFetching:s,fetchError:o,refetch:m}}},91728:(e,t,n)=>{n.d(t,{DH:()=>f,Qr:()=>b,i$:()=>d,rj:()=>E,sn:()=>p,zY:()=>v});var a=n(39155),l=n(3715),r=n(55037),i=n(77347),c=n(40752),s=n(24808),o=n(81230),m=n(70611);const u="sboms",d=(e={},t=!1)=>{const{data:n,isLoading:l,error:r,refetch:s}=(0,a.I)({queryKey:[u,e],queryFn:()=>(0,c.z1)({client:i.S,query:{...(0,m.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:e??e},isFetching:l,fetchError:r,refetch:s}},E=e=>{const{data:t,isLoading:n,error:l}=(0,a.I)({queryKey:[u,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,c.a7)({client:i.S,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:n,fetchError:l}},p=()=>{const e=(0,l.jE)();return(0,s.v)({parallel:!0,uploadFn:(e,t)=>(0,o.J4)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[u]})}})},b=(e,t={})=>{const{data:n,isLoading:l,error:r,refetch:s}=(0,a.I)({queryKey:["SBOMsQueryKeysss","by-package",e,t],queryFn:()=>(0,c.m9)({client:i.S,query:{id:e,...(0,m.kd)(t)}})});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:t??t},isFetching:l,fetchError:r,refetch:s}},f=e=>{const{data:t,isLoading:n,error:l}=(0,a.I)({queryKey:[u,e,"advisory"],queryFn:()=>(0,c.bj)({client:i.S,path:{id:e}})});return{advisories:t?.data||[],isFetching:n,fetchError:l}},v=e=>{const t=(0,r.E)({queries:e.map((e=>({queryKey:[u,e,"advisory"],queryFn:()=>(0,c.bj)({client:i.S,path:{id:e}})})))});return{advisories:t.map((({data:e})=>e?.data||[])),isFetching:t.some((({isLoading:e})=>e)),fetchError:t.map((({error:e})=>e))}}},15311:(e,t,n)=>{n.d(t,{f:()=>r});var a=n(63696),l=n(86820);const r=(e,t)=>(0,a.useMemo)((()=>e&&0!==e.length?e.map((e=>({...e,[l.FA]:t(e)}))):[]),[e,t])},38740:(e,t,n)=>{n.d(t,{A:()=>a});const a={list:"pf-v5-c-list",listItem:"pf-v5-c-list__item",listItemIcon:"pf-v5-c-list__item-icon",modifiers:{iconLg:"pf-m-icon-lg",plain:"pf-m-plain",inline:"pf-m-inline",bordered:"pf-m-bordered"}}},70028:(e,t,n)=>{n.d(t,{A:()=>s});const a=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],l=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],r=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],i=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],c=(e,t,n)=>{let a=e;return"string"==typeof t||Array.isArray(t)?a=e.toLocaleString(t,n):!0!==t&&void 0===n||(a=e.toLocaleString(void 0,n)),a};function s(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);const n=(t={bits:!1,binary:!1,space:!0,...t}).bits?t.binary?i:r:t.binary?l:a,s=t.space?" ":"";if(t.signed&&0===e)return` 0${s}${n[0]}`;const o=e<0,m=o?"-":t.signed?"+":"";let u;if(o&&(e=-e),void 0!==t.minimumFractionDigits&&(u={minimumFractionDigits:t.minimumFractionDigits}),void 0!==t.maximumFractionDigits&&(u={maximumFractionDigits:t.maximumFractionDigits,...u}),e<1)return m+c(e,t.locale,u)+s+n[0];const d=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),n.length-1);return e/=(t.binary?1024:1e3)**d,u||(e=e.toPrecision(3)),m+c(Number(e),t.locale,u)+s+n[d]}}}]);
//# sourceMappingURL=417.3649d855.min.js.map