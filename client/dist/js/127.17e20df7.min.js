"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[127],{36284:(e,t,a)=>{a.d(t,{K:()=>o});var r=a(34629),l=a(63696),n=a(45969),i=a(62634);const o=e=>{var{children:t=null,className:a=""}=e,o=(0,r.__rest)(e,["children","className"]);const s=(0,i.A)(n.A.formGroup,n.A.modifiers.action,a),c=l.createElement("div",{className:(0,i.A)(n.A.formActions)},t);return l.createElement("div",Object.assign({},o,{className:s}),l.createElement("div",{className:(0,i.A)(n.A.formGroupControl)},c))};o.displayName="ActionGroup"},46721:(e,t,a)=>{a.d(t,{l:()=>c});var r=a(34629),l=a(63696),n=a(45969),i=a(62634);const o="--pf-v5-c-form--m-limit-width--MaxWidth",s=e=>{var{children:t=null,className:a="",isHorizontal:s=!1,isWidthLimited:c=!1,maxWidth:m="",innerRef:d}=e,u=(0,r.__rest)(e,["children","className","isHorizontal","isWidthLimited","maxWidth","innerRef"]);return l.createElement("form",Object.assign({noValidate:!0},m&&{style:Object.assign({[o]:m},u.style)},u,{className:(0,i.A)(n.A.form,s&&n.A.modifiers.horizontal,(c||m)&&n.A.modifiers.limitWidth,a),ref:d}),t)},c=l.forwardRef(((e,t)=>l.createElement(s,Object.assign({innerRef:t},e))));c.displayName="Form"},40360:(e,t,a)=>{a.d(t,{g:()=>c});var r=a(34629),l=a(63696),n=a(45969),i=a(9721),o=a(62634),s=a(40066);const c=e=>{var{children:t=null,className:a="",label:c,labelInfo:m,labelIcon:d,isRequired:u=!1,isInline:p=!1,hasNoPaddingTop:f=!1,isStack:h=!1,fieldId:g,role:v}=e,E=(0,r.__rest)(e,["children","className","label","labelInfo","labelIcon","isRequired","isInline","hasNoPaddingTop","isStack","fieldId","role"]);const b="group"===v||"radiogroup"===v,y=b?"span":"label",C=l.createElement(l.Fragment,null,l.createElement(y,Object.assign({className:(0,o.A)(n.A.formLabel)},!b&&{htmlFor:g}),l.createElement("span",{className:(0,o.A)(n.A.formLabelText)},c),u&&l.createElement("span",{className:(0,o.A)(n.A.formLabelRequired),"aria-hidden":"true"}," ",i.L))," ",l.isValidElement(d)&&d);return l.createElement(s.N,null,(e=>l.createElement("div",Object.assign({className:(0,o.A)(n.A.formGroup,a)},v&&{role:v},b&&{"aria-labelledby":`${g||e}-legend`},E),c&&l.createElement("div",Object.assign({className:(0,o.A)(n.A.formGroupLabel,m&&n.A.modifiers.info,f&&n.A.modifiers.noPaddingTop)},b&&{id:`${g||e}-legend`}),m&&l.createElement(l.Fragment,null,l.createElement("div",{className:(0,o.A)(n.A.formGroupLabelMain)},C),l.createElement("div",{className:(0,o.A)(n.A.formGroupLabelInfo)},m)),!m&&C),l.createElement("div",{className:(0,o.A)(n.A.formGroupControl,p&&n.A.modifiers.inline,h&&n.A.modifiers.stack)},t))))};c.displayName="FormGroup"},34348:(e,t,a)=>{a.d(t,{I:()=>s});var r=a(34629),l=a(63696);const n={icon:"pf-v5-c-icon",iconContent:"pf-v5-c-icon__content",iconProgress:"pf-v5-c-icon__progress",modifiers:{inline:"pf-m-inline",sm:"pf-m-sm",md:"pf-m-md",lg:"pf-m-lg",xl:"pf-m-xl",inProgress:"pf-m-in-progress",danger:"pf-m-danger",warning:"pf-m-warning",success:"pf-m-success",info:"pf-m-info",custom:"pf-m-custom"},spinner:"pf-v5-c-spinner"};var i=a(62634),o=a(23338);const s=e=>{var{children:t,className:a,progressIcon:s,size:c,iconSize:m,progressIconSize:d,status:u,isInline:p=!1,isInProgress:f=!1,defaultProgressArialabel:h="Loading...",shouldMirrorRTL:g=!1}=e,v=(0,r.__rest)(e,["children","className","progressIcon","size","iconSize","progressIconSize","status","isInline","isInProgress","defaultProgressArialabel","shouldMirrorRTL"]);const E=null!=s?s:l.createElement(o.y,{diameter:"1em","aria-label":h});return l.createElement("span",Object.assign({className:(0,i.A)(n.icon,p&&n.modifiers.inline,f&&n.modifiers.inProgress,n.modifiers[c],a)},v),l.createElement("span",{className:(0,i.A)(n.iconContent,n.modifiers[m],n.modifiers[u],g&&"pf-v5-m-mirror-inline-rtl")},t),f&&l.createElement("span",{className:(0,i.A)(n.iconProgress,n.modifiers[d],a)},E))};s.displayName="Icon"},16177:(e,t,a)=>{a.d(t,{a:()=>n});var r=a(63696),l=a(891);const n=({value:e})=>r.createElement(r.Fragment,null,Object.entries(e).map((([e,t],a)=>r.createElement(l.J,{key:a,isCompact:!0},`${e}=${t}`))))},7602:(e,t,a)=>{a.d(t,{R:()=>c,r:()=>m});var r=a(63696),l=a(87043),n=a(86820),i=a(70611),o=a(5098),s=a(69935);const c=r.createContext({}),m=({children:e})=>{const t=(0,i.MM)({tableName:"advisory",persistenceKeyPrefix:n.rt.advisories,columnNames:{identifier:"ID",title:"Title",severity:"Aggregated Severity",modified:"Revision",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","severity","modified"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:l.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:l.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"modified",title:"Revision",type:l.RJ.dateRange}],isExpansionEnabled:!1}),{result:{data:a,total:m},isFetching:d,fetchError:u}=(0,s.VH)((0,i.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score",modified:"modified"}})),p=(0,i.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:m,isLoading:d,selectionState:(0,o.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return r.createElement(c.Provider,{value:{totalItemCount:m,isFetching:d,fetchError:u,tableControls:p}},e)}},7123:(e,t,a)=>{a.d(t,{q:()=>y});var r=a(63696),l=a(49348),n=a(85578),i=a(16646),o=a(31065),s=a(77819),c=a(28516),m=a(3629),d=a(62101),u=a(50705),p=a(1349),f=a(62520),h=a(91271),g=a(52302),v=a(28644),E=a(34066),b=a(7602);const y=({})=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:y}=r.useContext(b.R),{pushNotification:C}=r.useContext(u.K),{numRenderedColumns:_,currentPageItems:A,propHelpers:{paginationProps:N,tableProps:x,getThProps:S,getTrProps:T,getTdProps:P},expansionDerivedState:{isCellExpanded:I}}=y,{downloadAdvisory:k}=(0,h.m)();return r.createElement(r.Fragment,null,r.createElement(n.X,{...x,"aria-label":"advisory-table"},r.createElement(i.d,null,r.createElement(o.Tr,null,r.createElement(f.Ze,{...y},r.createElement(s.Th,{...S({columnKey:"identifier"})}),r.createElement(s.Th,{...S({columnKey:"title"})}),r.createElement(s.Th,{...S({columnKey:"severity"})}),r.createElement(s.Th,{...S({columnKey:"modified"})}),r.createElement(s.Th,{...S({columnKey:"vulnerabilities"})})))),r.createElement(f.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:_},A.map(((e,t)=>{const a=e.vulnerabilities.reduce(((e,t)=>({...e,[t.severity]:e[t.severity]+1})),{critical:0,high:0,medium:0,low:0,none:0});return r.createElement(c.N,{key:e.identifier,isExpanded:I(e)},r.createElement(o.Tr,{...T({item:e})},r.createElement(f.Oi,{...y,item:e,rowIndex:t},r.createElement(m.Td,{width:15,...P({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},r.createElement(l.k2,{to:`/advisories/${e.uuid}`},e.identifier)),r.createElement(m.Td,{width:40,modifier:"truncate",...P({columnKey:"title"})},e.title),r.createElement(m.Td,{width:15,modifier:"truncate",...P({columnKey:"severity"})},e.average_severity&&r.createElement(g.h,{value:e.average_severity})),r.createElement(m.Td,{width:10,...P({columnKey:"modified"})},(0,E.Yq)(e.modified)),r.createElement(m.Td,{width:20,...P({columnKey:"vulnerabilities"})},r.createElement(v.n,{severities:a})),r.createElement(m.Td,{isActionCell:!0},r.createElement(d.G,{items:[{title:"Download",onClick:()=>{k(e.uuid,`${e.identifier}.json`)}}]})))))})))),r.createElement(p.n,{idPrefix:"advisory-table",isTop:!1,isCompact:!0,paginationProps:N}))}},30426:(e,t,a)=>{a.d(t,{Y:()=>m,a:()=>d});var r=a(63696),l=a(87043),n=a(86820),i=a(70611),o=a(5098),s=a(17993),c=a(34066);const m=r.createContext({}),d=({children:e})=>{const t=(0,i.MM)({tableName:"packages",persistenceKeyPrefix:n.rt.packages,columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:l.RJ.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:l.RJ.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:l.RJ.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:a,total:d},isFetching:u,fetchError:p}=(0,s.Lx)((0,i.Ng)({...t,hubSortFieldKeys:{}})),f=r.useMemo((()=>a.map((e=>({...e,decomposedPurl:(0,c.fe)(e.purl)})))),[a]),h=(0,i.PB)({...t,idProperty:"uuid",currentPageItems:f,totalItemCount:d,isLoading:u,selectionState:(0,o.$)({items:f,isEqual:(e,t)=>e.uuid===t.uuid})});return r.createElement(m.Provider,{value:{totalItemCount:d,isFetching:u,fetchError:p,tableControls:h}},e)}},67475:(e,t,a)=>{a.d(t,{N:()=>N});var r=a(63696),l=a(49348),n=a(85578),i=a(16646),o=a(31065),s=a(77819),c=a(28516),m=a(3629),d=a(16177),u=a(1349),p=a(62520),f=a(1459),h=a(891),g=a(24417),v=a(28644),E=a(77347),b=a(40752),y=a(17993);const C={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},_=({packageId:e})=>{const{summary:t,isFetching:a,fetchError:l}=(e=>{const{pkg:t,isFetching:a,fetchError:l}=(0,y.Si)(e),[n,i]=r.useState([]),[o,s]=r.useState(new Map),[c,m]=r.useState(!1);r.useEffect((()=>{if(!t||0===t.advisories.length)return;const e=(t?.advisories??[]).flatMap((e=>(e.status??[]).map((t=>({vulnerabilityId:t.vulnerability.identifier,status:t.status,advisory:e}))))).filter((e=>"affected"===e.status)).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]);i(e),m(!0),Promise.all(e.map((async e=>(await(0,b.wk)({client:E.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),a=new Map;t.forEach((e=>{a.set(e.identifier,e)})),s(a),m(!1)}))}),[t]);const d=r.useMemo((()=>n.map((e=>({...e,vulnerability:o.get(e.vulnerabilityId)})))),[n,o]),u=r.useMemo((()=>d.reduce(((e,t)=>{if(t.vulnerability?.average_severity){const a=t.vulnerability?.average_severity;return{...e,total:e.total+1,severities:{...e.severities,[a]:e.severities[a]+1}}}return e}),C)),[d]);return{isFetching:a||c,fetchError:l,vulnerabilities:d,summary:u}})(e);return r.createElement(g.a,{isFetching:a,fetchError:l,isFetchingState:r.createElement(f.E,{screenreaderText:"Loading contents"}),fetchErrorState:r.createElement(h.J,{color:"red"},"Error")},r.createElement(v.n,{severities:t.severities}))};var A=a(30426);const N=()=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:f}=r.useContext(A.Y),{numRenderedColumns:h,currentPageItems:g,propHelpers:{paginationProps:v,tableProps:E,getThProps:b,getTrProps:y,getTdProps:C},expansionDerivedState:{isCellExpanded:N}}=f;return r.createElement(r.Fragment,null,r.createElement(n.X,{...E,"aria-label":"Package table"},r.createElement(i.d,null,r.createElement(o.Tr,null,r.createElement(p.Ze,{...f},r.createElement(s.Th,{...b({columnKey:"name"})}),r.createElement(s.Th,{...b({columnKey:"namespace"})}),r.createElement(s.Th,{...b({columnKey:"version"})}),r.createElement(s.Th,{...b({columnKey:"type"})}),r.createElement(s.Th,{...b({columnKey:"path"})}),r.createElement(s.Th,{...b({columnKey:"qualifiers"})}),r.createElement(s.Th,{...b({columnKey:"vulnerabilities"})})))),r.createElement(p.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:h},g.map(((e,t)=>r.createElement(c.N,{key:e.uuid},r.createElement(o.Tr,{...y({item:e})},r.createElement(p.Oi,{...f,item:e,rowIndex:t},r.createElement(m.Td,{width:15,...C({columnKey:"name"})},r.createElement(l.k2,{to:`/packages/${e.uuid}`},e.decomposedPurl?e.decomposedPurl?.name:e.purl)),r.createElement(m.Td,{width:15,modifier:"truncate",...C({columnKey:"namespace"})},e.decomposedPurl?.namespace),r.createElement(m.Td,{width:10,modifier:"truncate",...C({columnKey:"version"})},e.decomposedPurl?.version),r.createElement(m.Td,{width:10,modifier:"truncate",...C({columnKey:"type"})},e.decomposedPurl?.type),r.createElement(m.Td,{width:10,modifier:"truncate",...C({columnKey:"path"})},e.decomposedPurl?.path),r.createElement(m.Td,{width:20,...C({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&r.createElement(d.a,{value:e.decomposedPurl?.qualifiers})),r.createElement(m.Td,{width:20,...C({columnKey:"vulnerabilities"})},r.createElement(_,{packageId:e.uuid}))))))))),r.createElement(u.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:v}))}},39525:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Fe});var r=a(63696),l=a(23665),n=a(68430),i=a(20653),o=a(35048),s=a(56918),c=a(1180),m=a(72785),d=a(4433),u=a(34629),p=a(62634),f=a(77635),h=a(79893),g=a(34348),v=a(905),E=a(32791);const b=(0,E.w)({name:"AngleUpIcon",height:512,width:320,svgPath:"M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z",yOffset:0,xOffset:0});var y=a(53025),C=a(51463),_=a(18189);const A=(0,E.w)({name:"ArrowRightIcon",height:512,width:448,svgPath:"M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z",yOffset:0,xOffset:0});var N=a(40360),x=a(46721),S=a(36284),T=a(23857),P=a(4752),I=a(40066);const k="pf-m-bordered",R="pf-m-raised",F="pf-m-scrollable",w=e=>{var{className:t,children:a,variant:l,isScrollable:n,innerRef:i}=e,o=(0,u.__rest)(e,["className","children","variant","isScrollable","innerRef"]);return r.createElement("div",Object.assign({className:(0,p.A)("pf-v5-c-panel","raised"===l&&R,"bordered"===l&&k,n&&F,t),ref:i},o),a)},K=r.forwardRef(((e,t)=>r.createElement(w,Object.assign({innerRef:t},e))));K.displayName="Panel";const L="--pf-v5-c-panel__main--MaxHeight",O=e=>{var{className:t,children:a,maxHeight:l}=e,n=(0,u.__rest)(e,["className","children","maxHeight"]);return r.createElement("div",Object.assign({className:(0,p.A)("pf-v5-c-panel__main",t),style:{[L]:l}},n),a)};O.displayName="PanelMain";const D=e=>{var{className:t,children:a}=e,l=(0,u.__rest)(e,["className","children"]);return r.createElement("div",Object.assign({className:(0,p.A)("pf-v5-c-panel__main-body",t)},l),a)};D.displayName="PanelMainBody";const M=({className:e,parentRef:t,parentInputRef:a,value:l="",attributes:n=[],formAdditionalItems:i,hasWordsAttrLabel:o="Has words",advancedSearchDelimiter:s,getAttrValueMap:c,onChange:m,onSearch:d,onClear:u,resetButtonLabel:h="Reset",submitSearchButtonLabel:g="Search",isSearchMenuOpen:v,onToggleAdvancedMenu:E})=>{const b=r.useRef(null),[y,C]=r.useState(!1);r.useEffect((()=>{n.length>0&&!s&&console.error("AdvancedSearchMenu: An advancedSearchDelimiter prop is required when advanced search attributes are provided using the attributes prop")})),r.useEffect((()=>{v&&b&&b.current?(b.current.focus(),C(!0)):!v&&y&&a&&a.current&&a.current.focus()}),[v]),r.useEffect((()=>(document.addEventListener("mousedown",_),document.addEventListener("touchstart",_),document.addEventListener("keydown",A),function(){document.removeEventListener("mousedown",_),document.removeEventListener("touchstart",_),document.removeEventListener("keydown",A)})));const _=e=>{const a=t&&t.current.contains(e.target);v&&!a&&E(e)},A=e=>{v&&e.key===P.RU.Escape&&t&&t.current.contains(e.target)&&(E(e),a&&a.current.focus())},k=(e,t,a)=>{const r=c();r[e]=t;let l="";Object.entries(r).forEach((([e,t])=>{if(""!==t.trim()){const a=t.includes(" ")?`'${t.replace(/(^'|'$)/g,"")}'`:t;l="haswords"!==e?`${l} ${e}${s}${a}`:`${l} ${a}`}})),m&&m(a,l.replace(/^\s+/g,""))},R=e=>{const t=c();return t.hasOwnProperty(e)?t[e]:""};return v?r.createElement(K,{variant:"raised",className:(0,p.A)(e)},r.createElement(O,null,r.createElement(D,null,r.createElement(x.l,null,(()=>{const e=[];return n.forEach(((t,a)=>{const l="string"==typeof t?t:t.display,n="string"==typeof t?t:t.attr;0===a?e.push(r.createElement(N.g,{label:l,fieldId:`${n}_${a}`,key:`${t}_${a}`},r.createElement(T.ks,{ref:b,type:"text",id:`${n}_${a}`,value:R(n),onChange:(e,t)=>k(n,t,e)}))):e.push(r.createElement(N.g,{label:l,fieldId:`${n}_${a}`,key:`${t}_${a}`},r.createElement(T.ks,{type:"text",id:`${n}_${a}`,value:R(n),onChange:(e,t)=>k(n,t,e)})))})),e.push(r.createElement(I.N,{key:"hasWords"},(e=>r.createElement(N.g,{label:o,fieldId:e},r.createElement(T.ks,{type:"text",id:e,value:R("haswords"),onChange:(e,t)=>k("haswords",t,e)}))))),e})(),i||null,r.createElement(S.K,null,r.createElement(f.$n,{variant:"primary",type:"submit",onClick:e=>{e.preventDefault(),d&&d(e,l,c()),v&&E(e)},isDisabled:!l},g),!!u&&r.createElement(f.$n,{variant:"link",type:"reset",onClick:u},h)))))):null};M.displayName="SearchInput";var $=a(81643),V=a(4842),B=a(35743),G=a(58897),z=a(17150),j=a(97500),H=a(1760);const q=e=>{var{className:t,searchInputId:a,value:l="",attributes:n=[],formAdditionalItems:i,hasWordsAttrLabel:o="Has words",advancedSearchDelimiter:s,placeholder:c,hint:m,onChange:d,onSearch:E,onClear:N,onToggleAdvancedSearch:x,isAdvancedSearchOpen:S,resultsCount:T,onNextClick:P,onPreviousClick:I,innerRef:k,expandableInput:R,"aria-label":F="Search input",resetButtonLabel:w="Reset",openMenuButtonAriaLabel:K="Open advanced search",previousNavigationButtonAriaLabel:L="Previous",isPreviousNavigationButtonDisabled:O=!1,isNextNavigationButtonDisabled:D=!1,nextNavigationButtonAriaLabel:q="Next",submitSearchButtonLabel:J="Search",isDisabled:W=!1,appendTo:Y,zIndex:X=9999,name:U,areUtilitiesDisplayed:Z}=e,Q=(0,u.__rest)(e,["className","searchInputId","value","attributes","formAdditionalItems","hasWordsAttrLabel","advancedSearchDelimiter","placeholder","hint","onChange","onSearch","onClear","onToggleAdvancedSearch","isAdvancedSearchOpen","resultsCount","onNextClick","onPreviousClick","innerRef","expandableInput","aria-label","resetButtonLabel","openMenuButtonAriaLabel","previousNavigationButtonAriaLabel","isPreviousNavigationButtonDisabled","isNextNavigationButtonDisabled","nextNavigationButtonAriaLabel","submitSearchButtonLabel","isDisabled","appendTo","zIndex","name","areUtilitiesDisplayed"]);const[ee,te]=r.useState(!1),[ae,re]=r.useState(l),le=r.useRef(null),ne=r.useRef(null),ie=k||ne,oe=r.useRef(null),se=r.useRef(null),ce=r.useRef(null),[me,de]=r.useState(!1),{isExpanded:ue,onToggleExpand:pe,toggleAriaLabel:fe}=R||{};r.useEffect((()=>{var e,t;me&&(ue?null===(e=null==ie?void 0:ie.current)||void 0===e||e.focus():null===(t=null==oe?void 0:oe.current)||void 0===t||t.focus(),de(!1))}),[me,ue,ie,oe]),r.useEffect((()=>{re(l)}),[l]),r.useEffect((()=>{n.length>0&&!s&&console.error("An advancedSearchDelimiter prop is required when advanced search attributes are provided using the attributes prop")})),r.useEffect((()=>{te(S)}),[S]);const he=(e,t)=>{d&&d(e,t),re(t)},ge=e=>{const t=!ee;te(t),x&&x(e,t)},ve=e=>{e.preventDefault(),E&&E(e,l,Ee()),te(!1)},Ee=()=>{const e={};return(e=>{let t;return e.match(/\\?.|^$/g).reduce(((e,a)=>("'"===a||'"'===a?(t||(t=a),a===t&&(e.quote=!e.quote)):e.quote||" "!==a?e.a[e.a.length-1]+=a.replace(/\\(.)/,"$1"):e.a.push(""),e)),{a:[""]}).a})(ae).map((t=>{const a=t.split(s);2===a.length?e[a[0]]=a[1].replace(/(^'|'$)/g,""):1===a.length&&(e.haswords=e.hasOwnProperty("haswords")?`${e.haswords} ${a[0]}`:a[0])})),e},be=e=>{"Enter"===e.key&&ve(e)},ye=e=>{N&&N(e),ie&&ie.current&&ie.current.focus()},Ce=l&&(T||!!P&&!!I||!!N&&!R),_e=(e={})=>{var t=(0,u.__rest)(e,[]);return r.createElement($.f,Object.assign({isDisabled:W},t),r.createElement(V.Q,{hint:m,icon:r.createElement(C.Ay,null),innerRef:ie,value:ae,placeholder:c,"aria-label":F,onKeyDown:be,onChange:he,name:U,inputId:a}),(Ce||Z)&&r.createElement(B.N,null,T&&r.createElement(h.E,{isRead:!0},T),!!P&&!!I&&r.createElement("div",{className:H.A.textInputGroupGroup},r.createElement(f.$n,{variant:f.Ak.plain,"aria-label":L,isDisabled:W||O,onClick:I},r.createElement(b,null)),r.createElement(f.$n,{variant:f.Ak.plain,"aria-label":q,isDisabled:W||D,onClick:P},r.createElement(v.Ay,null))),!!N&&!R&&r.createElement(f.$n,{variant:f.Ak.plain,isDisabled:W,"aria-label":w,onClick:ye},r.createElement(y.Ay,null))))},Ae=r.createElement(f.$n,{variant:f.Ak.plain,"aria-label":fe,"aria-expanded":ue,icon:ue?r.createElement(y.Ay,null):r.createElement(C.Ay,null),onClick:e=>{re(""),pe(e,ue),de(!0)},ref:oe}),Ne=(e={})=>{var t=(0,u.__rest)(e,[]);return r.createElement(G.M,Object.assign({ref:se},t),r.createElement(z.b,{isFill:!0},_e()),(n.length>0||x)&&r.createElement(z.b,{isPlain:!0},r.createElement(f.$n,{className:ee&&"pf-m-expanded",variant:f.Ak.control,"aria-label":K,onClick:ge,isDisabled:W,"aria-expanded":ee},r.createElement(_.Ay,null))),!!E&&r.createElement(z.b,null,r.createElement(f.$n,{type:"submit",variant:f.Ak.control,"aria-label":J,onClick:ve,isDisabled:W},r.createElement(g.I,{shouldMirrorRTL:!0},r.createElement(A,null)))),R&&r.createElement(z.b,null,Ae))},xe=Object.assign(Object.assign({},Q),{className:t&&(0,p.A)(t),innerRef:le});if(R&&!ue)return r.createElement(G.M,Object.assign({},xe),r.createElement(z.b,null,Ae));if(E||n.length>0||x){if(n.length>0){const e=r.createElement("div",{ref:ce},r.createElement(M,{value:l,parentRef:le,parentInputRef:ie,onSearch:E,onClear:N,onChange:d,onToggleAdvancedMenu:ge,resetButtonLabel:w,submitSearchButtonLabel:J,attributes:n,formAdditionalItems:i,hasWordsAttrLabel:o,advancedSearchDelimiter:s,getAttrValueMap:Ee,isSearchMenuOpen:ee})),a=r.createElement("div",Object.assign({className:(0,p.A)(t),ref:le},Q),r.createElement(j.N,{trigger:Ne(),triggerRef:se,popper:e,popperRef:ce,isVisible:ee,enableFlip:!0,appendTo:()=>Y||le.current,zIndex:X})),c=r.createElement("div",Object.assign({className:(0,p.A)(t),ref:le},Q),Ne(),e);return"inline"!==Y?a:c}return Ne(Object.assign({},xe))}return((e={})=>{var t=(0,u.__rest)(e,[]);return R?((e={})=>{var t=(0,u.__rest)(e,[]);return r.createElement(G.M,Object.assign({},t),r.createElement(z.b,{isFill:!0},_e()," "),r.createElement(z.b,{isPlain:!0},Ae))})(Object.assign({},t)):_e(Object.assign({},t))})(xe)};q.displayName="SearchInputBase";const J=r.forwardRef(((e,t)=>r.createElement(q,Object.assign({},e,{innerRef:t}))));J.displayName="SearchInput";var W=a(76072),Y=a(97299),X=a(17327),U=a(71603),Z=a(87294),Q=a(71592),ee=a(40111),te=a(70414),ae=a(8210),re=a(38914),le=a(57901),ne=a(87043);const ie=({category:e,filterValue:t,setFilterValue:a,isNumeric:l,isDisabled:n=!1})=>{const[i,o]=r.useState(t?.[0]||"");r.useEffect((()=>{o(t?.[0]||"")}),[t]);const s=()=>{const e=i.trim();a(e?[e.replace(/\s+/g," ")]:[])},c=`${e.categoryKey}-input`;return r.createElement(G.M,null,r.createElement(T.ks,{name:c,id:"search-input",type:l?"number":"search",onChange:(e,t)=>o(t),"aria-label":`${e.title} filter`,value:i,placeholder:e.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||s()},isDisabled:n}),r.createElement(f.$n,{variant:f.Ak.control,id:"search-button","aria-label":"search button for search input",onClick:s,isDisabled:n},r.createElement(C.Ay,null)))},oe="pf-m-standalone",se="pf-m-disabled";var ce=a(1850);class me extends r.Component{constructor(e){super(e),this.handleChange=e=>{this.props.onChange(e,e.currentTarget.checked)},e.label||e["aria-label"]||console.error("Radio:","Radio requires an aria-label to be specified"),this.state={ouiaStateId:(0,ce.X)(me.displayName)}}render(){const e=this.props,{"aria-label":t,checked:a,className:l,inputClassName:n,defaultChecked:i,isLabelWrapped:o,isLabelBeforeButton:s,isChecked:c,isDisabled:m,isValid:d,label:f,onChange:h,description:g,body:v,ouiaId:E,ouiaSafe:b=!0,component:y}=e,C=(0,u.__rest)(e,["aria-label","checked","className","inputClassName","defaultChecked","isLabelWrapped","isLabelBeforeButton","isChecked","isDisabled","isValid","label","onChange","description","body","ouiaId","ouiaSafe","component"]);C.id||console.error("Radio:","id is required to make input accessible");const _=r.createElement("input",Object.assign({},C,{className:(0,p.A)("pf-v5-c-radio__input",n),type:"radio",onChange:this.handleChange,"aria-invalid":!d,disabled:m,checked:a||c},void 0===a&&{defaultChecked:i},!f&&{"aria-label":t},(0,ce.Bs)(me.displayName,void 0!==E?E:this.state.ouiaStateId,b))),A=o&&!y||"label"===y,N=A?"span":"label",x=f?r.createElement(N,{className:(0,p.A)("pf-v5-c-radio__label",m&&se),htmlFor:A?void 0:C.id},f):null,S=null!=y?y:A?"label":"div";return r.createElement(S,{className:(0,p.A)("pf-v5-c-radio",!f&&oe,l),htmlFor:A?C.id:void 0},s?r.createElement(r.Fragment,null,x,_):r.createElement(r.Fragment,null,_,x),g&&r.createElement("span",{className:(0,p.A)("pf-v5-c-radio__description")},g),v&&r.createElement("span",{className:(0,p.A)("pf-v5-c-radio__body")},v))}}me.displayName="Radio",me.defaultProps={className:"",isDisabled:!1,isValid:!0,onChange:()=>{}};const de=({category:e,filterValue:t,setFilterValue:a,isDisabled:l=!1})=>r.createElement(r.Fragment,null,e.selectOptions.map((({label:n,value:i,optionProps:o={}},s)=>{const c=t?.includes(i)||!1;return r.createElement(me,{isDisabled:l,key:s,id:`radio-${s}`,name:"radio",isLabelWrapped:!0,label:n,isChecked:c,onChange:()=>{(t=>{const r=(l=t,e.selectOptions.find((({value:e})=>e===l)));var l;a(r?[t]:null)})(i)}})})));var ue=a(58365);const pe=({category:e,filterValue:t,setFilterValue:a,isDisabled:l=!1})=>{const[n,i]=r.useState(Array.isArray(e.selectOptions)?e.selectOptions:[]);r.useEffect((()=>{i(Array.isArray(e.selectOptions)?e.selectOptions:[])}),[e.selectOptions]);const o=Array.isArray(n)?n:Object.values(n).flatMap((e=>e));return r.createElement(r.Fragment,null,o.map((({label:l,value:n,optionProps:i={}},o)=>r.createElement(ue.S,{key:o,id:`checkbox-${o}-${e.categoryKey}`,isLabelWrapped:!0,label:l,isChecked:t?.includes(n),onChange:()=>{(e=>{if(e&&"No results"!==e){let r;r=t&&t.includes(e)?t.filter((t=>t!==e)):t?[...t,e]:[e],a(r)}})(n)}}))))};var fe=a(86282),he=a(78109),ge=a(66341);const ve=({category:e,filterValue:t,setFilterValue:a,isDisabled:l=!1})=>{const n=t??[],[i,o]=(n?.filter((e=>(0,ge.Ce)((0,ge.P1)(e)))),(0,r.useState)()),[s,c]=(0,r.useState)();return r.useEffect((()=>{if(t?.[0]){const[e,a]=(0,ge.P1)(t?.[0]);o(e.toDate()),c(a.toDate())}else o(void 0),c(void 0)}),[t]),r.createElement(x.l,null,r.createElement(N.g,{role:"group",isInline:!0,label:"From"},r.createElement(fe.l,{value:i?(0,ge.ak)(i):"",dateFormat:ge.ak,dateParse:ge.sy,onChange:(e,t)=>{(0,ge.Fz)(t)&&(o((0,ge.sy)(t)),c(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:l})),r.createElement(N.g,{role:"group",isInline:!0,label:"To"},r.createElement(fe.l,{value:s?(0,ge.ak)(s):"",onChange:(e,t)=>{if((0,ge.Fz)(t)){const e=(0,ge.sy)(t);c(e);const r=(0,ge.Kg)(i,e);r&&a([r])}},isDisabled:l||!(0,he.v)(i),dateFormat:ge.ak,dateParse:ge.sy,invalidFormatText:"",rangeStart:i,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})))},Ee=({category:e,...t})=>e.type===ne.RJ.select?r.createElement(de,{category:e,...t}):e.type===ne.RJ.search||e.type===ne.RJ.numsearch?r.createElement(ie,{category:e,isNumeric:e.type===ne.RJ.numsearch,...t}):e.type===ne.RJ.multiselect?r.createElement(pe,{category:e,...t}):e.type===ne.RJ.dateRange?r.createElement(ve,{category:e,...t}):null,be=({filterCategories:e,filterValues:t,setFilterValues:a,isDisabled:l=!1,omitFilterCategoryKeys:n=[]})=>r.createElement(r.Fragment,null,r.createElement(re.B,{hasGutter:!0},r.createElement(le.a,null,r.createElement(f.$n,{variant:"link",isInline:!0,onClick:()=>{const r=e.filter((e=>void 0===n.find((t=>t===e.categoryKey)))).reduce(((e,t)=>({...e,[t.categoryKey]:void 0})),{});a({...t,...r})}},"Clear all filters")),e.filter((e=>void 0===n.find((t=>t===e.categoryKey)))).map((e=>r.createElement(le.a,{key:e.categoryKey},r.createElement(re.B,{hasGutter:!0},r.createElement(le.a,null,r.createElement(c.n,null,r.createElement(m.E,{component:"h4"},e.title))),r.createElement(le.a,null,r.createElement(Ee,{category:e,filterValue:t[e.categoryKey],setFilterValue:r=>((e,r)=>a({...t,[e.categoryKey]:r}))(e,r),isDisabled:l,isSidebar:!0}))))))));var ye=a(30426),Ce=a(36390),_e=a(14310),Ae=a(7602);function Ne(e,t){return{Component:e,props:t}}const xe=[Ne(Ce.c,{}),Ne(ye.a,{}),Ne(_e.y,{}),Ne(Ae.r,{})],Se=(Te=xe,({children:e})=>{const t=r.createElement(r.Fragment,null,e);return Te.reduceRight(((e,{Component:t,props:a={}})=>r.createElement(t,{...a},e)),t)});var Te,Pe=a(67475),Ie=a(59013),ke=a(1159),Re=a(7123);const Fe=()=>r.createElement(Se,null,r.createElement(we,null)),we=()=>{const{tableControls:e}=r.useContext(Ce.L),{tableControls:t}=r.useContext(ye.Y),{tableControls:a}=r.useContext(_e.u),{tableControls:u}=r.useContext(Ae.R),{totalItemCount:p,tableControls:{propHelpers:{filterPanelProps:f}}}=r.useContext(Ce.L),{totalItemCount:g,tableControls:{propHelpers:{filterPanelProps:v}}}=r.useContext(ye.Y),{totalItemCount:E,tableControls:{propHelpers:{filterPanelProps:b}}}=r.useContext(_e.u),{totalItemCount:y,tableControls:{propHelpers:{filterPanelProps:C}}}=r.useContext(Ae.R),[_,A]=r.useState(""),[N,x]=r.useState(0),S=r.createRef();return r.createElement(r.Fragment,null,r.createElement(n.d8,{variant:n.zC.light},r.createElement(i.M,{isStatic:!0},r.createElement(o.P,null,r.createElement(s.$,{align:{default:"alignLeft"}},r.createElement(c.n,null,r.createElement(m.E,{component:"h1"},"Search"))),r.createElement(s.$,{variant:"icon-button-group",align:{default:"alignRight"}},r.createElement(s.$,{visibility:{default:"hidden",lg:"visible"}},r.createElement(d.T,{widths:{default:"500px"}},r.createElement(J,{placeholder:"Search for an SBOM, Package, or Vulnerability",value:_,onChange:(e,t)=>(e=>{A(e)})(t),onClear:()=>{A("")},onKeyDown:r=>{r.key&&"Enter"!==r.key||(e.filterState.setFilterValues({...e.filterState.filterValues,"":[_]}),t.filterState.setFilterValues({...t.filterState.filterValues,"":[_]}),a.filterState.setFilterValues({...a.filterState.filterValues,"":[_]}),u.filterState.setFilterValues({...u.filterState.filterValues,"":[_]}))}}))))))),r.createElement(n.d8,null,r.createElement(W.x,{hasGutter:!0},r.createElement(Y.E,{md:2},r.createElement(X.Z,{isFullHeight:!0},r.createElement(U.b,null,0===N?r.createElement(be,{omitFilterCategoryKeys:[""],...f}):1===N?r.createElement(be,{omitFilterCategoryKeys:[""],...v}):2===N?r.createElement(be,{omitFilterCategoryKeys:[""],...b}):3===N?r.createElement(be,{omitFilterCategoryKeys:[""],...C}):null))),r.createElement(Y.E,{md:10},r.createElement(Z.t,{isBox:!0,activeKey:N,onSelect:(e,t)=>{x(t)},"aria-label":"Tabs",role:"region"},r.createElement(Q.o,{eventKey:0,title:r.createElement(ee.V,null,"SBOMs","  ",r.createElement(h.E,{screenReaderText:"Search Result Count"},p)),actions:r.createElement(r.Fragment,null,r.createElement(te.o,{"aria-label":"SBOM help popover",ref:S},r.createElement(ae.Ay,null)),(T=S,r.createElement(l.A,{bodyContent:r.createElement("div",null,"Software Bill of Materials for Products and Containers."),position:"right",triggerRef:T})))},r.createElement(Ie.Y,null)),r.createElement(Q.o,{eventKey:1,title:r.createElement(ee.V,null,"Packages","  ",r.createElement(h.E,{screenReaderText:"Search Result Count"},g))},r.createElement(Pe.N,null)),r.createElement(Q.o,{eventKey:2,title:r.createElement(ee.V,null,"Vulnerabilities","  ",r.createElement(h.E,{screenReaderText:"Search Result Count"},E))},r.createElement(ke.f,null)),r.createElement(Q.o,{eventKey:3,title:r.createElement(ee.V,null,"Advisories","  ",r.createElement(h.E,{screenReaderText:"Advisory Result Count"},E))},r.createElement(Re.q,null)))))));var T}},14310:(e,t,a)=>{a.d(t,{u:()=>c,y:()=>m});var r=a(63696),l=a(87043),n=a(86820),i=a(70611),o=a(5098),s=a(74932);const c=r.createContext({}),m=({children:e})=>{const t=(0,i.MM)({tableName:"vulnerability",persistenceKeyPrefix:n.rt.vulnerabilities,columnNames:{identifier:"ID",title:"Description",severity:"CVSS",published:"Date published",sboms:"Related documents"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:l.RJ.search},{categoryKey:"average_severity",title:"CVSS",placeholderText:"CVSS",type:l.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:a,total:m},isFetching:d,fetchError:u}=(0,s.WJ)((0,i.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score"}})),p=(0,i.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:m,isLoading:d,selectionState:(0,o.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return r.createElement(c.Provider,{value:{totalItemCount:m,isFetching:d,fetchError:u,tableControls:p}},e)}},1159:(e,t,a)=>{a.d(t,{f:()=>g});var r=a(63696),l=a(49348),n=a(85578),i=a(16646),o=a(31065),s=a(77819),c=a(28516),m=a(3629),d=(a(24417),a(52302)),u=a(1349),p=a(62520),f=(a(74932),a(34066)),h=(a(65636),a(14310));const g=()=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:g}=r.useContext(h.u),{numRenderedColumns:v,currentPageItems:E,propHelpers:{paginationProps:b,tableProps:y,getThProps:C,getTrProps:_,getTdProps:A}}=g;return r.createElement(r.Fragment,null,r.createElement(n.X,{...y,"aria-label":"Vulnerability table"},r.createElement(i.d,null,r.createElement(o.Tr,null,r.createElement(p.Ze,{...g},r.createElement(s.Th,{...C({columnKey:"identifier"})}),r.createElement(s.Th,{...C({columnKey:"title"})}),r.createElement(s.Th,{...C({columnKey:"severity"})}),r.createElement(s.Th,{...C({columnKey:"published"})}),r.createElement(s.Th,{...C({columnKey:"sboms"})})))),r.createElement(p.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:v},E.map(((e,t)=>r.createElement(c.N,{key:e.identifier},r.createElement(o.Tr,{..._({item:e})},r.createElement(p.Oi,{...g,item:e,rowIndex:t},r.createElement(m.Td,{width:15,...A({columnKey:"identifier",item:e,rowIndex:t})},r.createElement(l.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),r.createElement(m.Td,{width:45,modifier:"truncate",...A({columnKey:"title"})},e.title||e.description),r.createElement(m.Td,{width:10,...A({columnKey:"severity"})},e.average_severity&&r.createElement(d.h,{value:e.average_severity})),r.createElement(m.Td,{width:10,...A({columnKey:"published"})},(0,f.Yq)(e.published)),r.createElement(m.Td,{width:10,...A({columnKey:"sboms",item:e,rowIndex:t})},"X")))))))),r.createElement(u.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:b}))}},45969:(e,t,a)=>{a.d(t,{A:()=>r});const r={dirRtl:"pf-v5-m-dir-rtl",form:"pf-v5-c-form",formActions:"pf-v5-c-form__actions",formFieldGroup:"pf-v5-c-form__field-group",formFieldGroupBody:"pf-v5-c-form__field-group-body",formFieldGroupHeader:"pf-v5-c-form__field-group-header",formFieldGroupHeaderActions:"pf-v5-c-form__field-group-header-actions",formFieldGroupHeaderDescription:"pf-v5-c-form__field-group-header-description",formFieldGroupHeaderMain:"pf-v5-c-form__field-group-header-main",formFieldGroupHeaderTitle:"pf-v5-c-form__field-group-header-title",formFieldGroupHeaderTitleText:"pf-v5-c-form__field-group-header-title-text",formFieldGroupToggle:"pf-v5-c-form__field-group-toggle",formFieldGroupToggleButton:"pf-v5-c-form__field-group-toggle-button",formFieldGroupToggleIcon:"pf-v5-c-form__field-group-toggle-icon",formFieldset:"pf-v5-c-form__fieldset",formGroup:"pf-v5-c-form__group",formGroupControl:"pf-v5-c-form__group-control",formGroupLabel:"pf-v5-c-form__group-label",formGroupLabelHelp:"pf-v5-c-form__group-label-help",formGroupLabelInfo:"pf-v5-c-form__group-label-info",formGroupLabelMain:"pf-v5-c-form__group-label-main",formHelperText:"pf-v5-c-form__helper-text",formHelperTextIcon:"pf-v5-c-form__helper-text-icon",formLabel:"pf-v5-c-form__label",formLabelRequired:"pf-v5-c-form__label-required",formLabelText:"pf-v5-c-form__label-text",formSection:"pf-v5-c-form__section",formSectionTitle:"pf-v5-c-form__section-title",modifiers:{horizontal:"pf-m-horizontal",alignRight:"pf-m-align-right",noPaddingTop:"pf-m-no-padding-top",info:"pf-m-info",horizontalOnXs:"pf-m-horizontal-on-xs",horizontalOnSm:"pf-m-horizontal-on-sm",horizontalOnMd:"pf-m-horizontal-on-md",horizontalOnLg:"pf-m-horizontal-on-lg",horizontalOnXl:"pf-m-horizontal-on-xl",horizontalOn_2xl:"pf-m-horizontal-on-2xl",limitWidth:"pf-m-limit-width",action:"pf-m-action",disabled:"pf-m-disabled",inline:"pf-m-inline",stack:"pf-m-stack",error:"pf-m-error",success:"pf-m-success",warning:"pf-m-warning",inactive:"pf-m-inactive",hidden:"pf-m-hidden",expanded:"pf-m-expanded"},themeDark:"pf-v5-theme-dark"}}}]);
//# sourceMappingURL=127.17e20df7.min.js.map