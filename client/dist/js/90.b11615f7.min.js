"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[90],{16177:(e,t,l)=>{l.d(t,{a:()=>r});var n=l(63696),a=l(93962);const r=({value:e})=>n.createElement(n.Fragment,null,Object.entries(e).map((([e,t],l)=>n.createElement(a.J,{key:l,isCompact:!0},`${e}=${t}`))))},14671:(e,t,l)=>{l.r(t),l.d(t,{default:()=>se});var n=l(63696),a=l(68430),r=l(54518),i=l(48281),c=l(28338),m=l(70045),o=l(1180),s=l(72785),u=l(93962),d=l(77635),E=l(16459),p=l(71592),b=l(40111),h=l(70414),f=l(69673),g=l(10015),y=l(48783),v=l(8210),T=l(80876),P=l(24417),x=l(91271),C=l(91728),S=l(17327),K=l(71603),I=l(76072),k=l(97299),w=l(65753),$=l(24974),F=l(21639),N=l(3939),V=l(55399),_=l(34066);const B=({sbom:e})=>n.createElement(S.Z,null,n.createElement(K.b,null,n.createElement(I.x,{hasGutter:!0},n.createElement(k.E,{md:6},n.createElement(w.B,{columnModifier:{default:"2Col"}},n.createElement($.W,null,n.createElement(F.X,null,"Name"),n.createElement(N.d,null,e.name)),n.createElement($.W,null,n.createElement(F.X,null,"Author"),n.createElement(N.d,null,e.authors)),n.createElement($.W,null,n.createElement(F.X,null,"Published"),n.createElement(N.d,null,(0,_.Yq)(e.published))))))));var M=l(49348),O=l(20653),q=l(35048),R=l(4433),D=l(94279),X=l(16172),A=l(341),J=l(40319),W=l(16646),Z=l(9425),j=l(77819),L=l(28516),Y=l(3629),G=l(38139),H=l(87043),U=l(16177),Q=l(1349),z=l(62520),ee=l(70611),te=l(17993);const le=({sbomId:e})=>{const{result:{data:t},isFetching:l,fetchError:a}=(0,te.sl)(e,{page:{pageNumber:1,itemsPerPage:0}}),r=(0,n.useMemo)((()=>t.flatMap((e=>e.purl)).map((e=>({...e,decomposedPurl:(0,_.fe)(e.purl)})))),[t]),i=(0,ee.vY)({tableName:"package-table",idProperty:"uuid",items:r,isLoading:l,columnNames:{name:"Name",version:"Version",qualifiers:"Qualifiers"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","version"],getSortValues:e=>({name:`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`,version:e.version.version}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter tex",type:H.RJ.search,placeholderText:"Filter",getItemValue:e=>`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`||""}],isExpansionEnabled:!0,expandableVariant:"single"}),{currentPageItems:o,numRenderedColumns:s,propHelpers:{toolbarProps:d,filterToolbarProps:E,paginationToolbarItemProps:p,paginationProps:b,tableProps:h,getThProps:f,getTrProps:g,getTdProps:y,getExpandedContentTdProps:v},expansionDerivedState:{isCellExpanded:T}}=i;return n.createElement(n.Fragment,null,n.createElement(O.M,{...d},n.createElement(q.P,null,n.createElement(H.Us,{showFiltersSideBySide:!0,...E}),n.createElement(R.T,{...p},n.createElement(Q.n,{idPrefix:"package-table",isTop:!0,paginationProps:b})))),n.createElement(J.X,{...h,"aria-label":"Package table"},n.createElement(W.d,null,n.createElement(Z.Tr,null,n.createElement(z.Ze,{...i},n.createElement(j.Th,{...f({columnKey:"name"})}),n.createElement(j.Th,{...f({columnKey:"version"})}),n.createElement(j.Th,{...f({columnKey:"qualifiers"})})))),n.createElement(z.nJ,{isLoading:l,isError:!!a,isNoData:0===r?.length,numRenderedColumns:s},o?.map(((e,t)=>n.createElement(L.N,{key:e.uuid},n.createElement(Z.Tr,{...g({item:e})},n.createElement(z.Oi,{...i,item:e,rowIndex:t},n.createElement(Y.Td,{width:30,...y({columnKey:"name"})},n.createElement(c.s,null,n.createElement(m.Z,{spacer:{default:"spacerSm"}},`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`),n.createElement(m.Z,null,n.createElement(u.J,{isCompact:!0,color:"blue"},e.decomposedPurl?.type)))),n.createElement(Y.Td,{width:20,...y({columnKey:"version"})},e.decomposedPurl?.version),n.createElement(Y.Td,{width:50,...y({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&n.createElement(U.a,{value:e.decomposedPurl?.qualifiers})))),T(e)?n.createElement(Z.Tr,{isExpanded:!0},n.createElement(Y.Td,null),n.createElement(Y.Td,{...v({item:e}),className:A.A.pyLg},n.createElement(G.g,null,n.createElement(w.B,{columnModifier:{default:"3Col"}},n.createElement($.W,null,n.createElement(F.X,null,"Packages"),n.createElement(N.d,null,n.createElement(D.B8,null,n.createElement(X.c,null,n.createElement(M.N_,{to:`/packages/${e.uuid}`},e.purl))))),n.createElement($.W,null,n.createElement(F.X,null,"Base package"),n.createElement(N.d,null,e.base.purl)),n.createElement($.W,null,n.createElement(F.X,null,"Versions"),n.createElement(N.d,null,n.createElement(D.B8,null,n.createElement(X.c,null,e.version.version)))))))):null))))),n.createElement(Q.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:b}))};var ne=l(51257),ae=l(38914),re=l(57901),ie=l(52302),ce=l(89101),me=l(15311);const oe=({sbomId:e})=>{const{sbom:t,isFetching:l,fetchError:a}=(0,C.rj)(e),{vulnerabilities:r,summary:i,isFetching:c,fetchError:m}=(0,ce.U)(e),o=(0,me.f)(r,(e=>`${e.vulnerabilityId}-${e.advisory.identifier}-${e.advisory.uuid}`)),s=(0,ee.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:o,isLoading:c,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id"],isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:u,numRenderedColumns:d,propHelpers:{toolbarProps:E,filterToolbarProps:p,paginationToolbarItemProps:b,paginationProps:h,tableProps:f,getThProps:g,getTrProps:y,getTdProps:v,getExpandedContentTdProps:T},expansionDerivedState:{isCellExpanded:x}}=s,B=n.useMemo((()=>Object.keys(i.severities).map((e=>{const t=e,l=i.severities[t],n=V.Kb[t];return{severity:t,count:l,label:n.name,color:n.color.value}})).sort((0,V.Sx)((e=>e.severity)))),[i]);return n.createElement(n.Fragment,null,n.createElement(ae.B,{hasGutter:!0},n.createElement(re.a,null,n.createElement(S.Z,null,n.createElement(K.b,null,n.createElement(P.a,{isFetching:c||l},n.createElement(I.x,{hasGutter:!0},n.createElement(k.E,{md:6},n.createElement("div",{style:{height:"230px",width:"350px"}},n.createElement(ne.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${i.total}`,subTitle:"Total vulnerabilities",width:350,legendData:B.map((({label:e,count:t})=>({name:`${e}: ${t}`}))),data:B.map((({label:e,count:t})=>({x:e,y:t}))),labels:({datum:e})=>`${e.x}: ${e.y}`,colorScale:B.map((({color:e})=>e))}))),n.createElement(k.E,{md:6},n.createElement(w.B,null,n.createElement($.W,null,n.createElement(F.X,null,"Name"),n.createElement(N.d,null,t?.name)),n.createElement($.W,null,n.createElement(F.X,null,"Version"),n.createElement(N.d,null,t?.described_by.map((e=>e.version)).join(", "))),n.createElement($.W,null,n.createElement(F.X,null,"Creation date"),n.createElement(N.d,null,(0,_.Yq)(t?.published)))))))))),n.createElement(re.a,null,n.createElement(O.M,{...E},n.createElement(q.P,null,n.createElement(R.T,{...b},n.createElement(Q.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:h})))),n.createElement(J.X,{...f,"aria-label":"Vulnerability table"},n.createElement(W.d,null,n.createElement(Z.Tr,null,n.createElement(z.Ze,{...s},n.createElement(j.Th,{...g({columnKey:"id"})}),n.createElement(j.Th,{...g({columnKey:"description"})}),n.createElement(j.Th,{...g({columnKey:"cvss"})}),n.createElement(j.Th,{...g({columnKey:"affectedDependencies"})}),n.createElement(j.Th,{...g({columnKey:"published"})}),n.createElement(j.Th,{...g({columnKey:"updated"})})))),n.createElement(z.nJ,{isLoading:c,isError:!!m,isNoData:0===o.length,numRenderedColumns:d},u?.map(((e,t)=>n.createElement(L.N,{key:e._ui_unique_id,isExpanded:x(e)},n.createElement(Z.Tr,{...y({item:e})},n.createElement(z.Oi,{...s,item:e,rowIndex:t},n.createElement(Y.Td,{width:15,...v({columnKey:"id"})},n.createElement(M.N_,{to:`/vulnerabilities/${e.vulnerabilityId}`},e.vulnerabilityId)),n.createElement(Y.Td,{width:35,modifier:"truncate",...v({columnKey:"description"})},e.vulnerability?.title||e.vulnerability?.description),n.createElement(Y.Td,{width:10,...v({columnKey:"cvss"})},e.vulnerability?.average_severity&&n.createElement(ie.h,{value:e.vulnerability.average_severity})),n.createElement(Y.Td,{width:15,modifier:"truncate",...v({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:t})},e.packages.length),n.createElement(Y.Td,{width:10,modifier:"truncate",...v({columnKey:"published"})},(0,_.Yq)(e.vulnerability?.published)),n.createElement(Y.Td,{width:10,modifier:"truncate",...v({columnKey:"updated"})},(0,_.Yq)(e.vulnerability?.modified)))),x(e)?n.createElement(Z.Tr,{isExpanded:!0},n.createElement(Y.Td,{...T({item:e})},n.createElement(G.g,null,x(e,"affectedDependencies")?n.createElement(n.Fragment,null,n.createElement(J.X,{variant:"compact"},n.createElement(W.d,null,n.createElement(Z.Tr,null,n.createElement(j.Th,null,"Type"),n.createElement(j.Th,null,"Namespace"),n.createElement(j.Th,null,"Name"),n.createElement(j.Th,null,"Version"),n.createElement(j.Th,null,"Path"),n.createElement(j.Th,null,"Qualifiers"))),n.createElement(L.N,null,e.packages.flatMap((e=>e.purl)).map(((e,t)=>{const l=(0,_.fe)(e.purl);return n.createElement(Z.Tr,{key:t},n.createElement(Y.Td,null,l?.type),n.createElement(Y.Td,null,l?.namespace),n.createElement(Y.Td,null,l?.name),n.createElement(Y.Td,null,l?.version),n.createElement(Y.Td,null,l?.path),n.createElement(Y.Td,null,l?.qualifiers&&n.createElement(U.a,{value:l?.qualifiers})))}))))):null))):null))))),n.createElement(Q.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:h}))))},se=()=>{const[e,t]=n.useState(0),l=n.createRef(),S=n.createRef(),K=n.createRef(),I=n.createRef(),k=(0,T.Lu)(T.vO.SBOM_ID),{sbom:w,isFetching:$,fetchError:F}=(0,C.rj)(k),{downloadSBOM:N}=(0,x.m)();return n.createElement(n.Fragment,null,n.createElement(a.d8,{variant:"light"},n.createElement(r.B,null,n.createElement(i.o,{isFilled:!0},n.createElement(c.s,null,n.createElement(m.Z,{spacer:{default:"spacerSm"}},n.createElement(o.n,null,n.createElement(s.E,{component:"h1"},w?.name??k??""))),n.createElement(m.Z,null,w?.labels.type&&n.createElement(u.J,{color:"blue"},w?.labels.type)))),n.createElement(i.o,null,!$&&n.createElement(d.$n,{variant:"secondary",icon:n.createElement(y.Ay,null),onClick:()=>{k&&N(k,w?.name?`${w?.name}.json`:`${k}.json`)}},"Download")))),n.createElement(a.d8,{type:"nav"},n.createElement(E.t,{mountOnEnter:!0,activeKey:e,onSelect:(e,l)=>{t(l)},"aria-label":"Tabs that contain the SBOM information",role:"region"},n.createElement(p.o,{eventKey:0,title:n.createElement(b.V,null,"Info"),tabContentId:"refTabInfoSection",tabContentRef:l}),n.createElement(p.o,{eventKey:1,title:n.createElement(b.V,null,"Packages"),tabContentId:"refTabPackagesSection",tabContentRef:S}),n.createElement(p.o,{eventKey:2,title:n.createElement(b.V,null,"Vulnerabilities"),tabContentId:"refVulnerabilitiesSection",tabContentRef:K,actions:n.createElement(n.Fragment,null,n.createElement(h.o,{ref:I},n.createElement(v.Ay,null)),n.createElement(f.A,{triggerRef:I,bodyContent:n.createElement("div",null,"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed.")}))}))),n.createElement(a.d8,null,n.createElement(g.J,{eventKey:0,id:"refTabInfoSection",ref:l,"aria-label":"Information of the SBOM"},n.createElement(P.a,{isFetching:$,fetchError:F},w&&n.createElement(B,{sbom:w}))),n.createElement(g.J,{eventKey:1,id:"refTabPackagesSection",ref:S,"aria-label":"Packages within the SBOM",hidden:!0},k&&n.createElement(le,{sbomId:k})),n.createElement(g.J,{eventKey:2,id:"refVulnerabilitiesSection",ref:K,"aria-label":"Vulnerabilities within the SBOM",hidden:!0},k&&n.createElement(oe,{sbomId:k}))))}},15311:(e,t,l)=>{l.d(t,{f:()=>r});var n=l(63696),a=l(86820);const r=(e,t)=>(0,n.useMemo)((()=>e&&0!==e.length?e.map((e=>({...e,[a.FA]:t(e)}))):[]),[e,t])}}]);
//# sourceMappingURL=90.b11615f7.min.js.map