"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[395],{55399:(e,t,a)=>{a.d(t,{Kb:()=>c,Sx:()=>d,YT:()=>s});var n=a(44304),l=a(19174),r=a(53820),i=a(8742),o=a(53359);const c={none:{name:"None",color:n.p,progressProps:{variant:void 0}},low:{name:"Low",color:l.n,progressProps:{variant:void 0}},medium:{name:"Medium",color:r.H,progressProps:{variant:"warning"}},high:{name:"High",color:i.u,progressProps:{variant:"danger"}},critical:{name:"Critical",color:o.c,progressProps:{variant:"danger"}}},s=e=>{switch(e){case"low":return 1;case"medium":return 2;case"high":return 3;case"critical":return 4;default:return 0}};function d(e){return(t,a)=>s(e(t))-s(e(a))}},81230:(e,t,a)=>{a.d(t,{J4:()=>d,hP:()=>s});var n=a(64917),l=a(86820);a(63260);const r="/api",i=r+"/v1/advisory",o=r+"/v1/sbom",c=e=>{let t="application/json";return(e.name.endsWith(".bz2")||e.name.endsWith(".gz"))&&(t="application/json+bzip2"),t},s=(e,t)=>{const a=e.get(l.fs);return n.A.post(`${i}`,a,{...t,headers:{"Content-Type":c(a)}})},d=(e,t)=>{const a=e.get(l.fs);return n.A.post(`${o}`,a,{...t,headers:{"Content-Type":c(a)}})}},24417:(e,t,a)=>{a.d(t,{a:()=>o});var n=a(63696),l=a(59394),r=a(99135),i=a(75855);const o=e=>e.isFetching?e.isFetchingState||n.createElement(l.a,null,n.createElement(r.y,null)):e.fetchError?e.fetchErrorState||n.createElement(i.q,null):e.children},16177:(e,t,a)=>{a.d(t,{a:()=>r});var n=a(63696),l=a(891);const r=({value:e})=>n.createElement(n.Fragment,null,Object.entries(e).map((([e,t],a)=>n.createElement(l.J,{key:a,isCompact:!0},`${e}=${t}`))))},52302:(e,t,a)=>{a.d(t,{h:()=>s});var n=a(63696),l=a(28338),r=a(70045),i=a(26615),o=a(93914),c=a(55399);const s=({value:e,hideLabel:t})=>{const a=c.Kb[e],s=e.charAt(0).toUpperCase()+e.slice(1);return n.createElement(l.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},n.createElement(r.Z,null,t?n.createElement(i.m,{content:s},n.createElement(o.Ay,{color:a.color.value})):n.createElement(o.Ay,{color:a.color.value})),!t&&n.createElement(r.Z,null,s))}},1349:(e,t,a)=>{a.d(t,{n:()=>r});var n=a(63696),l=a(84348);const r=({paginationProps:e,isTop:t,isCompact:a=!1,noMargin:r=!1,idPrefix:i=""})=>n.createElement(l.d,{id:`${i?`${i}-`:""}pagination-${t?"top":"bottom"}`,variant:t?l.A.top:l.A.bottom,isCompact:a,...e,widgetId:"pagination-id"})},75855:(e,t,a)=>{a.d(t,{q:()=>d});var n=a(63696),l=a(63863),r=a(97157),i=a(2408),o=a(92411),c=a(60087),s=a(45960);const d=()=>n.createElement(l.p,{variant:l.s.sm},n.createElement(r.q,{icon:c.Ay,color:s.D.value}),n.createElement(i.h,{headingLevel:"h2",size:"lg"},"Unable to connect"),n.createElement(o.h,null,"There was an error retrieving data. Check your connection and try again."))},62520:(e,t,a)=>{a.d(t,{nJ:()=>f,Ze:()=>b,Oi:()=>v});var n=a(63696),l=a(59394),r=a(99135),i=a(28516),o=a(9425),c=a(3629),s=a(75855),d=a(63863),u=a(97157),m=a(2408),p=a(92411),E=a(28469);const h=({title:e,description:t})=>n.createElement(d.p,{variant:d.s.sm},n.createElement(u.q,{icon:E.Ay}),n.createElement(m.h,{headingLevel:"h2",size:"lg"},e),t&&n.createElement(p.h,null,t)),y=()=>n.createElement(h,{title:"No data available",description:"No data available to be shown here."}),f=({numRenderedColumns:e,isLoading:t=!1,isError:a=!1,isNoData:d=!1,errorEmptyState:u=null,noDataEmptyState:m=null,children:p})=>n.createElement(n.Fragment,null,t?n.createElement(i.N,null,n.createElement(o.Tr,null,n.createElement(c.Td,{colSpan:e},n.createElement(l.a,null,n.createElement(r.y,{size:"xl"}))))):a?n.createElement(i.N,{"aria-label":"Table error"},n.createElement(o.Tr,null,n.createElement(c.Td,{colSpan:e},n.createElement(l.a,null,u||n.createElement(s.q,null))))):d?n.createElement(i.N,{"aria-label":"Table error"},n.createElement(o.Tr,null,n.createElement(c.Td,{colSpan:e},n.createElement(l.a,null,m||n.createElement(y,null))))):p);var g=a(77819);const b=({numColumnsBeforeData:e,numColumnsAfterData:t,children:a})=>n.createElement(n.Fragment,null,Array(e).fill(null).map(((e,t)=>n.createElement(g.Th,{screenReaderText:`before-data-${t}`,key:t}))),a,Array(t).fill(null).map(((e,t)=>n.createElement(g.Th,{screenReaderText:`after-data-${t}`,key:t})))),v=({isExpansionEnabled:e=!1,expandableVariant:t,isSelectionEnabled:a=!1,propHelpers:{getSingleExpandButtonTdProps:l,getSelectCheckboxTdProps:r},item:i,rowIndex:o,children:s})=>n.createElement(n.Fragment,null,e&&"single"===t?n.createElement(c.Td,{...l({item:i,rowIndex:o})}):null,a?n.createElement(c.Td,{...r({item:i,rowIndex:o})}):null,s)},91271:(e,t,a)=>{a.d(t,{m:()=>i});var n=a(22249),l=a(77347),r=a(40752);const i=()=>({downloadAdvisory:(e,t)=>{(0,r.Mu)({client:l.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,n.saveAs)(new Blob([a.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,r.K0)({client:l.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,n.saveAs)(new Blob([a.data]),t||`${e}.json`)}))}})},4878:(e,t,a)=>{a.d(t,{r:()=>c});var n=a(63696),l=a(77347),r=a(40752),i=a(91728);const o={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},c=e=>{const{advisories:t,isFetching:a,fetchError:c}=(0,i.DH)(e),[s,d]=n.useState([]),[u,m]=n.useState(new Map),[p,E]=n.useState(!1);n.useEffect((()=>{if(0===t.length)return;const e=(t??[]).flatMap((e=>(e.status??[]).map((t=>({vulnerabilityId:t.vulnerability_id,status:t.status,packages:t.packages||[],advisory:{...e}}))))).filter((e=>"affected"===e.status)).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]);d(e),E(!0),Promise.all(e.map((async e=>(await(0,r.wk)({client:l.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),a=new Map;t.forEach((e=>{a.set(e.identifier,e)})),m(a),E(!1)}))}),[t]);const h=n.useMemo((()=>s.map((e=>({...e,vulnerability:u.get(e.vulnerabilityId)})))),[s,u]),y=n.useMemo((()=>h.reduce(((e,t)=>{if(t.vulnerability?.average_severity){const a=t.vulnerability?.average_severity;return{...e,total:e.total+1,severities:{...e.severities,[a]:e.severities[a]+1}}}return e}),o)),[h]);return{isFetching:a||p,fetchError:c,vulnerabilities:h,summary:y}}},24808:(e,t,a)=>{a.d(t,{v:()=>c});var n=a(63696),l=a(64917),r=a(86820);const i="cancelled",o=(e,t)=>{switch(t.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},status:"queued",cancelFn:t.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},progress:t.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",response:t.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",error:t.payload.error,wasCancelled:t.payload.error?.message===i})};case"removeUpload":{const a=new Map(e.uploads);return a.delete(t.payload.file),{...e,uploads:a}}default:throw new Error}},c=({parallel:e,uploadFn:t,onSuccess:a,onError:c})=>{const[s,d]=n.useReducer(o,{uploads:new Map});return{uploads:s.uploads,handleUpload:n=>{const o=[];for(let e=0;e<n.length;e++){const t=n[e],s=new FormData;s.set(r.fs,t);const u=l.A.CancelToken.source(),m={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{const a=e.total??1,n=e.loaded/a*100;d({type:"updateUploadProgress",payload:{file:t,progress:Math.round(n)}})},cancelToken:u.token};d({type:"queueUpload",payload:{file:t,cancelFn:u}});const p={formData:s,config:m,thenFn:e=>{d({type:"finishUploadSuccessfully",payload:{file:t,response:e}}),a&&a(e,t)},catchFn:e=>{d({type:"finishUploadWithError",payload:{file:t,error:e}}),e.message!==i&&c&&c(e,t)}};o.push(p)}e?o.forEach((e=>{t(e.formData,e.config).then(e.thenFn).catch(e.catchFn)})):o.reduce((async(e,a)=>(await e,t(a.formData,a.config).then(a.thenFn).catch(a.catchFn))),Promise.resolve())},handleCancelUpload:e=>{s.uploads.get(e)?.cancelFn?.cancel(i)},handleRemoveUpload:e=>{d({type:"removeUpload",payload:{file:e}})}}}},14671:(e,t,a)=>{a.r(t),a.d(t,{default:()=>de});var n=a(63696),l=a(68430),r=a(54518),i=a(48281),o=a(28338),c=a(70045),s=a(1180),d=a(72785),u=a(891),m=a(77635),p=a(16459),E=a(71592),h=a(40111),y=a(70414),f=a(69673),g=a(10015),b=a(48783),v=a(8210),T=a(80876),P=a(24417),S=a(91271),w=a(91728),F=a(17327),C=a(71603),x=a(76072),I=a(97299),q=a(65753),k=a(24974),K=a(21639),M=a(3939),$=a(55399),A=a(34066);const N=({sbom:e})=>n.createElement(F.Z,null,n.createElement(C.b,null,n.createElement(x.x,{hasGutter:!0},n.createElement(I.E,{md:6},n.createElement(q.B,{columnModifier:{default:"2Col"}},n.createElement(k.W,null,n.createElement(K.X,null,"Name"),n.createElement(M.d,null,e.name)),n.createElement(k.W,null,n.createElement(K.X,null,"Author"),n.createElement(M.d,null,e.authors)),n.createElement(k.W,null,n.createElement(K.X,null,"Published"),n.createElement(M.d,null,(0,A.Yq)(e.published))))))));var D=a(49348),B=a(20653),_=a(35048),L=a(4433),R=a(94279),U=a(16172),V=a(341),O=a(40319),j=a(16646),W=a(9425),X=a(77819),J=a(28516),Z=a(3629),H=a(38139),Y=a(87043),z=a(16177),Q=a(1349),G=a(62520),ee=a(70611),te=a(17993);const ae=({sbomId:e})=>{const{result:{data:t},isFetching:a,fetchError:l}=(0,te.sl)(e,{page:{pageNumber:1,itemsPerPage:0}}),r=(0,n.useMemo)((()=>t.flatMap((e=>e.purl)).map((e=>({...e,decomposedPurl:(0,A.fe)(e.purl)})))),[t]),i=(0,ee.vY)({tableName:"package-table",idProperty:"uuid",items:r,isLoading:a,columnNames:{name:"Name",version:"Version",qualifiers:"Qualifiers"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","version"],getSortValues:e=>({name:`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`,version:e.version.version}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter tex",type:Y.RJ.search,placeholderText:"Filter",getItemValue:e=>`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`||""}],isExpansionEnabled:!0,expandableVariant:"single"}),{currentPageItems:s,numRenderedColumns:d,propHelpers:{toolbarProps:m,filterToolbarProps:p,paginationToolbarItemProps:E,paginationProps:h,tableProps:y,getThProps:f,getTrProps:g,getTdProps:b,getExpandedContentTdProps:v},expansionDerivedState:{isCellExpanded:T}}=i;return n.createElement(n.Fragment,null,n.createElement(B.M,{...m},n.createElement(_.P,null,n.createElement(Y.Us,{showFiltersSideBySide:!0,...p}),n.createElement(L.T,{...E},n.createElement(Q.n,{idPrefix:"package-table",isTop:!0,paginationProps:h})))),n.createElement(O.X,{...y,"aria-label":"Package table"},n.createElement(j.d,null,n.createElement(W.Tr,null,n.createElement(G.Ze,{...i},n.createElement(X.Th,{...f({columnKey:"name"})}),n.createElement(X.Th,{...f({columnKey:"version"})}),n.createElement(X.Th,{...f({columnKey:"qualifiers"})})))),n.createElement(G.nJ,{isLoading:a,isError:!!l,isNoData:0===r?.length,numRenderedColumns:d},s?.map(((e,t)=>n.createElement(J.N,{key:e.uuid},n.createElement(W.Tr,{...g({item:e})},n.createElement(G.Oi,{...i,item:e,rowIndex:t},n.createElement(Z.Td,{width:30,...b({columnKey:"name"})},n.createElement(o.s,null,n.createElement(c.Z,{spacer:{default:"spacerSm"}},`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`),n.createElement(c.Z,null,n.createElement(u.J,{isCompact:!0,color:"blue"},e.decomposedPurl?.type)))),n.createElement(Z.Td,{width:20,...b({columnKey:"version"})},e.decomposedPurl?.version),n.createElement(Z.Td,{width:50,...b({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&n.createElement(z.a,{value:e.decomposedPurl?.qualifiers})))),T(e)?n.createElement(W.Tr,{isExpanded:!0},n.createElement(Z.Td,null),n.createElement(Z.Td,{...v({item:e}),className:V.A.pyLg},n.createElement(H.g,null,n.createElement(q.B,{columnModifier:{default:"3Col"}},n.createElement(k.W,null,n.createElement(K.X,null,"Packages"),n.createElement(M.d,null,n.createElement(R.B8,null,n.createElement(U.c,null,n.createElement(D.N_,{to:`/packages/${e.uuid}`},e.purl))))),n.createElement(k.W,null,n.createElement(K.X,null,"Base package"),n.createElement(M.d,null,e.base.purl)),n.createElement(k.W,null,n.createElement(K.X,null,"Versions"),n.createElement(M.d,null,n.createElement(R.B8,null,n.createElement(U.c,null,e.version.version)))))))):null))))),n.createElement(Q.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:h}))};var ne=a(51257),le=a(38914),re=a(57901),ie=a(52302),oe=a(4878),ce=a(15311);const se=({sbomId:e})=>{const{sbom:t,isFetching:a,fetchError:l}=(0,w.rj)(e),{vulnerabilities:r,summary:i,isFetching:o,fetchError:c}=(0,oe.r)(e),s=(0,ce.f)(r,(e=>`${e.vulnerabilityId}-${e.advisory.identifier}-${e.advisory.uuid}`)),d=(0,ee.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:s,isLoading:o,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id"],isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:u,numRenderedColumns:m,propHelpers:{toolbarProps:p,filterToolbarProps:E,paginationToolbarItemProps:h,paginationProps:y,tableProps:f,getThProps:g,getTrProps:b,getTdProps:v,getExpandedContentTdProps:T},expansionDerivedState:{isCellExpanded:S}}=d,N=n.useMemo((()=>Object.keys(i.severities).map((e=>{const t=e,a=i.severities[t],n=$.Kb[t];return{severity:t,count:a,label:n.name,color:n.color.value}})).sort((0,$.Sx)((e=>e.severity)))),[i]);return n.createElement(n.Fragment,null,n.createElement(le.B,{hasGutter:!0},n.createElement(re.a,null,n.createElement(F.Z,null,n.createElement(C.b,null,n.createElement(P.a,{isFetching:o||a},n.createElement(x.x,{hasGutter:!0},n.createElement(I.E,{md:6},n.createElement("div",{style:{height:"230px",width:"350px"}},n.createElement(ne.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${i.total}`,subTitle:"Total vulnerabilities",width:350,legendData:N.map((({label:e,count:t})=>({name:`${e}: ${t}`}))),data:N.map((({label:e,count:t})=>({x:e,y:t}))),labels:({datum:e})=>`${e.x}: ${e.y}`,colorScale:N.map((({color:e})=>e))}))),n.createElement(I.E,{md:6},n.createElement(q.B,null,n.createElement(k.W,null,n.createElement(K.X,null,"Name"),n.createElement(M.d,null,t?.name)),n.createElement(k.W,null,n.createElement(K.X,null,"Version"),n.createElement(M.d,null,t?.described_by.map((e=>e.version)).join(", "))),n.createElement(k.W,null,n.createElement(K.X,null,"Creation date"),n.createElement(M.d,null,(0,A.Yq)(t?.published)))))))))),n.createElement(re.a,null,n.createElement(B.M,{...p},n.createElement(_.P,null,n.createElement(L.T,{...h},n.createElement(Q.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:y})))),n.createElement(O.X,{...f,"aria-label":"Vulnerability table"},n.createElement(j.d,null,n.createElement(W.Tr,null,n.createElement(G.Ze,{...d},n.createElement(X.Th,{...g({columnKey:"id"})}),n.createElement(X.Th,{...g({columnKey:"description"})}),n.createElement(X.Th,{...g({columnKey:"cvss"})}),n.createElement(X.Th,{...g({columnKey:"affectedDependencies"})}),n.createElement(X.Th,{...g({columnKey:"published"})}),n.createElement(X.Th,{...g({columnKey:"updated"})})))),n.createElement(G.nJ,{isLoading:o,isError:!!c,isNoData:0===s.length,numRenderedColumns:m},u?.map(((e,t)=>n.createElement(J.N,{key:e._ui_unique_id,isExpanded:S(e)},n.createElement(W.Tr,{...b({item:e})},n.createElement(G.Oi,{...d,item:e,rowIndex:t},n.createElement(Z.Td,{width:15,...v({columnKey:"id"})},n.createElement(D.N_,{to:`/vulnerabilities/${e.vulnerabilityId}`},e.vulnerabilityId)),n.createElement(Z.Td,{width:35,modifier:"truncate",...v({columnKey:"description"})},e.vulnerability?.title||e.vulnerability?.description),n.createElement(Z.Td,{width:10,...v({columnKey:"cvss"})},e.vulnerability?.average_severity&&n.createElement(ie.h,{value:e.vulnerability.average_severity})),n.createElement(Z.Td,{width:15,modifier:"truncate",...v({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:t})},e.packages.length),n.createElement(Z.Td,{width:10,modifier:"truncate",...v({columnKey:"published"})},(0,A.Yq)(e.vulnerability?.published)),n.createElement(Z.Td,{width:10,modifier:"truncate",...v({columnKey:"updated"})},(0,A.Yq)(e.vulnerability?.modified)))),S(e)?n.createElement(W.Tr,{isExpanded:!0},n.createElement(Z.Td,{...T({item:e})},n.createElement(H.g,null,S(e,"affectedDependencies")?n.createElement(n.Fragment,null,n.createElement(O.X,{variant:"compact"},n.createElement(j.d,null,n.createElement(W.Tr,null,n.createElement(X.Th,null,"Type"),n.createElement(X.Th,null,"Namespace"),n.createElement(X.Th,null,"Name"),n.createElement(X.Th,null,"Version"),n.createElement(X.Th,null,"Path"),n.createElement(X.Th,null,"Qualifiers"))),n.createElement(J.N,null,e.packages.flatMap((e=>e.purl)).map(((e,t)=>{const a=(0,A.fe)(e.purl);return n.createElement(W.Tr,{key:t},n.createElement(Z.Td,null,a?.type),n.createElement(Z.Td,null,a?.namespace),n.createElement(Z.Td,null,a?.name),n.createElement(Z.Td,null,a?.version),n.createElement(Z.Td,null,a?.path),n.createElement(Z.Td,null,a?.qualifiers&&n.createElement(z.a,{value:a?.qualifiers})))}))))):null))):null))))),n.createElement(Q.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:y}))))},de=()=>{const[e,t]=n.useState(0),a=n.createRef(),F=n.createRef(),C=n.createRef(),x=n.createRef(),I=(0,T.Lu)(T.vO.SBOM_ID),{sbom:q,isFetching:k,fetchError:K}=(0,w.rj)(I),{downloadSBOM:M}=(0,S.m)();return n.createElement(n.Fragment,null,n.createElement(l.d8,{variant:"light"},n.createElement(r.B,null,n.createElement(i.o,{isFilled:!0},n.createElement(o.s,null,n.createElement(c.Z,{spacer:{default:"spacerSm"}},n.createElement(s.n,null,n.createElement(d.E,{component:"h1"},q?.name??I??""))),n.createElement(c.Z,null,q?.labels.type&&n.createElement(u.J,{color:"blue"},q?.labels.type)))),n.createElement(i.o,null,!k&&n.createElement(m.$n,{variant:"secondary",icon:n.createElement(b.Ay,null),onClick:()=>{I&&M(I,q?.name?`${q?.name}.json`:`${I}.json`)}},"Download")))),n.createElement(l.d8,{type:"nav"},n.createElement(p.t,{mountOnEnter:!0,activeKey:e,onSelect:(e,a)=>{t(a)},"aria-label":"Tabs that contain the SBOM information",role:"region"},n.createElement(E.o,{eventKey:0,title:n.createElement(h.V,null,"Info"),tabContentId:"refTabInfoSection",tabContentRef:a}),n.createElement(E.o,{eventKey:1,title:n.createElement(h.V,null,"Packages"),tabContentId:"refTabPackagesSection",tabContentRef:F}),n.createElement(E.o,{eventKey:2,title:n.createElement(h.V,null,"Vulnerabilities"),tabContentId:"refVulnerabilitiesSection",tabContentRef:C,actions:n.createElement(n.Fragment,null,n.createElement(y.o,{ref:x},n.createElement(v.Ay,null)),n.createElement(f.A,{triggerRef:x,bodyContent:n.createElement("div",null,"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed.")}))}))),n.createElement(l.d8,null,n.createElement(g.J,{eventKey:0,id:"refTabInfoSection",ref:a,"aria-label":"Information of the SBOM"},n.createElement(P.a,{isFetching:k,fetchError:K},q&&n.createElement(N,{sbom:q}))),n.createElement(g.J,{eventKey:1,id:"refTabPackagesSection",ref:F,"aria-label":"Packages within the SBOM",hidden:!0},I&&n.createElement(ae,{sbomId:I})),n.createElement(g.J,{eventKey:2,id:"refVulnerabilitiesSection",ref:C,"aria-label":"Vulnerabilities within the SBOM",hidden:!0},I&&n.createElement(se,{sbomId:I}))))}},17993:(e,t,a)=>{a.d(t,{Lx:()=>c,Si:()=>s,sl:()=>d});var n=a(7616),l=a(77347),r=a(40752),i=a(70611);const o="packages",c=(e={},t=!1)=>{const{data:a,isLoading:c,error:s,refetch:d}=(0,n.I)({queryKey:[o,e],queryFn:()=>(0,r.UD)({client:l.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e},isFetching:c,fetchError:s,refetch:d}},s=e=>{const{data:t,isLoading:a,error:i}=(0,n.I)({queryKey:[o,e],queryFn:()=>(0,r.Y0)({client:l.S,path:{key:e}})});return{pkg:t?.data,isFetching:a,fetchError:i}},d=(e,t={})=>{const{data:a,isLoading:c,error:s,refetch:d}=(0,n.I)({queryKey:[o,"by-sbom",e,t],queryFn:()=>(0,r.Ad)({client:l.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:t},isFetching:c,fetchError:s,refetch:d}}},91728:(e,t,a)=>{a.d(t,{DH:()=>f,Qr:()=>y,i$:()=>m,l6:()=>E,rj:()=>p,sn:()=>h});var n=a(7616),l=a(3715),r=a(26667),i=a(77347),o=a(40752),c=a(24808),s=a(81230),d=a(70611);const u="sboms",m=(e={},t=!1)=>{const{data:a,isLoading:l,error:r,refetch:c}=(0,n.I)({queryKey:[u,e],queryFn:()=>(0,o.z1)({client:i.S,query:{...(0,d.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e??e},isFetching:l,fetchError:r,refetch:c}},p=e=>{const{data:t,isLoading:a,error:l}=(0,n.I)({queryKey:[u,e],queryFn:()=>(0,o.a7)({client:i.S,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:a,fetchError:l}},E=(e,t)=>{const a=(0,l.jE)();return(0,r.n)({mutationFn:async e=>(await(0,o.bS)({client:i.S,path:{id:e}})).data,onSuccess:(t,n)=>{e(t,n),a.invalidateQueries({queryKey:[u]})},onError:t})},h=()=>{const e=(0,l.jE)();return(0,c.v)({parallel:!0,uploadFn:(e,t)=>(0,s.J4)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[u]})}})},y=(e,t={})=>{const{data:a,isLoading:l,error:r,refetch:c}=(0,n.I)({queryKey:[u,"by-package",e,t],queryFn:()=>(0,o.m9)({client:i.S,query:{id:e,...(0,d.kd)(t)}})});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:t??t},isFetching:l,fetchError:r,refetch:c}},f=e=>{const{data:t,isLoading:a,error:l}=(0,n.I)({queryKey:[u,e,"advisory"],queryFn:()=>(0,o.bj)({client:i.S,path:{id:e}})});return{advisories:t?.data||[],isFetching:a,fetchError:l}}},15311:(e,t,a)=>{a.d(t,{f:()=>r});var n=a(63696),l=a(86820);const r=(e,t)=>(0,n.useMemo)((()=>e&&0!==e.length?e.map((e=>({...e,[l.FA]:t(e)}))):[]),[e,t])}}]);
//# sourceMappingURL=395.b12bedc2.min.js.map