"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[586],{13506:(e,t,l)=>{l.d(t,{T:()=>i});var a=l(63696),r=l(77635),n=l(33364);const i=({isOpen:e,title:t,titleIconVariant:l,message:i,confirmBtnLabel:o,cancelBtnLabel:c,inProgress:s,confirmBtnVariant:m,onClose:u,onConfirm:d,onCancel:E})=>{const p=a.createElement(r.$n,{id:"confirm-dialog-button",key:"confirm","aria-label":"confirm",variant:m,isDisabled:s,onClick:d},o),y=E?a.createElement(r.$n,{key:"cancel",id:"confirm-cancel-button","aria-label":"cancel",variant:r.Ak.link,isDisabled:s,onClick:E},c):void 0;return a.createElement(n.a,{id:"confirm-dialog",variant:n.d.small,title:t,titleIconVariant:l,isOpen:e,onClose:u,"aria-label":"Confirm dialog",actions:E?[p,y]:[p]},i)}},23713:(e,t,l)=>{l.d(t,{m:()=>i});var a=l(77347),r=l(40752),n=l(22249);const i=()=>({downloadAdvisory:(e,t)=>{(0,r.Mu)({client:a.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((l=>{(0,n.saveAs)(new Blob([l.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,r.K0)({client:a.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((l=>{(0,n.saveAs)(new Blob([l.data]),t||`${e}.json`)}))}})},24596:(e,t,l)=>{l.d(t,{r:()=>c});var a=l(77347),r=l(40752),n=l(91728),i=l(63696);const o={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},c=e=>{const{advisories:t,isFetching:l,fetchError:c}=(0,n.DH)(e),[s,m]=i.useState([]),[u,d]=i.useState(new Map),[E,p]=i.useState(!1);i.useEffect((()=>{if(0===t.length)return;const e=(t??[]).flatMap((e=>(e.status??[]).map((t=>({vulnerabilityId:t.vulnerability_id,status:t.status,packages:t.packages||[],advisory:{...e}}))))).filter((e=>"affected"===e.status)).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]);m(e),p(!0),Promise.all(e.map((async e=>(await(0,r.wk)({client:a.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),l=new Map;t.forEach((e=>{l.set(e.identifier,e)})),d(l),p(!1)}))}),[t]);const y=i.useMemo((()=>s.map((e=>({...e,vulnerability:u.get(e.vulnerabilityId)})))),[s,u]),h=i.useMemo((()=>y.reduce(((e,t)=>{if(t.vulnerability?.average_severity){const l=t.vulnerability?.average_severity;return{...e,total:e.total+1,severities:{...e.severities,[l]:e.severities[l]+1}}}return e}),o)),[y]);return{isFetching:l||E,fetchError:c,vulnerabilities:y,summary:h}}},30426:(e,t,l)=>{l.d(t,{Y:()=>m,a:()=>u});var a=l(63696),r=l(87043),n=l(86820),i=l(70611),o=l(5098),c=l(17993),s=l(34066);const m=a.createContext({}),u=({children:e})=>{const t=(0,i.MM)({tableName:"packages",persistenceKeyPrefix:n.rt.packages,columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:r.RJ.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:r.RJ.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:l,total:u},isFetching:d,fetchError:E}=(0,c.Lx)((0,i.Ng)({...t,hubSortFieldKeys:{}})),p=a.useMemo((()=>l.map((e=>({...e,decomposedPurl:(0,s.fe)(e.purl)})))),[l]),y=(0,i.PB)({...t,idProperty:"uuid",currentPageItems:p,totalItemCount:u,isLoading:d,selectionState:(0,o.$)({items:p,isEqual:(e,t)=>e.uuid===t.uuid})});return a.createElement(m.Provider,{value:{totalItemCount:u,isFetching:d,fetchError:E,tableControls:y}},e)}},32059:(e,t,l)=>{l.d(t,{N:()=>y});var a=l(63696),r=l(49348),n=l(85578),i=l(16646),o=l(31065),c=l(77819),s=l(28516),m=l(3629),u=l(1349),d=l(62520),E=l(16177),p=l(30426);const y=()=>{const{isFetching:e,fetchError:t,totalItemCount:l,tableControls:y}=a.useContext(p.Y),{numRenderedColumns:h,currentPageItems:g,propHelpers:{paginationProps:b,tableProps:f,getThProps:v,getTrProps:C,getTdProps:T},expansionDerivedState:{isCellExpanded:P}}=y;return a.createElement(a.Fragment,null,a.createElement(n.X,{...f,"aria-label":"Package table"},a.createElement(i.d,null,a.createElement(o.Tr,null,a.createElement(d.Ze,{...y},a.createElement(c.Th,{...v({columnKey:"name"})}),a.createElement(c.Th,{...v({columnKey:"namespace"})}),a.createElement(c.Th,{...v({columnKey:"version"})}),a.createElement(c.Th,{...v({columnKey:"type"})}),a.createElement(c.Th,{...v({columnKey:"path"})}),a.createElement(c.Th,{...v({columnKey:"qualifiers"})})))),a.createElement(d.nJ,{isLoading:e,isError:!!t,isNoData:0===l,numRenderedColumns:h},g.map(((e,t)=>a.createElement(s.N,{key:e.uuid},a.createElement(o.Tr,{...C({item:e})},a.createElement(d.Oi,{...y,item:e,rowIndex:t},a.createElement(m.Td,{width:15,...T({columnKey:"name"})},a.createElement(r.k2,{to:`/packages/${e.uuid}`},e.decomposedPurl?e.decomposedPurl?.name:e.purl)),a.createElement(m.Td,{width:15,modifier:"truncate",...T({columnKey:"namespace"})},e.decomposedPurl?.namespace),a.createElement(m.Td,{width:15,modifier:"truncate",...T({columnKey:"version"})},e.decomposedPurl?.version),a.createElement(m.Td,{width:10,modifier:"truncate",...T({columnKey:"type"})},e.decomposedPurl?.type),a.createElement(m.Td,{width:10,modifier:"truncate",...T({columnKey:"path"})},e.decomposedPurl?.path),a.createElement(m.Td,{width:40,...T({columnKey:"path"})},e.decomposedPurl?.qualifiers&&a.createElement(E.a,{value:e.decomposedPurl?.qualifiers}))))))))),a.createElement(u.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:b}))}},36390:(e,t,l)=>{l.d(t,{L:()=>s,c:()=>m});var a=l(63696),r=l(87043),n=l(86820),i=l(70611),o=l(5098),c=l(91728);const s=a.createContext({}),m=({children:e})=>{const t=(0,i.MM)({tableName:"sbom",persistenceKeyPrefix:n.rt.sboms,columnNames:{name:"Name",version:"Version",supplier:"Supplier",published:"Created on",packages:"Dependencies",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["published"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"published",title:"Created on",type:r.RJ.dateRange}],isExpansionEnabled:!1}),{result:{data:l,total:m},isFetching:u,fetchError:d}=(0,c.i$)((0,i.Ng)({...t,hubSortFieldKeys:{published:"published"}})),E=(0,i.PB)({...t,idProperty:"id",currentPageItems:l,totalItemCount:m,isLoading:u,selectionState:(0,o.$)({items:l,isEqual:(e,t)=>e.id===t.id})});return a.createElement(s.Provider,{value:{totalItemCount:m,isFetching:u,fetchError:d,tableControls:E}},e)}},50382:(e,t,l)=>{l.d(t,{Y:()=>R});var a=l(63696),r=l(49348),n=l(77635),i=l(85578),o=l(16646),c=l(31065),s=l(77819),m=l(28516),u=l(3629),d=l(62101),E=l(50705),p=l(17993);const y=({sbomId:e})=>{const{result:{total:t}}=(0,p.sl)(e,{page:{pageNumber:1,itemsPerPage:1}});return a.createElement(a.Fragment,null,t)};var h=l(1349),g=l(62520),b=l(23713),f=l(91728),v=l(34066),C=l(13506),T=l(36390),P=l(1459),x=l(891),S=l(28338),K=l(70045),F=l(9369),k=l(86099),w=l(55399),I=l(52302);const M=({severities:e})=>{const t=Object.values(e).reduce(((e,t)=>e+t),0);return a.createElement(S.s,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},a.createElement(K.Z,{style:{minWidth:15,textAlign:k.pG}},t),a.createElement(F.c,{orientation:{default:"vertical"}}),a.createElement(K.Z,null,a.createElement(S.s,null,Object.entries(e).filter((([e,t])=>t>0)).sort((0,w.Sx)((([e,t])=>e))).reverse().map((([e,t],l)=>a.createElement(K.Z,{key:l,spacer:{default:"spacerXs"}},a.createElement(S.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},a.createElement(K.Z,null,a.createElement(I.h,{value:e,hideLabel:!0})),a.createElement(K.Z,null,t))))))))};var D=l(24596),V=l(24417);const N=({sbomId:e})=>{const{summary:t,isFetching:l,fetchError:r}=(0,D.r)(e);return a.createElement(V.a,{isFetching:l,fetchError:r,isFetchingState:a.createElement(P.E,{screenreaderText:"Loading contents"}),fetchErrorState:a.createElement(x.J,{color:"red"},"Error")},a.createElement(M,{severities:t.severities}))},R=({})=>{const{isFetching:e,fetchError:t,totalItemCount:l,tableControls:p}=a.useContext(T.L),{pushNotification:P}=a.useContext(E.K),[x,S]=a.useState(null),[K,F]=a.useState(null),{mutate:k}=(0,f.l6)((e=>{P({title:`The SBOM ${e.name} was deleted`,variant:"success"})}),(e=>{P({title:"Error occurred while deleting the SBOM",variant:"danger"})})),{numRenderedColumns:w,currentPageItems:I,propHelpers:{paginationProps:M,tableProps:D,getThProps:V,getTrProps:R,getTdProps:O},expansionDerivedState:{isCellExpanded:A}}=p,{downloadSBOM:B}=(0,b.m)();return a.createElement(a.Fragment,null,a.createElement(i.X,{...D,"aria-label":"sbom-table"},a.createElement(o.d,null,a.createElement(c.Tr,null,a.createElement(g.Ze,{...p},a.createElement(s.Th,{...V({columnKey:"name"})}),a.createElement(s.Th,{...V({columnKey:"version"})}),a.createElement(s.Th,{...V({columnKey:"supplier"})}),a.createElement(s.Th,{...V({columnKey:"published"})}),a.createElement(s.Th,{...V({columnKey:"packages"})}),a.createElement(s.Th,{...V({columnKey:"vulnerabilities"})})))),a.createElement(g.nJ,{isLoading:e,isError:!!t,isNoData:0===l,numRenderedColumns:w},I.map(((e,t)=>a.createElement(m.N,{key:e.id,isExpanded:A(e)},a.createElement(c.Tr,{...R({item:e})},a.createElement(g.Oi,{...p,item:e,rowIndex:t},a.createElement(u.Td,{width:25,...O({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t})},a.createElement(r.k2,{to:`/sboms/${e.id}`},e.name)),a.createElement(u.Td,{width:15,modifier:"truncate",...O({columnKey:"version"})},e.described_by.map((e=>e.version)).filter((e=>e)).join(", ")),a.createElement(u.Td,{width:20,modifier:"truncate",...O({columnKey:"supplier"})},e.authors.join(", ")),a.createElement(u.Td,{width:10,...O({columnKey:"published"})},(0,v.Yq)(e.published)),a.createElement(u.Td,{width:10,...O({columnKey:"packages"})},a.createElement(y,{sbomId:e.id})),a.createElement(u.Td,{width:20,...O({columnKey:"vulnerabilities"})},a.createElement(N,{sbomId:e.id})),a.createElement(u.Td,{isActionCell:!0},a.createElement(d.G,{items:[{title:"Download",onClick:()=>{B(e.id,`${e.name}.json`)}},{title:"Delete",onClick:()=>{return t=e,S("delete"),void F(t);var t}}]}))))))))),a.createElement(h.n,{idPrefix:"sbom-table",isTop:!1,isCompact:!0,paginationProps:M}),a.createElement(C.T,{title:`Delete ${K?.name}`,titleIconVariant:"warning",isOpen:"delete"===x,message:"Are you sure you want to delete this SBOM? This action cannot be undone.","aria-label":"Delete SBOM",confirmBtnVariant:n.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>S(null),onClose:()=>S(null),onConfirm:()=>{K&&k(K.id),S(null)}}))}},98436:(e,t,l)=>{l.r(t),l.d(t,{default:()=>U});var a=l(63696),r=l(23665),n=l(68430),i=l(20653),o=l(35048),c=l(56918),s=l(1180),m=l(72785),u=l(4433),d=l(65991),E=l(76072),p=l(97299),y=l(17327),h=l(71603),g=l(87294),b=l(71592),f=l(40111),v=l(79893),C=l(70414),T=l(8210),P=l(38914),x=l(57901),S=l(77635),K=l(87043),F=l(58897),k=l(23857),w=l(51463);const I=({category:e,filterValue:t,setFilterValue:l,isNumeric:r,isDisabled:n=!1})=>{const[i,o]=a.useState(t?.[0]||"");a.useEffect((()=>{o(t?.[0]||"")}),[t]);const c=()=>{const e=i.trim();l(e?[e.replace(/\s+/g," ")]:[])},s=`${e.categoryKey}-input`;return a.createElement(F.M,null,a.createElement(k.ks,{name:s,id:"search-input",type:r?"number":"search",onChange:(e,t)=>o(t),"aria-label":`${e.title} filter`,value:i,placeholder:e.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||c()},isDisabled:n}),a.createElement(S.$n,{variant:S.Ak.control,id:"search-button","aria-label":"search button for search input",onClick:c,isDisabled:n},a.createElement(w.Ay,null)))};var M=l(11493);const D=({category:e,filterValue:t,setFilterValue:l,isDisabled:r=!1})=>a.createElement(a.Fragment,null,e.selectOptions.map((({label:n,value:i,optionProps:o={}},c)=>{const s=t?.includes(i)||!1;return a.createElement(M.s,{isDisabled:r,key:c,id:`radio-${c}`,name:"radio",isLabelWrapped:!0,label:n,isChecked:s,onChange:()=>{(t=>{const a=(r=t,e.selectOptions.find((({value:e})=>e===r)));var r;l(a?[t]:null)})(i)}})})));var V=l(58365);const N=({category:e,filterValue:t,setFilterValue:l,isDisabled:r=!1})=>{const[n,i]=a.useState(Array.isArray(e.selectOptions)?e.selectOptions:[]);a.useEffect((()=>{i(Array.isArray(e.selectOptions)?e.selectOptions:[])}),[e.selectOptions]);const o=Array.isArray(n)?n:Object.values(n).flatMap((e=>e));return a.createElement(a.Fragment,null,o.map((({label:r,value:n,optionProps:i={}},o)=>a.createElement(V.S,{key:o,id:`checkbox-${o}-${e.categoryKey}`,isLabelWrapped:!0,label:r,isChecked:t?.includes(n),onChange:()=>{(e=>{if(e&&"No results"!==e){let a;a=t&&t.includes(e)?t.filter((t=>t!==e)):t?[...t,e]:[e],l(a)}})(n)}}))))};var R=l(46721),O=l(40360),A=l(86282),B=l(78109),L=l(66341);const $=({category:e,filterValue:t,setFilterValue:l,isDisabled:r=!1})=>{const n=t??[],[i,o]=(n?.filter((e=>(0,L.Ce)((0,L.P1)(e)))),(0,a.useState)()),[c,s]=(0,a.useState)();return a.useEffect((()=>{if(t?.[0]){const[e,l]=(0,L.P1)(t?.[0]);o(e.toDate()),s(l.toDate())}else o(void 0),s(void 0)}),[t]),a.createElement(R.l,null,a.createElement(O.g,{role:"group",isInline:!0,label:"From"},a.createElement(A.l,{value:i?(0,L.ak)(i):"",dateFormat:L.ak,dateParse:L.sy,onChange:(e,t)=>{(0,L.Fz)(t)&&(o((0,L.sy)(t)),s(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:r})),a.createElement(O.g,{role:"group",isInline:!0,label:"To"},a.createElement(A.l,{value:c?(0,L.ak)(c):"",onChange:(e,t)=>{if((0,L.Fz)(t)){const e=(0,L.sy)(t);s(e);const a=(0,L.Kg)(i,e);a&&l([a])}},isDisabled:r||!(0,B.v)(i),dateFormat:L.ak,dateParse:L.sy,invalidFormatText:"",rangeStart:i,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})))},Y=({category:e,...t})=>e.type===K.RJ.select?a.createElement(D,{category:e,...t}):e.type===K.RJ.search||e.type===K.RJ.numsearch?a.createElement(I,{category:e,isNumeric:e.type===K.RJ.numsearch,...t}):e.type===K.RJ.multiselect?a.createElement(N,{category:e,...t}):e.type===K.RJ.dateRange?a.createElement($,{category:e,...t}):null,q=({filterCategories:e,filterValues:t,setFilterValues:l,isDisabled:r=!1,omitFilterCategoryKeys:n=[]})=>a.createElement(a.Fragment,null,a.createElement(P.B,{hasGutter:!0},a.createElement(x.a,null,a.createElement(S.$n,{variant:"link",isInline:!0,onClick:()=>{const a=e.filter((e=>void 0===n.find((t=>t===e.categoryKey)))).reduce(((e,t)=>({...e,[t.categoryKey]:void 0})),{});l({...t,...a})}},"Clear all filters")),e.filter((e=>void 0===n.find((t=>t===e.categoryKey)))).map((e=>a.createElement(x.a,{key:e.categoryKey},a.createElement(P.B,{hasGutter:!0},a.createElement(x.a,null,a.createElement(s.n,null,a.createElement(m.E,{component:"h4"},e.title))),a.createElement(x.a,null,a.createElement(Y,{category:e,filterValue:t[e.categoryKey],setFilterValue:a=>((e,a)=>l({...t,[e.categoryKey]:a}))(e,a),isDisabled:r,isSidebar:!0}))))))));var J=l(30426),_=l(36390),W=l(14310);function Z(e,t){return{Component:e,props:t}}const H=[Z(_.c,{}),Z(J.a,{}),Z(W.y,{})],X=(j=H,({children:e})=>{const t=a.createElement(a.Fragment,null,e);return j.reduceRight(((e,{Component:t,props:l={}})=>a.createElement(t,{...l},e)),t)});var j,G=l(32059),z=l(50382),Q=l(1159);const U=()=>a.createElement(X,null,a.createElement(ee,null)),ee=()=>{const{tableControls:e}=a.useContext(_.L),{tableControls:t}=a.useContext(J.Y),{tableControls:l}=a.useContext(W.u),{totalItemCount:P,tableControls:{propHelpers:{filterPanelProps:x}}}=a.useContext(_.L),{totalItemCount:S,tableControls:{propHelpers:{filterPanelProps:K}}}=a.useContext(J.Y),{totalItemCount:F,tableControls:{propHelpers:{filterPanelProps:k}}}=a.useContext(W.u),[w,I]=a.useState(""),[M,D]=a.useState(0),V=a.createRef();return a.createElement(a.Fragment,null,a.createElement(n.d8,{variant:n.zC.light},a.createElement(i.M,{isStatic:!0},a.createElement(o.P,null,a.createElement(c.$,{align:{default:"alignLeft"}},a.createElement(s.n,null,a.createElement(m.E,{component:"h1"},"Search"))),a.createElement(c.$,{variant:"icon-button-group",align:{default:"alignRight"}},a.createElement(c.$,{visibility:{default:"hidden",lg:"visible"}},a.createElement(u.T,{widths:{default:"500px"}},a.createElement(d.D,{placeholder:"Search for an SBOM, Package, or Vulnerability",value:w,onChange:(e,t)=>(e=>{I(e)})(t),onClear:()=>{I("")},onKeyDown:a=>{a.key&&"Enter"!==a.key||(e.filterState.setFilterValues({...e.filterState.filterValues,"":[w]}),t.filterState.setFilterValues({...t.filterState.filterValues,"":[w]}),l.filterState.setFilterValues({...l.filterState.filterValues,"":[w]}))}}))))))),a.createElement(n.d8,null,a.createElement(E.x,{hasGutter:!0},a.createElement(p.E,{md:2},a.createElement(y.Z,{isFullHeight:!0},a.createElement(h.b,null,0===M?a.createElement(q,{omitFilterCategoryKeys:[""],...x}):1===M?a.createElement(q,{omitFilterCategoryKeys:[""],...K}):2===M?a.createElement(q,{omitFilterCategoryKeys:[""],...k}):null))),a.createElement(p.E,{md:10},a.createElement(y.Z,null,a.createElement(h.b,null,a.createElement(g.t,{activeKey:M,onSelect:(e,t)=>{D(t)},"aria-label":"Tabs",role:"region"},a.createElement(b.o,{eventKey:0,title:a.createElement(f.V,null,"SBOMs","  ",a.createElement(v.E,{screenReaderText:"Search Result Count"},P)),actions:a.createElement(a.Fragment,null,a.createElement(C.o,{"aria-label":"SBOM help popover",ref:V},a.createElement(T.Ay,null)),(N=V,a.createElement(r.A,{bodyContent:a.createElement("div",null,"Software Bill of Materials for Products and Containers."),position:"right",triggerRef:N})))},a.createElement(z.Y,null)),a.createElement(b.o,{eventKey:1,title:a.createElement(f.V,null,"Packages","  ",a.createElement(v.E,{screenReaderText:"Search Result Count"},S))},a.createElement(G.N,null)),a.createElement(b.o,{eventKey:2,title:a.createElement(f.V,null,"Vulnerabilities","  ",a.createElement(v.E,{screenReaderText:"Search Result Count"},F))},a.createElement(Q.fk,null)))))))));var N}},14310:(e,t,l)=>{l.d(t,{u:()=>s,y:()=>m});var a=l(63696),r=l(87043),n=l(86820),i=l(70611),o=l(5098),c=l(74932);const s=a.createContext({}),m=({children:e})=>{const t=(0,i.MM)({tableName:"vulnerability",persistenceKeyPrefix:n.rt.vulnerabilities,columnNames:{identifier:"Name",title:"Description",severity:"CVSS",published:"Published",packages:"Packages",sboms:"SBOMs"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"average_severity",title:"CVSS",placeholderText:"CVSS",type:r.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:l,total:m},isFetching:u,fetchError:d}=(0,c.WJ)((0,i.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score"}})),E=(0,i.PB)({...t,idProperty:"identifier",currentPageItems:l,totalItemCount:m,isLoading:u,selectionState:(0,o.$)({items:l,isEqual:(e,t)=>e.identifier===t.identifier})});return a.createElement(s.Provider,{value:{totalItemCount:m,isFetching:u,fetchError:d,tableControls:E}},e)}},1159:(e,t,l)=>{l.d(t,{fk:()=>D});var a=l(63696),r=l(49348),n=l(76072),i=l(97299),o=l(17327),c=l(64361),s=l(71603),m=l(65753),u=l(24974),d=l(21639),E=l(3939),p=l(85578),y=l(16646),h=l(31065),g=l(77819),b=l(28516),f=l(3629),v=l(62101),C=l(38139),T=l(24417),P=l(50705),x=l(52302),S=l(1349),K=l(62520),F=l(74932),k=l(34066),w=l(70400),I=l(65636),M=l(14310);const D=()=>{const{pushNotification:e}=a.useContext(P.K),{isFetching:t,fetchError:l,totalItemCount:T,tableControls:w}=a.useContext(M.u),I=(0,F.o5)((t=>{e({title:`The Vulnerability ${t.identifier} was deleted`,variant:"danger"})}),(t=>{e({title:"Error occurred while deleting the vulnerability",variant:"danger"})})),{numRenderedColumns:D,currentPageItems:R,propHelpers:{paginationProps:O,tableProps:A,getThProps:B,getTrProps:L,getTdProps:$,getExpandedContentTdProps:Y},expansionDerivedState:{isCellExpanded:q}}=w;return a.createElement(a.Fragment,null,a.createElement(p.X,{...A,"aria-label":"Vulnerability table"},a.createElement(y.d,null,a.createElement(h.Tr,null,a.createElement(K.Ze,{...w},a.createElement(g.Th,{...B({columnKey:"identifier"})}),a.createElement(g.Th,{...B({columnKey:"title"})}),a.createElement(g.Th,{...B({columnKey:"severity"})}),a.createElement(g.Th,{...B({columnKey:"published"})}),a.createElement(g.Th,{...B({columnKey:"packages"})}),a.createElement(g.Th,{...B({columnKey:"sboms"})})))),a.createElement(K.nJ,{isLoading:t,isError:!!l,isNoData:0===T,numRenderedColumns:D},R.map(((e,t)=>a.createElement(b.N,{key:e.identifier,isExpanded:q(e)},a.createElement(h.Tr,{...L({item:e})},a.createElement(K.Oi,{...w,item:e,rowIndex:t},a.createElement(f.Td,{width:15,...$({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},a.createElement(r.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),a.createElement(f.Td,{width:45,modifier:"truncate",...$({columnKey:"title"})},e.title||e.description),a.createElement(f.Td,{width:10,...$({columnKey:"severity"})},e.average_severity&&a.createElement(x.h,{value:e.average_severity})),a.createElement(f.Td,{width:10,...$({columnKey:"published"})},(0,k.Yq)(e.published)),a.createElement(f.Td,{width:10,modifier:"truncate",...$({columnKey:"packages",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"Packages"),a.createElement(f.Td,{width:10,modifier:"truncate",...$({columnKey:"sboms",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"SBOMs"),a.createElement(f.Td,{isActionCell:!0},a.createElement(v.G,{items:[{title:"Delete",onClick:()=>I.mutate(e.identifier)}]})))),q(e)?a.createElement(h.Tr,{isExpanded:!0},a.createElement(f.Td,{...Y({item:e})},a.createElement(C.g,null,a.createElement("div",{className:"pf-v5-u-m-md"},q(e,"identifier")?a.createElement(a.Fragment,null,a.createElement(n.x,{hasGutter:!0},a.createElement(i.E,{md:8},a.createElement(o.Z,{isFullHeight:!0,isCompact:!0},a.createElement(c.Z,null,"General view"),a.createElement(s.b,null,a.createElement(m.B,{columnModifier:{default:"2Col"}},a.createElement(u.W,null,a.createElement(d.X,null,"Published"),a.createElement(E.d,null,(0,k.Yq)(e.published))),a.createElement(u.W,null,a.createElement(d.X,null,"Modified"),a.createElement(E.d,null,(0,k.Yq)(e.modified))),a.createElement(u.W,null,a.createElement(d.X,null,"Released"),a.createElement(E.d,null,(0,k.Yq)(e.released))),a.createElement(u.W,null,a.createElement(d.X,null,"Withdrawn"),a.createElement(E.d,null,(0,k.Yq)(e.withdrawn))))))),a.createElement(i.E,{md:4},a.createElement(o.Z,{isFullHeight:!0,isCompact:!0},a.createElement(c.Z,null,"Additional info"),a.createElement(s.b,null,a.createElement(m.B,null,a.createElement(u.W,null,a.createElement(d.X,null,"CWE"),a.createElement(E.d,null,"item.cwe")),a.createElement(u.W,null,a.createElement(d.X,null,"Non normative"),a.createElement(E.d,null,e.normative?"Yes":"No")))))))):null,q(e,"packages")?a.createElement(a.Fragment,null,a.createElement(V,{vulnerabilityId:e.identifier})):null,q(e,"sboms")?a.createElement(a.Fragment,null,a.createElement(N,{vulnerabilityId:e.identifier})):null)))):null))))),a.createElement(S.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:O}))},V=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:r}=(0,F.uN)(e);return a.createElement(T.a,{isFetching:l,fetchError:r},a.createElement(w.n,{variant:"compact",initialItemsPerPage:5,advisories:t?.advisories??[]}))},N=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:r}=(0,F.uN)(e);return a.createElement(T.a,{isFetching:l,fetchError:r},a.createElement(I.m,{variant:"compact",advisories:t?.advisories??[]}))}},17993:(e,t,l)=>{l.d(t,{Lx:()=>c,Si:()=>s,sl:()=>m});var a=l(7616),r=l(77347),n=l(40752),i=l(70611);const o="packages",c=(e={},t=!1)=>{const{data:l,isLoading:c,error:s,refetch:m}=(0,a.I)({queryKey:[o,e],queryFn:()=>(0,n.UD)({client:r.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:e},isFetching:c,fetchError:s,refetch:m}},s=e=>{const{data:t,isLoading:l,error:i}=(0,a.I)({queryKey:[o,e],queryFn:()=>(0,n.Y0)({client:r.S,path:{key:e}})});return{pkg:t?.data,isFetching:l,fetchError:i}},m=(e,t={})=>{const{data:l,isLoading:c,error:s,refetch:m}=(0,a.I)({queryKey:[o,"by-sbom",e,t],queryFn:()=>(0,n.Ad)({client:r.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:t},isFetching:c,fetchError:s,refetch:m}}}}]);
//# sourceMappingURL=586.270a2e91.min.js.map