"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[4],{38139:(e,t,l)=>{l.d(t,{g:()=>c});var n=l(34629),r=l(63696),a=l(62634),i=l(36373);const c=e=>{var{children:t=null}=e,l=(0,n.__rest)(e,["children"]);return r.createElement("div",Object.assign({},l,{className:(0,a.A)(i.A.tableExpandableRowContent)}),t)};c.displayName="ExpandableRowContent"},14472:(e,t,l)=>{l.r(t),l.d(t,{default:()=>v});var n=l(63696),r=l(68430),a=l(1180),i=l(72785),c=l(14310),o=l(1159),m=l(20653),s=l(35048),d=l(4433),u=l(33273),E=l(1349);const p=({})=>{const{tableControls:e}=n.useContext(c.u),{propHelpers:{toolbarProps:t,filterToolbarProps:l,paginationToolbarItemProps:r,paginationProps:a}}=e;return n.createElement(m.M,{...t},n.createElement(s.P,null,n.createElement(u.Us,{...l}),n.createElement(d.T,{...r},n.createElement(E.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:a}))))},v=()=>n.createElement(n.Fragment,null,n.createElement(r.d8,{variant:r.zC.light},n.createElement(a.n,null,n.createElement(i.E,{component:"h1"},"Vulnerabilities"))),n.createElement(r.d8,null,n.createElement("div",{style:{backgroundColor:"var(--pf-v5-global--BackgroundColor--100)"}},n.createElement(c.y,null,n.createElement(p,null),n.createElement(o.fk,null)))))},14310:(e,t,l)=>{l.d(t,{u:()=>m,y:()=>s});var n=l(63696),r=l(33273),a=l(86820),i=l(70611),c=l(5098),o=l(74932);const m=n.createContext({}),s=({children:e})=>{const t=(0,i.MM)({tableName:"vulnerability",persistenceKeyPrefix:a.rt.vulnerabilities,columnNames:{identifier:"Identifier",title:"Title",severity:"Severity",packages:"Packages",sboms:"SBOMs",advisories:"Advisories"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:r.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:l,total:s},isFetching:d,fetchError:u}=(0,o.WJ)((0,i.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score"}})),E=(0,i.PB)({...t,idProperty:"identifier",currentPageItems:l,totalItemCount:s,isLoading:d,selectionState:(0,c.$)({items:l,isEqual:(e,t)=>e.identifier===t.identifier})});return n.createElement(m.Provider,{value:{totalItemCount:s,isFetching:d,fetchError:u,tableControls:E}},e)}},1159:(e,t,l)=>{l.d(t,{fk:()=>W});var n=l(63696),r=l(49348),a=l(76072),i=l(97299),c=l(17327),o=l(64361),m=l(71603),s=l(65753),d=l(24974),u=l(21639),E=l(3939),p=l(85578),v=l(16646),g=l(31065),b=l(77819),h=l(28516),y=l(3629),f=l(62101),C=l(38139),T=l(24417),x=l(50705),P=l(52302),w=l(1349),F=l(62520),k=l(74932),I=l(34066),K=l(82476),N=l(70400),_=l(48703),S=l(14310);const W=()=>{const{pushNotification:e}=n.useContext(x.K),{isFetching:t,fetchError:l,totalItemCount:T,tableControls:N}=n.useContext(S.u),_=(0,k.o5)((t=>{e({title:`The Vulnerability ${t.identifier} was deleted`,variant:"danger"})}),(t=>{e({title:"Error occurred while deleting the vulnerability",variant:"danger"})})),{numRenderedColumns:W,currentPageItems:X,propHelpers:{paginationProps:A,tableProps:B,getThProps:q,getTrProps:H,getTdProps:O,getExpandedContentTdProps:Y},expansionDerivedState:{isCellExpanded:Z}}=N;return n.createElement(n.Fragment,null,n.createElement(p.X,{...B,"aria-label":"Vulnerability table"},n.createElement(v.d,null,n.createElement(g.Tr,null,n.createElement(F.Ze,{...N},n.createElement(b.Th,{...q({columnKey:"identifier"})}),n.createElement(b.Th,{...q({columnKey:"title"})}),n.createElement(b.Th,{...q({columnKey:"severity"})}),n.createElement(b.Th,{...q({columnKey:"packages"})}),n.createElement(b.Th,{...q({columnKey:"sboms"})}),n.createElement(b.Th,{...q({columnKey:"advisories"})})))),n.createElement(F.nJ,{isLoading:t,isError:!!l,isNoData:0===T,numRenderedColumns:W},X.map(((e,t)=>n.createElement(h.N,{key:e.identifier,isExpanded:Z(e)},n.createElement(g.Tr,{...H({item:e})},n.createElement(F.Oi,{...N,item:e,rowIndex:t},n.createElement(y.Td,{width:15,...O({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},n.createElement(r.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),n.createElement(y.Td,{width:45,modifier:"truncate",...O({columnKey:"title"})},e.title||e.description),n.createElement(y.Td,{width:10,...O({columnKey:"severity"})},e.average_severity&&n.createElement(P.h,{value:e.average_severity})),n.createElement(y.Td,{width:10,modifier:"truncate",...O({columnKey:"packages",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"Packages"),n.createElement(y.Td,{width:10,modifier:"truncate",...O({columnKey:"sboms",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"SBOMs"),n.createElement(y.Td,{width:10,...O({columnKey:"advisories",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"Advisories"),n.createElement(y.Td,{isActionCell:!0},n.createElement(f.G,{items:[{title:"Delete",onClick:()=>_.mutate(e.identifier)}]})))),Z(e)?n.createElement(g.Tr,{isExpanded:!0},n.createElement(y.Td,{...Y({item:e})},n.createElement(C.g,null,n.createElement("div",{className:"pf-v5-u-m-md"},Z(e,"identifier")?n.createElement(n.Fragment,null,n.createElement(a.x,{hasGutter:!0},n.createElement(i.E,{md:8},n.createElement(c.Z,{isFullHeight:!0,isCompact:!0},n.createElement(o.Z,null,"General view"),n.createElement(m.b,null,n.createElement(s.B,{columnModifier:{default:"2Col"}},n.createElement(d.W,null,n.createElement(u.X,null,"Published"),n.createElement(E.d,null,(0,I.Yq)(e.published))),n.createElement(d.W,null,n.createElement(u.X,null,"Modified"),n.createElement(E.d,null,(0,I.Yq)(e.modified))),n.createElement(d.W,null,n.createElement(u.X,null,"Released"),n.createElement(E.d,null,(0,I.Yq)(e.released))),n.createElement(d.W,null,n.createElement(u.X,null,"Withdrawn"),n.createElement(E.d,null,(0,I.Yq)(e.withdrawn))))))),n.createElement(i.E,{md:4},n.createElement(c.Z,{isFullHeight:!0,isCompact:!0},n.createElement(o.Z,null,"Additional info"),n.createElement(m.b,null,n.createElement(s.B,null,n.createElement(d.W,null,n.createElement(u.X,null,"CWE"),n.createElement(E.d,null,"item.cwe")),n.createElement(d.W,null,n.createElement(u.X,null,"Non normative"),n.createElement(E.d,null,e.normative?"Yes":"No")))))))):null,Z(e,"packages")?n.createElement(n.Fragment,null,n.createElement(M,{vulnerabilityId:e.identifier})):null,Z(e,"sboms")?n.createElement(n.Fragment,null,n.createElement(R,{vulnerabilityId:e.identifier})):null,Z(e,"advisories")?n.createElement(n.Fragment,null,n.createElement(K.N,{variant:"compact",advisories:e.advisories})):null)))):null))))),n.createElement(w.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:A}))},M=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:r}=(0,k.uN)(e);return n.createElement(T.a,{isFetching:l,fetchError:r},n.createElement(N.n,{variant:"compact",initialItemsPerPage:5,advisories:t?.advisories??[]}))},R=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:r}=(0,k.uN)(e);return n.createElement(T.a,{isFetching:l,fetchError:r},n.createElement(_.m,{variant:"compact",advisories:t?.advisories??[]}))}}}]);
//# sourceMappingURL=4.699efd6e.min.js.map