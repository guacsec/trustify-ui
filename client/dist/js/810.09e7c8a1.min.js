"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[810],{81230:(e,a,t)=>{t.d(a,{J4:()=>i,hP:()=>c});var r=t(64917),n=t(86820);t(63260);const o="/api",s=o+"/v1/advisory",l=o+"/v1/sbom",d=e=>{let a="application/json";return(e.name.endsWith(".bz2")||e.name.endsWith(".gz"))&&(a="application/json+bzip2"),a},c=(e,a)=>{const t=e.get(n.fs);return r.A.post(`${s}`,t,{...a,headers:{"Content-Type":d(t)}})},i=(e,a)=>{const t=e.get(n.fs);return r.A.post(`${l}`,t,{...a,headers:{"Content-Type":d(t)}})}},24808:(e,a,t)=>{t.d(a,{v:()=>d});var r=t(63696),n=t(64917),o=t(86820);const s="cancelled",l=(e,a)=>{switch(a.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},status:"queued",cancelFn:a.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},progress:a.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file),status:"complete",response:a.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file),status:"complete",error:a.payload.error,wasCancelled:a.payload.error?.message===s})};case"removeUpload":{const t=new Map(e.uploads);return t.delete(a.payload.file),{...e,uploads:t}}default:throw new Error}},d=({parallel:e,uploadFn:a,onSuccess:t,onError:d})=>{const[c,i]=r.useReducer(l,{uploads:new Map});return{uploads:c.uploads,handleUpload:r=>{const l=[];for(let e=0;e<r.length;e++){const a=r[e],c=new FormData;c.set(o.fs,a);const u=n.A.CancelToken.source(),p={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{const t=e.total??1,r=e.loaded/t*100;i({type:"updateUploadProgress",payload:{file:a,progress:Math.round(r)}})},cancelToken:u.token};i({type:"queueUpload",payload:{file:a,cancelFn:u}});const y={formData:c,config:p,thenFn:e=>{i({type:"finishUploadSuccessfully",payload:{file:a,response:e}}),t&&t(e,a)},catchFn:e=>{i({type:"finishUploadWithError",payload:{file:a,error:e}}),e.message!==s&&d&&d(e,a)}};l.push(y)}e?l.forEach((e=>{a(e.formData,e.config).then(e.thenFn).catch(e.catchFn)})):l.reduce((async(e,t)=>(await e,a(t.formData,t.config).then(t.thenFn).catch(t.catchFn))),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(s)},handleRemoveUpload:e=>{i({type:"removeUpload",payload:{file:e}})}}}},34023:(e,a,t)=>{t.r(a),t.d(a,{default:()=>K});var r=t(63696),n=t(68430),o=t(1180),s=t(72785),l=t(17327),d=t(71603),c=t(87294),i=t(71592),u=t(40111),p=t(10015),y=t(36227),h=t(69935),m=t(91728),g=t(73401),f=t(64335),E=t(57311),v=t(73220),F=t(99205),q=t(68986),S=t(33364),U=t(94279),b=t(16172),w=t(56279),k=t(84608);const M=({uploads:e,handleUpload:a,handleRemoveUpload:t,extractSuccessMessage:n,extractErrorMessage:o})=>{const[s,l]=r.useState(!1),[d,c]=r.useState("inProgress"),[i,u]=r.useState([]);!s&&e.size>0&&l(!0),r.useEffect((()=>{const a=Array.from(e.values());a.some((e=>"inProgress"===e.status))?c("inProgress"):a.every((e=>"complete"===e.status))?c("success"):c("danger")}),[e]);const p=Array.from(e.values()).filter((e=>e.response)).length;return r.createElement(r.Fragment,null,r.createElement(g.w,{onFileDrop:(e,t)=>{a(t)},dropzoneProps:{accept:{"application/xml":[".json",".bz2",".gz"]},onDropRejected:e=>{u(e)},useFsAccessApi:!1}},r.createElement(f.x,{titleIcon:r.createElement(k.Ay,null),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2, .gz"}),s&&r.createElement(E.y,{statusToggleText:`${p} of ${e.size} files uploaded`,statusToggleIcon:d},Array.from(e.entries()).map((([e,a],s)=>r.createElement(v.L,{fileIcon:r.createElement(w.Ay,null),file:e,key:`${e.name}-${s}`,onClearClick:()=>{[e].forEach((e=>{t(e)}))},progressValue:a.progress,progressVariant:a.error?"danger":a.response?"success":void 0,progressHelperText:a.error?r.createElement(F.E,{isLiveRegion:!0},r.createElement(q.j,{variant:"error"},o(a.error))):a.response?r.createElement(F.E,{isLiveRegion:!0},r.createElement(q.j,{variant:"default"},n(a.response))):void 0})))),r.createElement(S.a,{isOpen:i.length>0,title:"Unsupported files",titleIconVariant:"warning",showClose:!0,"aria-label":"unsupported file upload attempted",onClose:()=>u([]),variant:"small"},r.createElement(U.B8,null,i.map(((e,a)=>r.createElement(b.c,{key:a},e.file.name)))))))},K=()=>{const{uploads:e,handleUpload:a,handleRemoveUpload:t}=(0,m.sn)(),{uploads:g,handleUpload:f,handleRemoveUpload:E}=(0,h.Yu)();return r.createElement(r.Fragment,null,r.createElement(n.d8,{variant:n.zC.light},r.createElement(o.n,null,r.createElement(s.E,{component:"h1"},"Upload"))),r.createElement(n.d8,null,r.createElement(l.Z,null,r.createElement(d.b,null,r.createElement(c.t,{defaultActiveKey:0},r.createElement(i.o,{eventKey:0,title:r.createElement(u.V,null,"SBOM")},r.createElement(p.J,{id:"upload-sbom-tab-content"},r.createElement(y.b,{hasPadding:!0},r.createElement(M,{uploads:e,handleUpload:a,handleRemoveUpload:t,extractSuccessMessage:e=>`${e.data.document_id} uploaded`,extractErrorMessage:e=>e.response?.data?e.message:"Error while uploading file"})))),r.createElement(i.o,{eventKey:1,title:r.createElement(u.V,null,"Advisory")},r.createElement(p.J,{id:"upload-advisory-tab-content"},r.createElement(y.b,{hasPadding:!0},r.createElement(M,{uploads:g,handleUpload:f,handleRemoveUpload:E,extractSuccessMessage:e=>`${e.data.document_id} uploaded`,extractErrorMessage:e=>e.response?.data?e.message:"Error while uploading file"})))))))))}},69935:(e,a,t)=>{t.d(a,{VH:()=>p,Yu:()=>g,ni:()=>h,qF:()=>m,uJ:()=>f,vy:()=>y});var r=t(7616),n=t(26667),o=t(3715),s=t(77347),l=t(40752),d=t(81230),c=t(70611),i=t(24808);const u="advisories",p=(e={},a=!1)=>{const{data:t,isLoading:n,error:o,refetch:d}=(0,r.I)({queryKey:[u,e],queryFn:()=>(0,l.YM)({client:s.S,query:{...(0,c.kd)(e)}}),refetchInterval:!a&&5e3});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:e??e},isFetching:n,fetchError:o,refetch:d}},y=e=>{const{data:a,isLoading:t,error:n}=(0,r.I)({queryKey:[u,e],queryFn:()=>(0,l.ai)({client:s.S,path:{key:e}}),enabled:void 0!==e});return{advisory:a?.data,isFetching:t,fetchError:n}},h=(e,a)=>(0,n.n)({mutationFn:async e=>(await(0,l.vl)({client:s.S,path:{key:e}})).data,mutationKey:[u],onSuccess:e,onError:a}),m=e=>{const{data:a,isLoading:t,error:n}=(0,r.I)({queryKey:[u,e,"source"],queryFn:()=>(0,l.Mu)({client:s.S,path:{key:e}}),enabled:void 0!==e});return{source:a,isFetching:t,fetchError:n}},g=()=>{const e=(0,o.jE)();return(0,i.v)({parallel:!0,uploadFn:(e,a)=>(0,d.hP)(e,a),onSuccess:()=>{e.invalidateQueries({queryKey:[u]})}})},f=(e,a)=>{const t=(0,o.jE)();return(0,n.n)({mutationFn:e=>(0,l._e)({client:s.S,path:{id:e.uuid},body:e.labels??{}}),onSuccess:(a,r)=>{e(),t.invalidateQueries({queryKey:[u]})},onError:a})}},91728:(e,a,t)=>{t.d(a,{DH:()=>f,Qr:()=>g,i$:()=>p,l6:()=>h,rj:()=>y,sn:()=>m});var r=t(7616),n=t(3715),o=t(26667),s=t(77347),l=t(40752),d=t(24808),c=t(81230),i=t(70611);const u="sboms",p=(e={},a=!1)=>{const{data:t,isLoading:n,error:o,refetch:d}=(0,r.I)({queryKey:[u,e],queryFn:()=>(0,l.z1)({client:s.S,query:{...(0,i.kd)(e)}}),refetchInterval:!a&&5e3});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:e??e},isFetching:n,fetchError:o,refetch:d}},y=e=>{const{data:a,isLoading:t,error:n}=(0,r.I)({queryKey:[u,e],queryFn:()=>(0,l.a7)({client:s.S,path:{id:e}}),enabled:void 0!==e});return{sbom:a?.data,isFetching:t,fetchError:n}},h=(e,a)=>{const t=(0,n.jE)();return(0,o.n)({mutationFn:async e=>(await(0,l.bS)({client:s.S,path:{id:e}})).data,onSuccess:(a,r)=>{e(a,r),t.invalidateQueries({queryKey:[u]})},onError:a})},m=()=>{const e=(0,n.jE)();return(0,d.v)({parallel:!0,uploadFn:(e,a)=>(0,c.J4)(e,a),onSuccess:()=>{e.invalidateQueries({queryKey:[u]})}})},g=(e,a={})=>{const{data:t,isLoading:n,error:o,refetch:d}=(0,r.I)({queryKey:[u,"by-package",e,a],queryFn:()=>(0,l.m9)({client:s.S,query:{id:e,...(0,i.kd)(a)}})});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:a??a},isFetching:n,fetchError:o,refetch:d}},f=e=>{const{data:a,isLoading:t,error:n}=(0,r.I)({queryKey:[u,e,"advisory"],queryFn:()=>(0,l.bj)({client:s.S,path:{id:e}})});return{advisories:a?.data||[],isFetching:t,fetchError:n}}}}]);
//# sourceMappingURL=810.09e7c8a1.min.js.map