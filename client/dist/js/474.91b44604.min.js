"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[474],{17327:(e,t,a)=>{a.d(t,{E:()=>o,Z:()=>c});var l=a(34629),r=a(63696),i=a(41775),n=a(62634),s=a(1850);const o=r.createContext({cardId:"",registerTitleId:()=>{},isExpanded:!1,isClickable:!1,isSelectable:!1,isSelected:!1,isClicked:!1,isDisabled:!1}),c=e=>{var{children:t,id:a="",className:d,component:u="div",isCompact:m=!1,isSelectable:p=!1,isClickable:f=!1,isDisabled:b=!1,isSelectableRaised:y=!1,isSelected:h=!1,isClicked:v=!1,isDisabledRaised:E=!1,isFlat:g=!1,isExpanded:C=!1,isRounded:P=!1,isLarge:S=!1,isFullHeight:T=!1,isPlain:k=!1,ouiaId:F,ouiaSafe:_=!0,hasSelectableInput:x=!1,selectableInputAriaLabel:I,onSelectableInputChange:K=()=>{}}=e,A=(0,l.__rest)(e,["children","id","className","component","isCompact","isSelectable","isClickable","isDisabled","isSelectableRaised","isSelected","isClicked","isDisabledRaised","isFlat","isExpanded","isRounded","isLarge","isFullHeight","isPlain","ouiaId","ouiaSafe","hasSelectableInput","selectableInputAriaLabel","onSelectableInputChange"]);const R=u,N=(0,s.iK)(c.displayName,F,_),[w,D]=r.useState(""),[V,M]=r.useState();m&&S&&(console.warn("Card: Cannot use isCompact with isLarge. Defaulting to isCompact"),S=!1);const L=r.useRef(!1);return r.useEffect((()=>{I?M({"aria-label":I}):w?M({"aria-labelledby":w}):x&&!L.current&&(M({}),console.warn("If no CardTitle component is passed as a child of Card the selectableInputAriaLabel prop must be passed"))}),[x,I,w]),r.createElement(o.Provider,{value:{cardId:a,registerTitleId:e=>{D(e),L.current=!!e},isExpanded:C,isClickable:f,isSelectable:p,isSelected:h,isClicked:v,isDisabled:b,hasSelectableInput:x}},x&&r.createElement("input",Object.assign({className:"pf-v5-screen-reader",id:`${a}-input`},V,{type:"checkbox",checked:h,onChange:e=>K(e,a),disabled:E,tabIndex:-1})),r.createElement(R,Object.assign({id:a,className:(0,n.A)(i.A.card,m&&i.A.modifiers.compact,C&&i.A.modifiers.expanded,g&&i.A.modifiers.flat,P&&i.A.modifiers.rounded,S&&i.A.modifiers.displayLg,T&&i.A.modifiers.fullHeight,k&&i.A.modifiers.plain,E?(0,n.A)(i.A.modifiers.nonSelectableRaised):y?(0,n.A)(i.A.modifiers.selectableRaised,h&&i.A.modifiers.selectedRaised):p&&f?(0,n.A)(i.A.modifiers.selectable,i.A.modifiers.clickable,(h||v)&&i.A.modifiers.current):p?(0,n.A)(i.A.modifiers.selectable,h&&i.A.modifiers.selected):f?(0,n.A)(i.A.modifiers.clickable,v&&i.A.modifiers.current):"",b&&i.A.modifiers.disabled,d),tabIndex:y?"0":void 0},A,N),t))};c.displayName="Card"},71603:(e,t,a)=>{a.d(t,{b:()=>s});var l=a(34629),r=a(63696),i=a(41775),n=a(62634);const s=e=>{var{children:t,className:a,component:s="div",isFilled:o=!0}=e,c=(0,l.__rest)(e,["children","className","component","isFilled"]);const d=s;return r.createElement(d,Object.assign({className:(0,n.A)(i.A.cardBody,!o&&i.A.modifiers.noFill,a)},c),t)};s.displayName="CardBody"},38914:(e,t,a)=>{a.d(t,{B:()=>s});var l=a(34629),r=a(63696),i=a(13364),n=a(62634);const s=e=>{var{hasGutter:t=!1,className:a="",children:s=null,component:o="div"}=e,c=(0,l.__rest)(e,["hasGutter","className","children","component"]);const d=o;return r.createElement(d,Object.assign({},c,{className:(0,n.A)(i.A.stack,t&&i.A.modifiers.gutter,a)}),s)};s.displayName="Stack"},57901:(e,t,a)=>{a.d(t,{a:()=>s});var l=a(34629),r=a(63696),i=a(13364),n=a(62634);const s=e=>{var{isFilled:t=!1,className:a="",children:s=null}=e,o=(0,l.__rest)(e,["isFilled","className","children"]);return r.createElement("div",Object.assign({},o,{className:(0,n.A)(i.A.stackItem,t&&i.A.modifiers.fill,a)}),s)};s.displayName="StackItem"},16177:(e,t,a)=>{a.d(t,{a:()=>i});var l=a(63696),r=a(93962);const i=({value:e})=>l.createElement(l.Fragment,null,Object.entries(e).map((([e,t],a)=>l.createElement(r.J,{key:a,isCompact:!0},`${e}=${t}`))))},68248:(e,t,a)=>{a.d(t,{f:()=>s});var l=a(63696),r=a(74932);const i=(e,t)=>e.sbom.id===t.sbom.id&&e.sbomStatus===t.sbomStatus,n={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0}},s=e=>{const{vulnerability:t,isFetching:a,fetchError:s}=(0,r.uN)(e);return{data:l.useMemo((()=>(e=>{const t=e.flatMap((e=>(e.sboms??[]).flatMap((t=>t.status.map((a=>({sbom:{...t,version:t.version||null},sbomStatus:a,advisory:e}))))).reduce(((e,t)=>{const a=e.find((e=>i(e,t)));if(a)return[...e.filter((e=>!i(e,a))),{...a,relatedPackages:[...a.relatedPackages,{advisory:t.advisory}]}];{const a={sbom:t.sbom,sbomStatus:t.sbomStatus,relatedPackages:[{advisory:t.advisory}]};return[...e,a]}}),[]))),a=t.reduce(((e,t)=>{const a=t.sbomStatus;return{...e,total:e.total+1,sbomStatus:{...e.sbomStatus,[a]:e.sbomStatus[a]+1}}}),n);return{sboms:t,summary:a}})(t?.advisories||[])),[t]),isFetching:a,fetchError:s}}},7602:(e,t,a)=>{a.d(t,{R:()=>c,r:()=>d});var l=a(63696),r=a(87043),i=a(86820),n=a(70611),s=a(5098),o=a(69935);const c=l.createContext({}),d=({children:e})=>{const t=(0,n.MM)({tableName:"advisory",persistenceKeyPrefix:i.rt.advisories,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Title",severity:"Aggregated Severity",modified:"Revision",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","severity","modified"],isFilterEnabled:!0,filterCategories:[{categoryKey:i._G,title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:r.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"modified",title:"Revision",type:r.RJ.dateRange}],isExpansionEnabled:!1}),{result:{data:a,total:d},isFetching:u,fetchError:m}=(0,o.VH)((0,n.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score",modified:"modified"}})),p=(0,n.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:d,isLoading:u,selectionState:(0,s.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return l.createElement(c.Provider,{value:{totalItemCount:d,isFetching:u,fetchError:m,tableControls:p}},e)}},7123:(e,t,a)=>{a.d(t,{q:()=>g});var l=a(63696),r=a(49348),i=a(40319),n=a(16646),s=a(9425),o=a(77819),c=a(28516),d=a(3629),u=a(62101),m=a(50705),p=a(1349),f=a(62520),b=a(91271),y=a(11848),h=a(28644),v=a(34066),E=a(7602);const g=({})=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:g}=l.useContext(E.R),{pushNotification:C}=l.useContext(m.K),{numRenderedColumns:P,currentPageItems:S,propHelpers:{paginationProps:T,tableProps:k,getThProps:F,getTrProps:_,getTdProps:x},expansionDerivedState:{isCellExpanded:I}}=g,{downloadAdvisory:K}=(0,b.m)();return l.createElement(l.Fragment,null,l.createElement(i.X,{...k,"aria-label":"advisory-table"},l.createElement(n.d,null,l.createElement(s.Tr,null,l.createElement(f.Ze,{...g},l.createElement(o.Th,{...F({columnKey:"identifier"})}),l.createElement(o.Th,{...F({columnKey:"title"})}),l.createElement(o.Th,{...F({columnKey:"severity"})}),l.createElement(o.Th,{...F({columnKey:"modified"})}),l.createElement(o.Th,{...F({columnKey:"vulnerabilities"})})))),l.createElement(f.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:P},S.map(((e,t)=>{const a=e.vulnerabilities.reduce(((e,t)=>({...e,[t.severity]:e[t.severity]+1})),{critical:0,high:0,medium:0,low:0,none:0});return l.createElement(c.N,{key:e.identifier,isExpanded:I(e)},l.createElement(s.Tr,{..._({item:e})},l.createElement(f.Oi,{...g,item:e,rowIndex:t},l.createElement(d.Td,{width:15,...x({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},l.createElement(r.k2,{to:`/advisories/${e.uuid}`},e.identifier)),l.createElement(d.Td,{width:40,modifier:"truncate",...x({columnKey:"title"})},e.title),l.createElement(d.Td,{width:15,modifier:"truncate",...x({columnKey:"severity"})},e.average_severity&&l.createElement(y.h,{value:e.average_severity})),l.createElement(d.Td,{width:10,...x({columnKey:"modified"})},(0,v.Yq)(e.modified)),l.createElement(d.Td,{width:20,...x({columnKey:"vulnerabilities"})},l.createElement(h.n,{severities:a})),l.createElement(d.Td,{isActionCell:!0},l.createElement(u.G,{items:[{title:"Download",onClick:()=>{K(e.uuid,`${e.identifier}.json`)}}]})))))})))),l.createElement(p.n,{idPrefix:"advisory-table",isTop:!1,isCompact:!0,paginationProps:T}))}},30426:(e,t,a)=>{a.d(t,{Y:()=>d,a:()=>u});var l=a(63696),r=a(87043),i=a(86820),n=a(70611),s=a(5098),o=a(17993),c=a(34066);const d=l.createContext({}),u=({children:e})=>{const t=(0,n.MM)({tableName:"packages",persistenceKeyPrefix:i.rt.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:i._G,title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:r.RJ.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:r.RJ.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:a,total:u},isFetching:m,fetchError:p}=(0,o.Lx)((0,n.Ng)({...t,hubSortFieldKeys:{}})),f=l.useMemo((()=>a.map((e=>({...e,decomposedPurl:(0,c.fe)(e.purl)})))),[a]),b=(0,n.PB)({...t,idProperty:"uuid",currentPageItems:f,totalItemCount:u,isLoading:m,selectionState:(0,s.$)({items:f,isEqual:(e,t)=>e.uuid===t.uuid})});return l.createElement(d.Provider,{value:{totalItemCount:u,isFetching:m,fetchError:p,tableControls:b}},e)}},53646:(e,t,a)=>{a.d(t,{N:()=>T});var l=a(63696),r=a(49348),i=a(40319),n=a(16646),s=a(9425),o=a(77819),c=a(28516),d=a(3629),u=a(16177),m=a(1349),p=a(62520),f=a(36509),b=a(93962),y=a(24417),h=a(28644),v=a(77347),E=a(40752),g=a(17993);const C={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},P=({packageId:e})=>{const{summary:t,isFetching:a,fetchError:r}=(e=>{const{pkg:t,isFetching:a,fetchError:r}=(0,g.Si)(e),[i,n]=l.useState([]),[s,o]=l.useState(new Map),[c,d]=l.useState(!1);l.useEffect((()=>{if(!t||0===t.advisories.length)return;const e=(t?.advisories??[]).flatMap((e=>(e.status??[]).map((t=>({vulnerabilityId:t.vulnerability.identifier,status:t.status,advisory:e}))))).filter((e=>"affected"===e.status)).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]);n(e),d(!0),Promise.all(e.map((async e=>(await(0,E.wk)({client:v.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),a=new Map;t.forEach((e=>{a.set(e.identifier,e)})),o(a),d(!1)}))}),[t]);const u=l.useMemo((()=>i.map((e=>({...e,vulnerability:s.get(e.vulnerabilityId)})))),[i,s]),m=l.useMemo((()=>u.reduce(((e,t)=>{if(t.vulnerability?.average_severity){const a=t.vulnerability?.average_severity;return{...e,total:e.total+1,severities:{...e.severities,[a]:e.severities[a]+1}}}return e}),C)),[u]);return{isFetching:a||c,fetchError:r,vulnerabilities:u,summary:m}})(e);return l.createElement(y.a,{isFetching:a,fetchError:r,isFetchingState:l.createElement(f.E,{screenreaderText:"Loading contents"}),fetchErrorState:l.createElement(b.J,{color:"red"},"Error")},l.createElement(h.n,{severities:t.severities}))};var S=a(30426);const T=()=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:f}=l.useContext(S.Y),{numRenderedColumns:b,currentPageItems:y,propHelpers:{paginationProps:h,tableProps:v,getThProps:E,getTrProps:g,getTdProps:C},expansionDerivedState:{isCellExpanded:T}}=f;return l.createElement(l.Fragment,null,l.createElement(i.X,{...v,"aria-label":"Package table"},l.createElement(n.d,null,l.createElement(s.Tr,null,l.createElement(p.Ze,{...f},l.createElement(o.Th,{...E({columnKey:"name"})}),l.createElement(o.Th,{...E({columnKey:"namespace"})}),l.createElement(o.Th,{...E({columnKey:"version"})}),l.createElement(o.Th,{...E({columnKey:"type"})}),l.createElement(o.Th,{...E({columnKey:"path"})}),l.createElement(o.Th,{...E({columnKey:"qualifiers"})}),l.createElement(o.Th,{...E({columnKey:"vulnerabilities"})})))),l.createElement(p.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:b},y.map(((e,t)=>l.createElement(c.N,{key:e.uuid},l.createElement(s.Tr,{...g({item:e})},l.createElement(p.Oi,{...f,item:e,rowIndex:t},l.createElement(d.Td,{width:15,...C({columnKey:"name"})},l.createElement(r.k2,{to:`/packages/${e.uuid}`},e.decomposedPurl?e.decomposedPurl?.name:e.purl)),l.createElement(d.Td,{width:15,modifier:"truncate",...C({columnKey:"namespace"})},e.decomposedPurl?.namespace),l.createElement(d.Td,{width:10,modifier:"truncate",...C({columnKey:"version"})},e.decomposedPurl?.version),l.createElement(d.Td,{width:10,modifier:"truncate",...C({columnKey:"type"})},e.decomposedPurl?.type),l.createElement(d.Td,{width:10,modifier:"truncate",...C({columnKey:"path"})},e.decomposedPurl?.path),l.createElement(d.Td,{width:20,...C({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&l.createElement(u.a,{value:e.decomposedPurl?.qualifiers})),l.createElement(d.Td,{width:20,...C({columnKey:"vulnerabilities"})},l.createElement(P,{packageId:e.uuid}))))))))),l.createElement(m.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:h}))}},36675:(e,t,a)=>{a.r(t),a.d(t,{default:()=>oe});var l=a(63696),r=a(68430),i=a(20653),n=a(35048),s=a(56918),o=a(1180),c=a(72785),d=a(4433),u=a(66174),m=a(86820),p=a(30426),f=a(36390),b=a(14310),y=a(7602);function h(e,t){return{Component:e,props:t}}const v=[h(f.c,{}),h(p.a,{}),h(b.y,{}),h(y.r,{})],E=(g=v,({children:e})=>{const t=l.createElement(l.Fragment,null,e);return g.reduceRight(((e,{Component:t,props:a={}})=>l.createElement(t,{...a},e)),t)});var g,C=a(69673),P=a(54518),S=a(48281),T=a(17327),k=a(71603),F=a(16459),_=a(71592),x=a(40111),I=a(96178),K=a(70414),A=a(53646),R=a(7123),N=a(90676),w=a(86416),D=a(8210),V=a(38914),M=a(57901),L=a(77635),O=a(87043),q=a(58897),B=a(71273),J=a(51463);const H=({category:e,filterValue:t,setFilterValue:a,isNumeric:r,isDisabled:i=!1})=>{const[n,s]=l.useState(t?.[0]||"");l.useEffect((()=>{s(t?.[0]||"")}),[t]);const o=()=>{const e=n.trim();a(e?[e.replace(/\s+/g," ")]:[])},c=`${e.categoryKey}-input`;return l.createElement(q.M,null,l.createElement(B.ks,{name:c,id:"search-input",type:r?"number":"search",onChange:(e,t)=>s(t),"aria-label":`${e.title} filter`,value:n,placeholder:e.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||o()},isDisabled:i}),l.createElement(L.$n,{variant:L.Ak.control,id:"search-button","aria-label":"search button for search input",onClick:o,isDisabled:i},l.createElement(J.Ay,null)))};var $=a(34629);const Y="pf-m-standalone",G="pf-m-disabled";var j=a(62634),W=a(1850);class Z extends l.Component{constructor(e){super(e),this.handleChange=e=>{this.props.onChange(e,e.currentTarget.checked)},e.label||e["aria-label"]||console.error("Radio:","Radio requires an aria-label to be specified"),this.state={ouiaStateId:(0,W.X)(Z.displayName)}}render(){const e=this.props,{"aria-label":t,checked:a,className:r,inputClassName:i,defaultChecked:n,isLabelWrapped:s,isLabelBeforeButton:o,isChecked:c,isDisabled:d,isValid:u,label:m,onChange:p,description:f,body:b,ouiaId:y,ouiaSafe:h=!0,component:v}=e,E=(0,$.__rest)(e,["aria-label","checked","className","inputClassName","defaultChecked","isLabelWrapped","isLabelBeforeButton","isChecked","isDisabled","isValid","label","onChange","description","body","ouiaId","ouiaSafe","component"]);E.id||console.error("Radio:","id is required to make input accessible");const g=l.createElement("input",Object.assign({},E,{className:(0,j.A)("pf-v5-c-radio__input",i),type:"radio",onChange:this.handleChange,"aria-invalid":!u,disabled:d,checked:a||c},void 0===a&&{defaultChecked:n},!m&&{"aria-label":t},(0,W.Bs)(Z.displayName,void 0!==y?y:this.state.ouiaStateId,h))),C=s&&!v||"label"===v,P=C?"span":"label",S=m?l.createElement(P,{className:(0,j.A)("pf-v5-c-radio__label",d&&G),htmlFor:C?void 0:E.id},m):null,T=null!=v?v:C?"label":"div";return l.createElement(T,{className:(0,j.A)("pf-v5-c-radio",!m&&Y,r),htmlFor:C?E.id:void 0},o?l.createElement(l.Fragment,null,S,g):l.createElement(l.Fragment,null,g,S),f&&l.createElement("span",{className:(0,j.A)("pf-v5-c-radio__description")},f),b&&l.createElement("span",{className:(0,j.A)("pf-v5-c-radio__body")},b))}}Z.displayName="Radio",Z.defaultProps={className:"",isDisabled:!1,isValid:!0,onChange:()=>{}};const X=({category:e,filterValue:t,setFilterValue:a,isDisabled:r=!1})=>l.createElement(l.Fragment,null,e.selectOptions.map((({label:i,value:n,optionProps:s={}},o)=>{const c=t?.includes(n)||!1;return l.createElement(Z,{isDisabled:r,key:o,id:`radio-${o}`,name:"radio",isLabelWrapped:!0,label:i,isChecked:c,onChange:()=>{(t=>{const l=(r=t,e.selectOptions.find((({value:e})=>e===r)));var r;a(l?[t]:null)})(n)}})})));var z=a(58365);const Q=({category:e,filterValue:t,setFilterValue:a,isDisabled:r=!1})=>{const[i,n]=l.useState(Array.isArray(e.selectOptions)?e.selectOptions:[]);l.useEffect((()=>{n(Array.isArray(e.selectOptions)?e.selectOptions:[])}),[e.selectOptions]);const s=Array.isArray(i)?i:Object.values(i).flatMap((e=>e));return l.createElement(l.Fragment,null,s.map((({label:r,value:i,optionProps:n={}},s)=>l.createElement(z.S,{key:s,id:`checkbox-${s}-${e.categoryKey}`,isLabelWrapped:!0,label:r,isChecked:t?.includes(i),onChange:()=>{(e=>{if(e&&"No results"!==e){let l;l=t&&t.includes(e)?t.filter((t=>t!==e)):t?[...t,e]:[e],a(l)}})(i)}}))))};var U=a(46721),ee=a(40360),te=a(23277),ae=a(78109),le=a(66341);const re=({category:e,filterValue:t,setFilterValue:a,isDisabled:r=!1})=>{const i=t??[],[n,s]=(i?.filter((e=>(0,le.Ce)((0,le.P1)(e)))),(0,l.useState)()),[o,c]=(0,l.useState)();return l.useEffect((()=>{if(t?.[0]){const[e,a]=(0,le.P1)(t?.[0]);s(e.toDate()),c(a.toDate())}else s(void 0),c(void 0)}),[t]),l.createElement(U.l,null,l.createElement(ee.g,{role:"group",isInline:!0,label:"From"},l.createElement(te.l,{value:n?(0,le.ak)(n):"",dateFormat:le.ak,dateParse:le.sy,onChange:(e,t)=>{(0,le.Fz)(t)&&(s((0,le.sy)(t)),c(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:r})),l.createElement(ee.g,{role:"group",isInline:!0,label:"To"},l.createElement(te.l,{value:o?(0,le.ak)(o):"",onChange:(e,t)=>{if((0,le.Fz)(t)){const e=(0,le.sy)(t);c(e);const l=(0,le.Kg)(n,e);l&&a([l])}},isDisabled:r||!(0,ae.v)(n),dateFormat:le.ak,dateParse:le.sy,invalidFormatText:"",rangeStart:n,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})))},ie=({category:e,...t})=>e.type===O.RJ.select?l.createElement(X,{category:e,...t}):e.type===O.RJ.search||e.type===O.RJ.numsearch?l.createElement(H,{category:e,isNumeric:e.type===O.RJ.numsearch,...t}):e.type===O.RJ.multiselect?l.createElement(Q,{category:e,...t}):e.type===O.RJ.dateRange?l.createElement(re,{category:e,...t}):null,ne=({filterCategories:e,filterValues:t,setFilterValues:a,isDisabled:r=!1,omitFilterCategoryKeys:i=[]})=>l.createElement(l.Fragment,null,l.createElement(V.B,{hasGutter:!0},l.createElement(M.a,null,l.createElement(L.$n,{variant:"link",isInline:!0,onClick:()=>{const l=e.filter((e=>void 0===i.find((t=>t===e.categoryKey)))).reduce(((e,t)=>({...e,[t.categoryKey]:void 0})),{});a({...t,...l})}},"Clear all filters")),e.filter((e=>void 0===i.find((t=>t===e.categoryKey)))).map((e=>l.createElement(M.a,{key:e.categoryKey},l.createElement(V.B,{hasGutter:!0},l.createElement(M.a,null,l.createElement(o.n,null,l.createElement(c.E,{component:"h4"},e.title))),l.createElement(M.a,null,l.createElement(ie,{category:e,filterValue:t[e.categoryKey],setFilterValue:l=>((e,l)=>a({...t,[e.categoryKey]:l}))(e,l),isDisabled:r,isSidebar:!0})))))))),se=({advisoryTable:e,filterPanelProps:t,packageTable:a,packageTotalCount:r,sbomTable:i,sbomTotalCount:n,vulnerabilityTable:s,vulnerabilityTotalCount:o})=>{const[c,d]=l.useState(0),{advisoryFilterPanelProps:u,packageFilterPanelProps:m,sbomFilterPanelProps:p,vulnerabilityFilterPanelProps:f}=t,b=l.createRef();return l.createElement(P.B,{hasGutter:!0},l.createElement(S.o,null,l.createElement(T.Z,{isFullHeight:!0},l.createElement(k.b,{style:{width:241}},0===c?l.createElement(ne,{omitFilterCategoryKeys:[""],...p}):1===c?l.createElement(ne,{omitFilterCategoryKeys:[""],...m}):2===c?l.createElement(ne,{omitFilterCategoryKeys:[""],...f}):3===c?l.createElement(ne,{omitFilterCategoryKeys:[""],...u}):null))),l.createElement(S.o,{isFilled:!0},l.createElement(F.t,{isBox:!0,activeKey:c,onSelect:(e,t)=>{d(t)},"aria-label":"Tabs",role:"region"},l.createElement(_.o,{eventKey:0,title:l.createElement(x.V,null,"SBOMs","  ",l.createElement(I.E,{screenReaderText:"Search Result Count"},n)),actions:l.createElement(l.Fragment,null,l.createElement(K.o,{"aria-label":"SBOM help popover",ref:b},l.createElement(D.Ay,null)),(y=b,l.createElement(C.A,{bodyContent:l.createElement("div",null,"Software Bill of Materials for Products and Containers."),position:"right",triggerRef:y})))},i??l.createElement(N.Y,null)),l.createElement(_.o,{eventKey:1,title:l.createElement(x.V,null,"Packages","  ",l.createElement(I.E,{screenReaderText:"Search Result Count"},r))},a??l.createElement(A.N,null)),l.createElement(_.o,{eventKey:2,title:l.createElement(x.V,null,"CVEs","  ",l.createElement(I.E,{screenReaderText:"Search Result Count"},o))},s??l.createElement(w.f,null)),l.createElement(_.o,{eventKey:3,title:l.createElement(x.V,null,"Advisories","  ",l.createElement(I.E,{screenReaderText:"Advisory Result Count"},o))},e??l.createElement(R.q,null)))));var y},oe=({searchBodyOverride:e})=>l.createElement(E,null,l.createElement(ce,{searchBodyOverride:e})),ce=({searchBodyOverride:e})=>{const{tableControls:t}=l.useContext(f.L),{tableControls:a}=l.useContext(p.Y),{tableControls:h}=l.useContext(b.u),{tableControls:v}=l.useContext(y.R),{totalItemCount:E,tableControls:{propHelpers:{filterPanelProps:g}}}=l.useContext(f.L),{totalItemCount:C,tableControls:{propHelpers:{filterPanelProps:P}}}=l.useContext(p.Y),{totalItemCount:S,tableControls:{propHelpers:{filterPanelProps:T}}}=l.useContext(b.u),{totalItemCount:k,tableControls:{propHelpers:{filterPanelProps:F}}}=l.useContext(y.R),_={advisoryFilterPanelProps:F,packageFilterPanelProps:P,sbomFilterPanelProps:g,vulnerabilityFilterPanelProps:T},[x,I]=l.useState(t.filterState.filterValues[m._G]?.[0]||""),K=l.createElement(se,{filterPanelProps:_,packageTotalCount:C,sbomTotalCount:E,vulnerabilityTotalCount:S});return l.createElement(l.Fragment,null,l.createElement(r.d8,{variant:r.zC.light},l.createElement(i.M,{isStatic:!0},l.createElement(n.P,null,l.createElement(s.$,{align:{default:"alignLeft"}},l.createElement(o.n,null,l.createElement(c.E,{component:"h1"},"Search Results"))),l.createElement(s.$,{variant:"icon-button-group",align:{default:"alignRight"}},l.createElement(s.$,{visibility:{default:"hidden",lg:"visible"}},l.createElement(d.T,{widths:{default:"500px"}},l.createElement(u.D,{placeholder:"Search for an SBOM, Package, or Vulnerability",value:x,onChange:(e,t)=>(e=>{I(e)})(t),onClear:()=>{I("")},onKeyDown:e=>{e.key&&"Enter"!==e.key||(t.filterState.setFilterValues({...t.filterState.filterValues,[m._G]:[x]}),a.filterState.setFilterValues({...a.filterState.filterValues,[m._G]:[x]}),h.filterState.setFilterValues({...h.filterState.filterValues,[m._G]:[x]}),v.filterState.setFilterValues({...v.filterState.filterValues,[m._G]:[x]}))}}))))))),l.createElement(r.d8,null,e||K))}},14310:(e,t,a)=>{a.d(t,{u:()=>c,y:()=>d});var l=a(63696),r=a(87043),i=a(86820),n=a(70611),s=a(5098),o=a(74932);const c=l.createContext({}),d=({children:e})=>{const t=(0,n.MM)({tableName:"vulnerability",persistenceKeyPrefix:i.rt.vulnerabilities,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Description",severity:"CVSS",published:"Date published",sboms:"Related documents"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["published","severity"],isFilterEnabled:!0,filterCategories:[{categoryKey:i._G,title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"average_severity",title:"CVSS",placeholderText:"CVSS",type:r.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"published",title:"Created on",type:r.RJ.dateRange}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:a,total:d},isFetching:u,fetchError:m}=(0,o.WJ)((0,n.Ng)({...t,hubSortFieldKeys:{severity:"average_severity",published:"published"}})),p=(0,n.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:d,isLoading:u,selectionState:(0,s.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return l.createElement(c.Provider,{value:{totalItemCount:d,isFetching:u,fetchError:m,tableControls:p}},e)}},86416:(e,t,a)=>{a.d(t,{f:()=>P});var l=a(63696),r=a(49348),i=a(40319),n=a(16646),s=a(9425),o=a(77819),c=a(28516),d=a(3629),u=a(11848),m=a(1349),p=a(62520),f=a(23560),b=a(34066),y=a(36509),h=a(93962),v=a(24417),E=a(68248);const g=({vulnerabilityId:e})=>{const{data:t,isFetching:a,fetchError:r}=(0,E.f)(e);return l.createElement(v.a,{isFetching:a,fetchError:r,isFetchingState:l.createElement(y.E,{screenreaderText:"Loading contents"}),fetchErrorState:l.createElement(h.J,{color:"red"},"Error")},t.summary.sbomStatus.affected)};var C=a(14310);const P=()=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:y}=l.useContext(C.u),{numRenderedColumns:h,currentPageItems:v,propHelpers:{paginationProps:E,tableProps:P,getThProps:S,getTrProps:T,getTdProps:k}}=y;return l.createElement(l.Fragment,null,l.createElement(i.X,{...P,"aria-label":"Vulnerability table"},l.createElement(n.d,null,l.createElement(s.Tr,null,l.createElement(p.Ze,{...y},l.createElement(o.Th,{...S({columnKey:"identifier"})}),l.createElement(o.Th,{...S({columnKey:"title"})}),l.createElement(o.Th,{...S({columnKey:"severity"})}),l.createElement(o.Th,{...S({columnKey:"published"})}),l.createElement(o.Th,{...S({columnKey:"sboms"})})))),l.createElement(p.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:h},v.map(((e,t)=>l.createElement(c.N,{key:e.identifier},l.createElement(s.Tr,{...T({item:e})},l.createElement(p.Oi,{...y,item:e,rowIndex:t},l.createElement(d.Td,{width:15,...k({columnKey:"identifier",item:e,rowIndex:t})},l.createElement(r.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),l.createElement(d.Td,{width:45,modifier:"truncate",...k({columnKey:"title"})},l.createElement(f.j,{vulnerability:e})),l.createElement(d.Td,{width:10,...k({columnKey:"severity"})},e.average_severity&&l.createElement(u.h,{value:e.average_severity})),l.createElement(d.Td,{width:10,...k({columnKey:"published"})},(0,b.Yq)(e.published)),l.createElement(d.Td,{width:10,...k({columnKey:"sboms",item:e,rowIndex:t})},l.createElement(g,{vulnerabilityId:e.identifier}))))))))),l.createElement(m.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:E}))}},69935:(e,t,a)=>{a.d(t,{VH:()=>u,Yu:()=>p,vy:()=>m});var l=a(39155),r=a(3715),i=a(77347),n=a(40752),s=a(81230),o=a(70611),c=a(24808);const d="advisories",u=(e={},t=!1)=>{const{data:a,isLoading:r,error:s,refetch:c}=(0,l.I)({queryKey:[d,e],queryFn:()=>(0,n.YM)({client:i.S,query:{...(0,o.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e??e},isFetching:r,fetchError:s||null,refetch:c}},m=e=>{const{data:t,isLoading:a,error:r}=(0,l.I)({queryKey:[d,e],queryFn:()=>(0,n.ai)({client:i.S,path:{key:e}}),enabled:void 0!==e});return{advisory:t?.data,isFetching:a,fetchError:r}},p=()=>{const e=(0,r.jE)();return(0,c.v)({parallel:!0,uploadFn:(e,t)=>(0,s.hP)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[d]})}})}},74932:(e,t,a)=>{a.d(t,{WJ:()=>o,uN:()=>c});var l=a(39155),r=a(77347),i=a(40752),n=a(70611);const s="vulnerabilities",o=(e={},t=!1)=>{const{data:a,isLoading:o,error:c,refetch:d}=(0,l.I)({queryKey:[s,e],queryFn:()=>(0,i.NI)({client:r.S,query:{...(0,n.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e},isFetching:o,fetchError:c,refetch:d}},c=e=>{const{data:t,isLoading:a,error:n}=(0,l.I)({queryKey:[s,e],queryFn:()=>(0,i.wk)({client:r.S,path:{id:e}})});return{vulnerability:t?.data,isFetching:a,fetchError:n}}},41775:(e,t,a)=>{a.d(t,{A:()=>l});const l={card:"pf-v5-c-card",cardActions:"pf-v5-c-card__actions",cardBody:"pf-v5-c-card__body",cardExpandableContent:"pf-v5-c-card__expandable-content",cardFooter:"pf-v5-c-card__footer",cardHeader:"pf-v5-c-card__header",cardHeaderMain:"pf-v5-c-card__header-main",cardHeaderToggle:"pf-v5-c-card__header-toggle",cardHeaderToggleIcon:"pf-v5-c-card__header-toggle-icon",cardSelectableActions:"pf-v5-c-card__selectable-actions",cardSrInput:"pf-v5-c-card__sr-input",cardTitle:"pf-v5-c-card__title",cardTitleText:"pf-v5-c-card__title-text",check:"pf-v5-c-check",checkInput:"pf-v5-c-check__input",checkLabel:"pf-v5-c-check__label",dirRtl:"pf-v5-m-dir-rtl",divider:"pf-v5-c-divider",modifiers:{selectable:"pf-m-selectable",clickable:"pf-m-clickable",selected:"pf-m-selected",current:"pf-m-current",disabled:"pf-m-disabled",hoverableRaised:"pf-m-hoverable-raised",selectableRaised:"pf-m-selectable-raised",nonSelectableRaised:"pf-m-non-selectable-raised",selectedRaised:"pf-m-selected-raised",compact:"pf-m-compact",displayLg:"pf-m-display-lg",flat:"pf-m-flat",plain:"pf-m-plain",rounded:"pf-m-rounded",expanded:"pf-m-expanded",fullHeight:"pf-m-full-height",toggleRight:"pf-m-toggle-right",noOffset:"pf-m-no-offset",noFill:"pf-m-no-fill"},radio:"pf-v5-c-radio",radioInput:"pf-v5-c-radio__input",radioLabel:"pf-v5-c-radio__label",themeDark:"pf-v5-theme-dark"}},13364:(e,t,a)=>{a.d(t,{A:()=>l});const l={modifiers:{fill:"pf-m-fill",gutter:"pf-m-gutter"},stack:"pf-v5-l-stack",stackItem:"pf-v5-l-stack__item"}}}]);
//# sourceMappingURL=474.91b44604.min.js.map