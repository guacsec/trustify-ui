"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[431],{17327:(e,t,a)=>{a.d(t,{E:()=>o,Z:()=>c});var l=a(34629),r=a(63696),n=a(53141),i=a(62634),s=a(1850);const o=r.createContext({cardId:"",registerTitleId:()=>{},isExpanded:!1,isClickable:!1,isSelectable:!1,isSelected:!1,isClicked:!1,isDisabled:!1}),c=e=>{var{children:t,id:a="",className:d,component:m="div",isCompact:u=!1,isSelectable:p=!1,isClickable:f=!1,isDisabled:v=!1,isSelectableRaised:E=!1,isSelected:b=!1,isClicked:g=!1,isDisabledRaised:h=!1,isFlat:y=!1,isExpanded:C=!1,isRounded:w=!1,isLarge:T=!1,isFullHeight:I=!1,isPlain:S=!1,ouiaId:x,ouiaSafe:A=!0,hasSelectableInput:P=!1,selectableInputAriaLabel:k,onSelectableInputChange:_=(()=>{})}=e,F=(0,l.__rest)(e,["children","id","className","component","isCompact","isSelectable","isClickable","isDisabled","isSelectableRaised","isSelected","isClicked","isDisabledRaised","isFlat","isExpanded","isRounded","isLarge","isFullHeight","isPlain","ouiaId","ouiaSafe","hasSelectableInput","selectableInputAriaLabel","onSelectableInputChange"]);const K=m,N=(0,s.iK)(c.displayName,x,A),[R,L]=r.useState(""),[q,U]=r.useState();u&&T&&(console.warn("Card: Cannot use isCompact with isLarge. Defaulting to isCompact"),T=!1);const M=r.useRef(!1);return r.useEffect((()=>{k?U({"aria-label":k}):R?U({"aria-labelledby":R}):P&&!M.current&&(U({}),console.warn("If no CardTitle component is passed as a child of Card the selectableInputAriaLabel prop must be passed"))}),[P,k,R]),r.createElement(o.Provider,{value:{cardId:a,registerTitleId:e=>{L(e),M.current=!!e},isExpanded:C,isClickable:f,isSelectable:p,isSelected:b,isClicked:g,isDisabled:v,hasSelectableInput:P}},P&&r.createElement("input",Object.assign({className:"pf-v5-screen-reader",id:`${a}-input`},q,{type:"checkbox",checked:b,onChange:e=>_(e,a),disabled:h,tabIndex:-1})),r.createElement(K,Object.assign({id:a,className:(0,i.A)(n.A.card,u&&n.A.modifiers.compact,C&&n.A.modifiers.expanded,y&&n.A.modifiers.flat,w&&n.A.modifiers.rounded,T&&n.A.modifiers.displayLg,I&&n.A.modifiers.fullHeight,S&&n.A.modifiers.plain,h?(0,i.A)(n.A.modifiers.nonSelectableRaised):E?(0,i.A)(n.A.modifiers.selectableRaised,b&&n.A.modifiers.selectedRaised):p&&f?(0,i.A)(n.A.modifiers.selectable,n.A.modifiers.clickable,(b||g)&&n.A.modifiers.current):p?(0,i.A)(n.A.modifiers.selectable,b&&n.A.modifiers.selected):f?(0,i.A)(n.A.modifiers.clickable,g&&n.A.modifiers.current):"",v&&n.A.modifiers.disabled,d),tabIndex:E?"0":void 0},F,N),t))};c.displayName="Card"},71603:(e,t,a)=>{a.d(t,{b:()=>s});var l=a(34629),r=a(63696),n=a(53141),i=a(62634);const s=e=>{var{children:t,className:a,component:s="div",isFilled:o=!0}=e,c=(0,l.__rest)(e,["children","className","component","isFilled"]);const d=s;return r.createElement(d,Object.assign({className:(0,i.A)(n.A.cardBody,!o&&n.A.modifiers.noFill,a)},c),t)};s.displayName="CardBody"},64361:(e,t,a)=>{a.d(t,{Z:()=>o});var l=a(34629),r=a(63696),n=a(62634),i=a(53141),s=a(17327);const o=e=>{var{children:t,className:a,component:o="div"}=e,c=(0,l.__rest)(e,["children","className","component"]);const{cardId:d,registerTitleId:m}=r.useContext(s.E),u=o,p=d?`${d}-title`:"";return r.useEffect((()=>(m(p),()=>m(""))),[m,p]),r.createElement("div",{className:(0,n.A)(i.A.cardTitle)},r.createElement(u,Object.assign({className:(0,n.A)(i.A.cardTitleText,a),id:p||void 0},c),t))};o.displayName="CardTitle"},93914:(e,t,a)=>{a.d(t,{Ay:()=>l});const l=(0,a(32791).w)({name:"ShieldAltIcon",height:512,width:512,svgPath:"M466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256.1 446.3l-.1-381 175.9 73.3c-3.3 151.4-82.1 261.1-175.8 307.7z",yOffset:0,xOffset:0})},8742:(e,t,a)=>{a.d(t,{u:()=>l});const l={name:"--pf-v5-global--danger-color--100",value:"#c9190b",var:"var(--pf-v5-global--danger-color--100)"}},19174:(e,t,a)=>{a.d(t,{n:()=>l});const l={name:"--pf-v5-global--info-color--100",value:"#2b9af3",var:"var(--pf-v5-global--info-color--100)"}},44304:(e,t,a)=>{a.d(t,{p:()=>l});const l={name:"--pf-v5-global--palette--black-400",value:"#b8bbbe",var:"var(--pf-v5-global--palette--black-400)"}},53359:(e,t,a)=>{a.d(t,{c:()=>l});const l={name:"--pf-v5-global--palette--purple-400",value:"#8476d1",var:"var(--pf-v5-global--palette--purple-400)"}},53820:(e,t,a)=>{a.d(t,{H:()=>l});const l={name:"--pf-v5-global--warning-color--100",value:"#f0ab00",var:"var(--pf-v5-global--warning-color--100)"}},55399:(e,t,a)=>{a.d(t,{K:()=>o,S:()=>d});var l=a(44304),r=a(19174),n=a(53820),i=a(8742),s=a(53359);const o={none:{name:"None",shieldIconColor:l.p,progressProps:{variant:void 0}},low:{name:"Low",shieldIconColor:r.n,progressProps:{variant:void 0}},medium:{name:"Medium",shieldIconColor:n.H,progressProps:{variant:"warning"}},high:{name:"High",shieldIconColor:i.u,progressProps:{variant:"danger"}},critical:{name:"Critical",shieldIconColor:s.c,progressProps:{variant:"danger"}}},c=e=>{switch(e){case"low":return 1;case"medium":return 2;case"high":return 3;case"critical":return 4;default:return 0}};function d(e){return(t,a)=>c(e(t))-c(e(a))}},80254:(e,t,a)=>{a.d(t,{V:()=>c});var l=a(63696),r=a(34066),n=a(65753),i=a(24974),s=a(21639),o=a(3939);const c=({advisory:e,excludedFields:t=[],descriptionListProps:a})=>l.createElement(n.B,{...a},!t.includes("title")&&l.createElement(i.W,null,l.createElement(s.X,null,"Title"),l.createElement(o.d,null,e.title)),!t.includes("published")&&l.createElement(i.W,null,l.createElement(s.X,null,"Published"),l.createElement(o.d,null,(0,r.Yq)(e.published))),!t.includes("modified")&&l.createElement(i.W,null,l.createElement(s.X,null,"Modified"),l.createElement(o.d,null,(0,r.Yq)(e.modified))),!t.includes("withdrawn")&&l.createElement(i.W,null,l.createElement(s.X,null,"Withdrawn"),l.createElement(o.d,null,(0,r.Yq)(e.withdrawn))))},88112:(e,t,a)=>{a.d(t,{N:()=>o});var l=a(63696),r=a(65753),n=a(24974),i=a(21639),s=a(3939);const o=({value:e})=>l.createElement(r.B,null,l.createElement(n.W,null,l.createElement(i.X,null,"Name"),l.createElement(s.d,null,e.issuer?.name)),l.createElement(n.W,null,l.createElement(i.X,null,"Website"),l.createElement(s.d,null,e.issuer?.website)))},85278:(e,t,a)=>{a.d(t,{x:()=>v});var l=a(63696),r=a(33364),n=a(77635),i=a(38914),s=a(57901),o=a(40360),c=a(23546),d=a(891),m=a(46721),u=a(76072),p=a(97299),f=a(23857);const v=({resourceName:e,value:t,onSave:a,onClose:v})=>{const[E,b]=l.useState(""),[g,h]=l.useState(""),[y,C]=l.useState(Object.entries(t).sort((([e],[t])=>t.localeCompare(e)))),w=()=>{if(!E||!g)return;const e=y.filter((([e])=>e!==E));C([...e,[E,g]]),b(""),h("")};return l.createElement(r.a,{isOpen:!0,variant:r.d.small,title:"Edit labels",onClose:v,actions:[l.createElement(n.$n,{key:"Save",variant:"primary",onClick:()=>{const e=y.reduce(((e,[t,a])=>({...e,[t]:a})),{});a(e)}},"Save"),l.createElement(n.$n,{key:"cancel",variant:"link",onClick:v},"Cancel")],ouiaId:"BasicModal"},l.createElement(i.B,{hasGutter:!0},l.createElement(s.a,null,"Labels help you organize and select resources. Adding labels below will let you query for objects that have similar, overlapping or dissimilar labels."),l.createElement(s.a,null,l.createElement("div",{className:"pf-v5-c-form"},l.createElement(o.g,{label:`Labels for ${e}`},l.createElement(c.o,{className:"pf-v5-c-form-control",style:{padding:10,minHeight:10},defaultIsOpen:!0,numLabels:10},y.map((([e,t],a)=>l.createElement(d.J,{key:a,color:"blue",onClose:()=>{const e=[...y];e.splice(a,1),C(e)}},`${e}=${t}`))))))),l.createElement(s.a,null,l.createElement(m.l,{onSubmit:e=>{w(),e.preventDefault()}},l.createElement(u.x,{hasGutter:!0},l.createElement(p.E,{md:5},l.createElement(o.g,{label:"Key",isRequired:!0,fieldId:"key"},l.createElement(f.ks,{isRequired:!0,type:"text",id:"key",name:"key",value:E,onChange:(e,t)=>b(t)}))),l.createElement(p.E,{md:5},l.createElement(o.g,{label:"Value",isRequired:!0,fieldId:"value"},l.createElement(f.ks,{isRequired:!0,type:"text",id:"value",name:"value",value:g,onChange:(e,t)=>h(t)}))),l.createElement(p.E,{md:2},l.createElement(o.g,{label:"Action"},l.createElement(n.$n,{type:"submit",variant:n.Ak.secondary,onClick:w},"Add"))))))))}},67837:(e,t,a)=>{a.d(t,{g:()=>s});var l=a(63696),r=a(23546),n=a(891),i=a(71743);const s=({value:e,defaultIsOpen:t})=>l.createElement(r.o,{isVertical:!0,defaultIsOpen:t,numLabels:2},Object.entries(e).sort((([e],[t])=>t.localeCompare(e))).map((([e,t],a)=>l.createElement(n.J,{key:a,color:"blue"},l.createElement(i.P,{content:`${e}=${t}`})))))},52302:(e,t,a)=>{a.d(t,{h:()=>c});var l=a(63696),r=a(28338),n=a(70045),i=a(85310),s=a(93914),o=a(55399);const c=({value:e,hideLabel:t})=>{const a=o.K[e],c=e.charAt(0).toUpperCase()+e.slice(1);return l.createElement(r.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},l.createElement(n.Z,null,t?l.createElement(i.m,{content:c},l.createElement(s.Ay,{color:a.shieldIconColor.value})):l.createElement(s.Ay,{color:a.shieldIconColor.value})),!t&&l.createElement(n.Z,null,c))}},24813:(e,t,a)=>{a.d(t,{A:()=>h});var l=a(1180),r=a(28341),n=a(73401),i=a(64335),s=a(57311),o=a(73220),c=a(99205),d=a(68986),m=a(33364),u=a(94279),p=a(16172),f=a(63696),v=a(56279),E=a(84608),b=a(341),g=a(77307);const h=({isExpanded:e,uploads:t,onCloseClick:a,handleUpload:h,handleRemoveUpload:y,extractSuccessMessage:C,extractErrorMessage:w})=>{const[T,I]=f.useState(!1),[S,x]=f.useState("inProgress"),[A,P]=f.useState([]);!T&&t.size>0&&I(!0),f.useEffect((()=>{const e=Array.from(t.values());e.some((e=>"inProgress"===e.status))?x("inProgress"):e.every((e=>"complete"===e.status))?x("success"):x("danger")}),[t]);const k=Array.from(t.values()).filter((e=>e.response)).length;return f.createElement(g.q,{isExpanded:e,onCloseClick:a,pageKey:"upload-files",drawerPanelContentProps:{defaultSize:"600px"},header:f.createElement(l.n,null,f.createElement(r.h,{headingLevel:"h2",size:"lg",className:b.A.mtXs},"Upload files"))},f.createElement(n.w,{onFileDrop:(e,t)=>{h(t)},dropzoneProps:{accept:{"application/xml":[".json"]},onDropRejected:e=>{P(e)}},isHorizontal:!0},f.createElement(i.x,{titleIcon:f.createElement(E.Ay,null),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: JSON"}),T&&f.createElement(s.y,{statusToggleText:`${k} of ${t.size} files uploaded`,statusToggleIcon:S},Array.from(t.entries()).map((([e,t],a)=>f.createElement(o.L,{fileIcon:f.createElement(v.Ay,null),file:e,key:`${e.name}-${a}`,onClearClick:()=>{[e].forEach((e=>{y(e)}))},progressValue:t.progress,progressVariant:t.error?"danger":t.response?"success":void 0,progressHelperText:t.error?f.createElement(c.E,{isLiveRegion:!0},f.createElement(d.j,{variant:"error"},w(t.error))):t.response?f.createElement(c.E,{isLiveRegion:!0},f.createElement(d.j,{variant:"default"},C(t.response))):void 0})))),f.createElement(m.a,{isOpen:A.length>0,title:"Unsupported files",titleIconVariant:"warning",showClose:!0,"aria-label":"unsupported file upload attempted",onClose:()=>P([]),variant:"small"},f.createElement(u.B8,null,A.map(((e,t)=>f.createElement(p.c,{key:t},e.file.name)))))))}},23713:(e,t,a)=>{a.d(t,{m:()=>n});var l=a(81230),r=a(22249);const n=()=>({downloadAdvisory:(e,t)=>{(0,l.yZ)(e).then((a=>{(0,r.saveAs)(new Blob([a.data]),t||`${e}.json`)}))},downloadCVE:(e,t)=>{(0,l.J8)(e).then((a=>{(0,r.saveAs)(new Blob([a.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,l.Ix)(e).then((a=>{(0,r.saveAs)(new Blob([a.data]),t||`${e}.json`)}))}})},24808:(e,t,a)=>{a.d(t,{v:()=>o});var l=a(63696),r=a(64917),n=a(86820);const i="cancelled",s=(e,t)=>{switch(t.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},status:"queued",cancelFn:t.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},progress:t.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",response:t.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",error:t.payload.error,wasCancelled:t.payload.error?.message===i})};case"removeUpload":{const a=new Map(e.uploads);return a.delete(t.payload.file),{...e,uploads:a}}default:throw new Error}},o=({parallel:e,uploadFn:t,onSuccess:a,onError:o})=>{const[c,d]=l.useReducer(s,{uploads:new Map});return{uploads:c.uploads,handleUpload:l=>{const s=[];for(let e=0;e<l.length;e++){const t=l[e],c=new FormData;c.set(n.fs,t);const m=r.A.CancelToken.source(),u={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{const a=e.total??1,l=e.loaded/a*100;d({type:"updateUploadProgress",payload:{file:t,progress:Math.round(l)}})},cancelToken:m.token};d({type:"queueUpload",payload:{file:t,cancelFn:m}});const p={formData:c,config:u,thenFn:e=>{d({type:"finishUploadSuccessfully",payload:{file:t,response:e}}),a&&a(e,t)},catchFn:e=>{d({type:"finishUploadWithError",payload:{file:t,error:e}}),e.message!==i&&o&&o(e,t)}};s.push(p)}e?s.forEach((e=>{t(e.formData,e.config).then(e.thenFn).catch(e.catchFn)})):s.reduce((async(e,a)=>(await e,t(a.formData,a.config).then(a.thenFn).catch(a.catchFn))),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(i)},handleRemoveUpload:e=>{d({type:"removeUpload",payload:{file:e}})}}}},32343:(e,t,a)=>{a.d(t,{j:()=>w});var l=a(63696),r=a(49348),n=a(95285),i=a.n(n),s=a(20653),o=a(35048),c=a(4433),d=a(85578),m=a(16646),u=a(31065),p=a(77819),f=a(28516),v=a(3629),E=a(33273),b=a(52302),g=a(1349),h=a(62520),y=a(70611),C=a(34066);const w=({enableToolbar:e,variant:t,vulnerabilities:a})=>{const n=(0,y.vY)({variant:t,tableName:"vulnerability-table",idProperty:"identifier",items:a,columnNames:{identifier:"Identifier",title:"Title",severity:"Severity",discovered:"Discovered",released:"Released",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier","discovered","released"],getSortValues:e=>({identifier:e?.identifier||"",discovered:e.discovered?i()(e.discovered).valueOf():0,released:e.released?i()(e.released).valueOf():0}),isPaginationEnabled:!0,isExpansionEnabled:!1,isFilterEnabled:!0,filterCategories:[{categoryKey:"id",title:"ID",type:E.RJ.search,placeholderText:"Search by ID...",getItemValue:e=>e.identifier||""}]}),{currentPageItems:w,numRenderedColumns:T,propHelpers:{toolbarProps:I,filterToolbarProps:S,paginationToolbarItemProps:x,paginationProps:A,tableProps:P,getThProps:k,getTrProps:_,getTdProps:F}}=n;return l.createElement(l.Fragment,null,e&&l.createElement(s.M,{...I},l.createElement(o.P,null,l.createElement(E.Us,{showFiltersSideBySide:!0,...S}),l.createElement(c.T,{...x},l.createElement(g.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:A})))),l.createElement(d.X,{...P,"aria-label":"Vulnerability table"},l.createElement(m.d,null,l.createElement(u.Tr,null,l.createElement(h.Ze,{...n},l.createElement(p.Th,{...k({columnKey:"identifier"})}),l.createElement(p.Th,{...k({columnKey:"title"})}),l.createElement(p.Th,{...k({columnKey:"severity"})}),l.createElement(p.Th,{...k({columnKey:"discovered"})}),l.createElement(p.Th,{...k({columnKey:"released"})}),l.createElement(p.Th,{...k({columnKey:"cwe"})})))),l.createElement(h.nJ,{isLoading:!1,isError:void 0,isNoData:0===a.length,numRenderedColumns:T},w?.map(((e,t)=>l.createElement(f.N,{key:e.identifier},l.createElement(u.Tr,{..._({item:e})},l.createElement(h.Oi,{...n,item:e,rowIndex:t},l.createElement(v.Td,{width:15,...F({columnKey:"identifier"})},l.createElement(r.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),l.createElement(v.Td,{width:40,modifier:"truncate",...F({columnKey:"title"})},e.title||e.description),l.createElement(v.Td,{width:15,...F({columnKey:"severity"})},l.createElement(b.h,{value:e.severity})),l.createElement(v.Td,{width:10,...F({columnKey:"discovered"})},(0,C.Yq)(e.discovered)),l.createElement(v.Td,{width:10,...F({columnKey:"released"})},(0,C.Yq)(e.released)),l.createElement(v.Td,{width:10,...F({columnKey:"cwe"})},e.cwe)))))))),l.createElement(g.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:A}))}},63195:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Y});var l=a(63696),r=a(49348),n=a(68430),i=a(1180),s=a(72785),o=a(20653),c=a(35048),d=a(4433),m=a(77635),u=a(38914),p=a(57901),f=a(76072),v=a(97299),E=a(17327),b=a(64361),g=a(71603),h=a(85578),y=a(16646),C=a(31065),w=a(77819),T=a(28516),I=a(3629),S=a(62101),x=a(38139),A=a(86820),P=a(33273),k=a(1349),_=a(62520),F=a(24813),K=a(70611),N=a(23713),R=a(5098),L=a(69935),q=a(67837),U=a(52302),M=a(85278),D=a(50705),O=a(80254),$=a(88112),H=a(32343),j=a(28338),B=a(70045),W=a(9369),Z=a(55399),V=a(86099);const X=({severities:e})=>{const t=Object.values(e).reduce(((e,t)=>e+t),0);return l.createElement(j.s,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},l.createElement(B.Z,{style:{minWidth:15,textAlign:V.pG}},t),l.createElement(W.c,{orientation:{default:"vertical"}}),l.createElement(B.Z,null,l.createElement(j.s,null,Object.entries(e).filter((([e,t])=>t>0)).sort((0,Z.S)((([e,t])=>e))).reverse().map((([e,t],a)=>l.createElement(B.Z,{key:a,spacer:{default:"spacerXs"}},l.createElement(j.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},l.createElement(B.Z,null,l.createElement(U.h,{value:e,hideLabel:!0})),l.createElement(B.Z,null,t))))))))},J={none:0,low:0,medium:0,high:0,critical:0},z=({vulnerabilities:e})=>{const t=e.reduce(((e,t)=>({...e,[t.severity]:e[t.severity]+1})),J);return l.createElement(X,{severities:t})},Y=()=>{const{pushNotification:e}=l.useContext(D.K),[t,a]=l.useState(!1),{uploads:j,handleUpload:B,handleRemoveUpload:W}=(0,L.Yu)(),[Z,V]=l.useState(null),[X,J]=l.useState(null),{mutate:Y}=(0,L.uJ)((()=>{}),(t=>{e({title:"Error while updating labels",variant:"danger"})})),G=(0,K.MM)({tableName:"advisories",persistenceKeyPrefix:A.rt.advisories,columnNames:{identifier:"Identifier",title:"Title",severity:"Severity",labels:"Labels",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","severity"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:P.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:P.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:Q,total:ee},isFetching:te,fetchError:ae}=(0,L.VH)((0,K.Ng)({...G,hubSortFieldKeys:{identifier:"identifier",severity:"average_score"}})),le=(0,K.PB)({...G,idProperty:"uuid",currentPageItems:Q,totalItemCount:ee,isLoading:te,selectionState:(0,R.$)({items:Q,isEqual:(e,t)=>e.identifier===t.identifier})}),{numRenderedColumns:re,currentPageItems:ne,propHelpers:{toolbarProps:ie,filterToolbarProps:se,paginationToolbarItemProps:oe,paginationProps:ce,tableProps:de,getThProps:me,getTrProps:ue,getTdProps:pe,getExpandedContentTdProps:fe},expansionDerivedState:{isCellExpanded:ve}}=le,{downloadAdvisory:Ee}=(0,N.m)();return l.createElement(l.Fragment,null,l.createElement(n.d8,{variant:n.zC.light},l.createElement(i.n,null,l.createElement(s.E,{component:"h1"},"Advisories"))),l.createElement(n.d8,null,l.createElement("div",{style:{backgroundColor:"var(--pf-v5-global--BackgroundColor--100)"}},l.createElement(o.M,{...ie},l.createElement(c.P,null,l.createElement(P.Us,{showFiltersSideBySide:!0,...se}),l.createElement(d.T,null,l.createElement(m.$n,{type:"button",id:"upload","aria-label":"Upload",variant:"secondary",onClick:()=>a(!0)},"Upload")),l.createElement(d.T,{...oe},l.createElement(k.n,{idPrefix:"advisory-table",isTop:!0,paginationProps:ce})))),l.createElement(h.X,{...de,"aria-label":"Advisory table",className:"vertical-middle-aligned-table"},l.createElement(y.d,null,l.createElement(C.Tr,null,l.createElement(_.Ze,{...le},l.createElement(w.Th,{...me({columnKey:"identifier"})}),l.createElement(w.Th,{...me({columnKey:"title"})}),l.createElement(w.Th,{...me({columnKey:"severity"})}),l.createElement(w.Th,{...me({columnKey:"labels"})}),l.createElement(w.Th,{...me({columnKey:"vulnerabilities"})})))),l.createElement(_.nJ,{isLoading:te,isError:!!ae,isNoData:0===ee,numRenderedColumns:re},ne.map(((e,t)=>l.createElement(T.N,{key:e.identifier,isExpanded:ve(e)},l.createElement(C.Tr,{...ue({item:e})},l.createElement(_.Oi,{...le,item:e,rowIndex:t},l.createElement(I.Td,{width:15,...pe({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},l.createElement(r.k2,{to:`/advisories/${e.uuid}`},e.identifier)),l.createElement(I.Td,{width:40,modifier:"breakWord",...pe({columnKey:"title"})},e.title),l.createElement(I.Td,{width:10,modifier:"truncate",...pe({columnKey:"severity"})},e.average_severity&&l.createElement(U.h,{value:e.average_severity})),l.createElement(I.Td,{width:25,modifier:"truncate",...pe({columnKey:"labels"})},e.labels&&l.createElement(q.g,{value:e.labels})),l.createElement(I.Td,{width:10,modifier:"truncate",...pe({columnKey:"vulnerabilities",isCompoundExpandToggle:!0,item:e,rowIndex:t})},e.vulnerabilities&&l.createElement(z,{vulnerabilities:e.vulnerabilities})),l.createElement(I.Td,{isActionCell:!0},l.createElement(S.G,{items:[{title:"Edit labels",onClick:()=>{var t;t=e,V("editLabels"),J(t)}},{title:"Download",onClick:()=>{Ee(e.uuid,`${e.identifier}.json`)}}]})))),ve(e)?l.createElement(C.Tr,{isExpanded:!0},l.createElement(I.Td,{...fe({item:e})},l.createElement(x.g,null,l.createElement("div",{className:"pf-v5-u-m-md"},ve(e,"identifier")?l.createElement(l.Fragment,null,l.createElement(u.B,{hasGutter:!0},l.createElement(p.a,null,l.createElement(f.x,{hasGutter:!0},l.createElement(v.E,{md:6},l.createElement(E.Z,{isFullHeight:!0,isCompact:!0},l.createElement(b.Z,null,"General view"),l.createElement(g.b,null,l.createElement(O.V,{advisory:e,excludedFields:["title"],descriptionListProps:{columnModifier:{default:"2Col"}}})))),l.createElement(v.E,{md:6},l.createElement(E.Z,{isFullHeight:!0,isCompact:!0},l.createElement(b.Z,null,"Issuer"),l.createElement(g.b,null,l.createElement($.N,{value:e})))))))):null,ve(e,"vulnerabilities")?l.createElement(l.Fragment,null,e.vulnerabilities&&l.createElement(H.j,{variant:"compact",vulnerabilities:e.vulnerabilities})):null)))):null))))),l.createElement(k.n,{idPrefix:"advisories-table",isTop:!1,isCompact:!0,paginationProps:ce}))),l.createElement(F.A,{isExpanded:t,uploads:j,handleUpload:B,handleRemoveUpload:W,extractSuccessMessage:e=>`${e.data.document_id} uploaded`,extractErrorMessage:e=>e.response?.data?e.message:"Error while uploading file",onCloseClick:()=>a(!1)}),"editLabels"===Z&&X&&l.createElement(M.x,{resourceName:X.identifier,value:X.labels??{},onSave:e=>{((e,t)=>{Y({...e,labels:t})})(X,e),J(null),V(null)},onClose:()=>V(null)}))}},69935:(e,t,a)=>{a.d(t,{VH:()=>c,Yu:()=>u,qF:()=>m,uJ:()=>p,vy:()=>d});var l=a(7616),r=a(3715),n=a(26667),i=a(81230),s=a(24808);const o="advisories",c=(e={},t=!1)=>{const{data:a,isLoading:r,error:n,refetch:s}=(0,l.I)({queryKey:[o,e],queryFn:()=>(0,i.uK)(e),refetchInterval:!t&&5e3});return{result:{data:a?.data||[],total:a?.total??0,params:a?.params??e},isFetching:r,fetchError:n,refetch:s}},d=e=>{const{data:t,isLoading:a,error:r}=(0,l.I)({queryKey:[o,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,i.wJ)(e),enabled:void 0!==e});return{advisory:t,isFetching:a,fetchError:r}},m=e=>{const{data:t,isLoading:a,error:r}=(0,l.I)({queryKey:[o,e,"source"],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,i.N2)(e),enabled:void 0!==e});return{source:t,isFetching:a,fetchError:r}},u=()=>{const e=(0,r.jE)();return(0,s.v)({parallel:!0,uploadFn:(e,t)=>(0,i.hP)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[o]})}})},p=(e,t)=>{const a=(0,r.jE)();return(0,n.n)({mutationFn:e=>(0,i._e)(e.uuid,e.labels??{}),onSuccess:(t,l)=>{e(),a.invalidateQueries({queryKey:[o]})},onError:t})}},53141:(e,t,a)=>{a.d(t,{A:()=>l});const l={card:"pf-v5-c-card",cardActions:"pf-v5-c-card__actions",cardBody:"pf-v5-c-card__body",cardExpandableContent:"pf-v5-c-card__expandable-content",cardFooter:"pf-v5-c-card__footer",cardHeader:"pf-v5-c-card__header",cardHeaderMain:"pf-v5-c-card__header-main",cardHeaderToggle:"pf-v5-c-card__header-toggle",cardHeaderToggleIcon:"pf-v5-c-card__header-toggle-icon",cardSelectableActions:"pf-v5-c-card__selectable-actions",cardSrInput:"pf-v5-c-card__sr-input",cardTitle:"pf-v5-c-card__title",cardTitleText:"pf-v5-c-card__title-text",check:"pf-v5-c-check",checkInput:"pf-v5-c-check__input",checkLabel:"pf-v5-c-check__label",dirRtl:"pf-v5-m-dir-rtl",divider:"pf-v5-c-divider",modifiers:{selectable:"pf-m-selectable",clickable:"pf-m-clickable",selected:"pf-m-selected",current:"pf-m-current",disabled:"pf-m-disabled",hoverableRaised:"pf-m-hoverable-raised",selectableRaised:"pf-m-selectable-raised",nonSelectableRaised:"pf-m-non-selectable-raised",selectedRaised:"pf-m-selected-raised",compact:"pf-m-compact",displayLg:"pf-m-display-lg",flat:"pf-m-flat",plain:"pf-m-plain",rounded:"pf-m-rounded",expanded:"pf-m-expanded",fullHeight:"pf-m-full-height",toggleRight:"pf-m-toggle-right",noOffset:"pf-m-no-offset",noFill:"pf-m-no-fill"},radio:"pf-v5-c-radio",radioInput:"pf-v5-c-radio__input",radioLabel:"pf-v5-c-radio__label",themeDark:"pf-v5-theme-dark"}}}]);
//# sourceMappingURL=431.88484d34.min.js.map