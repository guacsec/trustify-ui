"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[721],{85278:(e,t,l)=>{l.d(t,{x:()=>y});var a=l(63696),n=l(33364),r=l(77635),i=l(38914),o=l(57901),c=l(40360),s=l(23546),m=l(891),u=l(46721),d=l(76072),E=l(97299),p=l(23857);const y=({resourceName:e,value:t,onSave:l,onClose:y})=>{const[g,b]=a.useState(""),[h,v]=a.useState(""),[f,C]=a.useState(Object.entries(t).sort((([e],[t])=>t.localeCompare(e)))),T=()=>{if(!g||!h)return;const e=f.filter((([e])=>e!==g));C([...e,[g,h]]),b(""),v("")};return a.createElement(n.a,{isOpen:!0,variant:n.d.small,title:"Edit labels",onClose:y,actions:[a.createElement(r.$n,{key:"Save",variant:"primary",onClick:()=>{const e=f.reduce(((e,[t,l])=>({...e,[t]:l})),{});l(e)}},"Save"),a.createElement(r.$n,{key:"cancel",variant:"link",onClick:y},"Cancel")],ouiaId:"BasicModal"},a.createElement(i.B,{hasGutter:!0},a.createElement(o.a,null,"Labels help you organize and select resources. Adding labels below will let you query for objects that have similar, overlapping or dissimilar labels."),a.createElement(o.a,null,a.createElement("div",{className:"pf-v5-c-form"},a.createElement(c.g,{label:`Labels for ${e}`},a.createElement(s.o,{className:"pf-v5-c-form-control",style:{padding:10,minHeight:10},defaultIsOpen:!0,numLabels:10},f.map((([e,t],l)=>a.createElement(m.J,{key:l,color:"blue",onClose:()=>{const e=[...f];e.splice(l,1),C(e)}},`${e}=${t}`))))))),a.createElement(o.a,null,a.createElement(u.l,{onSubmit:e=>{T(),e.preventDefault()}},a.createElement(d.x,{hasGutter:!0},a.createElement(E.E,{md:5},a.createElement(c.g,{label:"Key",isRequired:!0,fieldId:"key"},a.createElement(p.ks,{isRequired:!0,type:"text",id:"key",name:"key",value:g,onChange:(e,t)=>b(t)}))),a.createElement(E.E,{md:5},a.createElement(c.g,{label:"Value",isRequired:!0,fieldId:"value"},a.createElement(p.ks,{isRequired:!0,type:"text",id:"value",name:"value",value:h,onChange:(e,t)=>v(t)}))),a.createElement(E.E,{md:2},a.createElement(c.g,{label:"Action"},a.createElement(r.$n,{type:"submit",variant:r.Ak.secondary,onClick:T},"Add"))))))))}},23713:(e,t,l)=>{l.d(t,{m:()=>r});var a=l(81230),n=l(22249);const r=()=>({downloadAdvisory:(e,t)=>{(0,a.yZ)(e).then((l=>{(0,n.saveAs)(new Blob([l.data]),t||`${e}.json`)}))},downloadCVE:(e,t)=>{(0,a.J8)(e).then((l=>{(0,n.saveAs)(new Blob([l.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,a.Ix)(e).then((l=>{(0,n.saveAs)(new Blob([l.data]),t||`${e}.json`)}))}})},63095:(e,t,l)=>{l.d(t,{w:()=>r});var a=l(63696),n=l(50705);const r=e=>{const{pushNotification:t}=a.useContext(n.K);return(l,a)=>{let n="";n="string"==typeof e?e:e(l,a),t({title:n,variant:"danger"})}}},30426:(e,t,l)=>{l.d(t,{Y:()=>m,a:()=>u});var a=l(63696),n=l(33273),r=l(86820),i=l(70611),o=l(5098),c=l(17993),s=l(34066);const m=a.createContext({}),u=({children:e})=>{const t=(0,i.MM)({tableName:"packages",persistenceKeyPrefix:r.rt.packages,columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",qualifiers:"Qualifiers"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:n.RJ.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:n.RJ.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"}]}],isExpansionEnabled:!0,expandableVariant:"single"}),{result:{data:l,total:u},isFetching:d,fetchError:E}=(0,c.Lx)((0,i.Ng)({...t})),p=a.useMemo((()=>l.map((e=>({...e,decomposedPurl:(0,s.fe)(e.purl)})))),[l]),y=(0,i.PB)({...t,idProperty:"uuid",currentPageItems:p,totalItemCount:u,isLoading:d,selectionState:(0,o.$)({items:p,isEqual:(e,t)=>e.uuid===t.uuid})});return a.createElement(m.Provider,{value:{totalItemCount:u,isFetching:d,fetchError:E,tableControls:y}},e)}},32059:(e,t,l)=>{l.d(t,{N:()=>f});var a=l(63696),n=l(49348),r=l(65753),i=l(24974),o=l(21639),c=l(3939),s=l(85578),m=l(16646),u=l(31065),d=l(77819),E=l(28516),p=l(3629),y=l(38139),g=l(16177),b=l(1349),h=l(62520),v=l(30426);const f=()=>{const{isFetching:e,fetchError:t,totalItemCount:l,tableControls:f}=a.useContext(v.Y),{numRenderedColumns:C,currentPageItems:T,propHelpers:{paginationProps:P,tableProps:x,getThProps:S,getTrProps:k,getTdProps:K},expansionDerivedState:{isCellExpanded:F}}=f;return a.createElement(a.Fragment,null,a.createElement(s.X,{...x,"aria-label":"Package table"},a.createElement(m.d,null,a.createElement(u.Tr,null,a.createElement(h.Ze,{...f},a.createElement(d.Th,{...S({columnKey:"name"})}),a.createElement(d.Th,{...S({columnKey:"namespace"})}),a.createElement(d.Th,{...S({columnKey:"version"})}),a.createElement(d.Th,{...S({columnKey:"type"})}),a.createElement(d.Th,{...S({columnKey:"qualifiers"})})))),a.createElement(h.nJ,{isLoading:e,isError:!!t,isNoData:0===l,numRenderedColumns:C},T.map(((e,t)=>a.createElement(E.N,{key:e.uuid},a.createElement(u.Tr,{...k({item:e})},a.createElement(h.Oi,{...f,item:e,rowIndex:t},a.createElement(p.Td,{width:25,...K({columnKey:"name"})},a.createElement(n.k2,{to:`/packages/${encodeURIComponent(e.uuid)}`},e.decomposedPurl?e.decomposedPurl?.name:e.purl)),a.createElement(p.Td,{width:10,modifier:"truncate",...K({columnKey:"namespace"})},e.decomposedPurl?.namespace),a.createElement(p.Td,{width:15,modifier:"truncate",...K({columnKey:"version"})},e.decomposedPurl?.version),a.createElement(p.Td,{width:10,modifier:"truncate",...K({columnKey:"type"})},e.decomposedPurl?.type),a.createElement(p.Td,{width:40,...K({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&a.createElement(g.a,{value:e.decomposedPurl?.qualifiers})))),F(e)?a.createElement(u.Tr,{isExpanded:!0},a.createElement(p.Td,{colSpan:7},a.createElement(y.g,null,a.createElement("div",{className:"pf-v5-u-m-md"},a.createElement(r.B,null,a.createElement(i.W,null,a.createElement(o.X,null,"Purl"),a.createElement(c.d,null,e.purl)),a.createElement(i.W,null,a.createElement(o.X,null,"Path"),a.createElement(c.d,null,e.decomposedPurl?.path))))))):null))))),a.createElement(b.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:P}))}},36390:(e,t,l)=>{l.d(t,{L:()=>s,c:()=>m});var a=l(63696),n=l(33273),r=l(86820),i=l(70611),o=l(5098),c=l(91728);const s=a.createContext({}),m=({children:e})=>{const t=(0,i.MM)({tableName:"sbom",persistenceKeyPrefix:r.rt.sboms,columnNames:{name:"Name",published:"Published",labels:"Labels",packages:"Packages"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["published"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:n.RJ.search}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:l,total:m},isFetching:u,fetchError:d}=(0,c.i$)((0,i.Ng)({...t,hubSortFieldKeys:{published:"published"}})),E=(0,i.PB)({...t,idProperty:"id",currentPageItems:l,totalItemCount:m,isLoading:u,selectionState:(0,o.$)({items:l,isEqual:(e,t)=>e.id===t.id})});return a.createElement(s.Provider,{value:{totalItemCount:m,isFetching:u,fetchError:d,tableControls:E}},e)}},72112:(e,t,l)=>{l.d(t,{Y:()=>V});var a=l(63696),n=l(49348),r=l(65753),i=l(24974),o=l(21639),c=l(3939),s=l(94279),m=l(16172),u=l(85578),d=l(16646),E=l(31065),p=l(77819),y=l(28516),g=l(3629),b=l(62101),h=l(38139),v=l(85278),f=l(33273),C=l(67837),T=l(50705),P=l(17993);const x=({sbomId:e})=>{const{result:{total:t}}=(0,P.sl)(e,{page:{pageNumber:1,itemsPerPage:1}});return a.createElement(a.Fragment,null,t)};var S=l(1349),k=l(62520),K=l(70611),F=l(23713),w=l(63095),I=l(91728),N=l(34066),R=l(36390);const V=({})=>{const{isFetching:e,fetchError:t,totalItemCount:l,tableControls:f}=a.useContext(R.L),{pushNotification:P}=a.useContext(T.K),[K,V]=a.useState(null),[M,O]=a.useState(null),{mutate:A}=(0,I.cF)((()=>{}),(e=>{P({title:"Error while updating labels",variant:"danger"})})),$=(0,I.l6)((0,w.w)("Error occurred while deleting the SBOM")),{numRenderedColumns:D,currentPageItems:B,propHelpers:{paginationProps:L,tableProps:J,getThProps:W,getTrProps:X,getTdProps:Y},expansionDerivedState:{isCellExpanded:_}}=f,{downloadSBOM:Z}=(0,F.m)();return a.createElement(a.Fragment,null,a.createElement(u.X,{...J,"aria-label":"SBOM table"},a.createElement(d.d,null,a.createElement(E.Tr,null,a.createElement(k.Ze,{...f},a.createElement(p.Th,{...W({columnKey:"name"})}),a.createElement(p.Th,{...W({columnKey:"published"})}),a.createElement(p.Th,{...W({columnKey:"labels"})}),a.createElement(p.Th,{...W({columnKey:"packages"})})))),a.createElement(k.nJ,{isLoading:e,isError:!!t,isNoData:0===l,numRenderedColumns:D},B.map(((e,t)=>a.createElement(y.N,{key:e.id,isExpanded:_(e)},a.createElement(E.Tr,{...X({item:e})},a.createElement(k.Oi,{...f,item:e,rowIndex:t},a.createElement(g.Td,{width:40,...Y({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t})},a.createElement(n.k2,{to:`/sboms/${e.id}`},e.name)),a.createElement(g.Td,{width:10,modifier:"truncate",...Y({columnKey:"published"})},(0,N.Yq)(e.published)),a.createElement(g.Td,{width:25,modifier:"truncate",...Y({columnKey:"labels"})},e.labels&&a.createElement(C.g,{value:e.labels})),a.createElement(g.Td,{width:10,...Y({columnKey:"packages"})},a.createElement(x,{sbomId:e.id})),a.createElement(g.Td,{isActionCell:!0},a.createElement(b.G,{items:[{title:"Edit labels",onClick:()=>{var t;t=e,V("editLabels"),O(t)}},{title:"Download",onClick:()=>{Z(e.id,`${e.name}.json`)}},{title:"Delete",onClick:()=>$.mutate(e.id)}]})))),_(e)?a.createElement(E.Tr,{isExpanded:!0},a.createElement(g.Td,{colSpan:7},a.createElement(h.g,null,a.createElement("div",{className:"pf-v5-u-m-md"},_(e,"name")?a.createElement(a.Fragment,null,a.createElement(r.B,null,a.createElement(i.W,null,a.createElement(o.X,null,"Author"),a.createElement(c.d,null,a.createElement(s.B8,null,e.authors.map(((e,t)=>a.createElement(m.c,{key:t},e)))))),a.createElement(i.W,null,a.createElement(o.X,null,"Described by"),a.createElement(c.d,null,e.described_by&&a.createElement(q,{described_by:e.described_by}))))):null)))):null))))),a.createElement(S.n,{idPrefix:"sbom-apps-table",isTop:!1,isCompact:!0,paginationProps:L}),"editLabels"===K&&M&&a.createElement(v.x,{resourceName:M.name,value:M.labels??{},onSave:e=>{((e,t)=>{A({...e,labels:t})})(M,e),O(null),V(null)},onClose:()=>V(null)}))},q=({described_by:e})=>{const t=(0,K.vY)({variant:"compact",tableName:"version-table",idProperty:"name",items:e,columnNames:{name:"Name",version:"Version"},isPaginationEnabled:!1,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter tex",type:f.RJ.search,placeholderText:"Search...",getItemValue:e=>e.name}],isExpansionEnabled:!1}),{currentPageItems:l,numRenderedColumns:n,propHelpers:{tableProps:r,getThProps:i,getTrProps:o,getTdProps:c}}=t;return a.createElement(a.Fragment,null,a.createElement(u.X,{...r,"aria-label":"Version table"},a.createElement(d.d,null,a.createElement(E.Tr,null,a.createElement(k.Ze,{...t},a.createElement(p.Th,{...i({columnKey:"name"})}),a.createElement(p.Th,{...i({columnKey:"version"})})))),a.createElement(k.nJ,{isLoading:!1,isError:void 0,isNoData:0===e?.length,numRenderedColumns:n},l?.map(((e,l)=>a.createElement(y.N,{key:e.name},a.createElement(E.Tr,{...o({item:e})},a.createElement(k.Oi,{...t,item:e,rowIndex:l},a.createElement(g.Td,{width:20,modifier:"truncate",...c({columnKey:"name"})},e.name),a.createElement(g.Td,{width:15,modifier:"truncate",...c({columnKey:"version"})},e.version)))))))))}},68067:(e,t,l)=>{l.r(t),l.d(t,{default:()=>_});var a=l(63696),n=l(23665),r=l(68430),i=l(20653),o=l(35048),c=l(56918),s=l(1180),m=l(72785),u=l(4433),d=l(65991),E=l(76072),p=l(97299),y=l(17327),g=l(71603),b=l(38527),h=l(71592),v=l(40111),f=l(79893),C=l(70414),T=l(8210),P=l(64361),x=l(33273),S=l(58897),k=l(23857),K=l(77635),F=l(51463);const w=({category:e,filterValue:t,setFilterValue:l,isNumeric:n,isDisabled:r=!1})=>{const[i,o]=a.useState(t?.[0]||"");a.useEffect((()=>{o(t?.[0]||"")}),[t]);const c=()=>{const e=i.trim();l(e?[e.replace(/\s+/g," ")]:[])},s=`${e.categoryKey}-input`;return a.createElement(S.M,null,a.createElement(k.ks,{name:s,id:"search-input",type:n?"number":"search",onChange:(e,t)=>o(t),"aria-label":`${e.title} filter`,value:i,placeholder:e.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||c()},isDisabled:r}),a.createElement(K.$n,{variant:K.Ak.control,id:"search-button","aria-label":"search button for search input",onClick:c,isDisabled:r},a.createElement(F.Ay,null)))};var I=l(11493);const N=({category:e,filterValue:t,setFilterValue:l,isDisabled:n=!1})=>a.createElement(a.Fragment,null,e.selectOptions.map((({label:r,value:i,optionProps:o={}},c)=>{const s=t?.includes(i)||!1;return a.createElement(I.s,{isDisabled:n,key:c,id:`radio-${c}`,name:"radio",isLabelWrapped:!0,label:r,isChecked:s,onChange:()=>{(t=>{const a=(n=t,e.selectOptions.find((({value:e})=>e===n)));var n;l(a?[t]:null)})(i)}})})));var R=l(58365);const V=({category:e,filterValue:t,setFilterValue:l,isDisabled:n=!1})=>{const[r,i]=a.useState(Array.isArray(e.selectOptions)?e.selectOptions:[]);a.useEffect((()=>{i(Array.isArray(e.selectOptions)?e.selectOptions:[])}),[e.selectOptions]);const o=Array.isArray(r)?r:Object.values(r).flatMap((e=>e));return a.createElement(a.Fragment,null,o.map((({label:e,value:n,optionProps:r={}},i)=>a.createElement(R.S,{key:i,id:`checkbox-${i}`,isLabelWrapped:!0,label:e,isChecked:t?.includes(n),onChange:()=>{(e=>{if(e&&"No results"!==e){let a;a=t&&t.includes(e)?t.filter((t=>t!==e)):t?[...t,e]:[e],l(a)}})(n)}}))))},q=({category:e,...t})=>e.type===x.RJ.select?a.createElement(N,{category:e,...t}):e.type===x.RJ.search||e.type===x.RJ.numsearch?a.createElement(w,{category:e,isNumeric:e.type===x.RJ.numsearch,...t}):e.type===x.RJ.multiselect?a.createElement(V,{category:e,...t}):null,M=({filterCategories:e,filterValues:t,setFilterValues:l,isDisabled:n=!1,ommitFilterCategoryKeys:r=[]})=>a.createElement(a.Fragment,null,e.filter((e=>void 0===r.find((t=>t===e.categoryKey)))).map((e=>a.createElement(y.Z,{key:e.categoryKey,isPlain:!0},a.createElement(P.Z,null,e.title),a.createElement(g.b,null,a.createElement(q,{category:e,filterValue:t[e.categoryKey],setFilterValue:a=>((e,a)=>l({...t,[e.categoryKey]:a}))(e,a),isDisabled:n,isSidebar:!0}))))));var O=l(30426),A=l(36390),$=l(14310);function D(e,t){return{Component:e,props:t}}const B=[D(A.c,{}),D(O.a,{}),D($.y,{})],L=(J=B,({children:e})=>{const t=a.createElement(a.Fragment,null,e);return J.reduceRight(((e,{Component:t,props:l={}})=>a.createElement(t,{...l},e)),t)});var J,W=l(32059),X=l(72112),Y=l(1159);const _=()=>a.createElement(L,null,a.createElement(Z,null)),Z=()=>{const{tableControls:e}=a.useContext(A.L),{tableControls:t}=a.useContext(O.Y),{tableControls:l}=a.useContext($.u),{totalItemCount:P,tableControls:{propHelpers:{filterPanelProps:x}}}=a.useContext(A.L),{totalItemCount:S,tableControls:{propHelpers:{filterPanelProps:k}}}=a.useContext(O.Y),{totalItemCount:K,tableControls:{propHelpers:{filterPanelProps:F}}}=a.useContext($.u),[w,I]=a.useState(""),[N,R]=a.useState(0),V=a.createRef();return a.createElement(a.Fragment,null,a.createElement(r.d8,{variant:r.zC.light},a.createElement(i.M,{isStatic:!0},a.createElement(o.P,null,a.createElement(c.$,{align:{default:"alignLeft"}},a.createElement(s.n,null,a.createElement(m.E,{component:"h1"},"Search"))),a.createElement(c.$,{variant:"icon-button-group",align:{default:"alignRight"}},a.createElement(c.$,{visibility:{default:"hidden",lg:"visible"}},a.createElement(u.T,{widths:{default:"500px"}},a.createElement(d.D,{placeholder:"Search for an SBOM, Package, or Vulnerability",value:w,onChange:(e,t)=>(e=>{I(e)})(t),onClear:()=>{I("")},onKeyDown:a=>{a.key&&"Enter"!==a.key||(e.filterState.setFilterValues({...e.filterState.filterValues,"":[w]}),t.filterState.setFilterValues({...t.filterState.filterValues,"":[w]}),l.filterState.setFilterValues({...l.filterState.filterValues,"":[w]}))}}))))))),a.createElement(r.d8,null,a.createElement(E.x,{hasGutter:!0},a.createElement(p.E,{md:2},a.createElement(y.Z,{isFullHeight:!0},a.createElement(g.b,null,0===N?a.createElement(M,{ommitFilterCategoryKeys:[""],...x}):1===N?a.createElement(M,{ommitFilterCategoryKeys:[""],...k}):2===N?a.createElement(M,{ommitFilterCategoryKeys:[""],...F}):null))),a.createElement(p.E,{md:10},a.createElement(y.Z,null,a.createElement(g.b,null,a.createElement(b.t,{activeKey:N,onSelect:(e,t)=>{R(t)},"aria-label":"Tabs",role:"region"},a.createElement(h.o,{eventKey:0,title:a.createElement(v.V,null,"SBOMs","  ",a.createElement(f.E,{screenReaderText:"Search Result Count"},P)),actions:a.createElement(a.Fragment,null,a.createElement(C.o,{"aria-label":"SBOM help popover",ref:V},a.createElement(T.Ay,null)),(q=V,a.createElement(n.A,{bodyContent:a.createElement("div",null,"Software Bill of Materials for Products and Containers."),position:"right",triggerRef:q})))},a.createElement(X.Y,null)),a.createElement(h.o,{eventKey:1,title:a.createElement(v.V,null,"Packages","  ",a.createElement(f.E,{screenReaderText:"Search Result Count"},S))},a.createElement(W.N,null)),a.createElement(h.o,{eventKey:2,title:a.createElement(v.V,null,"Vulnerabilities","  ",a.createElement(f.E,{screenReaderText:"Search Result Count"},K))},a.createElement(Y.fk,null)))))))));var q}},14310:(e,t,l)=>{l.d(t,{u:()=>s,y:()=>m});var a=l(63696),n=l(33273),r=l(86820),i=l(70611),o=l(5098),c=l(74932);const s=a.createContext({}),m=({children:e})=>{const t=(0,i.MM)({tableName:"vulnerability",persistenceKeyPrefix:r.rt.vulnerabilities,columnNames:{identifier:"Identifier",title:"Title",severity:"Severity",packages:"Packages",sboms:"SBOMs",advisories:"Advisories"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:n.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:n.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:l,total:m},isFetching:u,fetchError:d}=(0,c.WJ)((0,i.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score"}})),E=(0,i.PB)({...t,idProperty:"identifier",currentPageItems:l,totalItemCount:m,isLoading:u,selectionState:(0,o.$)({items:l,isEqual:(e,t)=>e.identifier===t.identifier})});return a.createElement(s.Provider,{value:{totalItemCount:m,isFetching:u,fetchError:d,tableControls:E}},e)}},1159:(e,t,l)=>{l.d(t,{fk:()=>V});var a=l(63696),n=l(49348),r=l(76072),i=l(97299),o=l(17327),c=l(64361),s=l(71603),m=l(65753),u=l(24974),d=l(21639),E=l(3939),p=l(85578),y=l(16646),g=l(31065),b=l(77819),h=l(28516),v=l(3629),f=l(62101),C=l(38139),T=l(24417),P=l(52302),x=l(1349),S=l(62520),k=l(63095),K=l(74932),F=l(34066),w=l(82476),I=l(70400),N=l(48703),R=l(14310);const V=()=>{const{isFetching:e,fetchError:t,totalItemCount:l,tableControls:T}=a.useContext(R.u),I=(0,K.o5)((0,k.w)("Error occurred while deleting the vulnerability")),{numRenderedColumns:N,currentPageItems:V,propHelpers:{paginationProps:O,tableProps:A,getThProps:$,getTrProps:D,getTdProps:B,getExpandedContentTdProps:L},expansionDerivedState:{isCellExpanded:J}}=T;return a.createElement(a.Fragment,null,a.createElement(p.X,{...A,"aria-label":"Vulnerability table"},a.createElement(y.d,null,a.createElement(g.Tr,null,a.createElement(S.Ze,{...T},a.createElement(b.Th,{...$({columnKey:"identifier"})}),a.createElement(b.Th,{...$({columnKey:"title"})}),a.createElement(b.Th,{...$({columnKey:"severity"})}),a.createElement(b.Th,{...$({columnKey:"packages"})}),a.createElement(b.Th,{...$({columnKey:"sboms"})}),a.createElement(b.Th,{...$({columnKey:"advisories"})})))),a.createElement(S.nJ,{isLoading:e,isError:!!t,isNoData:0===l,numRenderedColumns:N},V.map(((e,t)=>a.createElement(h.N,{key:e.identifier,isExpanded:J(e)},a.createElement(g.Tr,{...D({item:e})},a.createElement(S.Oi,{...T,item:e,rowIndex:t},a.createElement(v.Td,{width:15,...B({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},a.createElement(n.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),a.createElement(v.Td,{width:45,modifier:"truncate",...B({columnKey:"title"})},e.title||e.description),a.createElement(v.Td,{width:10,...B({columnKey:"severity"})},e.average_severity&&a.createElement(P.h,{value:e.average_severity})),a.createElement(v.Td,{width:10,modifier:"truncate",...B({columnKey:"packages",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"Packages"),a.createElement(v.Td,{width:10,modifier:"truncate",...B({columnKey:"sboms",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"SBOMs"),a.createElement(v.Td,{width:10,...B({columnKey:"advisories",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"Advisories"),a.createElement(v.Td,{isActionCell:!0},a.createElement(f.G,{items:[{title:"Delete",onClick:()=>I.mutate(e.identifier)}]})))),J(e)?a.createElement(g.Tr,{isExpanded:!0},a.createElement(v.Td,{...L({item:e})},a.createElement(C.g,null,a.createElement("div",{className:"pf-v5-u-m-md"},J(e,"identifier")?a.createElement(a.Fragment,null,a.createElement(r.x,{hasGutter:!0},a.createElement(i.E,{md:8},a.createElement(o.Z,{isFullHeight:!0,isCompact:!0},a.createElement(c.Z,null,"General view"),a.createElement(s.b,null,a.createElement(m.B,{columnModifier:{default:"2Col"}},a.createElement(u.W,null,a.createElement(d.X,null,"Published"),a.createElement(E.d,null,(0,F.Yq)(e.published))),a.createElement(u.W,null,a.createElement(d.X,null,"Modified"),a.createElement(E.d,null,(0,F.Yq)(e.modified))),a.createElement(u.W,null,a.createElement(d.X,null,"Released"),a.createElement(E.d,null,(0,F.Yq)(e.released))),a.createElement(u.W,null,a.createElement(d.X,null,"Withdrawn"),a.createElement(E.d,null,(0,F.Yq)(e.withdrawn))))))),a.createElement(i.E,{md:4},a.createElement(o.Z,{isFullHeight:!0,isCompact:!0},a.createElement(c.Z,null,"Additional info"),a.createElement(s.b,null,a.createElement(m.B,null,a.createElement(u.W,null,a.createElement(d.X,null,"CWE"),a.createElement(E.d,null,e.cwe)),a.createElement(u.W,null,a.createElement(d.X,null,"Non normative"),a.createElement(E.d,null,e.normative?"Yes":"No")))))))):null,J(e,"packages")?a.createElement(a.Fragment,null,a.createElement(q,{vulnerabilityId:e.identifier})):null,J(e,"sboms")?a.createElement(a.Fragment,null,a.createElement(M,{vulnerabilityId:e.identifier})):null,J(e,"advisories")?a.createElement(a.Fragment,null,a.createElement(w.N,{variant:"compact",advisories:e.advisories})):null)))):null))))),a.createElement(x.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:O}))},q=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:n}=(0,K.uN)(e);return a.createElement(T.a,{isFetching:l,fetchError:n},a.createElement(I.n,{variant:"compact",initialItemsPerPage:5,advisories:t?.advisories??[]}))},M=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:n}=(0,K.uN)(e);return a.createElement(T.a,{isFetching:l,fetchError:n},a.createElement(N.m,{variant:"compact",advisories:t?.advisories??[]}))}},17993:(e,t,l)=>{l.d(t,{Lx:()=>s,Si:()=>m,sl:()=>u});var a=l(7616),n=l(6841),r=l(40752),i=l(77347),o=l(70611);const c="packages",s=(e={},t=!1)=>{const l=(0,a.I)({queryKey:[c,e],queryFn:()=>(0,n.q)((0,r.UD)({client:i.S,query:{...(0,o.kd)(e)}})),refetchInterval:!t&&5e3});return{...(0,n.S)(l),result:{data:l.data?.items||[],total:l.data?.total??0,params:e}}},m=e=>{const t=(0,a.I)({queryKey:[c,e],queryFn:()=>(0,n.q)((0,r.Y0)({client:i.S,path:{key:e}}))});return{...(0,n.S)(t),pkg:t.data}},u=(e,t={})=>{const l=(0,a.I)({queryKey:[c,"by-sbom",e,t],queryFn:()=>(0,n.q)((0,r.Ad)({client:i.S,path:{id:e},query:{...(0,o.kd)(t)}}))});return{...(0,n.S)(l),result:{data:l.data?.items||[],total:l.data?.total??0,params:t}}}}}]);
//# sourceMappingURL=721.a4f667ff.min.js.map