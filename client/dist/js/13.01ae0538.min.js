"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[13],{1459:(e,t,a)=>{a.d(t,{E:()=>o});var r=a(34629),n=a(63696);const i={circle:"pf-m-circle",square:"pf-m-square",widthSm:"pf-m-width-sm",widthMd:"pf-m-width-md",widthLg:"pf-m-width-lg",width_25:"pf-m-width-25",width_33:"pf-m-width-33",width_50:"pf-m-width-50",width_66:"pf-m-width-66",width_75:"pf-m-width-75",heightSm:"pf-m-height-sm",heightMd:"pf-m-height-md",heightLg:"pf-m-height-lg",height_25:"pf-m-height-25",height_33:"pf-m-height-33",height_50:"pf-m-height-50",height_66:"pf-m-height-66",height_75:"pf-m-height-75",height_100:"pf-m-height-100",text_4xl:"pf-m-text-4xl",text_3xl:"pf-m-text-3xl",text_2xl:"pf-m-text-2xl",textXl:"pf-m-text-xl",textLg:"pf-m-text-lg",textMd:"pf-m-text-md",textSm:"pf-m-text-sm"};var l=a(62634);const s="--pf-v5-c-skeleton--Height",c="--pf-v5-c-skeleton--Width",o=e=>{var{className:t,width:a,height:o,fontSize:d,shape:m,screenreaderText:u}=e,h=(0,r.__rest)(e,["className","width","height","fontSize","shape","screenreaderText"]);const p=d?Object.values(i).find((e=>e===`pf-m-text-${d}`)):void 0;return n.createElement("div",Object.assign({},h,{className:(0,l.A)("pf-v5-c-skeleton",d&&p,"circle"===m&&i.circle,"square"===m&&i.square,t)},(a||o)&&{style:Object.assign({[c]:a||void 0,[s]:o||void 0},h.style)}),n.createElement("span",{className:"pf-v5-screen-reader"},u))};o.displayName="Skeleton"},13506:(e,t,a)=>{a.d(t,{T:()=>l});var r=a(63696),n=a(77635),i=a(33364);const l=({isOpen:e,title:t,titleIconVariant:a,message:l,confirmBtnLabel:s,cancelBtnLabel:c,inProgress:o,confirmBtnVariant:d,onClose:m,onConfirm:u,onCancel:h})=>{const p=r.createElement(n.$n,{id:"confirm-dialog-button",key:"confirm","aria-label":"confirm",variant:d,isDisabled:o,onClick:u},s),f=h?r.createElement(n.$n,{key:"cancel",id:"confirm-cancel-button","aria-label":"cancel",variant:n.Ak.link,isDisabled:o,onClick:h},c):void 0;return r.createElement(i.a,{id:"confirm-dialog",variant:i.d.small,title:t,titleIconVariant:a,isOpen:e,onClose:m,"aria-label":"Confirm dialog",actions:h?[p,f]:[p]},l)}},28644:(e,t,a)=>{a.d(t,{n:()=>d});var r=a(63696),n=a(28338),i=a(70045),l=a(9369),s=a(86099),c=a(55399),o=a(52302);const d=({severities:e})=>{const t=Object.values(e).reduce(((e,t)=>e+t),0);return r.createElement(n.s,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},r.createElement(i.Z,{style:{minWidth:15,textAlign:s.pG}},t),r.createElement(l.c,{orientation:{default:"vertical"}}),r.createElement(i.Z,null,r.createElement(n.s,null,Object.entries(e).filter((([e,t])=>t>0)).sort((0,c.Sx)((([e,t])=>e))).reverse().map((([e,t],a)=>r.createElement(i.Z,{key:a,spacer:{default:"spacerXs"}},r.createElement(n.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},r.createElement(i.Z,null,r.createElement(o.h,{value:e,hideLabel:!0})),r.createElement(i.Z,null,t))))))))}},91271:(e,t,a)=>{a.d(t,{m:()=>l});var r=a(22249),n=a(77347),i=a(40752);const l=()=>({downloadAdvisory:(e,t)=>{(0,i.Mu)({client:n.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,r.saveAs)(new Blob([a.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,i.K0)({client:n.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,r.saveAs)(new Blob([a.data]),t||`${e}.json`)}))}})},4878:(e,t,a)=>{a.d(t,{r:()=>c});var r=a(63696),n=a(77347),i=a(40752),l=a(91728);const s={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},c=e=>{const{advisories:t,isFetching:a,fetchError:c}=(0,l.DH)(e),[o,d]=r.useState([]),[m,u]=r.useState(new Map),[h,p]=r.useState(!1);r.useEffect((()=>{if(0===t.length)return;const e=(t??[]).flatMap((e=>(e.status??[]).map((t=>({vulnerabilityId:t.vulnerability_id,status:t.status,packages:t.packages||[],advisory:{...e}}))))).filter((e=>"affected"===e.status)).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]);d(e),p(!0),Promise.all(e.map((async e=>(await(0,i.wk)({client:n.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),a=new Map;t.forEach((e=>{a.set(e.identifier,e)})),u(a),p(!1)}))}),[t]);const f=r.useMemo((()=>o.map((e=>({...e,vulnerability:m.get(e.vulnerabilityId)})))),[o,m]),g=r.useMemo((()=>f.reduce(((e,t)=>{if(t.vulnerability?.average_severity){const a=t.vulnerability?.average_severity;return{...e,total:e.total+1,severities:{...e.severities,[a]:e.severities[a]+1}}}return e}),s)),[f]);return{isFetching:a||h,fetchError:c,vulnerabilities:f,summary:g}}},36390:(e,t,a)=>{a.d(t,{L:()=>o,c:()=>d});var r=a(63696),n=a(87043),i=a(86820),l=a(70611),s=a(5098),c=a(91728);const o=r.createContext({}),d=({children:e})=>{const t=(0,l.MM)({tableName:"sbom",persistenceKeyPrefix:i.rt.sboms,columnNames:{name:"Name",version:"Version",supplier:"Supplier",published:"Created on",packages:"Dependencies",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","published"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:n.RJ.search},{categoryKey:"published",title:"Created on",type:n.RJ.dateRange}],isExpansionEnabled:!1}),{result:{data:a,total:d},isFetching:m,fetchError:u}=(0,c.i$)((0,l.Ng)({...t,hubSortFieldKeys:{name:"name",published:"published"}})),h=(0,l.PB)({...t,idProperty:"id",currentPageItems:a,totalItemCount:d,isLoading:m,selectionState:(0,s.$)({items:a,isEqual:(e,t)=>e.id===t.id})});return r.createElement(o.Provider,{value:{totalItemCount:d,isFetching:m,fetchError:u,tableControls:h}},e)}},59013:(e,t,a)=>{a.d(t,{Y:()=>K});var r=a(63696),n=a(49348),i=a(77635),l=a(85578),s=a(16646),c=a(31065),o=a(77819),d=a(28516),m=a(3629),u=a(62101),h=a(13506),p=a(50705),f=a(17993);const g=({sbomId:e})=>{const{result:{total:t}}=(0,f.sl)(e,{page:{pageNumber:1,itemsPerPage:1}});return r.createElement(r.Fragment,null,t)};var b=a(1349),E=a(62520),y=a(91271),v=a(91728),w=a(34066),x=a(1459),S=a(891),C=a(24417),k=a(28644),T=a(4878);const I=({sbomId:e})=>{const{summary:t,isFetching:a,fetchError:n}=(0,T.r)(e);return r.createElement(C.a,{isFetching:a,fetchError:n,isFetchingState:r.createElement(x.E,{screenreaderText:"Loading contents"}),fetchErrorState:r.createElement(S.J,{color:"red"},"Error")},r.createElement(k.n,{severities:t.severities}))};var _=a(36390);const K=({})=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:f}=r.useContext(_.L),{pushNotification:x}=r.useContext(p.K),[S,C]=r.useState(null),[k,T]=r.useState(null),{mutate:K}=(0,v.l6)((e=>{x({title:`The SBOM ${e.name} was deleted`,variant:"success"})}),(e=>{x({title:"Error occurred while deleting the SBOM",variant:"danger"})})),{numRenderedColumns:F,currentPageItems:P,propHelpers:{paginationProps:L,tableProps:M,getThProps:B,getTrProps:O,getTdProps:q},expansionDerivedState:{isCellExpanded:N}}=f,{downloadSBOM:A}=(0,y.m)();return r.createElement(r.Fragment,null,r.createElement(l.X,{...M,"aria-label":"sbom-table"},r.createElement(s.d,null,r.createElement(c.Tr,null,r.createElement(E.Ze,{...f},r.createElement(o.Th,{...B({columnKey:"name"})}),r.createElement(o.Th,{...B({columnKey:"version"})}),r.createElement(o.Th,{...B({columnKey:"supplier"})}),r.createElement(o.Th,{...B({columnKey:"published"})}),r.createElement(o.Th,{...B({columnKey:"packages"})}),r.createElement(o.Th,{...B({columnKey:"vulnerabilities"})})))),r.createElement(E.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:F},P.map(((e,t)=>r.createElement(d.N,{key:e.id,isExpanded:N(e)},r.createElement(c.Tr,{...O({item:e})},r.createElement(E.Oi,{...f,item:e,rowIndex:t},r.createElement(m.Td,{width:25,...q({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t})},r.createElement(n.k2,{to:`/sboms/${e.id}`},e.name)),r.createElement(m.Td,{width:15,modifier:"truncate",...q({columnKey:"version"})},e.described_by.map((e=>e.version)).filter((e=>e)).join(", ")),r.createElement(m.Td,{width:20,modifier:"truncate",...q({columnKey:"supplier"})},e.authors.join(", ")),r.createElement(m.Td,{width:10,...q({columnKey:"published"})},(0,w.Yq)(e.published)),r.createElement(m.Td,{width:10,...q({columnKey:"packages"})},r.createElement(g,{sbomId:e.id})),r.createElement(m.Td,{width:20,...q({columnKey:"vulnerabilities"})},r.createElement(I,{sbomId:e.id})),r.createElement(m.Td,{isActionCell:!0},r.createElement(u.G,{items:[{title:"Download",onClick:()=>{A(e.id,`${e.name}.json`)}},{title:"Delete",onClick:()=>{return t=e,C("delete"),void T(t);var t}}]}))))))))),r.createElement(b.n,{idPrefix:"sbom-table",isTop:!1,isCompact:!0,paginationProps:L}),r.createElement(h.T,{title:`Delete ${k?.name}`,titleIconVariant:"warning",isOpen:"delete"===S,message:"Are you sure you want to delete this SBOM? This action cannot be undone.","aria-label":"Delete SBOM",confirmBtnVariant:i.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>C(null),onClose:()=>C(null),onConfirm:()=>{k&&K(k.id),C(null)}}))}},17993:(e,t,a)=>{a.d(t,{Lx:()=>c,Si:()=>o,sl:()=>d});var r=a(7616),n=a(77347),i=a(40752),l=a(70611);const s="packages",c=(e={},t=!1)=>{const{data:a,isLoading:c,error:o,refetch:d}=(0,r.I)({queryKey:[s,e],queryFn:()=>(0,i.UD)({client:n.S,query:{...(0,l.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e},isFetching:c,fetchError:o,refetch:d}},o=e=>{const{data:t,isLoading:a,error:l}=(0,r.I)({queryKey:[s,e],queryFn:()=>(0,i.Y0)({client:n.S,path:{key:e}})});return{pkg:t?.data,isFetching:a,fetchError:l}},d=(e,t={})=>{const{data:a,isLoading:c,error:o,refetch:d}=(0,r.I)({queryKey:[s,"by-sbom",e,t],queryFn:()=>(0,i.Ad)({client:n.S,path:{id:e},query:{...(0,l.kd)(t)}})});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:t},isFetching:c,fetchError:o,refetch:d}}}}]);
//# sourceMappingURL=13.01ae0538.min.js.map