"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[548],{80254:(e,t,l)=>{l.d(t,{V:()=>o});var n=l(63696),a=l(34066),r=l(65753),i=l(24974),c=l(21639),s=l(3939);const o=({advisory:e,excludedFields:t=[],descriptionListProps:l})=>n.createElement(r.B,{...l},!t.includes("title")&&n.createElement(i.W,null,n.createElement(c.X,null,"Title"),n.createElement(s.d,null,e.title)),!t.includes("published")&&n.createElement(i.W,null,n.createElement(c.X,null,"Published"),n.createElement(s.d,null,(0,a.Yq)(e.published))),!t.includes("modified")&&n.createElement(i.W,null,n.createElement(c.X,null,"Modified"),n.createElement(s.d,null,(0,a.Yq)(e.modified))),!t.includes("withdrawn")&&n.createElement(i.W,null,n.createElement(c.X,null,"Withdrawn"),n.createElement(s.d,null,(0,a.Yq)(e.withdrawn))))},88112:(e,t,l)=>{l.d(t,{N:()=>s});var n=l(63696),a=l(65753),r=l(24974),i=l(21639),c=l(3939);const s=({value:e})=>n.createElement(a.B,null,n.createElement(r.W,null,n.createElement(i.X,null,"Name"),n.createElement(c.d,null,e.issuer?.name)),n.createElement(r.W,null,n.createElement(i.X,null,"Website"),n.createElement(c.d,null,e.issuer?.website)))},85278:(e,t,l)=>{l.d(t,{x:()=>p});var n=l(63696),a=l(33364),r=l(77635),i=l(38914),c=l(57901),s=l(40360),o=l(23546),m=l(891),d=l(46721),u=l(76072),E=l(97299),v=l(23857);const p=({resourceName:e,value:t,onSave:l,onClose:p})=>{const[h,b]=n.useState(""),[y,f]=n.useState(""),[g,T]=n.useState(Object.entries(t).sort((([e],[t])=>t.localeCompare(e)))),w=()=>{if(!h||!y)return;const e=g.filter((([e])=>e!==h));T([...e,[h,y]]),b(""),f("")};return n.createElement(a.a,{isOpen:!0,variant:a.d.small,title:"Edit labels",onClose:p,actions:[n.createElement(r.$n,{key:"Save",variant:"primary",onClick:()=>{const e=g.reduce(((e,[t,l])=>({...e,[t]:l})),{});l(e)}},"Save"),n.createElement(r.$n,{key:"cancel",variant:"link",onClick:p},"Cancel")],ouiaId:"BasicModal"},n.createElement(i.B,{hasGutter:!0},n.createElement(c.a,null,"Labels help you organize and select resources. Adding labels below will let you query for objects that have similar, overlapping or dissimilar labels."),n.createElement(c.a,null,n.createElement("div",{className:"pf-v5-c-form"},n.createElement(s.g,{label:`Labels for ${e}`},n.createElement(o.o,{className:"pf-v5-c-form-control",style:{padding:10,minHeight:10},defaultIsOpen:!0,numLabels:10},g.map((([e,t],l)=>n.createElement(m.J,{key:l,color:"blue",onClose:()=>{const e=[...g];e.splice(l,1),T(e)}},`${e}=${t}`))))))),n.createElement(c.a,null,n.createElement(d.l,{onSubmit:e=>{w(),e.preventDefault()}},n.createElement(u.x,{hasGutter:!0},n.createElement(E.E,{md:5},n.createElement(s.g,{label:"Key",isRequired:!0,fieldId:"key"},n.createElement(v.ks,{isRequired:!0,type:"text",id:"key",name:"key",value:h,onChange:(e,t)=>b(t)}))),n.createElement(E.E,{md:5},n.createElement(s.g,{label:"Value",isRequired:!0,fieldId:"value"},n.createElement(v.ks,{isRequired:!0,type:"text",id:"value",name:"value",value:y,onChange:(e,t)=>f(t)}))),n.createElement(E.E,{md:2},n.createElement(s.g,{label:"Action"},n.createElement(r.$n,{type:"submit",variant:r.Ak.secondary,onClick:w},"Add"))))))))}},23713:(e,t,l)=>{l.d(t,{m:()=>i});var n=l(77347),a=l(40752),r=l(22249);const i=()=>({downloadAdvisory:(e,t)=>{(0,a.Mu)({client:n.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((l=>{(0,r.saveAs)(new Blob([l.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,a.K0)({client:n.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((l=>{(0,r.saveAs)(new Blob([l.data]),t||`${e}.json`)}))}})},69578:(e,t,l)=>{l.r(t),l.d(t,{default:()=>L});var n=l(63696),a=l(49348),r=l(71523),i=l(68430),c=l(98261),s=l(75530),o=l(48783),m=l(80876),d=l(24417),u=l(52302),E=l(69935),v=l(38835);l(91728);const p=({source:e,isFetching:t,fetchError:l,height:a="sizeToFit"})=>{const[r,i]=n.useMemo((()=>e?"object"==typeof e?[JSON.stringify(e,null,2),v.T.json]:"string"==typeof e?[e,v.T.plaintext]:["Not supported format",v.T.plaintext]:[e,void 0]),[e]);return n.createElement(n.Fragment,null,n.createElement(d.a,{isFetching:t,fetchError:l},r&&n.createElement(v.B,{isDarkTheme:!0,isLineNumbersVisible:!0,isReadOnly:!0,isMinimapVisible:!0,isLanguageLabelVisible:!0,code:r??"",language:i,height:a})))},h=({advisoryId:e,height:t="sizeToFit"})=>{const{source:l,isFetching:a,fetchError:r}=(0,E.qF)(e);return n.createElement(n.Fragment,null,n.createElement(p,{source:l,isFetching:a,fetchError:r,height:t}))};var b=l(23713),y=l(38914),f=l(57901),g=l(76072),T=l(97299),w=l(17327),k=l(64361),C=l(71603),S=l(65753),F=l(24974),N=l(21639),A=l(77635),K=l(3939),P=l(40360),x=l(10410),I=l(80254),O=l(88112),B=l(85278),V=l(67837),q=l(50705);const $=({advisory:e})=>{const{pushNotification:t}=n.useContext(q.K),[l,a]=n.useState(!1),{mutate:r}=(0,E.uJ)((()=>{}),(e=>{t({title:"Error while updating labels",variant:"danger"})}));return n.createElement(n.Fragment,null,n.createElement(y.B,{hasGutter:!0},n.createElement(f.a,null,n.createElement(g.x,{hasGutter:!0},n.createElement(T.E,{md:4},n.createElement(w.Z,{isFullHeight:!0},n.createElement(k.Z,null,"General view"),n.createElement(C.b,null,n.createElement(I.V,{advisory:e})))),n.createElement(T.E,{md:4},n.createElement(w.Z,{isFullHeight:!0},n.createElement(k.Z,null,"Issuer"),n.createElement(C.b,null,n.createElement(O.N,{value:e})))),n.createElement(T.E,{md:4},n.createElement(w.Z,{isFullHeight:!0},n.createElement(k.Z,null,"System"),n.createElement(C.b,null,n.createElement(S.B,null,n.createElement(F.W,null,n.createElement(N.X,null,"Labels ","",n.createElement(A.$n,{variant:A.Ak.link,size:"sm",icon:n.createElement(x.Ay,null),iconPosition:"end",onClick:()=>a(!0)},"Edit")),n.createElement(K.d,null,n.createElement("div",{className:"pf-v5-c-form"},n.createElement(P.g,null,n.createElement("div",{className:"pf-v5-c-form-control",style:{padding:10}},e.labels&&n.createElement(V.g,{defaultIsOpen:!0,value:e.labels}))))))))))))),l&&n.createElement(B.x,{resourceName:e.identifier,value:e.labels??{},onSave:t=>{(t=>{r({...e,labels:t})})(t),a(!1)},onClose:()=>a(!1)}))};var D=l(32343);const L=()=>{const e=(0,m.Lu)(m.vO.ADVISORY_ID),{advisory:t,isFetching:l,fetchError:v}=(0,E.vy)(e),{downloadAdvisory:p}=(0,b.m)();return n.createElement(n.Fragment,null,n.createElement(i.d8,{variant:"light"},n.createElement(r.A,{breadcrumbs:n.createElement(c.Q,null,n.createElement(s.J,{key:"advisories"},n.createElement(a.N_,{to:"/advisories"},"Advisories")),n.createElement(s.J,{isActive:!0},"Advisory details")),actionButtons:[{children:n.createElement(n.Fragment,null,n.createElement(o.Ay,null)," Download"),variant:"secondary",onClick:()=>{e&&p(e,`${t?.identifier}.json`)}}],pageHeading:{title:t?.identifier??"",label:t?.average_severity?{children:n.createElement(u.h,{value:t.average_severity}),isCompact:!0}:void 0},tabs:[{eventKey:"overview",title:"Overview",children:n.createElement("div",{className:"pf-v5-u-m-md"},n.createElement(d.a,{isFetching:l,fetchError:v},t&&n.createElement($,{advisory:t})))},{eventKey:"vulnerabilities",title:"Vulnerabilities",children:n.createElement("div",{className:"pf-v5-u-m-md"},n.createElement(d.a,{isFetching:l,fetchError:v},n.createElement(D.j,{enableToolbar:!0,vulnerabilities:t?.vulnerabilities||[]})))},{eventKey:"source",title:"Source",children:n.createElement("div",{className:"pf-v5-u-m-md"},e&&n.createElement(h,{advisoryId:e,height:"645px"}))}]})))}},32343:(e,t,l)=>{l.d(t,{j:()=>w});var n=l(63696),a=l(49348),r=l(95285),i=l.n(r),c=l(20653),s=l(35048),o=l(4433),m=l(85578),d=l(16646),u=l(31065),E=l(77819),v=l(28516),p=l(3629),h=l(33273),b=l(52302),y=l(1349),f=l(62520),g=l(70611),T=l(34066);const w=({enableToolbar:e,variant:t,vulnerabilities:l})=>{const r=(0,g.vY)({variant:t,tableName:"vulnerability-table",idProperty:"identifier",items:l,columnNames:{identifier:"Name",title:"Description",severity:"CVSS",discovered:"Discovered",released:"Released",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier","discovered","released"],getSortValues:e=>({identifier:e?.identifier||"",discovered:e.discovered?i()(e.discovered).valueOf():0,released:e.released?i()(e.released).valueOf():0}),isPaginationEnabled:!0,isExpansionEnabled:!1,isFilterEnabled:!0,filterCategories:[{categoryKey:"id",title:"ID",type:h.RJ.search,placeholderText:"Search by ID...",getItemValue:e=>e.identifier||""}]}),{currentPageItems:w,numRenderedColumns:k,propHelpers:{toolbarProps:C,filterToolbarProps:S,paginationToolbarItemProps:F,paginationProps:N,tableProps:A,getThProps:K,getTrProps:P,getTdProps:x}}=r;return n.createElement(n.Fragment,null,e&&n.createElement(c.M,{...C},n.createElement(s.P,null,n.createElement(h.Us,{showFiltersSideBySide:!0,...S}),n.createElement(o.T,{...F},n.createElement(y.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:N})))),n.createElement(m.X,{...A,"aria-label":"Vulnerability table"},n.createElement(d.d,null,n.createElement(u.Tr,null,n.createElement(f.Ze,{...r},n.createElement(E.Th,{...K({columnKey:"identifier"})}),n.createElement(E.Th,{...K({columnKey:"title"})}),n.createElement(E.Th,{...K({columnKey:"severity"})}),n.createElement(E.Th,{...K({columnKey:"discovered"})}),n.createElement(E.Th,{...K({columnKey:"released"})}),n.createElement(E.Th,{...K({columnKey:"cwe"})})))),n.createElement(f.nJ,{isLoading:!1,isError:void 0,isNoData:0===l.length,numRenderedColumns:k},w?.map(((e,t)=>n.createElement(v.N,{key:e.identifier},n.createElement(u.Tr,{...P({item:e})},n.createElement(f.Oi,{...r,item:e,rowIndex:t},n.createElement(p.Td,{width:15,...x({columnKey:"identifier"})},n.createElement(a.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),n.createElement(p.Td,{width:40,modifier:"truncate",...x({columnKey:"title"})},e.title||e.description),n.createElement(p.Td,{width:15,...x({columnKey:"severity"})},n.createElement(b.h,{value:e.severity})),n.createElement(p.Td,{width:10,...x({columnKey:"discovered"})},(0,T.Yq)(e.discovered)),n.createElement(p.Td,{width:10,...x({columnKey:"released"})},(0,T.Yq)(e.released)),n.createElement(p.Td,{width:10,...x({columnKey:"cwe"})},"item.cwe")))))))),n.createElement(y.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:N}))}}}]);
//# sourceMappingURL=548.e3a8a0a4.min.js.map