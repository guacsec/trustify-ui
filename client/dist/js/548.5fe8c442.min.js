"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[548],{24417:(e,t,r)=>{r.d(t,{a:()=>c});var a=r(63696),n=r(59394),l=r(23338),i=r(75855);const c=e=>e.isFetching?a.createElement(n.a,null,a.createElement(l.y,null)):e.fetchError?a.createElement(i.q,null):e.children},69578:(e,t,r)=>{r.r(t),r.d(t,{default:()=>D});var a=r(63696),n=r(49348),l=r(71523),i=r(68430),c=r(98261),s=r(75530),o=r(48783),u=r(80876),m=r(24417),d=r(52302),E=r(69935),v=r(38835);r(91728);const h=({source:e,isFetching:t,fetchError:r,height:n="sizeToFit"})=>{const[l,i]=a.useMemo((()=>e?"object"==typeof e?[JSON.stringify(e,null,2),v.T.json]:"string"==typeof e?[e,v.T.plaintext]:["Not supported format",v.T.plaintext]:[e,void 0]),[e]);return a.createElement(a.Fragment,null,a.createElement(m.a,{isFetching:t,fetchError:r},l&&a.createElement(v.B,{isDarkTheme:!0,isLineNumbersVisible:!0,isReadOnly:!0,isMinimapVisible:!0,isLanguageLabelVisible:!0,code:l??"",language:i,height:n})))},y=({advisoryId:e,height:t="sizeToFit"})=>{const{source:r,isFetching:n,fetchError:l}=(0,E.qF)(e);return a.createElement(a.Fragment,null,a.createElement(h,{source:r,isFetching:n,fetchError:l,height:t}))};var g=r(23713),f=r(38914),b=r(57901),p=r(76072),F=r(97299),q=r(17327),S=r(64361),k=r(71603),N=r(65753),I=r(24974),K=r(21639),_=r(77635),w=r(3939),A=r(40360),L=r(10410),j=r(80254),C=r(88112),T=r(85278),x=r(67837),O=r(50705);const V=({advisory:e})=>{const{pushNotification:t}=a.useContext(O.K),[r,n]=a.useState(!1),{mutate:l}=(0,E.uJ)((()=>{}),(e=>{t({title:"Error while updating labels",variant:"danger"})}));return a.createElement(a.Fragment,null,a.createElement(f.B,{hasGutter:!0},a.createElement(b.a,null,a.createElement(p.x,{hasGutter:!0},a.createElement(F.E,{md:4},a.createElement(q.Z,{isFullHeight:!0},a.createElement(S.Z,null,"General view"),a.createElement(k.b,null,a.createElement(j.V,{advisory:e})))),a.createElement(F.E,{md:4},a.createElement(q.Z,{isFullHeight:!0},a.createElement(S.Z,null,"Issuer"),a.createElement(k.b,null,a.createElement(C.N,{value:e})))),a.createElement(F.E,{md:4},a.createElement(q.Z,{isFullHeight:!0},a.createElement(S.Z,null,"System"),a.createElement(k.b,null,a.createElement(N.B,null,a.createElement(I.W,null,a.createElement(K.X,null,"Labels ","",a.createElement(_.$n,{variant:_.Ak.link,size:"sm",icon:a.createElement(L.Ay,null),iconPosition:"end",onClick:()=>n(!0)},"Edit")),a.createElement(w.d,null,a.createElement("div",{className:"pf-v5-c-form"},a.createElement(A.g,null,a.createElement("div",{className:"pf-v5-c-form-control",style:{padding:10}},e.labels&&a.createElement(x.g,{defaultIsOpen:!0,value:e.labels}))))))))))))),r&&a.createElement(T.x,{resourceName:e.identifier,value:e.labels??{},onSave:t=>{(t=>{l({...e,labels:t})})(t),n(!1)},onClose:()=>n(!1)}))};var Z=r(32343);const D=()=>{const e=(0,u.Lu)(u.vO.ADVISORY_ID),{advisory:t,isFetching:r,fetchError:v}=(0,E.vy)(e),{downloadAdvisory:h}=(0,g.m)();return a.createElement(a.Fragment,null,a.createElement(i.d8,{variant:"light"},a.createElement(l.A,{breadcrumbs:a.createElement(c.Q,null,a.createElement(s.J,{key:"advisories"},a.createElement(n.N_,{to:"/advisories"},"Advisories")),a.createElement(s.J,{isActive:!0},"Advisory details")),actionButtons:[{children:a.createElement(a.Fragment,null,a.createElement(o.Ay,null)," Download"),variant:"secondary",onClick:()=>{e&&h(e,`${t?.identifier}.json`)}}],pageHeading:{title:t?.identifier??"",label:t?.average_severity?{children:a.createElement(d.h,{value:t.average_severity}),isCompact:!0}:void 0},tabs:[{eventKey:"overview",title:"Overview",children:a.createElement("div",{className:"pf-v5-u-m-md"},a.createElement(m.a,{isFetching:r,fetchError:v},t&&a.createElement(V,{advisory:t})))},{eventKey:"vulnerabilities",title:"Vulnerabilities",children:a.createElement("div",{className:"pf-v5-u-m-md"},a.createElement(m.a,{isFetching:r,fetchError:v},a.createElement(Z.j,{enableToolbar:!0,vulnerabilities:t?.vulnerabilities||[]})))},{eventKey:"source",title:"Source",children:a.createElement("div",{className:"pf-v5-u-m-md"},e&&a.createElement(y,{advisoryId:e,height:"645px"}))}]})))}},91728:(e,t,r)=>{r.d(t,{DH:()=>g,Qr:()=>y,i$:()=>d,l6:()=>v,rj:()=>E,sn:()=>h});var a=r(7616),n=r(3715),l=r(26667),i=r(77347),c=r(40752),s=r(24808),o=r(81230),u=r(70611);const m="sboms",d=(e={},t=!1)=>{const{data:r,isLoading:n,error:l,refetch:s}=(0,a.I)({queryKey:[m,e],queryFn:()=>(0,c.z1)({client:i.S,query:{...(0,u.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e??e},isFetching:n,fetchError:l,refetch:s}},E=e=>{const{data:t,isLoading:r,error:n}=(0,a.I)({queryKey:[m,e],queryFn:()=>(0,c.a7)({client:i.S,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:r,fetchError:n}},v=(e,t)=>{const r=(0,n.jE)();return(0,l.n)({mutationFn:async e=>(await(0,c.bS)({client:i.S,path:{id:e}})).data,onSuccess:(t,a)=>{e(t,a),r.invalidateQueries({queryKey:[m]})},onError:t})},h=()=>{const e=(0,n.jE)();return(0,s.v)({parallel:!0,uploadFn:(e,t)=>(0,o.J4)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[m]})}})},y=(e,t={})=>{const{data:r,isLoading:n,error:l,refetch:s}=(0,a.I)({queryKey:[m,"by-package",e,t],queryFn:()=>(0,c.m9)({client:i.S,query:{id:e,...(0,u.kd)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t??t},isFetching:n,fetchError:l,refetch:s}},g=e=>{const{data:t,isLoading:r,error:n}=(0,a.I)({queryKey:[m,e,"advisory"],queryFn:()=>(0,c.bj)({client:i.S,path:{id:e}})});return{advisories:t?.data||[],isFetching:r,fetchError:n}}}}]);
//# sourceMappingURL=548.5fe8c442.min.js.map