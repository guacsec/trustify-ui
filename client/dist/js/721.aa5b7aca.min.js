"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[721],{85278:(e,t,l)=>{l.d(t,{x:()=>y});var a=l(63696),n=l(33364),r=l(77635),i=l(38914),c=l(57901),o=l(40360),s=l(23546),m=l(891),u=l(46721),d=l(76072),E=l(97299),p=l(23857);const y=({resourceName:e,value:t,onSave:l,onClose:y})=>{const[g,b]=a.useState(""),[h,v]=a.useState(""),[f,C]=a.useState(Object.entries(t).sort((([e],[t])=>t.localeCompare(e)))),T=()=>{if(!g||!h)return;const e=f.filter((([e])=>e!==g));C([...e,[g,h]]),b(""),v("")};return a.createElement(n.a,{isOpen:!0,variant:n.d.small,title:"Edit labels",onClose:y,actions:[a.createElement(r.$n,{key:"Save",variant:"primary",onClick:()=>{const e=f.reduce(((e,[t,l])=>({...e,[t]:l})),{});l(e)}},"Save"),a.createElement(r.$n,{key:"cancel",variant:"link",onClick:y},"Cancel")],ouiaId:"BasicModal"},a.createElement(i.B,{hasGutter:!0},a.createElement(c.a,null,"Labels help you organize and select resources. Adding labels below will let you query for objects that have similar, overlapping or dissimilar labels."),a.createElement(c.a,null,a.createElement("div",{className:"pf-v5-c-form"},a.createElement(o.g,{label:`Labels for ${e}`},a.createElement(s.o,{className:"pf-v5-c-form-control",style:{padding:10,minHeight:10},defaultIsOpen:!0,numLabels:10},f.map((([e,t],l)=>a.createElement(m.J,{key:l,color:"blue",onClose:()=>{const e=[...f];e.splice(l,1),C(e)}},`${e}=${t}`))))))),a.createElement(c.a,null,a.createElement(u.l,{onSubmit:e=>{T(),e.preventDefault()}},a.createElement(d.x,{hasGutter:!0},a.createElement(E.E,{md:5},a.createElement(o.g,{label:"Key",isRequired:!0,fieldId:"key"},a.createElement(p.ks,{isRequired:!0,type:"text",id:"key",name:"key",value:g,onChange:(e,t)=>b(t)}))),a.createElement(E.E,{md:5},a.createElement(o.g,{label:"Value",isRequired:!0,fieldId:"value"},a.createElement(p.ks,{isRequired:!0,type:"text",id:"value",name:"value",value:h,onChange:(e,t)=>v(t)}))),a.createElement(E.E,{md:2},a.createElement(o.g,{label:"Action"},a.createElement(r.$n,{type:"submit",variant:r.Ak.secondary,onClick:T},"Add"))))))))}},23713:(e,t,l)=>{l.d(t,{m:()=>i});var a=l(77347),n=l(40752),r=l(22249);const i=()=>({downloadAdvisory:(e,t)=>{(0,n.Mu)({client:a.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((l=>{(0,r.saveAs)(new Blob([l.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,n.K0)({client:a.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((l=>{(0,r.saveAs)(new Blob([l.data]),t||`${e}.json`)}))}})},30426:(e,t,l)=>{l.d(t,{Y:()=>m,a:()=>u});var a=l(63696),n=l(33273),r=l(86820),i=l(70611),c=l(5098),o=l(17993),s=l(34066);const m=a.createContext({}),u=({children:e})=>{const t=(0,i.MM)({tableName:"packages",persistenceKeyPrefix:r.rt.packages,columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",qualifiers:"Qualifiers"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:n.RJ.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:n.RJ.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"}]}],isExpansionEnabled:!0,expandableVariant:"single"}),{result:{data:l,total:u},isFetching:d,fetchError:E}=(0,o.Lx)((0,i.Ng)({...t})),p=a.useMemo((()=>l.map((e=>({...e,decomposedPurl:(0,s.fe)(e.purl)})))),[l]),y=(0,i.PB)({...t,idProperty:"uuid",currentPageItems:p,totalItemCount:u,isLoading:d,selectionState:(0,c.$)({items:p,isEqual:(e,t)=>e.uuid===t.uuid})});return a.createElement(m.Provider,{value:{totalItemCount:u,isFetching:d,fetchError:E,tableControls:y}},e)}},32059:(e,t,l)=>{l.d(t,{N:()=>f});var a=l(63696),n=l(49348),r=l(65753),i=l(24974),c=l(21639),o=l(3939),s=l(85578),m=l(16646),u=l(31065),d=l(77819),E=l(28516),p=l(3629),y=l(38139),g=l(16177),b=l(1349),h=l(62520),v=l(30426);const f=()=>{const{isFetching:e,fetchError:t,totalItemCount:l,tableControls:f}=a.useContext(v.Y),{numRenderedColumns:C,currentPageItems:T,propHelpers:{paginationProps:P,tableProps:x,getThProps:k,getTrProps:K,getTdProps:S},expansionDerivedState:{isCellExpanded:F}}=f;return a.createElement(a.Fragment,null,a.createElement(s.X,{...x,"aria-label":"Package table"},a.createElement(m.d,null,a.createElement(u.Tr,null,a.createElement(h.Ze,{...f},a.createElement(d.Th,{...k({columnKey:"name"})}),a.createElement(d.Th,{...k({columnKey:"namespace"})}),a.createElement(d.Th,{...k({columnKey:"version"})}),a.createElement(d.Th,{...k({columnKey:"type"})}),a.createElement(d.Th,{...k({columnKey:"qualifiers"})})))),a.createElement(h.nJ,{isLoading:e,isError:!!t,isNoData:0===l,numRenderedColumns:C},T.map(((e,t)=>a.createElement(E.N,{key:e.uuid},a.createElement(u.Tr,{...K({item:e})},a.createElement(h.Oi,{...f,item:e,rowIndex:t},a.createElement(p.Td,{width:25,...S({columnKey:"name"})},a.createElement(n.k2,{to:`/packages/${encodeURIComponent(e.uuid)}`},e.decomposedPurl?e.decomposedPurl?.name:e.purl)),a.createElement(p.Td,{width:10,modifier:"truncate",...S({columnKey:"namespace"})},e.decomposedPurl?.namespace),a.createElement(p.Td,{width:15,modifier:"truncate",...S({columnKey:"version"})},e.decomposedPurl?.version),a.createElement(p.Td,{width:10,modifier:"truncate",...S({columnKey:"type"})},e.decomposedPurl?.type),a.createElement(p.Td,{width:40,...S({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&a.createElement(g.a,{value:e.decomposedPurl?.qualifiers})))),F(e)?a.createElement(u.Tr,{isExpanded:!0},a.createElement(p.Td,{colSpan:7},a.createElement(y.g,null,a.createElement("div",{className:"pf-v5-u-m-md"},a.createElement(r.B,null,a.createElement(i.W,null,a.createElement(c.X,null,"Purl"),a.createElement(o.d,null,e.purl)),a.createElement(i.W,null,a.createElement(c.X,null,"Path"),a.createElement(o.d,null,e.decomposedPurl?.path))))))):null))))),a.createElement(b.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:P}))}},36390:(e,t,l)=>{l.d(t,{L:()=>s,c:()=>m});var a=l(63696),n=l(33273),r=l(86820),i=l(70611),c=l(5098),o=l(91728);const s=a.createContext({}),m=({children:e})=>{const t=(0,i.MM)({tableName:"sbom",persistenceKeyPrefix:r.rt.sboms,columnNames:{name:"Name",published:"Published",labels:"Labels",packages:"Packages"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["published"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:n.RJ.search}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:l,total:m},isFetching:u,fetchError:d}=(0,o.i$)((0,i.Ng)({...t,hubSortFieldKeys:{published:"published"}})),E=(0,i.PB)({...t,idProperty:"id",currentPageItems:l,totalItemCount:m,isLoading:u,selectionState:(0,c.$)({items:l,isEqual:(e,t)=>e.id===t.id})});return a.createElement(s.Provider,{value:{totalItemCount:m,isFetching:u,fetchError:d,tableControls:E}},e)}},72112:(e,t,l)=>{l.d(t,{Y:()=>R});var a=l(63696),n=l(49348),r=l(65753),i=l(24974),c=l(21639),o=l(3939),s=l(94279),m=l(16172),u=l(85578),d=l(16646),E=l(31065),p=l(77819),y=l(28516),g=l(3629),b=l(62101),h=l(38139),v=l(85278),f=l(33273),C=l(67837),T=l(50705),P=l(17993);const x=({sbomId:e})=>{const{result:{total:t}}=(0,P.sl)(e,{page:{pageNumber:1,itemsPerPage:1}});return a.createElement(a.Fragment,null,t)};var k=l(1349),K=l(62520),S=l(70611),F=l(23713),w=l(91728),I=l(34066),N=l(36390);const R=({})=>{const{isFetching:e,fetchError:t,totalItemCount:l,tableControls:f}=a.useContext(N.L),{pushNotification:P}=a.useContext(T.K),[S,R]=a.useState(null),[M,O]=a.useState(null),{mutate:q}=(0,w.cF)((()=>{}),(e=>{P({title:"Error while updating labels",variant:"danger"})})),A=(0,w.l6)((e=>{P({title:`The SBOM ${e.name} was deleted`,variant:"danger"})}),(e=>{P({title:"Error occurred while deleting the SBOM",variant:"danger"})})),{numRenderedColumns:L,currentPageItems:$,propHelpers:{paginationProps:D,tableProps:B,getThProps:J,getTrProps:W,getTdProps:X},expansionDerivedState:{isCellExpanded:Y}}=f,{downloadSBOM:_}=(0,F.m)();return a.createElement(a.Fragment,null,a.createElement(u.X,{...B,"aria-label":"SBOM table"},a.createElement(d.d,null,a.createElement(E.Tr,null,a.createElement(K.Ze,{...f},a.createElement(p.Th,{...J({columnKey:"name"})}),a.createElement(p.Th,{...J({columnKey:"published"})}),a.createElement(p.Th,{...J({columnKey:"labels"})}),a.createElement(p.Th,{...J({columnKey:"packages"})})))),a.createElement(K.nJ,{isLoading:e,isError:!!t,isNoData:0===l,numRenderedColumns:L},$.map(((e,t)=>a.createElement(y.N,{key:e.id,isExpanded:Y(e)},a.createElement(E.Tr,{...W({item:e})},a.createElement(K.Oi,{...f,item:e,rowIndex:t},a.createElement(g.Td,{width:40,...X({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t})},a.createElement(n.k2,{to:`/sboms/${e.id}`},e.name)),a.createElement(g.Td,{width:10,modifier:"truncate",...X({columnKey:"published"})},(0,I.Yq)(e.published)),a.createElement(g.Td,{width:25,modifier:"truncate",...X({columnKey:"labels"})},e.labels&&a.createElement(C.g,{value:e.labels})),a.createElement(g.Td,{width:10,...X({columnKey:"packages"})},a.createElement(x,{sbomId:e.id})),a.createElement(g.Td,{isActionCell:!0},a.createElement(b.G,{items:[{title:"Edit labels",onClick:()=>{var t;t=e,R("editLabels"),O(t)}},{title:"Download",onClick:()=>{_(e.id,`${e.name}.json`)}},{title:"Delete",onClick:()=>A.mutate(e.id)}]})))),Y(e)?a.createElement(E.Tr,{isExpanded:!0},a.createElement(g.Td,{colSpan:7},a.createElement(h.g,null,a.createElement("div",{className:"pf-v5-u-m-md"},Y(e,"name")?a.createElement(a.Fragment,null,a.createElement(r.B,null,a.createElement(i.W,null,a.createElement(c.X,null,"Author"),a.createElement(o.d,null,a.createElement(s.B8,null,e.authors.map(((e,t)=>a.createElement(m.c,{key:t},e)))))),a.createElement(i.W,null,a.createElement(c.X,null,"Described by"),a.createElement(o.d,null,e.described_by&&a.createElement(V,{described_by:e.described_by}))))):null)))):null))))),a.createElement(k.n,{idPrefix:"sbom-apps-table",isTop:!1,isCompact:!0,paginationProps:D}),"editLabels"===S&&M&&a.createElement(v.x,{resourceName:M.name,value:M.labels??{},onSave:e=>{((e,t)=>{q({...e,labels:t})})(M,e),O(null),R(null)},onClose:()=>R(null)}))},V=({described_by:e})=>{const t=(0,S.vY)({variant:"compact",tableName:"version-table",idProperty:"name",items:e,columnNames:{name:"Name",version:"Version"},isPaginationEnabled:!1,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter tex",type:f.RJ.search,placeholderText:"Search...",getItemValue:e=>e.name}],isExpansionEnabled:!1}),{currentPageItems:l,numRenderedColumns:n,propHelpers:{tableProps:r,getThProps:i,getTrProps:c,getTdProps:o}}=t;return a.createElement(a.Fragment,null,a.createElement(u.X,{...r,"aria-label":"Version table"},a.createElement(d.d,null,a.createElement(E.Tr,null,a.createElement(K.Ze,{...t},a.createElement(p.Th,{...i({columnKey:"name"})}),a.createElement(p.Th,{...i({columnKey:"version"})})))),a.createElement(K.nJ,{isLoading:!1,isError:void 0,isNoData:0===e?.length,numRenderedColumns:n},l?.map(((e,l)=>a.createElement(y.N,{key:e.name},a.createElement(E.Tr,{...c({item:e})},a.createElement(K.Oi,{...t,item:e,rowIndex:l},a.createElement(g.Td,{width:20,modifier:"truncate",...o({columnKey:"name"})},e.name),a.createElement(g.Td,{width:15,modifier:"truncate",...o({columnKey:"version"})},e.version)))))))))}},68067:(e,t,l)=>{l.r(t),l.d(t,{default:()=>_});var a=l(63696),n=l(23665),r=l(68430),i=l(20653),c=l(35048),o=l(56918),s=l(1180),m=l(72785),u=l(4433),d=l(65991),E=l(76072),p=l(97299),y=l(17327),g=l(71603),b=l(38527),h=l(71592),v=l(40111),f=l(79893),C=l(70414),T=l(8210),P=l(64361),x=l(33273),k=l(58897),K=l(23857),S=l(77635),F=l(51463);const w=({category:e,filterValue:t,setFilterValue:l,isNumeric:n,isDisabled:r=!1})=>{const[i,c]=a.useState(t?.[0]||"");a.useEffect((()=>{c(t?.[0]||"")}),[t]);const o=()=>{const e=i.trim();l(e?[e.replace(/\s+/g," ")]:[])},s=`${e.categoryKey}-input`;return a.createElement(k.M,null,a.createElement(K.ks,{name:s,id:"search-input",type:n?"number":"search",onChange:(e,t)=>c(t),"aria-label":`${e.title} filter`,value:i,placeholder:e.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||o()},isDisabled:r}),a.createElement(S.$n,{variant:S.Ak.control,id:"search-button","aria-label":"search button for search input",onClick:o,isDisabled:r},a.createElement(F.Ay,null)))};var I=l(11493);const N=({category:e,filterValue:t,setFilterValue:l,isDisabled:n=!1})=>a.createElement(a.Fragment,null,e.selectOptions.map((({label:r,value:i,optionProps:c={}},o)=>{const s=t?.includes(i)||!1;return a.createElement(I.s,{isDisabled:n,key:o,id:`radio-${o}`,name:"radio",isLabelWrapped:!0,label:r,isChecked:s,onChange:()=>{(t=>{const a=(n=t,e.selectOptions.find((({value:e})=>e===n)));var n;l(a?[t]:null)})(i)}})})));var R=l(58365);const V=({category:e,filterValue:t,setFilterValue:l,isDisabled:n=!1})=>{const[r,i]=a.useState(Array.isArray(e.selectOptions)?e.selectOptions:[]);a.useEffect((()=>{i(Array.isArray(e.selectOptions)?e.selectOptions:[])}),[e.selectOptions]);const c=Array.isArray(r)?r:Object.values(r).flatMap((e=>e));return a.createElement(a.Fragment,null,c.map((({label:e,value:n,optionProps:r={}},i)=>a.createElement(R.S,{key:i,id:`checkbox-${i}`,isLabelWrapped:!0,label:e,isChecked:t?.includes(n),onChange:()=>{(e=>{if(e&&"No results"!==e){let a;a=t&&t.includes(e)?t.filter((t=>t!==e)):t?[...t,e]:[e],l(a)}})(n)}}))))},M=({category:e,...t})=>e.type===x.RJ.select?a.createElement(N,{category:e,...t}):e.type===x.RJ.search||e.type===x.RJ.numsearch?a.createElement(w,{category:e,isNumeric:e.type===x.RJ.numsearch,...t}):e.type===x.RJ.multiselect?a.createElement(V,{category:e,...t}):null,O=({filterCategories:e,filterValues:t,setFilterValues:l,isDisabled:n=!1,ommitFilterCategoryKeys:r=[]})=>a.createElement(a.Fragment,null,e.filter((e=>void 0===r.find((t=>t===e.categoryKey)))).map((e=>a.createElement(y.Z,{key:e.categoryKey,isPlain:!0},a.createElement(P.Z,null,e.title),a.createElement(g.b,null,a.createElement(M,{category:e,filterValue:t[e.categoryKey],setFilterValue:a=>((e,a)=>l({...t,[e.categoryKey]:a}))(e,a),isDisabled:n,isSidebar:!0}))))));var q=l(30426),A=l(36390),L=l(14310);function $(e,t){return{Component:e,props:t}}const D=[$(A.c,{}),$(q.a,{}),$(L.y,{})],B=(J=D,({children:e})=>{const t=a.createElement(a.Fragment,null,e);return J.reduceRight(((e,{Component:t,props:l={}})=>a.createElement(t,{...l},e)),t)});var J,W=l(32059),X=l(72112),Y=l(1159);const _=()=>a.createElement(B,null,a.createElement(H,null)),H=()=>{const{tableControls:e}=a.useContext(A.L),{tableControls:t}=a.useContext(q.Y),{tableControls:l}=a.useContext(L.u),{totalItemCount:P,tableControls:{propHelpers:{filterPanelProps:x}}}=a.useContext(A.L),{totalItemCount:k,tableControls:{propHelpers:{filterPanelProps:K}}}=a.useContext(q.Y),{totalItemCount:S,tableControls:{propHelpers:{filterPanelProps:F}}}=a.useContext(L.u),[w,I]=a.useState(""),[N,R]=a.useState(0),V=a.createRef();return a.createElement(a.Fragment,null,a.createElement(r.d8,{variant:r.zC.light},a.createElement(i.M,{isStatic:!0},a.createElement(c.P,null,a.createElement(o.$,{align:{default:"alignLeft"}},a.createElement(s.n,null,a.createElement(m.E,{component:"h1"},"Search"))),a.createElement(o.$,{variant:"icon-button-group",align:{default:"alignRight"}},a.createElement(o.$,{visibility:{default:"hidden",lg:"visible"}},a.createElement(u.T,{widths:{default:"500px"}},a.createElement(d.D,{placeholder:"Search for an SBOM, Package, or Vulnerability",value:w,onChange:(e,t)=>(e=>{I(e)})(t),onClear:()=>{I("")},onKeyDown:a=>{a.key&&"Enter"!==a.key||(e.filterState.setFilterValues({...e.filterState.filterValues,"":[w]}),t.filterState.setFilterValues({...t.filterState.filterValues,"":[w]}),l.filterState.setFilterValues({...l.filterState.filterValues,"":[w]}))}}))))))),a.createElement(r.d8,null,a.createElement(E.x,{hasGutter:!0},a.createElement(p.E,{md:2},a.createElement(y.Z,{isFullHeight:!0},a.createElement(g.b,null,0===N?a.createElement(O,{ommitFilterCategoryKeys:[""],...x}):1===N?a.createElement(O,{ommitFilterCategoryKeys:[""],...K}):2===N?a.createElement(O,{ommitFilterCategoryKeys:[""],...F}):null))),a.createElement(p.E,{md:10},a.createElement(y.Z,null,a.createElement(g.b,null,a.createElement(b.t,{activeKey:N,onSelect:(e,t)=>{R(t)},"aria-label":"Tabs",role:"region"},a.createElement(h.o,{eventKey:0,title:a.createElement(v.V,null,"SBOMs","  ",a.createElement(f.E,{screenReaderText:"Search Result Count"},P)),actions:a.createElement(a.Fragment,null,a.createElement(C.o,{"aria-label":"SBOM help popover",ref:V},a.createElement(T.Ay,null)),(M=V,a.createElement(n.A,{bodyContent:a.createElement("div",null,"Software Bill of Materials for Products and Containers."),position:"right",triggerRef:M})))},a.createElement(X.Y,null)),a.createElement(h.o,{eventKey:1,title:a.createElement(v.V,null,"Packages","  ",a.createElement(f.E,{screenReaderText:"Search Result Count"},k))},a.createElement(W.N,null)),a.createElement(h.o,{eventKey:2,title:a.createElement(v.V,null,"Vulnerabilities","  ",a.createElement(f.E,{screenReaderText:"Search Result Count"},S))},a.createElement(Y.fk,null)))))))));var M}},14310:(e,t,l)=>{l.d(t,{u:()=>s,y:()=>m});var a=l(63696),n=l(33273),r=l(86820),i=l(70611),c=l(5098),o=l(74932);const s=a.createContext({}),m=({children:e})=>{const t=(0,i.MM)({tableName:"vulnerability",persistenceKeyPrefix:r.rt.vulnerabilities,columnNames:{identifier:"Identifier",title:"Title",severity:"Severity",packages:"Packages",sboms:"SBOMs",advisories:"Advisories"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:n.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:n.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:l,total:m},isFetching:u,fetchError:d}=(0,o.WJ)((0,i.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score"}})),E=(0,i.PB)({...t,idProperty:"identifier",currentPageItems:l,totalItemCount:m,isLoading:u,selectionState:(0,c.$)({items:l,isEqual:(e,t)=>e.identifier===t.identifier})});return a.createElement(s.Provider,{value:{totalItemCount:m,isFetching:u,fetchError:d,tableControls:E}},e)}},1159:(e,t,l)=>{l.d(t,{fk:()=>V});var a=l(63696),n=l(49348),r=l(76072),i=l(97299),c=l(17327),o=l(64361),s=l(71603),m=l(65753),u=l(24974),d=l(21639),E=l(3939),p=l(85578),y=l(16646),g=l(31065),b=l(77819),h=l(28516),v=l(3629),f=l(62101),C=l(38139),T=l(24417),P=l(50705),x=l(52302),k=l(1349),K=l(62520),S=l(74932),F=l(34066),w=l(82476),I=l(70400),N=l(48703),R=l(14310);const V=()=>{const{pushNotification:e}=a.useContext(P.K),{isFetching:t,fetchError:l,totalItemCount:T,tableControls:I}=a.useContext(R.u),N=(0,S.o5)((t=>{e({title:`The Vulnerability ${t.identifier} was deleted`,variant:"danger"})}),(t=>{e({title:"Error occurred while deleting the vulnerability",variant:"danger"})})),{numRenderedColumns:V,currentPageItems:q,propHelpers:{paginationProps:A,tableProps:L,getThProps:$,getTrProps:D,getTdProps:B,getExpandedContentTdProps:J},expansionDerivedState:{isCellExpanded:W}}=I;return a.createElement(a.Fragment,null,a.createElement(p.X,{...L,"aria-label":"Vulnerability table"},a.createElement(y.d,null,a.createElement(g.Tr,null,a.createElement(K.Ze,{...I},a.createElement(b.Th,{...$({columnKey:"identifier"})}),a.createElement(b.Th,{...$({columnKey:"title"})}),a.createElement(b.Th,{...$({columnKey:"severity"})}),a.createElement(b.Th,{...$({columnKey:"packages"})}),a.createElement(b.Th,{...$({columnKey:"sboms"})}),a.createElement(b.Th,{...$({columnKey:"advisories"})})))),a.createElement(K.nJ,{isLoading:t,isError:!!l,isNoData:0===T,numRenderedColumns:V},q.map(((e,t)=>a.createElement(h.N,{key:e.identifier,isExpanded:W(e)},a.createElement(g.Tr,{...D({item:e})},a.createElement(K.Oi,{...I,item:e,rowIndex:t},a.createElement(v.Td,{width:15,...B({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},a.createElement(n.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),a.createElement(v.Td,{width:45,modifier:"truncate",...B({columnKey:"title"})},e.title||e.description),a.createElement(v.Td,{width:10,...B({columnKey:"severity"})},e.average_severity&&a.createElement(x.h,{value:e.average_severity})),a.createElement(v.Td,{width:10,modifier:"truncate",...B({columnKey:"packages",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"Packages"),a.createElement(v.Td,{width:10,modifier:"truncate",...B({columnKey:"sboms",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"SBOMs"),a.createElement(v.Td,{width:10,...B({columnKey:"advisories",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"Advisories"),a.createElement(v.Td,{isActionCell:!0},a.createElement(f.G,{items:[{title:"Delete",onClick:()=>N.mutate(e.identifier)}]})))),W(e)?a.createElement(g.Tr,{isExpanded:!0},a.createElement(v.Td,{...J({item:e})},a.createElement(C.g,null,a.createElement("div",{className:"pf-v5-u-m-md"},W(e,"identifier")?a.createElement(a.Fragment,null,a.createElement(r.x,{hasGutter:!0},a.createElement(i.E,{md:8},a.createElement(c.Z,{isFullHeight:!0,isCompact:!0},a.createElement(o.Z,null,"General view"),a.createElement(s.b,null,a.createElement(m.B,{columnModifier:{default:"2Col"}},a.createElement(u.W,null,a.createElement(d.X,null,"Published"),a.createElement(E.d,null,(0,F.Yq)(e.published))),a.createElement(u.W,null,a.createElement(d.X,null,"Modified"),a.createElement(E.d,null,(0,F.Yq)(e.modified))),a.createElement(u.W,null,a.createElement(d.X,null,"Released"),a.createElement(E.d,null,(0,F.Yq)(e.released))),a.createElement(u.W,null,a.createElement(d.X,null,"Withdrawn"),a.createElement(E.d,null,(0,F.Yq)(e.withdrawn))))))),a.createElement(i.E,{md:4},a.createElement(c.Z,{isFullHeight:!0,isCompact:!0},a.createElement(o.Z,null,"Additional info"),a.createElement(s.b,null,a.createElement(m.B,null,a.createElement(u.W,null,a.createElement(d.X,null,"CWE"),a.createElement(E.d,null,"item.cwe")),a.createElement(u.W,null,a.createElement(d.X,null,"Non normative"),a.createElement(E.d,null,e.normative?"Yes":"No")))))))):null,W(e,"packages")?a.createElement(a.Fragment,null,a.createElement(M,{vulnerabilityId:e.identifier})):null,W(e,"sboms")?a.createElement(a.Fragment,null,a.createElement(O,{vulnerabilityId:e.identifier})):null,W(e,"advisories")?a.createElement(a.Fragment,null,a.createElement(w.N,{variant:"compact",advisories:e.advisories})):null)))):null))))),a.createElement(k.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:A}))},M=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:n}=(0,S.uN)(e);return a.createElement(T.a,{isFetching:l,fetchError:n},a.createElement(I.n,{variant:"compact",initialItemsPerPage:5,advisories:t?.advisories??[]}))},O=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:n}=(0,S.uN)(e);return a.createElement(T.a,{isFetching:l,fetchError:n},a.createElement(N.m,{variant:"compact",advisories:t?.advisories??[]}))}},17993:(e,t,l)=>{l.d(t,{Lx:()=>o,Si:()=>s,sl:()=>m});var a=l(7616),n=l(77347),r=l(40752),i=l(70611);const c="packages",o=(e={},t=!1)=>{const{data:l,isLoading:o,error:s,refetch:m}=(0,a.I)({queryKey:[c,e],queryFn:()=>(0,r.UD)({client:n.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:e},isFetching:o,fetchError:s,refetch:m}},s=e=>{const{data:t,isLoading:l,error:i}=(0,a.I)({queryKey:[c,e],queryFn:()=>(0,r.Y0)({client:n.S,path:{key:e}})});return{pkg:t?.data,isFetching:l,fetchError:i}},m=(e,t={})=>{const{data:l,isLoading:o,error:s,refetch:m}=(0,a.I)({queryKey:[c,"by-sbom",e,t],queryFn:()=>(0,r.Ad)({client:n.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:t},isFetching:o,fetchError:s,refetch:m}}}}]);
//# sourceMappingURL=721.aa5b7aca.min.js.map