"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[159],{48703:(e,t,l)=>{l.d(t,{m:()=>A});var a=l(63696),n=l(95285),r=l.n(n),i=l(20653),s=l(35048),m=l(4433),o=l(77635),c=l(891),d=l(1180),u=l(28341),E=l(341),p=l(85578),h=l(16646),b=l(31065),g=l(77819),y=l(28516),v=l(3629),f=l(77347),T=l(40752),C=l(80863),P=l(33273),w=l(67837),S=l(77307),x=l(78833),K=l(1349),I=l(62520),F=l(70611),k=l(15311),N=l(34066);const A=({variant:e,advisories:t})=>{const[l,n]=a.useState(null),[A,_]=a.useState(null),M=(e,t)=>{n(e),_(t)},[X,q]=a.useState([]),[L,R]=a.useState(new Map),[W,Y]=a.useState(!1),[J,O]=a.useState(new Set);a.useEffect((()=>{const e=(t??[]).flatMap((e=>(e.sboms||[]).flatMap((t=>t.status.map((l=>({sbomId:t.id,status:l,advisory:{...e}}))))))).reduce(((e,t)=>e.find((e=>e.sbomId===t.sbomId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]),l=new Set;e.forEach((e=>l.add(e.status))),q(e),O(l),Y(!0),Promise.all(e.map((e=>(0,T.a7)({client:f.S,path:{id:e.sbomId}}).then((e=>e.data)))).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),l=new Map;t.forEach((e=>l.set(e.id,e))),R(l),Y(!1)}))}),[t]);const V=a.useMemo((()=>X.map((e=>({...e,sbom:L.get(e.sbomId)})))),[X,L]),$=(0,k.f)(V,(e=>`${e.sbomId}-${e.advisory.identifier}-${e.advisory.uuid}`)),B=(0,F.vY)({variant:e,tableName:"sboms-table",idProperty:"_ui_unique_id",items:$,isLoading:!1,columnNames:{name:"Name",published:"Published",labels:"Labels",status:"Status",advisory:"Advisory"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["published"],getSortValues:e=>({published:e.sbom?.published?r()(e.sbom.published).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:P.RJ.search,getItemValue:e=>e.sbom?.name??""},{categoryKey:"status",title:"Status",placeholderText:"Status",type:P.RJ.multiselect,selectOptions:Array.from(J).map((e=>({value:e,label:e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")}))),matcher:(e,t)=>t.status===e}],isExpansionEnabled:!1}),{currentPageItems:z,numRenderedColumns:D,propHelpers:{toolbarProps:Z,filterToolbarProps:H,paginationToolbarItemProps:G,paginationProps:U,tableProps:j,getThProps:Q,getTrProps:ee,getTdProps:te},expansionDerivedState:{isCellExpanded:le}}=B;return a.createElement(a.Fragment,null,B.isFilterEnabled&&a.createElement(i.M,{...Z},a.createElement(s.P,null,a.createElement(P.Us,{showFiltersSideBySide:!0,...H}),a.createElement(m.T,{...G},a.createElement(K.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:U})))),a.createElement(p.X,{...j,"aria-label":"Sbom table"},a.createElement(h.d,null,a.createElement(b.Tr,null,a.createElement(I.Ze,{...B},a.createElement(g.Th,{...Q({columnKey:"name"})}),a.createElement(g.Th,{...Q({columnKey:"published"})}),a.createElement(g.Th,{...Q({columnKey:"labels"})}),a.createElement(g.Th,{...Q({columnKey:"status"})}),a.createElement(g.Th,{...Q({columnKey:"advisory"})})))),a.createElement(I.nJ,{isLoading:W,isError:void 0,isNoData:0===$.length,numRenderedColumns:D},z?.map(((e,t)=>a.createElement(y.N,{key:e.sbomId,isExpanded:le(e)},a.createElement(b.Tr,{...ee({item:e})},a.createElement(I.Oi,{...B,item:e,rowIndex:t},a.createElement(v.Td,{width:25,...te({columnKey:"name"})},a.createElement(o.$n,{size:"sm",variant:o.Ak.secondary,onClick:()=>M("showSbom",e)},e?.sbom?.name)),a.createElement(v.Td,{width:10,modifier:"truncate",...te({columnKey:"published"})},(0,N.Yq)(e.sbom?.published)),a.createElement(v.Td,{width:40,modifier:"truncate",...te({columnKey:"labels"})},e.sbom?.labels&&a.createElement(w.g,{value:e.sbom.labels})),a.createElement(v.Td,{width:10,modifier:"truncate",...te({columnKey:"status"})},a.createElement(c.J,null,e.status.charAt(0).toUpperCase()+e.status.slice(1).replace("_"," "))),a.createElement(v.Td,{width:15,modifier:"truncate",...te({columnKey:"advisory"})},a.createElement(o.$n,{size:"sm",variant:o.Ak.secondary,onClick:()=>M("showAdvisory",e)},e.advisory.identifier))))))))),a.createElement(K.n,{idPrefix:"sboms-table",isTop:!1,isCompact:!0,paginationProps:U}),a.createElement(S.q,{isExpanded:null!==l,onCloseClick:()=>n(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:a.createElement(a.Fragment,null,"showSbom"===l&&a.createElement(d.n,null,a.createElement(u.h,{headingLevel:"h2",size:"lg",className:E.A.mtXs},"SBOM")),"showAdvisory"===l&&a.createElement(d.n,null,a.createElement(u.h,{headingLevel:"h2",size:"lg",className:E.A.mtXs},"Advisory")),"showPackages"===l&&a.createElement(d.n,null,a.createElement(u.h,{headingLevel:"h2",size:"lg",className:E.A.mtXs},"Packages")))},"showSbom"===l&&a.createElement(a.Fragment,null,A?.sbomId&&a.createElement(x.Y,{sbomId:A?.sbomId})),"showAdvisory"===l&&a.createElement(a.Fragment,null,A?.advisory&&a.createElement(C.c,{advisoryId:A?.advisory.uuid}))))}},14310:(e,t,l)=>{l.d(t,{u:()=>o,y:()=>c});var a=l(63696),n=l(33273),r=l(86820),i=l(70611),s=l(5098),m=l(74932);const o=a.createContext({}),c=({children:e})=>{const t=(0,i.MM)({tableName:"vulnerability",persistenceKeyPrefix:r.rt.vulnerabilities,columnNames:{identifier:"Name",title:"Description",severity:"CVSS",published:"Published",packages:"Packages",sboms:"SBOMs"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:n.RJ.search},{categoryKey:"average_severity",title:"CVSS",placeholderText:"CVSS",type:n.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:l,total:c},isFetching:d,fetchError:u}=(0,m.WJ)((0,i.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score"}})),E=(0,i.PB)({...t,idProperty:"identifier",currentPageItems:l,totalItemCount:c,isLoading:d,selectionState:(0,s.$)({items:l,isEqual:(e,t)=>e.identifier===t.identifier})});return a.createElement(o.Provider,{value:{totalItemCount:c,isFetching:d,fetchError:u,tableControls:E}},e)}},1159:(e,t,l)=>{l.d(t,{fk:()=>A});var a=l(63696),n=l(49348),r=l(76072),i=l(97299),s=l(17327),m=l(64361),o=l(71603),c=l(65753),d=l(24974),u=l(21639),E=l(3939),p=l(85578),h=l(16646),b=l(31065),g=l(77819),y=l(28516),v=l(3629),f=l(62101),T=l(38139),C=l(24417),P=l(50705),w=l(52302),S=l(1349),x=l(62520),K=l(74932),I=l(34066),F=l(70400),k=l(48703),N=l(14310);const A=()=>{const{pushNotification:e}=a.useContext(P.K),{isFetching:t,fetchError:l,totalItemCount:C,tableControls:F}=a.useContext(N.u),k=(0,K.o5)((t=>{e({title:`The Vulnerability ${t.identifier} was deleted`,variant:"danger"})}),(t=>{e({title:"Error occurred while deleting the vulnerability",variant:"danger"})})),{numRenderedColumns:A,currentPageItems:X,propHelpers:{paginationProps:q,tableProps:L,getThProps:R,getTrProps:W,getTdProps:Y,getExpandedContentTdProps:J},expansionDerivedState:{isCellExpanded:O}}=F;return a.createElement(a.Fragment,null,a.createElement(p.X,{...L,"aria-label":"Vulnerability table"},a.createElement(h.d,null,a.createElement(b.Tr,null,a.createElement(x.Ze,{...F},a.createElement(g.Th,{...R({columnKey:"identifier"})}),a.createElement(g.Th,{...R({columnKey:"title"})}),a.createElement(g.Th,{...R({columnKey:"severity"})}),a.createElement(g.Th,{...R({columnKey:"published"})}),a.createElement(g.Th,{...R({columnKey:"packages"})}),a.createElement(g.Th,{...R({columnKey:"sboms"})})))),a.createElement(x.nJ,{isLoading:t,isError:!!l,isNoData:0===C,numRenderedColumns:A},X.map(((e,t)=>a.createElement(y.N,{key:e.identifier,isExpanded:O(e)},a.createElement(b.Tr,{...W({item:e})},a.createElement(x.Oi,{...F,item:e,rowIndex:t},a.createElement(v.Td,{width:15,...Y({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},a.createElement(n.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),a.createElement(v.Td,{width:45,modifier:"truncate",...Y({columnKey:"title"})},e.title||e.description),a.createElement(v.Td,{width:10,...Y({columnKey:"severity"})},e.average_severity&&a.createElement(w.h,{value:e.average_severity})),a.createElement(v.Td,{width:10,...Y({columnKey:"published"})},(0,I.Yq)(e.published)),a.createElement(v.Td,{width:10,modifier:"truncate",...Y({columnKey:"packages",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"Packages"),a.createElement(v.Td,{width:10,modifier:"truncate",...Y({columnKey:"sboms",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"SBOMs"),a.createElement(v.Td,{isActionCell:!0},a.createElement(f.G,{items:[{title:"Delete",onClick:()=>k.mutate(e.identifier)}]})))),O(e)?a.createElement(b.Tr,{isExpanded:!0},a.createElement(v.Td,{...J({item:e})},a.createElement(T.g,null,a.createElement("div",{className:"pf-v5-u-m-md"},O(e,"identifier")?a.createElement(a.Fragment,null,a.createElement(r.x,{hasGutter:!0},a.createElement(i.E,{md:8},a.createElement(s.Z,{isFullHeight:!0,isCompact:!0},a.createElement(m.Z,null,"General view"),a.createElement(o.b,null,a.createElement(c.B,{columnModifier:{default:"2Col"}},a.createElement(d.W,null,a.createElement(u.X,null,"Published"),a.createElement(E.d,null,(0,I.Yq)(e.published))),a.createElement(d.W,null,a.createElement(u.X,null,"Modified"),a.createElement(E.d,null,(0,I.Yq)(e.modified))),a.createElement(d.W,null,a.createElement(u.X,null,"Released"),a.createElement(E.d,null,(0,I.Yq)(e.released))),a.createElement(d.W,null,a.createElement(u.X,null,"Withdrawn"),a.createElement(E.d,null,(0,I.Yq)(e.withdrawn))))))),a.createElement(i.E,{md:4},a.createElement(s.Z,{isFullHeight:!0,isCompact:!0},a.createElement(m.Z,null,"Additional info"),a.createElement(o.b,null,a.createElement(c.B,null,a.createElement(d.W,null,a.createElement(u.X,null,"CWE"),a.createElement(E.d,null,"item.cwe")),a.createElement(d.W,null,a.createElement(u.X,null,"Non normative"),a.createElement(E.d,null,e.normative?"Yes":"No")))))))):null,O(e,"packages")?a.createElement(a.Fragment,null,a.createElement(_,{vulnerabilityId:e.identifier})):null,O(e,"sboms")?a.createElement(a.Fragment,null,a.createElement(M,{vulnerabilityId:e.identifier})):null)))):null))))),a.createElement(S.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:q}))},_=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:n}=(0,K.uN)(e);return a.createElement(C.a,{isFetching:l,fetchError:n},a.createElement(F.n,{variant:"compact",initialItemsPerPage:5,advisories:t?.advisories??[]}))},M=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:n}=(0,K.uN)(e);return a.createElement(C.a,{isFetching:l,fetchError:n},a.createElement(k.m,{variant:"compact",advisories:t?.advisories??[]}))}}}]);
//# sourceMappingURL=159.c9524638.min.js.map