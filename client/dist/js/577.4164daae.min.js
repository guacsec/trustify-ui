"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[577],{17327:(e,t,a)=>{a.d(t,{E:()=>o,Z:()=>c});var r=a(34629),l=a(63696),i=a(41775),n=a(62634),s=a(1850);const o=l.createContext({cardId:"",registerTitleId:()=>{},isExpanded:!1,isClickable:!1,isSelectable:!1,isSelected:!1,isClicked:!1,isDisabled:!1}),c=e=>{var{children:t,id:a="",className:d,component:u="div",isCompact:m=!1,isSelectable:p=!1,isClickable:f=!1,isDisabled:y=!1,isSelectableRaised:b=!1,isSelected:v=!1,isClicked:h=!1,isDisabledRaised:E=!1,isFlat:g=!1,isExpanded:C=!1,isRounded:S=!1,isLarge:k=!1,isFullHeight:P=!1,isPlain:T=!1,ouiaId:F,ouiaSafe:_=!0,hasSelectableInput:x=!1,selectableInputAriaLabel:I,onSelectableInputChange:K=()=>{}}=e,A=(0,r.__rest)(e,["children","id","className","component","isCompact","isSelectable","isClickable","isDisabled","isSelectableRaised","isSelected","isClicked","isDisabledRaised","isFlat","isExpanded","isRounded","isLarge","isFullHeight","isPlain","ouiaId","ouiaSafe","hasSelectableInput","selectableInputAriaLabel","onSelectableInputChange"]);const N=u,w=(0,s.iK)(c.displayName,F,_),[R,L]=l.useState(""),[D,V]=l.useState();m&&k&&(console.warn("Card: Cannot use isCompact with isLarge. Defaulting to isCompact"),k=!1);const q=l.useRef(!1);return l.useEffect((()=>{I?V({"aria-label":I}):R?V({"aria-labelledby":R}):x&&!q.current&&(V({}),console.warn("If no CardTitle component is passed as a child of Card the selectableInputAriaLabel prop must be passed"))}),[x,I,R]),l.createElement(o.Provider,{value:{cardId:a,registerTitleId:e=>{L(e),q.current=!!e},isExpanded:C,isClickable:f,isSelectable:p,isSelected:v,isClicked:h,isDisabled:y,hasSelectableInput:x}},x&&l.createElement("input",Object.assign({className:"pf-v5-screen-reader",id:`${a}-input`},D,{type:"checkbox",checked:v,onChange:e=>K(e,a),disabled:E,tabIndex:-1})),l.createElement(N,Object.assign({id:a,className:(0,n.A)(i.A.card,m&&i.A.modifiers.compact,C&&i.A.modifiers.expanded,g&&i.A.modifiers.flat,S&&i.A.modifiers.rounded,k&&i.A.modifiers.displayLg,P&&i.A.modifiers.fullHeight,T&&i.A.modifiers.plain,E?(0,n.A)(i.A.modifiers.nonSelectableRaised):b?(0,n.A)(i.A.modifiers.selectableRaised,v&&i.A.modifiers.selectedRaised):p&&f?(0,n.A)(i.A.modifiers.selectable,i.A.modifiers.clickable,(v||h)&&i.A.modifiers.current):p?(0,n.A)(i.A.modifiers.selectable,v&&i.A.modifiers.selected):f?(0,n.A)(i.A.modifiers.clickable,h&&i.A.modifiers.current):"",y&&i.A.modifiers.disabled,d),tabIndex:b?"0":void 0},A,w),t))};c.displayName="Card"},71603:(e,t,a)=>{a.d(t,{b:()=>s});var r=a(34629),l=a(63696),i=a(41775),n=a(62634);const s=e=>{var{children:t,className:a,component:s="div",isFilled:o=!0}=e,c=(0,r.__rest)(e,["children","className","component","isFilled"]);const d=s;return l.createElement(d,Object.assign({className:(0,n.A)(i.A.cardBody,!o&&i.A.modifiers.noFill,a)},c),t)};s.displayName="CardBody"},54518:(e,t,a)=>{a.d(t,{B:()=>s});var r=a(34629),l=a(63696),i=a(90829),n=a(62634);const s=e=>{var{hasGutter:t=!1,isWrappable:a=!1,className:s="",children:o=null,component:c="div"}=e,d=(0,r.__rest)(e,["hasGutter","isWrappable","className","children","component"]);const u=c;return l.createElement(u,Object.assign({},d,{className:(0,n.A)(i.A.split,t&&i.A.modifiers.gutter,a&&i.A.modifiers.wrap,s)}),o)};s.displayName="Split"},48281:(e,t,a)=>{a.d(t,{o:()=>s});var r=a(34629),l=a(63696),i=a(90829),n=a(62634);const s=e=>{var{isFilled:t=!1,className:a="",children:s=null}=e,o=(0,r.__rest)(e,["isFilled","className","children"]);return l.createElement("div",Object.assign({},o,{className:(0,n.A)(i.A.splitItem,t&&i.A.modifiers.fill,a)}),s)};s.displayName="SplitItem"},38914:(e,t,a)=>{a.d(t,{B:()=>s});var r=a(34629),l=a(63696),i=a(13364),n=a(62634);const s=e=>{var{hasGutter:t=!1,className:a="",children:s=null,component:o="div"}=e,c=(0,r.__rest)(e,["hasGutter","className","children","component"]);const d=o;return l.createElement(d,Object.assign({},c,{className:(0,n.A)(i.A.stack,t&&i.A.modifiers.gutter,a)}),s)};s.displayName="Stack"},57901:(e,t,a)=>{a.d(t,{a:()=>s});var r=a(34629),l=a(63696),i=a(13364),n=a(62634);const s=e=>{var{isFilled:t=!1,className:a="",children:s=null}=e,o=(0,r.__rest)(e,["isFilled","className","children"]);return l.createElement("div",Object.assign({},o,{className:(0,n.A)(i.A.stackItem,t&&i.A.modifiers.fill,a)}),s)};s.displayName="StackItem"},16177:(e,t,a)=>{a.d(t,{a:()=>i});var r=a(63696),l=a(93962);const i=({value:e})=>r.createElement(r.Fragment,null,Object.entries(e).map((([e,t],a)=>r.createElement(l.J,{key:a,isCompact:!0},`${e}=${t}`))))},23560:(e,t,a)=>{a.d(t,{j:()=>l});var r=a(63696);const l=({vulnerability:e})=>r.createElement("p",null,e.withdrawn&&r.createElement("em",null,"Rejected:Â "),e.title||e.description)},68248:(e,t,a)=>{a.d(t,{f:()=>s});var r=a(63696),l=a(74932);const i=(e,t)=>e.sbom.id===t.sbom.id&&e.sbomStatus===t.sbomStatus,n={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0}},s=e=>{const{vulnerability:t,isFetching:a,fetchError:s}=(0,l.uN)(e);return{data:r.useMemo((()=>(e=>{const t=e.flatMap((e=>(e.sboms??[]).flatMap((t=>Object.entries(t.purl_statuses||{}).map((([a,r])=>({sbom:{...t},sbomStatus:a,advisory:e,packages:r}))))).reduce(((e,t)=>{const a=e.find((e=>i(e,t)));if(a)return[...e.filter((e=>!i(e,a))),{...a,relatedPackages:[...a.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];{const a={sbom:t.sbom,sbomStatus:t.sbomStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};return[...e,a]}}),[]))),a=t.reduce(((e,t)=>{const a=t.sbomStatus;return{...e,total:e.total+1,sbomStatus:{...e.sbomStatus,[a]:e.sbomStatus[a]+1}}}),n);return{sboms:t,summary:a}})(t?.advisories||[])),[t]),isFetching:a,fetchError:s}}},9366:(e,t,a)=>{a.d(t,{$:()=>o});var r=a(63696),l=a(17993);const i=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,n={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},s={vulnerabilityStatus:{affected:{...n},fixed:{...n},not_affected:{...n},known_not_affected:{...n}}},o=e=>{const{pkg:t,isFetching:a,fetchError:n}=(0,l.Si)(e);return{data:r.useMemo((()=>(e=>{const t=e.flatMap((e=>(e.status??[]).map((t=>({vulnerability:{...t.vulnerability,average_severity:t.average_severity},vulnerabilityStatus:t.status,advisory:e}))).reduce(((e,t)=>{const a=e.find((e=>i(e,t)));if(a)return[...e.filter((e=>!i(e,a))),{...a,relatedSboms:[...a.relatedSboms,{advisory:t.advisory}]}];{const a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};return[...e,a]}}),[]))),a=t.reduce(((e,t)=>{const a=t.vulnerabilityStatus,r=t.vulnerability.average_severity,l=e.vulnerabilityStatus[a];return{...e,vulnerabilityStatus:{...e.vulnerabilityStatus,[a]:{total:l.total+1,severities:{...l.severities,[r]:l.severities[r]+1}}}}}),s);return{vulnerabilities:t,summary:a}})(t?.advisories||[])),[t]),isFetching:a,fetchError:n}}},7602:(e,t,a)=>{a.d(t,{R:()=>c,r:()=>d});var r=a(63696),l=a(87043),i=a(86820),n=a(70611),s=a(5098),o=a(69935);const c=r.createContext({}),d=({children:e})=>{const t=(0,n.MM)({tableName:"advisory",persistenceKeyPrefix:i.rt.advisories,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Title",severity:"Aggregated Severity",modified:"Revision",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","severity","modified"],isFilterEnabled:!0,filterCategories:[{categoryKey:i._G,title:"Filter text",placeholderText:"Search",type:l.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:l.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"modified",title:"Revision",type:l.RJ.dateRange}],isExpansionEnabled:!1}),{result:{data:a,total:d},isFetching:u,fetchError:m}=(0,o.VH)((0,n.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score",modified:"modified"}})),p=(0,n.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:d,isLoading:u,selectionState:(0,s.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return r.createElement(c.Provider,{value:{totalItemCount:d,isFetching:u,fetchError:m,tableControls:p}},e)}},7123:(e,t,a)=>{a.d(t,{q:()=>g});var r=a(63696),l=a(49348),i=a(40319),n=a(16646),s=a(9425),o=a(77819),c=a(28516),d=a(3629),u=a(62101),m=a(50705),p=a(1349),f=a(62520),y=a(91271),b=a(11848),v=a(28644),h=a(34066),E=a(7602);const g=({})=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:g}=r.useContext(E.R),{pushNotification:C}=r.useContext(m.K),{numRenderedColumns:S,currentPageItems:k,propHelpers:{paginationProps:P,tableProps:T,getThProps:F,getTrProps:_,getTdProps:x},expansionDerivedState:{isCellExpanded:I}}=g,{downloadAdvisory:K}=(0,y.m)();return r.createElement(r.Fragment,null,r.createElement(i.X,{...T,"aria-label":"advisory-table"},r.createElement(n.d,null,r.createElement(s.Tr,null,r.createElement(f.Ze,{...g},r.createElement(o.Th,{...F({columnKey:"identifier"})}),r.createElement(o.Th,{...F({columnKey:"title"})}),r.createElement(o.Th,{...F({columnKey:"severity"})}),r.createElement(o.Th,{...F({columnKey:"modified"})}),r.createElement(o.Th,{...F({columnKey:"vulnerabilities"})})))),r.createElement(f.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:S},k.map(((e,t)=>{const a=e.vulnerabilities.reduce(((e,t)=>({...e,[t.severity]:e[t.severity]+1})),{critical:0,high:0,medium:0,low:0,none:0});return r.createElement(c.N,{key:e.identifier,isExpanded:I(e)},r.createElement(s.Tr,{..._({item:e})},r.createElement(f.Oi,{...g,item:e,rowIndex:t},r.createElement(d.Td,{width:15,...x({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},r.createElement(l.k2,{to:`/advisories/${e.uuid}`},e.document_id)),r.createElement(d.Td,{width:40,modifier:"truncate",...x({columnKey:"title"})},e.title),r.createElement(d.Td,{width:15,modifier:"truncate",...x({columnKey:"severity"})},e.average_severity&&r.createElement(b.h,{value:e.average_severity})),r.createElement(d.Td,{width:10,...x({columnKey:"modified"})},(0,h.Yq)(e.modified)),r.createElement(d.Td,{width:20,...x({columnKey:"vulnerabilities"})},r.createElement(v.n,{severities:a})),r.createElement(d.Td,{isActionCell:!0},r.createElement(u.G,{items:[{title:"Download",onClick:()=>{K(e.uuid,`${e.identifier}.json`)}}]})))))})))),r.createElement(p.n,{idPrefix:"advisory-table",isTop:!1,isCompact:!0,paginationProps:P}))}},30426:(e,t,a)=>{a.d(t,{Y:()=>d,a:()=>u});var r=a(63696),l=a(87043),i=a(86820),n=a(70611),s=a(5098),o=a(17993),c=a(34066);const d=r.createContext({}),u=({children:e})=>{const t=(0,n.MM)({tableName:"packages",persistenceKeyPrefix:i.rt.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:i._G,title:"Filter text",placeholderText:"Search",type:l.RJ.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:l.RJ.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:l.RJ.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:a,total:u},isFetching:m,fetchError:p}=(0,o.Lx)((0,n.Ng)({...t,hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}})),f=r.useMemo((()=>a.map((e=>({...e,decomposedPurl:(0,c.fe)(e.purl)})))),[a]),y=(0,n.PB)({...t,idProperty:"uuid",currentPageItems:f,totalItemCount:u,isLoading:m,selectionState:(0,s.$)({items:f,isEqual:(e,t)=>e.uuid===t.uuid})});return r.createElement(d.Provider,{value:{totalItemCount:u,isFetching:m,fetchError:p,tableControls:y}},e)}},17170:(e,t,a)=>{a.d(t,{N:()=>C});var r=a(63696),l=a(49348),i=a(40319),n=a(16646),s=a(9425),o=a(77819),c=a(28516),d=a(3629),u=a(16177),m=a(1349),p=a(62520),f=a(36509),y=a(93962),b=a(24417),v=a(28644),h=a(9366);const E=({packageId:e})=>{const{data:t,isFetching:a,fetchError:l}=(0,h.$)(e);return r.createElement(b.a,{isFetching:a,fetchError:l,isFetchingState:r.createElement(f.E,{screenreaderText:"Loading contents"}),fetchErrorState:r.createElement(y.J,{color:"red"},"Error")},r.createElement(v.n,{severities:t.summary.vulnerabilityStatus.affected.severities}))};var g=a(30426);const C=()=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:f}=r.useContext(g.Y),{numRenderedColumns:y,currentPageItems:b,propHelpers:{paginationProps:v,tableProps:h,getThProps:C,getTrProps:S,getTdProps:k},expansionDerivedState:{isCellExpanded:P}}=f;return r.createElement(r.Fragment,null,r.createElement(i.X,{...h,"aria-label":"Package table"},r.createElement(n.d,null,r.createElement(s.Tr,null,r.createElement(p.Ze,{...f},r.createElement(o.Th,{...C({columnKey:"name"})}),r.createElement(o.Th,{...C({columnKey:"namespace"})}),r.createElement(o.Th,{...C({columnKey:"version"})}),r.createElement(o.Th,{...C({columnKey:"type"})}),r.createElement(o.Th,{...C({columnKey:"path"})}),r.createElement(o.Th,{...C({columnKey:"qualifiers"})}),r.createElement(o.Th,{...C({columnKey:"vulnerabilities"})})))),r.createElement(p.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:y},b.map(((e,t)=>r.createElement(c.N,{key:e.uuid},r.createElement(s.Tr,{...S({item:e})},r.createElement(p.Oi,{...f,item:e,rowIndex:t},r.createElement(d.Td,{width:15,...k({columnKey:"name"})},r.createElement(l.k2,{to:`/packages/${e.uuid}`},e.decomposedPurl?e.decomposedPurl?.name:e.purl)),r.createElement(d.Td,{width:15,modifier:"truncate",...k({columnKey:"namespace"})},e.decomposedPurl?.namespace),r.createElement(d.Td,{width:10,modifier:"truncate",...k({columnKey:"version"})},e.decomposedPurl?.version),r.createElement(d.Td,{width:10,modifier:"truncate",...k({columnKey:"type"})},e.decomposedPurl?.type),r.createElement(d.Td,{width:10,modifier:"truncate",...k({columnKey:"path"})},e.decomposedPurl?.path),r.createElement(d.Td,{width:20,...k({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&r.createElement(u.a,{value:e.decomposedPurl?.qualifiers})),r.createElement(d.Td,{width:20,...k({columnKey:"vulnerabilities"})},r.createElement(E,{packageId:e.uuid}))))))))),r.createElement(m.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:v}))}},62107:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Se});var r=a(63696),l=a(68430),i=a(20653),n=a(35048),s=a(56918),o=a(1180),c=a(72785),d=a(4433),u=a(86820),m=a(69935),p=a(17993),f=a(91728),y=a(74932),b=a(68792),v=a(93962),h=a(60876),E=a(51522),g=a(65841),C=a(66174),S=a(66129),k=a(49348);const P=e=>r.createElement(k.N_,{key:e.id,to:e.navLink,style:{textDecoration:"none"}},r.createElement(b.D,{itemId:e.id,description:e.description},e.title," ",r.createElement(v.J,{color:e.typeColor},e.type)));function T(e,t){let a=e.filter((e=>e.id.toLowerCase().startsWith(t.toLowerCase())||e.title?.toLowerCase().startsWith(t.toLowerCase())||e.description?.toLowerCase().startsWith(t.toLowerCase()))).map(P);return a=a.length>10?a.slice(0,10):[...a,...e.filter((e=>!e.id.startsWith(t.toLowerCase())&&e.id.includes(t.toLowerCase()))).map(P)].slice(0,10),a}const F=({filterFunction:e=T,onChangeSearch:t})=>{const{list:a,defaultValue:l}=function(){const e={filters:[{field:u._G,operator:"~",value:""}],page:{pageNumber:1,itemsPerPage:10}},{result:{data:t}}=(0,m.VH)({...e}),{result:{data:a}}=(0,p.Lx)({...e}),{result:{data:r}}=(0,f.i$)({...e}),{result:{data:l}}=(0,y.WJ)({...e}),i=[],n=t.map((e=>({id:e.document_id,title:e.document_id,description:e.title?.substring(0,75),navLink:`/advisories/${e.uuid}`,type:"Advisory",typeColor:"blue"}))),s=a.map((e=>({id:e.uuid,title:e.purl,navLink:`/packages/${e.uuid}`,type:"Package",typeColor:"cyan"}))),o=r.map((e=>({id:e.id,title:e.name,description:e.authors.join(", "),navLink:`/sboms/${e.id}`,type:"SBOM",typeColor:"purple"}))),c=l.map((e=>({id:e.identifier,title:e.identifier,description:e.description?.substring(0,75),navLink:`/vulnerabilities/${e.identifier}`,type:"Vulnerability",typeColor:"orange"})));return i.push(...n,...s,...o,...c),{list:i,defaultValue:""}}(),[i,n]=r.useState(l),[s,o]=r.useState([]),[c,d]=r.useState(!1),b=r.useRef(null),v=r.useRef(null);r.useEffect((()=>{const e=e=>{if(c&&b.current&&b.current===e.target)if("Escape"===e.key)d(!1),b.current.focus();else if("ArrowDown"===e.key||"ArrowUp"===e.key){const t=v.current?.querySelector("li > button:not(:disabled)");t&&t?.focus(),e.preventDefault()}else"Tab"!==e.key&&"Enter"!==e.key&&"Space"!==e.key||(d(!1),"Enter"!==e.key&&"Space"!==e.key||e.preventDefault());else c&&v.current?.contains(e.target)&&"Tab"===e.key&&(e.preventDefault(),d(!1),b.current?.focus())},t=e=>{c&&v&&v.current&&!v.current.contains(e.target)&&d(!1)};return window.addEventListener("keydown",e),window.addEventListener("click",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("click",t)}}),[c]);const k=r.createElement(h.W,{ref:v,style:{maxWidth:"450px"}},r.createElement(E.r,null,r.createElement(g.c,null,s))),P=r.createElement(C.D,{placeholder:"Search for an SBOM, Package, or Vulnerability",value:i,onChange:(t,r)=>(t=>{if(""!==t&&b&&b.current&&b.current.contains(document.activeElement)){d(!0);const r=e(a,t);d(r.length>0),o(r)}else d(!1);n(t)})(r),onClear:()=>{n("")},onSearch:()=>{t(i)},onKeyDown:e=>{!e.key||e.key},ref:b,id:"autocomplete-search"});return r.createElement(S.N,{trigger:P,triggerRef:b,popper:k,popperRef:v,isVisible:c,enableFlip:!1,appendTo:()=>document.querySelector("#autocomplete-search")})};var _=a(30426),x=a(36390),I=a(14310),K=a(7602);function A(e,t){return{Component:e,props:t}}const N=[A(x.c,{}),A(_.a,{}),A(I.y,{}),A(K.r,{})],w=(R=N,({children:e})=>{const t=r.createElement(r.Fragment,null,e);return R.reduceRight(((e,{Component:t,props:a={}})=>r.createElement(t,{...a},e)),t)});var R,L=a(69673),D=a(54518),V=a(48281),q=a(17327),O=a(71603),M=a(16459),$=a(71592),B=a(40111),J=a(96178),H=a(70414),Y=a(38914),j=a(57901),G=a(77635),W=a(87043),Z=a(58897),X=a(71273),z=a(51463);const Q=({category:e,filterValue:t,setFilterValue:a,isNumeric:l,isDisabled:i=!1})=>{const[n,s]=r.useState(t?.[0]||"");r.useEffect((()=>{s(t?.[0]||"")}),[t]);const o=()=>{const e=n.trim();a(e?[e.replace(/\s+/g," ")]:[])},c=`${e.categoryKey}-input`;return r.createElement(Z.M,null,r.createElement(X.ks,{name:c,id:"search-input",type:l?"number":"search",onChange:(e,t)=>s(t),"aria-label":`${e.title} filter`,value:n,placeholder:e.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||o()},isDisabled:i}),r.createElement(G.$n,{variant:G.Ak.control,id:"search-button","aria-label":"search button for search input",onClick:o,isDisabled:i},r.createElement(z.Ay,null)))};var U=a(34629);const ee="pf-m-standalone",te="pf-m-disabled";var ae=a(62634),re=a(1850);class le extends r.Component{constructor(e){super(e),this.handleChange=e=>{this.props.onChange(e,e.currentTarget.checked)},e.label||e["aria-label"]||console.error("Radio:","Radio requires an aria-label to be specified"),this.state={ouiaStateId:(0,re.X)(le.displayName)}}render(){const e=this.props,{"aria-label":t,checked:a,className:l,inputClassName:i,defaultChecked:n,isLabelWrapped:s,isLabelBeforeButton:o,isChecked:c,isDisabled:d,isValid:u,label:m,onChange:p,description:f,body:y,ouiaId:b,ouiaSafe:v=!0,component:h}=e,E=(0,U.__rest)(e,["aria-label","checked","className","inputClassName","defaultChecked","isLabelWrapped","isLabelBeforeButton","isChecked","isDisabled","isValid","label","onChange","description","body","ouiaId","ouiaSafe","component"]);E.id||console.error("Radio:","id is required to make input accessible");const g=r.createElement("input",Object.assign({},E,{className:(0,ae.A)("pf-v5-c-radio__input",i),type:"radio",onChange:this.handleChange,"aria-invalid":!u,disabled:d,checked:a||c},void 0===a&&{defaultChecked:n},!m&&{"aria-label":t},(0,re.Bs)(le.displayName,void 0!==b?b:this.state.ouiaStateId,v))),C=s&&!h||"label"===h,S=C?"span":"label",k=m?r.createElement(S,{className:(0,ae.A)("pf-v5-c-radio__label",d&&te),htmlFor:C?void 0:E.id},m):null,P=null!=h?h:C?"label":"div";return r.createElement(P,{className:(0,ae.A)("pf-v5-c-radio",!m&&ee,l),htmlFor:C?E.id:void 0},o?r.createElement(r.Fragment,null,k,g):r.createElement(r.Fragment,null,g,k),f&&r.createElement("span",{className:(0,ae.A)("pf-v5-c-radio__description")},f),y&&r.createElement("span",{className:(0,ae.A)("pf-v5-c-radio__body")},y))}}le.displayName="Radio",le.defaultProps={className:"",isDisabled:!1,isValid:!0,onChange:()=>{}};const ie=({category:e,filterValue:t,setFilterValue:a,isDisabled:l=!1})=>r.createElement(r.Fragment,null,e.selectOptions.map((({label:i,value:n,optionProps:s={}},o)=>{const c=t?.includes(n)||!1;return r.createElement(le,{isDisabled:l,key:o,id:`radio-${o}`,name:"radio",isLabelWrapped:!0,label:i,isChecked:c,onChange:()=>{(t=>{const r=(l=t,e.selectOptions.find((({value:e})=>e===l)));var l;a(r?[t]:null)})(n)}})})));var ne=a(58365);const se=({category:e,filterValue:t,setFilterValue:a,isDisabled:l=!1})=>{const[i,n]=r.useState(Array.isArray(e.selectOptions)?e.selectOptions:[]);r.useEffect((()=>{n(Array.isArray(e.selectOptions)?e.selectOptions:[])}),[e.selectOptions]);const s=Array.isArray(i)?i:Object.values(i).flatMap((e=>e));return r.createElement(r.Fragment,null,s.map((({label:l,value:i,optionProps:n={}},s)=>r.createElement(ne.S,{key:s,id:`checkbox-${s}-${e.categoryKey}`,isLabelWrapped:!0,label:l,isChecked:t?.includes(i),onChange:()=>{(e=>{if(e&&"No results"!==e){let r;r=t&&t.includes(e)?t.filter((t=>t!==e)):t?[...t,e]:[e],a(r)}})(i)}}))))};var oe=a(46721),ce=a(40360),de=a(23277),ue=a(78109),me=a(66341);const pe=({category:e,filterValue:t,setFilterValue:a,isDisabled:l=!1})=>{const i=t??[],[n,s]=(i?.filter((e=>(0,me.Ce)((0,me.P1)(e)))),(0,r.useState)()),[o,c]=(0,r.useState)();return r.useEffect((()=>{if(t?.[0]){const[e,a]=(0,me.P1)(t?.[0]);s(e.toDate()),c(a.toDate())}else s(void 0),c(void 0)}),[t]),r.createElement(oe.l,null,r.createElement(ce.g,{role:"group",isInline:!0,label:"From"},r.createElement(de.l,{value:n?(0,me.ak)(n):"",dateFormat:me.ak,dateParse:me.sy,onChange:(e,t)=>{(0,me.Fz)(t)&&(s((0,me.sy)(t)),c(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:l})),r.createElement(ce.g,{role:"group",isInline:!0,label:"To"},r.createElement(de.l,{value:o?(0,me.ak)(o):"",onChange:(e,t)=>{if((0,me.Fz)(t)){const e=(0,me.sy)(t);c(e);const r=(0,me.Kg)(n,e);r&&a([r])}},isDisabled:l||!(0,ue.v)(n),dateFormat:me.ak,dateParse:me.sy,invalidFormatText:"",rangeStart:n,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})))},fe=({category:e,...t})=>e.type===W.RJ.select?r.createElement(ie,{category:e,...t}):e.type===W.RJ.search||e.type===W.RJ.numsearch?r.createElement(Q,{category:e,isNumeric:e.type===W.RJ.numsearch,...t}):e.type===W.RJ.multiselect?r.createElement(se,{category:e,...t}):e.type===W.RJ.dateRange?r.createElement(pe,{category:e,...t}):null,ye=({filterCategories:e,filterValues:t,setFilterValues:a,isDisabled:l=!1,omitFilterCategoryKeys:i=[]})=>r.createElement(r.Fragment,null,r.createElement(Y.B,{hasGutter:!0},r.createElement(j.a,null,r.createElement(G.$n,{variant:"link",isInline:!0,onClick:()=>{const r=e.filter((e=>void 0===i.find((t=>t===e.categoryKey)))).reduce(((e,t)=>({...e,[t.categoryKey]:void 0})),{});a({...t,...r})}},"Clear all filters")),e.filter((e=>void 0===i.find((t=>t===e.categoryKey)))).map((e=>r.createElement(j.a,{key:e.categoryKey},r.createElement(Y.B,{hasGutter:!0},r.createElement(j.a,null,r.createElement(o.n,null,r.createElement(c.E,{component:"h4"},e.title))),r.createElement(j.a,null,r.createElement(fe,{category:e,filterValue:t[e.categoryKey],setFilterValue:r=>((e,r)=>a({...t,[e.categoryKey]:r}))(e,r),isDisabled:l,isSidebar:!0}))))))));var be=a(7123),ve=a(17170),he=a(48989),Ee=a(86416),ge=a(8210);const Ce=({filterPanelProps:e,sbomTable:t,sbomTotalCount:a,packageTable:l,packageTotalCount:i,vulnerabilityTable:n,vulnerabilityTotalCount:s,advisoryTable:o,advisoryTotalCount:c})=>{const[d,u]=r.useState(0),{sbomFilterPanelProps:m,packageFilterPanelProps:p,vulnerabilityFilterPanelProps:f,advisoryFilterPanelProps:y}=e,b=r.createRef();return r.createElement(D.B,{hasGutter:!0},r.createElement(V.o,null,r.createElement(q.Z,{isFullHeight:!0},r.createElement(O.b,{style:{width:241}},0===d?r.createElement(ye,{omitFilterCategoryKeys:[""],...m}):1===d?r.createElement(ye,{omitFilterCategoryKeys:[""],...p}):2===d?r.createElement(ye,{omitFilterCategoryKeys:[""],...f}):3===d?r.createElement(ye,{omitFilterCategoryKeys:[""],...y}):null))),r.createElement(V.o,{isFilled:!0},r.createElement(M.t,{isBox:!0,activeKey:d,onSelect:(e,t)=>{u(t)},"aria-label":"Tabs",role:"region"},r.createElement($.o,{eventKey:0,title:r.createElement(B.V,null,"SBOMs","  ",r.createElement(J.E,{screenReaderText:"Search Result Count"},a)),actions:r.createElement(r.Fragment,null,r.createElement(H.o,{"aria-label":"SBOM help popover",ref:b},r.createElement(ge.Ay,null)),(v=b,r.createElement(L.A,{bodyContent:r.createElement("div",null,"Software Bill of Materials for Products and Containers."),position:"right",triggerRef:v})))},t??r.createElement(he.Y,null)),r.createElement($.o,{eventKey:1,title:r.createElement(B.V,null,"Packages","  ",r.createElement(J.E,{screenReaderText:"Search Result Count"},i))},l??r.createElement(ve.N,null)),r.createElement($.o,{eventKey:2,title:r.createElement(B.V,null,"Vulnerabilities","  ",r.createElement(J.E,{screenReaderText:"Search Result Count"},s))},n??r.createElement(Ee.f,null)),r.createElement($.o,{eventKey:3,title:r.createElement(B.V,null,"Advisories","  ",r.createElement(J.E,{screenReaderText:"Advisory Result Count"},c))},o??r.createElement(be.q,null)))));var v},Se=({searchBodyOverride:e})=>r.createElement(w,null,r.createElement(ke,{searchBodyOverride:e})),ke=({searchBodyOverride:e})=>{const{tableControls:t}=r.useContext(x.L),{tableControls:a}=r.useContext(_.Y),{tableControls:m}=r.useContext(I.u),{tableControls:p}=r.useContext(K.R),{totalItemCount:f,tableControls:{propHelpers:{filterPanelProps:y}}}=r.useContext(x.L),{totalItemCount:b,tableControls:{propHelpers:{filterPanelProps:v}}}=r.useContext(_.Y),{totalItemCount:h,tableControls:{propHelpers:{filterPanelProps:E}}}=r.useContext(I.u),{totalItemCount:g,tableControls:{propHelpers:{filterPanelProps:C}}}=r.useContext(K.R),S={advisoryFilterPanelProps:C,packageFilterPanelProps:v,sbomFilterPanelProps:y,vulnerabilityFilterPanelProps:E},k=r.createElement(Ce,{filterPanelProps:S,packageTotalCount:b,sbomTotalCount:f,vulnerabilityTotalCount:h,advisoryTotalCount:g});return r.createElement(r.Fragment,null,r.createElement(l.d8,{variant:l.zC.light},r.createElement(i.M,{isStatic:!0},r.createElement(n.P,null,r.createElement(s.$,{align:{default:"alignLeft"}},r.createElement(o.n,null,r.createElement(c.E,{component:"h1"},"Search Results"))),r.createElement(s.$,{variant:"icon-button-group",align:{default:"alignRight"}},r.createElement(s.$,{visibility:{default:"hidden",lg:"visible"}},r.createElement(d.T,{widths:{default:"500px"}},r.createElement(F,{onChangeSearch:e=>{null!=e&&(t.filterState.setFilterValues({...t.filterState.filterValues,[u._G]:[e]}),a.filterState.setFilterValues({...a.filterState.filterValues,[u._G]:[e]}),m.filterState.setFilterValues({...m.filterState.filterValues,[u._G]:[e]}),p.filterState.setFilterValues({...p.filterState.filterValues,[u._G]:[e]}))}}))))))),r.createElement(l.d8,null,e||k))}},14310:(e,t,a)=>{a.d(t,{u:()=>c,y:()=>d});var r=a(63696),l=a(87043),i=a(86820),n=a(70611),s=a(5098),o=a(74932);const c=r.createContext({}),d=({children:e})=>{const t=(0,n.MM)({tableName:"vulnerability",persistenceKeyPrefix:i.rt.vulnerabilities,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Description",severity:"CVSS",published:"Date published",sboms:"Related documents"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["published","severity"],isFilterEnabled:!0,filterCategories:[{categoryKey:i._G,title:"Filter text",placeholderText:"Search",type:l.RJ.search},{categoryKey:"average_severity",title:"CVSS",placeholderText:"CVSS",type:l.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"published",title:"Created on",type:l.RJ.dateRange}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:a,total:d},isFetching:u,fetchError:m}=(0,o.WJ)((0,n.Ng)({...t,hubSortFieldKeys:{severity:"average_severity",published:"published"}})),p=(0,n.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:d,isLoading:u,selectionState:(0,s.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return r.createElement(c.Provider,{value:{totalItemCount:d,isFetching:u,fetchError:m,tableControls:p}},e)}},86416:(e,t,a)=>{a.d(t,{f:()=>S});var r=a(63696),l=a(49348),i=a(40319),n=a(16646),s=a(9425),o=a(77819),c=a(28516),d=a(3629),u=a(11848),m=a(1349),p=a(62520),f=a(23560),y=a(34066),b=a(36509),v=a(93962),h=a(24417),E=a(68248);const g=({vulnerabilityId:e})=>{const{data:t,isFetching:a,fetchError:l}=(0,E.f)(e);return r.createElement(h.a,{isFetching:a,fetchError:l,isFetchingState:r.createElement(b.E,{screenreaderText:"Loading contents"}),fetchErrorState:r.createElement(v.J,{color:"red"},"Error")},t.summary.sbomStatus.affected)};var C=a(14310);const S=()=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:b}=r.useContext(C.u),{numRenderedColumns:v,currentPageItems:h,propHelpers:{paginationProps:E,tableProps:S,getThProps:k,getTrProps:P,getTdProps:T}}=b;return r.createElement(r.Fragment,null,r.createElement(i.X,{...S,"aria-label":"Vulnerability table"},r.createElement(n.d,null,r.createElement(s.Tr,null,r.createElement(p.Ze,{...b},r.createElement(o.Th,{...k({columnKey:"identifier"})}),r.createElement(o.Th,{...k({columnKey:"title"})}),r.createElement(o.Th,{...k({columnKey:"severity"})}),r.createElement(o.Th,{...k({columnKey:"published"})}),r.createElement(o.Th,{...k({columnKey:"sboms"})})))),r.createElement(p.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:v},h.map(((e,t)=>r.createElement(c.N,{key:e.identifier},r.createElement(s.Tr,{...P({item:e})},r.createElement(p.Oi,{...b,item:e,rowIndex:t},r.createElement(d.Td,{width:15,...T({columnKey:"identifier",item:e,rowIndex:t})},r.createElement(l.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),r.createElement(d.Td,{width:45,modifier:"truncate",...T({columnKey:"title"})},r.createElement(f.j,{vulnerability:e})),r.createElement(d.Td,{width:10,...T({columnKey:"severity"})},e.average_severity&&r.createElement(u.h,{value:e.average_severity})),r.createElement(d.Td,{width:10,...T({columnKey:"published"})},(0,y.Yq)(e.published)),r.createElement(d.Td,{width:10,...T({columnKey:"sboms",item:e,rowIndex:t})},r.createElement(g,{vulnerabilityId:e.identifier}))))))))),r.createElement(m.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:E}))}},69935:(e,t,a)=>{a.d(t,{VH:()=>u,Yu:()=>p,vy:()=>m});var r=a(39155),l=a(3715),i=a(77347),n=a(40752),s=a(81230),o=a(70611),c=a(24808);const d="advisories",u=(e={},t=!1)=>{const{data:a,isLoading:l,error:s,refetch:c}=(0,r.I)({queryKey:[d,e],queryFn:()=>(0,n.YM)({client:i.S,query:{...(0,o.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e??e},isFetching:l,fetchError:s||null,refetch:c}},m=e=>{const{data:t,isLoading:a,error:l}=(0,r.I)({queryKey:[d,e],queryFn:()=>(0,n.ai)({client:i.S,path:{key:e}}),enabled:void 0!==e});return{advisory:t?.data,isFetching:a,fetchError:l}},p=()=>{const e=(0,l.jE)();return(0,c.v)({parallel:!0,uploadFn:(e,t)=>(0,s.hP)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[d]})}})}},17993:(e,t,a)=>{a.d(t,{Lx:()=>o,Si:()=>c,sl:()=>d});var r=a(39155),l=a(77347),i=a(40752),n=a(70611);const s="packages",o=(e={},t=!1)=>{const{data:a,isLoading:o,error:c,refetch:d}=(0,r.I)({queryKey:[s,e],queryFn:()=>(0,i.UD)({client:l.S,query:{...(0,n.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e},isFetching:o,fetchError:c,refetch:d}},c=e=>{const{data:t,isLoading:a,error:n}=(0,r.I)({queryKey:[s,e],queryFn:()=>(0,i.Y0)({client:l.S,path:{key:e}})});return{pkg:t?.data,isFetching:a,fetchError:n}},d=(e,t={})=>{const{data:a,isLoading:o,error:c,refetch:d}=(0,r.I)({queryKey:[s,"by-sbom",e,t],queryFn:()=>(0,i.Ad)({client:l.S,path:{id:e},query:{...(0,n.kd)(t)}})});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:t},isFetching:o,fetchError:c,refetch:d}}},74932:(e,t,a)=>{a.d(t,{WJ:()=>o,uN:()=>c});var r=a(39155),l=a(77347),i=a(40752),n=a(70611);const s="vulnerabilities",o=(e={},t=!1)=>{const{data:a,isLoading:o,error:c,refetch:d}=(0,r.I)({queryKey:[s,e],queryFn:()=>(0,i.NI)({client:l.S,query:{...(0,n.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e},isFetching:o,fetchError:c,refetch:d}},c=e=>{const{data:t,isLoading:a,error:n}=(0,r.I)({queryKey:[s,e],queryFn:()=>(0,i.wk)({client:l.S,path:{id:e}})});return{vulnerability:t?.data,isFetching:a,fetchError:n}}},41775:(e,t,a)=>{a.d(t,{A:()=>r});const r={card:"pf-v5-c-card",cardActions:"pf-v5-c-card__actions",cardBody:"pf-v5-c-card__body",cardExpandableContent:"pf-v5-c-card__expandable-content",cardFooter:"pf-v5-c-card__footer",cardHeader:"pf-v5-c-card__header",cardHeaderMain:"pf-v5-c-card__header-main",cardHeaderToggle:"pf-v5-c-card__header-toggle",cardHeaderToggleIcon:"pf-v5-c-card__header-toggle-icon",cardSelectableActions:"pf-v5-c-card__selectable-actions",cardSrInput:"pf-v5-c-card__sr-input",cardTitle:"pf-v5-c-card__title",cardTitleText:"pf-v5-c-card__title-text",check:"pf-v5-c-check",checkInput:"pf-v5-c-check__input",checkLabel:"pf-v5-c-check__label",dirRtl:"pf-v5-m-dir-rtl",divider:"pf-v5-c-divider",modifiers:{selectable:"pf-m-selectable",clickable:"pf-m-clickable",selected:"pf-m-selected",current:"pf-m-current",disabled:"pf-m-disabled",hoverableRaised:"pf-m-hoverable-raised",selectableRaised:"pf-m-selectable-raised",nonSelectableRaised:"pf-m-non-selectable-raised",selectedRaised:"pf-m-selected-raised",compact:"pf-m-compact",displayLg:"pf-m-display-lg",flat:"pf-m-flat",plain:"pf-m-plain",rounded:"pf-m-rounded",expanded:"pf-m-expanded",fullHeight:"pf-m-full-height",toggleRight:"pf-m-toggle-right",noOffset:"pf-m-no-offset",noFill:"pf-m-no-fill"},radio:"pf-v5-c-radio",radioInput:"pf-v5-c-radio__input",radioLabel:"pf-v5-c-radio__label",themeDark:"pf-v5-theme-dark"}},90829:(e,t,a)=>{a.d(t,{A:()=>r});const r={modifiers:{wrap:"pf-m-wrap",fill:"pf-m-fill",gutter:"pf-m-gutter"},split:"pf-v5-l-split",splitItem:"pf-v5-l-split__item"}},13364:(e,t,a)=>{a.d(t,{A:()=>r});const r={modifiers:{fill:"pf-m-fill",gutter:"pf-m-gutter"},stack:"pf-v5-l-stack",stackItem:"pf-v5-l-stack__item"}}}]);
//# sourceMappingURL=577.4164daae.min.js.map