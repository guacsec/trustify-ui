"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[417],{93962:(e,t,n)=>{n.d(t,{J:()=>F});var l=n(34629),a=n(63696);const r="pf-v5-c-label__content",i="pf-m-compact",c="pf-m-blue",s="pf-m-green",o="pf-m-orange",m="pf-m-red",u="pf-m-purple",d="pf-m-cyan",E="pf-m-gold",p="pf-m-outline",b="pf-m-overflow",f="pf-m-editable-active",g="pf-m-disabled",v="pf-m-editable";var h=n(77635),y=n(26615),P=n(62634),T=n(53025),C=n(99847);const S="--pf-v5-c-label__text--MaxWidth",k={blue:c,cyan:d,green:s,orange:o,purple:u,red:m,gold:E,grey:""},F=e=>{var{children:t,className:n="",color:c="grey",variant:s="filled",isCompact:o=!1,isDisabled:m=!1,isEditable:u=!1,editableProps:d,textMaxWidth:E,tooltipPosition:F,icon:x,onClose:_,onClick:B,onEditCancel:A,onEditComplete:N,closeBtn:I,closeBtnAriaLabel:w,closeBtnProps:K,href:L,isOverflowLabel:M,render:O}=e,q=(0,l.__rest)(e,["children","className","color","variant","isCompact","isDisabled","isEditable","editableProps","textMaxWidth","tooltipPosition","icon","onClose","onClick","onEditCancel","onEditComplete","closeBtn","closeBtnAriaLabel","closeBtnProps","href","isOverflowLabel","render"]);const[j,D]=(0,a.useState)(!1),[$,R]=(0,a.useState)(t),W=a.useRef(),V=a.useRef();a.useEffect((()=>(document.addEventListener("mousedown",X),document.addEventListener("keydown",Z),()=>{document.removeEventListener("mousedown",X),document.removeEventListener("keydown",Z)}))),a.useEffect((()=>{B&&L?console.warn("Link labels cannot have onClick passed, this results in invalid HTML. Please remove either the href or onClick prop."):B&&u&&console.warn("Editable labels cannot have onClick passed, clicking starts the label edit process. Please remove either the isEditable or onClick prop.")}),[B,L,u]);const X=e=>{j&&V&&V.current&&!V.current.contains(e.target)&&(V.current.value&&N&&N(e,V.current.value),D(!1))},Z=e=>{var n,l;const a=e.key;if((j||W&&W.current&&W.current.contains(e.target))&&(!j||V&&V.current&&V.current.contains(e.target))&&(!j||"Enter"!==a&&"Tab"!==a||(e.preventDefault(),e.stopImmediatePropagation(),V.current.value&&N&&N(e,V.current.value),D(!1),null===(n=null==W?void 0:W.current)||void 0===n||n.focus()),j&&"Escape"===a&&(e.preventDefault(),e.stopImmediatePropagation(),V.current.value&&(V.current.value=t,A&&A(e,t)),D(!1),null===(l=null==W?void 0:W.current)||void 0===l||l.focus()),!j&&"Enter"===a)){e.preventDefault(),e.stopImmediatePropagation(),D(!0);const t=e.target,n=document.createRange(),l=window.getSelection();n.selectNodeContents(t),n.collapse(!1),l.removeAllRanges(),l.addRange(n)}},Y=(L||B)&&m,H=a.createElement(h.$n,Object.assign({type:"button",variant:"plain",onClick:_,"aria-label":w||`Close ${t}`},Y&&{isDisabled:!0},K),a.createElement(T.Ay,null)),z=a.createElement("span",{className:(0,P.A)("pf-v5-c-label__actions")},I||H),J=a.createRef(),G=a.useRef(),[Q,U]=a.useState(!1);(0,C.E)((()=>{const e=u?W:J;j||U(e.current&&e.current.offsetWidth<e.current.scrollWidth)}),[j]);const ee=a.createElement(a.Fragment,null,x&&a.createElement("span",{className:(0,P.A)("pf-v5-c-label__icon")},x),a.createElement("span",Object.assign({ref:J,className:(0,P.A)("pf-v5-c-label__text")},E&&{style:{[S]:E}}),t));a.useEffect((()=>{j&&V&&V.current&&V.current.focus()}),[V,j]);let te="span";L?te="a":(u||B&&!M)&&(te="button");const ne={type:"button",onClick:B},le="button"===te,ae=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({className:(0,P.A)(r)},Q&&{tabIndex:0}),L&&{href:L}),L&&m&&{onClick:e=>e.preventDefault()}),le&&ne),u&&Object.assign({ref:W,onClick:e=>{D(!0),e.stopPropagation()}},d)),Y&&le&&{disabled:!0}),Y&&L&&{tabIndex:-1,"aria-disabled":!0});let re=a.createElement(te,Object.assign({},ae),ee);O?re=a.createElement(a.Fragment,null,Q&&a.createElement(y.m,{triggerRef:G,content:t,position:F}),O({className:r,content:ee,componentRef:G})):Q&&(re=a.createElement(y.m,{content:t,position:F},re));const ie=M?"button":"span";return a.createElement(ie,Object.assign({},q,{className:(0,P.A)("pf-v5-c-label",Y&&g,k[c],"outline"===s&&p,M&&b,o&&i,u&&v,j&&f,n),onClick:M?B:void 0},"button"===ie&&{type:"button"}),!j&&re,!j&&_&&z,j&&a.createElement("input",Object.assign({className:(0,P.A)(r),type:"text",id:"editable-input",ref:V,value:$,onChange:()=>{R(V.current.value)}},d)))};F.displayName="Label"},94279:(e,t,n)=>{n.d(t,{B8:()=>m});var l,a,r,i=n(34629),c=n(63696),s=n(38740),o=n(62634);!function(e){e.number="1",e.lowercaseLetter="a",e.uppercaseLetter="A",e.lowercaseRomanNumber="i",e.uppercaseRomanNumber="I"}(l||(l={})),function(e){e.inline="inline"}(a||(a={})),function(e){e.ol="ol",e.ul="ul"}(r||(r={}));const m=e=>{var{className:t="",children:n=null,variant:a=null,isBordered:m=!1,isPlain:u=!1,iconSize:d="default",type:E=l.number,ref:p=null,component:b=r.ul}=e,f=(0,i.__rest)(e,["className","children","variant","isBordered","isPlain","iconSize","type","ref","component"]);return b===r.ol?c.createElement("ol",Object.assign({ref:p,type:E},u&&{role:"list"},f,{className:(0,o.A)(s.A.list,a&&s.A.modifiers[a],m&&s.A.modifiers.bordered,u&&s.A.modifiers.plain,d&&"large"===d&&s.A.modifiers.iconLg,t)}),n):c.createElement("ul",Object.assign({ref:p},u&&{role:"list"},f,{className:(0,o.A)(s.A.list,a&&s.A.modifiers[a],m&&s.A.modifiers.bordered,u&&s.A.modifiers.plain,d&&"large"===d&&s.A.modifiers.iconLg,t)}),n)};m.displayName="List"},16172:(e,t,n)=>{n.d(t,{c:()=>c});var l=n(34629),a=n(63696),r=n(38740),i=n(62634);const c=e=>{var{icon:t=null,children:n=null}=e,c=(0,l.__rest)(e,["icon","children"]);return a.createElement("li",Object.assign({className:(0,i.A)(t&&r.A.listItem)},c),t&&a.createElement("span",{className:(0,i.A)(r.A.listItemIcon)},t),n)};c.displayName="ListItem"},48783:(e,t,n)=>{n.d(t,{Ay:()=>l});const l=(0,n(32791).w)({name:"DownloadIcon",height:512,width:512,svgPath:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",yOffset:0,xOffset:0})},38139:(e,t,n)=>{n.d(t,{g:()=>c});var l=n(34629),a=n(63696),r=n(62634),i=n(89863);const c=e=>{var{children:t=null}=e,n=(0,l.__rest)(e,["children"]);return a.createElement("div",Object.assign({},n,{className:(0,r.A)(i.A.tableExpandableRowContent)}),t)};c.displayName="ExpandableRowContent"},16177:(e,t,n)=>{n.d(t,{a:()=>r});var l=n(63696),a=n(93962);const r=({value:e})=>l.createElement(l.Fragment,null,Object.entries(e).map((([e,t],n)=>l.createElement(a.J,{key:n,isCompact:!0},`${e}=${t}`))))},27473:(e,t,n)=>{n.d(t,{Y:()=>i});var l=n(63696),a=n(18045),r=n(55399);const i=({vulnerabilitiesSummary:e})=>{const t=l.useMemo((()=>Object.keys(e.severities).map((t=>{const n=t,l=e.severities[n],a=r.Kb[n];return{severity:n,count:l,label:a.name,color:a.color.value}})).sort((0,r.Sx)((e=>e.severity)))),[e]);return l.createElement("div",{style:{height:"230px",maxWidth:"350px"}},l.createElement(a.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${e.total}`,subTitle:"Total vulnerabilities",width:350,legendData:t.map((({label:e,count:t})=>({name:`${e}: ${t}`}))),data:t.map((({label:e,count:t})=>({x:e,y:t}))),labels:({datum:e})=>`${e.x}: ${e.y}`,colorScale:t.map((({color:e})=>e))}))}},89101:(e,t,n)=>{n.d(t,{U:()=>s,n:()=>o});var l=n(63696),a=n(91728);const r={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},i={vulnerabilityStatus:{affected:{...r},fixed:{...r},not_affected:{...r},known_not_affected:{...r}}},c=e=>{const t=e.flatMap((e=>(e.status??[]).map((t=>({vulnerability:t,advisory:e,vulnerabilityStatus:t.status,packages:t.packages||[]}))))),n=t.reduce(((e,t)=>{const n=t.vulnerabilityStatus,l=t.vulnerability.average_severity,a=e.vulnerabilityStatus[n];return{...e,vulnerabilityStatus:{...e.vulnerabilityStatus,[n]:{total:a.total+1,severities:{...a.severities,[l]:a.severities[l]+1}}}}}),i);return{vulnerabilities:t,summary:n}},s=e=>{const{advisories:t,isFetching:n,fetchError:r}=(0,a.DH)(e);return{data:l.useMemo((()=>c(t||[])),[t]),isFetching:n,fetchError:r}},o=e=>{const{advisories:t,isFetching:n,fetchError:r}=(0,a.zY)(e);return{data:l.useMemo((()=>(t??[]).map((e=>c(e||[])))),[t]),isFetching:n,fetchError:r}}},14671:(e,t,n)=>{n.r(t),n.d(t,{default:()=>de});var l=n(63696),a=n(68430),r=n(54518),i=n(48281),c=n(28338),s=n(70045),o=n(1180),m=n(72785),u=n(93962),d=n(77635),E=n(16459),p=n(71592),b=n(40111),f=n(70414),g=n(69673),v=n(10015),h=n(48783),y=n(8210),P=n(80876),T=n(24417),C=n(91271),S=n(91728),k=n(70028),F=n(76072),x=n(97299),_=n(17327),B=n(64361),A=n(71603),N=n(65753),I=n(24974),w=n(21639),K=n(3939),L=n(94279),M=n(16172),O=n(34066);const q=({sbom:e})=>l.createElement(F.x,{hasGutter:!0},l.createElement(x.E,{md:4},l.createElement(_.Z,{isFullHeight:!0},l.createElement(B.Z,null,"Metadata"),l.createElement(A.b,null,l.createElement(N.B,null,l.createElement(I.W,null,l.createElement(w.X,null,"Name"),l.createElement(K.d,null,e.name)),l.createElement(I.W,null,l.createElement(w.X,null,"Namespace"),l.createElement(K.d,null,e.document_id)),l.createElement(I.W,null,l.createElement(w.X,null,"Data License"),l.createElement(K.d,null,e.data_licenses.join(", "))))))),l.createElement(x.E,{md:4},l.createElement(_.Z,{isFullHeight:!0},l.createElement(B.Z,null,"Creation"),l.createElement(A.b,null,l.createElement(N.B,null,l.createElement(I.W,null,l.createElement(w.X,null,"Created"),l.createElement(K.d,null,(0,O.Yq)(e.published))),l.createElement(I.W,null,l.createElement(w.X,null,"Creator"),l.createElement(K.d,null,e.authors)))))),l.createElement(x.E,{md:4},l.createElement(_.Z,{isFullHeight:!0},l.createElement(B.Z,null,"Statistics"),l.createElement(A.b,null,l.createElement(N.B,null,l.createElement(I.W,null,l.createElement(w.X,null,"Size"),l.createElement(K.d,null,(0,k.A)(e.size))),l.createElement(I.W,null,l.createElement(w.X,null,"Packages"),l.createElement(K.d,null,e.number_of_packages)))))),l.createElement(x.E,{md:12},l.createElement(_.Z,{isFullHeight:!0},l.createElement(B.Z,null,"Package"),l.createElement(A.b,null,l.createElement(N.B,null,l.createElement(I.W,null,l.createElement(w.X,null,"Name"),l.createElement(K.d,null,e.name)),l.createElement(I.W,null,l.createElement(w.X,null,"Version"),l.createElement(K.d,null,e.described_by.map((e=>e.version)).join(", "))),l.createElement(I.W,null,l.createElement(w.X,null,"External References"),l.createElement(K.d,null,l.createElement(L.B8,null,e.described_by.flatMap((e=>e.cpe)).map(((e,t)=>l.createElement(M.c,{key:t},e))),l.createElement(M.c,null,e.described_by.flatMap((e=>e.purl)).map((e=>e.purl)))))))))));var j=n(49348),D=n(20653),$=n(35048),R=n(4433),W=n(341),V=n(40319),X=n(16646),Z=n(9425),Y=n(77819),H=n(28516),z=n(3629),J=n(38139),G=n(87043),Q=n(16177),U=n(1349),ee=n(62520),te=n(70611),ne=n(17993);const le=({sbomId:e})=>{const{result:{data:t},isFetching:n,fetchError:a}=(0,ne.sl)(e,{page:{pageNumber:1,itemsPerPage:0}}),r=(0,l.useMemo)((()=>t.flatMap((e=>e.purl)).map((e=>({...e,decomposedPurl:(0,O.fe)(e.purl)})))),[t]),i=(0,te.vY)({tableName:"package-table",idProperty:"uuid",items:r,isLoading:n,columnNames:{name:"Name",version:"Version",qualifiers:"Qualifiers"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","version"],getSortValues:e=>({name:`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`,version:e.version.version}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter tex",type:G.RJ.search,placeholderText:"Filter",getItemValue:e=>`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`||""}],isExpansionEnabled:!0,expandableVariant:"single"}),{currentPageItems:o,numRenderedColumns:m,propHelpers:{toolbarProps:d,filterToolbarProps:E,paginationToolbarItemProps:p,paginationProps:b,tableProps:f,getThProps:g,getTrProps:v,getTdProps:h,getExpandedContentTdProps:y},expansionDerivedState:{isCellExpanded:P}}=i;return l.createElement(l.Fragment,null,l.createElement(D.M,{...d},l.createElement($.P,null,l.createElement(G.Us,{showFiltersSideBySide:!0,...E}),l.createElement(R.T,{...p},l.createElement(U.n,{idPrefix:"package-table",isTop:!0,paginationProps:b})))),l.createElement(V.X,{...f,"aria-label":"Package table"},l.createElement(X.d,null,l.createElement(Z.Tr,null,l.createElement(ee.Ze,{...i},l.createElement(Y.Th,{...g({columnKey:"name"})}),l.createElement(Y.Th,{...g({columnKey:"version"})}),l.createElement(Y.Th,{...g({columnKey:"qualifiers"})})))),l.createElement(ee.nJ,{isLoading:n,isError:!!a,isNoData:0===r?.length,numRenderedColumns:m},o?.map(((e,t)=>l.createElement(H.N,{key:e.uuid},l.createElement(Z.Tr,{...v({item:e})},l.createElement(ee.Oi,{...i,item:e,rowIndex:t},l.createElement(z.Td,{width:30,...h({columnKey:"name"})},l.createElement(c.s,null,l.createElement(s.Z,{spacer:{default:"spacerSm"}},`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`),l.createElement(s.Z,null,l.createElement(u.J,{isCompact:!0,color:"blue"},e.decomposedPurl?.type)))),l.createElement(z.Td,{width:20,...h({columnKey:"version"})},e.decomposedPurl?.version),l.createElement(z.Td,{width:50,...h({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&l.createElement(Q.a,{value:e.decomposedPurl?.qualifiers})))),P(e)?l.createElement(Z.Tr,{isExpanded:!0},l.createElement(z.Td,null),l.createElement(z.Td,{...y({item:e}),className:W.A.pyLg},l.createElement(J.g,null,l.createElement(N.B,{columnModifier:{default:"3Col"}},l.createElement(I.W,null,l.createElement(w.X,null,"Packages"),l.createElement(K.d,null,l.createElement(L.B8,null,l.createElement(M.c,null,l.createElement(j.N_,{to:`/packages/${e.uuid}`},e.purl))))),l.createElement(I.W,null,l.createElement(w.X,null,"Base package"),l.createElement(K.d,null,e.base.purl)),l.createElement(I.W,null,l.createElement(w.X,null,"Versions"),l.createElement(K.d,null,l.createElement(L.B8,null,l.createElement(M.c,null,e.version.version)))))))):null))))),l.createElement(U.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:b}))};var ae=n(38914),re=n(57901),ie=n(27473),ce=n(11848),se=n(23560),oe=n(89101),me=n(15311);const ue=({sbomId:e})=>{const{sbom:t,isFetching:n,fetchError:a}=(0,S.rj)(e),{data:{vulnerabilities:r,summary:i},isFetching:c,fetchError:s}=(0,oe.U)(e),o=(0,me.f)(r,(e=>`${e.vulnerability.identifier}-${e.advisory.identifier}-${e.advisory.uuid}`)),m=(0,te.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:o,isLoading:c,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id"],isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:u,numRenderedColumns:d,propHelpers:{toolbarProps:E,filterToolbarProps:p,paginationToolbarItemProps:b,paginationProps:f,tableProps:g,getThProps:v,getTrProps:h,getTdProps:y,getExpandedContentTdProps:P},expansionDerivedState:{isCellExpanded:C}}=m;return l.createElement(l.Fragment,null,l.createElement(ae.B,{hasGutter:!0},l.createElement(re.a,null,l.createElement(_.Z,null,l.createElement(A.b,null,l.createElement(T.a,{isFetching:c||n},l.createElement(F.x,{hasGutter:!0},l.createElement(x.E,{md:6},l.createElement(ie.Y,{vulnerabilitiesSummary:i.vulnerabilityStatus.affected})),l.createElement(x.E,{md:6},l.createElement(N.B,null,l.createElement(I.W,null,l.createElement(w.X,null,"Name"),l.createElement(K.d,null,t?.name)),l.createElement(I.W,null,l.createElement(w.X,null,"Version"),l.createElement(K.d,null,t?.described_by.map((e=>e.version)).join(", "))),l.createElement(I.W,null,l.createElement(w.X,null,"Creation date"),l.createElement(K.d,null,(0,O.Yq)(t?.published)))))))))),l.createElement(re.a,null,l.createElement(D.M,{...E},l.createElement($.P,null,l.createElement(R.T,{...b},l.createElement(U.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:f})))),l.createElement(V.X,{...g,"aria-label":"Vulnerability table"},l.createElement(X.d,null,l.createElement(Z.Tr,null,l.createElement(ee.Ze,{...m},l.createElement(Y.Th,{...v({columnKey:"id"})}),l.createElement(Y.Th,{...v({columnKey:"description"})}),l.createElement(Y.Th,{...v({columnKey:"cvss"})}),l.createElement(Y.Th,{...v({columnKey:"affectedDependencies"})}),l.createElement(Y.Th,{...v({columnKey:"published"})}),l.createElement(Y.Th,{...v({columnKey:"updated"})})))),l.createElement(ee.nJ,{isLoading:c,isError:!!s,isNoData:0===o.length,numRenderedColumns:d},u?.map(((e,t)=>l.createElement(H.N,{key:e._ui_unique_id,isExpanded:C(e)},l.createElement(Z.Tr,{...h({item:e})},l.createElement(ee.Oi,{...m,item:e,rowIndex:t},l.createElement(z.Td,{width:15,...y({columnKey:"id"})},l.createElement(j.N_,{to:`/vulnerabilities/${e.vulnerability.identifier}`},e.vulnerability.identifier)),l.createElement(z.Td,{width:35,modifier:"truncate",...y({columnKey:"description"})},e.vulnerability&&l.createElement(se.j,{vulnerability:e.vulnerability})),l.createElement(z.Td,{width:10,...y({columnKey:"cvss"})},e.vulnerability.average_severity&&l.createElement(ce.h,{value:e.vulnerability.average_severity})),l.createElement(z.Td,{width:15,modifier:"truncate",...y({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:t})},e.packages.length),l.createElement(z.Td,{width:10,modifier:"truncate",...y({columnKey:"published"})},(0,O.Yq)(e.vulnerability?.published)),l.createElement(z.Td,{width:10,modifier:"truncate",...y({columnKey:"updated"})},(0,O.Yq)(e.vulnerability?.modified)))),C(e)?l.createElement(Z.Tr,{isExpanded:!0},l.createElement(z.Td,{...P({item:e})},l.createElement(J.g,null,C(e,"affectedDependencies")?l.createElement(l.Fragment,null,l.createElement(V.X,{variant:"compact"},l.createElement(X.d,null,l.createElement(Z.Tr,null,l.createElement(Y.Th,null,"Type"),l.createElement(Y.Th,null,"Namespace"),l.createElement(Y.Th,null,"Name"),l.createElement(Y.Th,null,"Version"),l.createElement(Y.Th,null,"Path"),l.createElement(Y.Th,null,"Qualifiers"))),l.createElement(H.N,null,e.packages.flatMap((e=>e.purl)).map(((e,t)=>{const n=(0,O.fe)(e.purl);return l.createElement(Z.Tr,{key:t},l.createElement(z.Td,null,n?.type),l.createElement(z.Td,null,n?.namespace),l.createElement(z.Td,null,n?.name),l.createElement(z.Td,null,n?.version),l.createElement(z.Td,null,n?.path),l.createElement(z.Td,null,n?.qualifiers&&l.createElement(Q.a,{value:n?.qualifiers})))}))))):null))):null))))),l.createElement(U.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:f}))))},de=()=>{const[e,t]=l.useState(0),n=l.createRef(),k=l.createRef(),F=l.createRef(),x=l.createRef(),_=(0,P.Lu)(P.vO.SBOM_ID),{sbom:B,isFetching:A,fetchError:N}=(0,S.rj)(_),{downloadSBOM:I}=(0,C.m)();return l.createElement(l.Fragment,null,l.createElement(a.d8,{variant:"light"},l.createElement(r.B,null,l.createElement(i.o,{isFilled:!0},l.createElement(c.s,null,l.createElement(s.Z,{spacer:{default:"spacerSm"}},l.createElement(o.n,null,l.createElement(m.E,{component:"h1"},B?.name??_??""))),l.createElement(s.Z,null,B?.labels.type&&l.createElement(u.J,{color:"blue"},B?.labels.type)))),l.createElement(i.o,null,!A&&l.createElement(d.$n,{variant:"secondary",icon:l.createElement(h.Ay,null),onClick:()=>{_&&I(_,B?.name?`${B?.name}.json`:`${_}.json`)}},"Download")))),l.createElement(a.d8,{type:"nav"},l.createElement(E.t,{mountOnEnter:!0,activeKey:e,onSelect:(e,n)=>{t(n)},"aria-label":"Tabs that contain the SBOM information",role:"region"},l.createElement(p.o,{eventKey:0,title:l.createElement(b.V,null,"Info"),tabContentId:"refTabInfoSection",tabContentRef:n}),l.createElement(p.o,{eventKey:1,title:l.createElement(b.V,null,"Packages"),tabContentId:"refTabPackagesSection",tabContentRef:k}),l.createElement(p.o,{eventKey:2,title:l.createElement(b.V,null,"Vulnerabilities"),tabContentId:"refVulnerabilitiesSection",tabContentRef:F,actions:l.createElement(l.Fragment,null,l.createElement(f.o,{ref:x},l.createElement(y.Ay,null)),l.createElement(g.A,{triggerRef:x,bodyContent:l.createElement("div",null,"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed.")}))}))),l.createElement(a.d8,null,l.createElement(v.J,{eventKey:0,id:"refTabInfoSection",ref:n,"aria-label":"Information of the SBOM"},l.createElement(T.a,{isFetching:A,fetchError:N},B&&l.createElement(q,{sbom:B}))),l.createElement(v.J,{eventKey:1,id:"refTabPackagesSection",ref:k,"aria-label":"Packages within the SBOM",hidden:!0},_&&l.createElement(le,{sbomId:_})),l.createElement(v.J,{eventKey:2,id:"refVulnerabilitiesSection",ref:F,"aria-label":"Vulnerabilities within the SBOM",hidden:!0},_&&l.createElement(ue,{sbomId:_}))))}},17993:(e,t,n)=>{n.d(t,{Lx:()=>s,Si:()=>o,sl:()=>m});var l=n(39155),a=n(77347),r=n(40752),i=n(70611);const c="packages",s=(e={},t=!1)=>{const{data:n,isLoading:s,error:o,refetch:m}=(0,l.I)({queryKey:[c,e],queryFn:()=>(0,r.UD)({client:a.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:e},isFetching:s,fetchError:o,refetch:m}},o=e=>{const{data:t,isLoading:n,error:i}=(0,l.I)({queryKey:[c,e],queryFn:()=>(0,r.Y0)({client:a.S,path:{key:e}})});return{pkg:t?.data,isFetching:n,fetchError:i}},m=(e,t={})=>{const{data:n,isLoading:s,error:o,refetch:m}=(0,l.I)({queryKey:[c,"by-sbom",e,t],queryFn:()=>(0,r.Ad)({client:a.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:t},isFetching:s,fetchError:o,refetch:m}}},91728:(e,t,n)=>{n.d(t,{DH:()=>f,Qr:()=>b,i$:()=>d,rj:()=>E,sn:()=>p,zY:()=>g});var l=n(39155),a=n(3715),r=n(55037),i=n(77347),c=n(40752),s=n(24808),o=n(81230),m=n(70611);const u="sboms",d=(e={},t=!1)=>{const{data:n,isLoading:a,error:r,refetch:s}=(0,l.I)({queryKey:[u,e],queryFn:()=>(0,c.z1)({client:i.S,query:{...(0,m.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:e??e},isFetching:a,fetchError:r,refetch:s}},E=e=>{const{data:t,isLoading:n,error:a}=(0,l.I)({queryKey:[u,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,c.a7)({client:i.S,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:n,fetchError:a}},p=()=>{const e=(0,a.jE)();return(0,s.v)({parallel:!0,uploadFn:(e,t)=>(0,o.J4)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[u]})}})},b=(e,t={})=>{const{data:n,isLoading:a,error:r,refetch:s}=(0,l.I)({queryKey:["SBOMsQueryKeysss","by-package",e,t],queryFn:()=>(0,c.m9)({client:i.S,query:{id:e,...(0,m.kd)(t)}})});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:t??t},isFetching:a,fetchError:r,refetch:s}},f=e=>{const{data:t,isLoading:n,error:a}=(0,l.I)({queryKey:[u,e,"advisory"],queryFn:()=>(0,c.bj)({client:i.S,path:{id:e}})});return{advisories:t?.data||[],isFetching:n,fetchError:a}},g=e=>{const t=(0,r.E)({queries:e.map((e=>({queryKey:[u,e,"advisory"],queryFn:()=>(0,c.bj)({client:i.S,path:{id:e}})})))});return{advisories:t.map((({data:e})=>e?.data||[])),isFetching:t.some((({isLoading:e})=>e)),fetchError:t.map((({error:e})=>e))}}},15311:(e,t,n)=>{n.d(t,{f:()=>r});var l=n(63696),a=n(86820);const r=(e,t)=>(0,l.useMemo)((()=>e&&0!==e.length?e.map((e=>({...e,[a.FA]:t(e)}))):[]),[e,t])},38740:(e,t,n)=>{n.d(t,{A:()=>l});const l={list:"pf-v5-c-list",listItem:"pf-v5-c-list__item",listItemIcon:"pf-v5-c-list__item-icon",modifiers:{iconLg:"pf-m-icon-lg",plain:"pf-m-plain",inline:"pf-m-inline",bordered:"pf-m-bordered"}}},70028:(e,t,n)=>{n.d(t,{A:()=>s});const l=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],a=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],r=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],i=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],c=(e,t,n)=>{let l=e;return"string"==typeof t||Array.isArray(t)?l=e.toLocaleString(t,n):!0!==t&&void 0===n||(l=e.toLocaleString(void 0,n)),l};function s(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);const n=(t={bits:!1,binary:!1,space:!0,...t}).bits?t.binary?i:r:t.binary?a:l,s=t.space?" ":"";if(t.signed&&0===e)return` 0${s}${n[0]}`;const o=e<0,m=o?"-":t.signed?"+":"";let u;if(o&&(e=-e),void 0!==t.minimumFractionDigits&&(u={minimumFractionDigits:t.minimumFractionDigits}),void 0!==t.maximumFractionDigits&&(u={maximumFractionDigits:t.maximumFractionDigits,...u}),e<1)return m+c(e,t.locale,u)+s+n[0];const d=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),n.length-1);return e/=(t.binary?1024:1e3)**d,u||(e=e.toPrecision(3)),m+c(Number(e),t.locale,u)+s+n[d]}}}]);
//# sourceMappingURL=417.a55ed16d.min.js.map