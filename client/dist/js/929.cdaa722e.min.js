"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[929],{91271:(e,t,l)=>{l.d(t,{m:()=>i});var n=l(22249),a=l(77347),r=l(40752);const i=()=>({downloadAdvisory:(e,t)=>{(0,r.Mu)({client:a.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((l=>{(0,n.saveAs)(new Blob([l.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,r.K0)({client:a.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((l=>{(0,n.saveAs)(new Blob([l.data]),t||`${e}.json`)}))}})},4878:(e,t,l)=>{l.d(t,{r:()=>o});var n=l(63696),a=l(77347),r=l(40752),i=l(91728);const c={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},o=e=>{const{advisories:t,isFetching:l,fetchError:o}=(0,i.DH)(e),[s,m]=n.useState([]),[u,d]=n.useState(new Map),[E,p]=n.useState(!1);n.useEffect((()=>{if(0===t.length)return;const e=(t??[]).flatMap((e=>(e.status??[]).map((t=>({vulnerabilityId:t.vulnerability_id,status:t.status,packages:t.packages||[],advisory:{...e}}))))).filter((e=>"affected"===e.status)).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]);m(e),p(!0),Promise.all(e.map((async e=>(await(0,r.wk)({client:a.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),l=new Map;t.forEach((e=>{l.set(e.identifier,e)})),d(l),p(!1)}))}),[t]);const b=n.useMemo((()=>s.map((e=>({...e,vulnerability:u.get(e.vulnerabilityId)})))),[s,u]),h=n.useMemo((()=>b.reduce(((e,t)=>{if(t.vulnerability?.average_severity){const l=t.vulnerability?.average_severity;return{...e,total:e.total+1,severities:{...e.severities,[l]:e.severities[l]+1}}}return e}),c)),[b]);return{isFetching:l||E,fetchError:o,vulnerabilities:b,summary:h}}},14671:(e,t,l)=>{l.r(t),l.d(t,{default:()=>me});var n=l(63696),a=l(68430),r=l(54518),i=l(48281),c=l(28338),o=l(70045),s=l(1180),m=l(72785),u=l(891),d=l(77635),E=l(87294),p=l(71592),b=l(40111),h=l(70414),y=l(23665),f=l(10015),v=l(48783),g=l(8210),T=l(80876),P=l(24417),S=l(91271),x=l(91728),I=l(17327),k=l(71603),C=l(76072),K=l(97299),w=l(65753),F=l(24974),M=l(21639),_=l(3939),$=l(55399),q=l(34066);const B=({sbom:e})=>n.createElement(I.Z,null,n.createElement(k.b,null,n.createElement(C.x,{hasGutter:!0},n.createElement(K.E,{md:6},n.createElement(w.B,{columnModifier:{default:"2Col"}},n.createElement(F.W,null,n.createElement(M.X,null,"Name"),n.createElement(_.d,null,e.name)),n.createElement(F.W,null,n.createElement(M.X,null,"Author"),n.createElement(_.d,null,e.authors)),n.createElement(F.W,null,n.createElement(M.X,null,"Published"),n.createElement(_.d,null,(0,q.Yq)(e.published))))))));var N=l(49348),V=l(20653),A=l(35048),D=l(4433),O=l(94279),R=l(16172),X=l(341),L=l(85578),W=l(16646),j=l(31065),J=l(77819),Z=l(28516),Y=l(3629),H=l(38139),U=l(87043),G=l(16177),Q=l(1349),z=l(62520),ee=l(70611),te=l(17993);const le=({sbomId:e})=>{const{result:{data:t},isFetching:l,fetchError:a}=(0,te.sl)(e,{page:{pageNumber:1,itemsPerPage:0}}),r=(0,n.useMemo)((()=>t.flatMap((e=>e.purl)).map((e=>({...e,decomposedPurl:(0,q.fe)(e.purl)})))),[t]),i=(0,ee.vY)({tableName:"package-table",idProperty:"uuid",items:r,isLoading:l,columnNames:{name:"Name",version:"Version",qualifiers:"Qualifiers"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","version"],getSortValues:e=>({name:`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`,version:e.version.version}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter tex",type:U.RJ.search,placeholderText:"Filter",getItemValue:e=>`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`||""}],isExpansionEnabled:!0,expandableVariant:"single"}),{currentPageItems:s,numRenderedColumns:m,propHelpers:{toolbarProps:d,filterToolbarProps:E,paginationToolbarItemProps:p,paginationProps:b,tableProps:h,getThProps:y,getTrProps:f,getTdProps:v,getExpandedContentTdProps:g},expansionDerivedState:{isCellExpanded:T}}=i;return n.createElement(n.Fragment,null,n.createElement(V.M,{...d},n.createElement(A.P,null,n.createElement(U.Us,{showFiltersSideBySide:!0,...E}),n.createElement(D.T,{...p},n.createElement(Q.n,{idPrefix:"package-table",isTop:!0,paginationProps:b})))),n.createElement(L.X,{...h,"aria-label":"Package table"},n.createElement(W.d,null,n.createElement(j.Tr,null,n.createElement(z.Ze,{...i},n.createElement(J.Th,{...y({columnKey:"name"})}),n.createElement(J.Th,{...y({columnKey:"version"})}),n.createElement(J.Th,{...y({columnKey:"qualifiers"})})))),n.createElement(z.nJ,{isLoading:l,isError:!!a,isNoData:0===r?.length,numRenderedColumns:m},s?.map(((e,t)=>n.createElement(Z.N,{key:e.uuid},n.createElement(j.Tr,{...f({item:e})},n.createElement(z.Oi,{...i,item:e,rowIndex:t},n.createElement(Y.Td,{width:30,...v({columnKey:"name"})},n.createElement(c.s,null,n.createElement(o.Z,{spacer:{default:"spacerSm"}},`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`),n.createElement(o.Z,null,n.createElement(u.J,{isCompact:!0,color:"blue"},e.decomposedPurl?.type)))),n.createElement(Y.Td,{width:20,...v({columnKey:"version"})},e.decomposedPurl?.version),n.createElement(Y.Td,{width:50,...v({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&n.createElement(G.a,{value:e.decomposedPurl?.qualifiers})))),T(e)?n.createElement(j.Tr,{isExpanded:!0},n.createElement(Y.Td,null),n.createElement(Y.Td,{...g({item:e}),className:X.A.pyLg},n.createElement(H.g,null,n.createElement(w.B,{columnModifier:{default:"3Col"}},n.createElement(F.W,null,n.createElement(M.X,null,"Packages"),n.createElement(_.d,null,n.createElement(O.B8,null,n.createElement(R.c,null,n.createElement(N.N_,{to:`/packages/${e.uuid}`},e.purl))))),n.createElement(F.W,null,n.createElement(M.X,null,"Base package"),n.createElement(_.d,null,e.base.purl)),n.createElement(F.W,null,n.createElement(M.X,null,"Versions"),n.createElement(_.d,null,n.createElement(O.B8,null,n.createElement(R.c,null,e.version.version)))))))):null))))),n.createElement(Q.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:b}))};var ne=l(51257),ae=l(38914),re=l(57901),ie=l(52302),ce=l(4878),oe=l(15311);const se=({sbomId:e})=>{const{sbom:t,isFetching:l,fetchError:a}=(0,x.rj)(e),{vulnerabilities:r,summary:i,isFetching:c,fetchError:o}=(0,ce.r)(e),s=(0,oe.f)(r,(e=>`${e.vulnerabilityId}-${e.advisory.identifier}-${e.advisory.uuid}`)),m=(0,ee.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:s,isLoading:c,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id"],isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:u,numRenderedColumns:d,propHelpers:{toolbarProps:E,filterToolbarProps:p,paginationToolbarItemProps:b,paginationProps:h,tableProps:y,getThProps:f,getTrProps:v,getTdProps:g,getExpandedContentTdProps:T},expansionDerivedState:{isCellExpanded:S}}=m,B=n.useMemo((()=>Object.keys(i.severities).map((e=>{const t=e,l=i.severities[t],n=$.Kb[t];return{severity:t,count:l,label:n.name,color:n.color.value}})).sort((0,$.Sx)((e=>e.severity)))),[i]);return n.createElement(n.Fragment,null,n.createElement(ae.B,{hasGutter:!0},n.createElement(re.a,null,n.createElement(I.Z,null,n.createElement(k.b,null,n.createElement(P.a,{isFetching:c||l},n.createElement(C.x,{hasGutter:!0},n.createElement(K.E,{md:6},n.createElement("div",{style:{height:"230px",width:"350px"}},n.createElement(ne.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${i.total}`,subTitle:"Total vulnerabilities",width:350,legendData:B.map((({label:e,count:t})=>({name:`${e}: ${t}`}))),data:B.map((({label:e,count:t})=>({x:e,y:t}))),labels:({datum:e})=>`${e.x}: ${e.y}`,colorScale:B.map((({color:e})=>e))}))),n.createElement(K.E,{md:6},n.createElement(w.B,null,n.createElement(F.W,null,n.createElement(M.X,null,"Name"),n.createElement(_.d,null,t?.name)),n.createElement(F.W,null,n.createElement(M.X,null,"Version"),n.createElement(_.d,null,t?.described_by.map((e=>e.version)).join(", "))),n.createElement(F.W,null,n.createElement(M.X,null,"Creation date"),n.createElement(_.d,null,(0,q.Yq)(t?.published)))))))))),n.createElement(re.a,null,n.createElement(V.M,{...E},n.createElement(A.P,null,n.createElement(D.T,{...b},n.createElement(Q.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:h})))),n.createElement(L.X,{...y,"aria-label":"Vulnerability table"},n.createElement(W.d,null,n.createElement(j.Tr,null,n.createElement(z.Ze,{...m},n.createElement(J.Th,{...f({columnKey:"id"})}),n.createElement(J.Th,{...f({columnKey:"description"})}),n.createElement(J.Th,{...f({columnKey:"cvss"})}),n.createElement(J.Th,{...f({columnKey:"affectedDependencies"})}),n.createElement(J.Th,{...f({columnKey:"published"})}),n.createElement(J.Th,{...f({columnKey:"updated"})})))),n.createElement(z.nJ,{isLoading:c,isError:!!o,isNoData:0===s.length,numRenderedColumns:d},u?.map(((e,t)=>n.createElement(Z.N,{key:e._ui_unique_id,isExpanded:S(e)},n.createElement(j.Tr,{...v({item:e})},n.createElement(z.Oi,{...m,item:e,rowIndex:t},n.createElement(Y.Td,{width:15,...g({columnKey:"id"})},n.createElement(N.N_,{to:`/vulnerabilities/${e.vulnerabilityId}`},e.vulnerabilityId)),n.createElement(Y.Td,{width:35,modifier:"truncate",...g({columnKey:"description"})},e.vulnerability?.title||e.vulnerability?.description),n.createElement(Y.Td,{width:10,...g({columnKey:"cvss"})},e.vulnerability?.average_severity&&n.createElement(ie.h,{value:e.vulnerability.average_severity})),n.createElement(Y.Td,{width:15,modifier:"truncate",...g({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:t})},e.packages.length),n.createElement(Y.Td,{width:10,modifier:"truncate",...g({columnKey:"published"})},(0,q.Yq)(e.vulnerability?.published)),n.createElement(Y.Td,{width:10,modifier:"truncate",...g({columnKey:"updated"})},"CREATE_ISSUE"))),S(e)?n.createElement(j.Tr,{isExpanded:!0},n.createElement(Y.Td,{...T({item:e})},n.createElement(H.g,null,S(e,"affectedDependencies")?n.createElement(n.Fragment,null,n.createElement(L.X,{variant:"compact"},n.createElement(W.d,null,n.createElement(j.Tr,null,n.createElement(J.Th,null,"Type"),n.createElement(J.Th,null,"Namespace"),n.createElement(J.Th,null,"Name"),n.createElement(J.Th,null,"Version"),n.createElement(J.Th,null,"Path"),n.createElement(J.Th,null,"Qualifiers"))),n.createElement(Z.N,null,e.packages.flatMap((e=>e.purl)).map(((e,t)=>{const l=(0,q.fe)(e.purl);return n.createElement(j.Tr,{key:t},n.createElement(Y.Td,null,l?.type),n.createElement(Y.Td,null,l?.namespace),n.createElement(Y.Td,null,l?.name),n.createElement(Y.Td,null,l?.version),n.createElement(Y.Td,null,l?.path),n.createElement(Y.Td,null,l?.qualifiers&&n.createElement(G.a,{value:l?.qualifiers})))}))))):null))):null))))),n.createElement(Q.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:h}))))},me=()=>{const[e,t]=n.useState(0),l=n.createRef(),I=n.createRef(),k=n.createRef(),C=n.createRef(),K=(0,T.Lu)(T.vO.SBOM_ID),{sbom:w,isFetching:F,fetchError:M}=(0,x.rj)(K),{downloadSBOM:_}=(0,S.m)();return n.createElement(n.Fragment,null,n.createElement(a.d8,{variant:"light"},n.createElement(r.B,null,n.createElement(i.o,{isFilled:!0},n.createElement(c.s,null,n.createElement(o.Z,{spacer:{default:"spacerSm"}},n.createElement(s.n,null,n.createElement(m.E,{component:"h1"},w?.name??K??""))),n.createElement(o.Z,null,w?.labels.type&&n.createElement(u.J,{color:"blue"},w?.labels.type)))),n.createElement(i.o,null,!F&&n.createElement(d.$n,{variant:"secondary",icon:n.createElement(v.Ay,null),onClick:()=>{K&&_(K,w?.name?`${w?.name}.json`:`${K}.json`)}},"Download")))),n.createElement(a.d8,{type:"nav"},n.createElement(E.t,{mountOnEnter:!0,activeKey:e,onSelect:(e,l)=>{t(l)},"aria-label":"Tabs that contain the SBOM information",role:"region"},n.createElement(p.o,{eventKey:0,title:n.createElement(b.V,null,"Info"),tabContentId:"refTabInfoSection",tabContentRef:l}),n.createElement(p.o,{eventKey:1,title:n.createElement(b.V,null,"Packages"),tabContentId:"refTabPackagesSection",tabContentRef:I}),n.createElement(p.o,{eventKey:2,title:n.createElement(b.V,null,"Vulnerabilities"),tabContentId:"refVulnerabilitiesSection",tabContentRef:k,actions:n.createElement(n.Fragment,null,n.createElement(h.o,{ref:C},n.createElement(g.Ay,null)),n.createElement(y.A,{triggerRef:C,bodyContent:n.createElement("div",null,"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed.")}))}))),n.createElement(a.d8,null,n.createElement(f.J,{eventKey:0,id:"refTabInfoSection",ref:l,"aria-label":"Information of the SBOM"},n.createElement(P.a,{isFetching:F,fetchError:M},w&&n.createElement(B,{sbom:w}))),n.createElement(f.J,{eventKey:1,id:"refTabPackagesSection",ref:I,"aria-label":"Packages within the SBOM",hidden:!0},K&&n.createElement(le,{sbomId:K})),n.createElement(f.J,{eventKey:2,id:"refVulnerabilitiesSection",ref:k,"aria-label":"Vulnerabilities within the SBOM",hidden:!0},K&&n.createElement(se,{sbomId:K}))))}},17993:(e,t,l)=>{l.d(t,{Lx:()=>o,Si:()=>s,sl:()=>m});var n=l(7616),a=l(77347),r=l(40752),i=l(70611);const c="packages",o=(e={},t=!1)=>{const{data:l,isLoading:o,error:s,refetch:m}=(0,n.I)({queryKey:[c,e],queryFn:()=>(0,r.UD)({client:a.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:e},isFetching:o,fetchError:s,refetch:m}},s=e=>{const{data:t,isLoading:l,error:i}=(0,n.I)({queryKey:[c,e],queryFn:()=>(0,r.Y0)({client:a.S,path:{key:e}})});return{pkg:t?.data,isFetching:l,fetchError:i}},m=(e,t={})=>{const{data:l,isLoading:o,error:s,refetch:m}=(0,n.I)({queryKey:[c,"by-sbom",e,t],queryFn:()=>(0,r.Ad)({client:a.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:t},isFetching:o,fetchError:s,refetch:m}}}}]);
//# sourceMappingURL=929.cdaa722e.min.js.map