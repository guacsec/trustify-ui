"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[495],{80863:(e,t,l)=>{l.d(t,{c:()=>y});var a=l(69935),n=l(34066),r=l(65753),c=l(24974),s=l(21639),i=l(3939),u=l(77635),m=l(92939),o=l(63696),d=l(49348),E=l(67837),p=l(52302),h=l(24417);const y=({advisoryId:e})=>{const{advisory:t,isFetching:l,fetchError:y}=(0,a.vy)(e);return o.createElement(h.a,{isFetching:l,fetchError:y},o.createElement(r.B,null,o.createElement(c.W,null,o.createElement(s.X,null,"Identifier"),o.createElement(i.d,null,o.createElement(u.$n,{variant:"link",isInline:!0,icon:o.createElement(m.Ay,null)},o.createElement(d.k2,{to:`/advisories/${t?.uuid}`},t?.identifier)))),o.createElement(c.W,null,o.createElement(s.X,null,"Severity"),o.createElement(i.d,null,t?.average_severity&&o.createElement(p.h,{value:t?.average_severity}))),o.createElement(c.W,null,o.createElement(s.X,null,"Title"),o.createElement(i.d,null,t?.title)),o.createElement(c.W,null,o.createElement(s.X,null,"Labels"),o.createElement(i.d,null,t?.labels&&o.createElement(E.g,{value:t?.labels}))),o.createElement(c.W,null,o.createElement(s.X,null,"Published"),o.createElement(i.d,null,(0,n.Yq)(t?.published))),o.createElement(c.W,null,o.createElement(s.X,null,"Modified"),o.createElement(i.d,null,(0,n.Yq)(t?.modified))),o.createElement(c.W,null,o.createElement(s.X,null,"Withdrawn"),o.createElement(i.d,null,(0,n.Yq)(t?.withdrawn))),o.createElement(c.W,null,o.createElement(s.X,null,"Issuer"),o.createElement(i.d,null,t?.issuer?.name))))}},67837:(e,t,l)=>{l.d(t,{g:()=>s});var a=l(63696),n=l(23546),r=l(891),c=l(71743);const s=({value:e,defaultIsOpen:t})=>a.createElement(n.o,{isVertical:!0,defaultIsOpen:t,numLabels:2},Object.entries(e).sort((([e],[t])=>t.localeCompare(e))).map((([e,t],l)=>a.createElement(r.J,{key:l,color:"blue"},a.createElement(c.P,{content:`${e}=${t}`})))))},78833:(e,t,l)=>{l.d(t,{Y:()=>h});var a=l(63696),n=l(49348),r=l(34066),c=l(65753),s=l(24974),i=l(21639),u=l(3939),m=l(77635),o=l(92939),d=l(91728),E=l(67837),p=l(24417);const h=({sbomId:e})=>{const{sbom:t,isFetching:l,fetchError:h}=(0,d.rj)(e);return a.createElement(p.a,{isFetching:l,fetchError:h},a.createElement(c.B,null,a.createElement(s.W,null,a.createElement(i.X,null,"Name"),a.createElement(u.d,null,a.createElement(m.$n,{variant:"link",isInline:!0,icon:a.createElement(o.Ay,null)},a.createElement(n.k2,{to:`/sboms/${e}`},t?.name)))),a.createElement(s.W,null,a.createElement(i.X,null,"Published"),a.createElement(u.d,null,(0,r.Yq)(t?.published))),a.createElement(s.W,null,a.createElement(i.X,null,"Labels"),a.createElement(u.d,null,t?.labels&&a.createElement(E.g,{defaultIsOpen:!0,value:t?.labels})))))}},70400:(e,t,l)=>{l.d(t,{n:()=>x,L:()=>q});var a=l(63696),n=l(20653),r=l(35048),c=l(4433),s=l(77635),i=l(891),u=l(1180),m=l(28341),o=l(341),d=l(85578),E=l(16646),p=l(31065),h=l(77819),y=l(28516),v=l(3629),g=l(80863),f=l(33273),P=l(65753),b=l(24974),k=l(21639),T=l(3939),w=l(16177);const I=({decomposedPurl:e})=>a.createElement(P.B,null,a.createElement(b.W,null,a.createElement(k.X,null,"Name"),a.createElement(T.d,null,e.name)),a.createElement(b.W,null,a.createElement(k.X,null,"Namespace"),a.createElement(T.d,null,e.namespace)),a.createElement(b.W,null,a.createElement(k.X,null,"Type"),a.createElement(T.d,null,e.type)),e.version&&a.createElement(b.W,null,a.createElement(k.X,null,"Version"),a.createElement(T.d,null,e.version)),e.path&&a.createElement(b.W,null,a.createElement(k.X,null,"Path"),a.createElement(T.d,null,e.path)),e.qualifiers&&a.createElement(b.W,null,a.createElement(k.X,null,"Qualifiers"),a.createElement(T.d,null,a.createElement(w.a,{value:e.qualifiers}))));var K=l(77307),X=l(1349),F=l(62520),S=l(70611),W=l(15311),C=l(34066);const q=({value:e})=>{if(!e)return null;let t=e;return t.cpe?t.cpe:e.purl},x=({variant:e,initialItemsPerPage:t,advisories:l})=>{const[P,b]=a.useState(null),[k,T]=a.useState(null),w=(e,t)=>{b(e),T(t)},x=a.useMemo((()=>l.flatMap((e=>Object.entries(e.purls??{}).flatMap((([t,l])=>l.map((l=>{const a=l.base_purl;return{basePurl:{...a},advisory:{...e},status:t,context:l.context,versionRange:l.version,decomposedPurl:(0,C.fe)(a.purl)}}))))))),[l]),A=(0,W.f)(x,(e=>`${e.basePurl.purl}-${e.advisory.identifier}-${e.status}`)),_=a.useMemo((()=>{const e=new Set;return x.forEach((t=>e.add(t.status))),e}),[x]),N=(0,S.vY)({variant:e,tableName:"package-table",idProperty:"_ui_unique_id",items:A,isLoading:!1,columnNames:{name:"Name",namespace:"Namespace",affectedVersions:"Affected version",advisory:"Advisory",context:"Context",status:"Status"},hasActionsColumn:!1,isSortEnabled:!1,sortableColumns:["name"],getSortValues:e=>({name:e.decomposedPurl?.name??e.basePurl.purl}),isPaginationEnabled:!0,initialItemsPerPage:t,isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:f.RJ.search,getItemValue:e=>e.decomposedPurl?.name??e.basePurl.purl},{categoryKey:"status",title:"Status",placeholderText:"Status",type:f.RJ.multiselect,selectOptions:Array.from(_).map((e=>({value:e,label:e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")}))),matcher:(e,t)=>t.status===e}],isExpansionEnabled:!1}),{currentPageItems:L,numRenderedColumns:$,propHelpers:{toolbarProps:J,filterToolbarProps:O,paginationToolbarItemProps:V,paginationProps:Y,tableProps:M,getThProps:R,getTrProps:z,getTdProps:j}}=N;return a.createElement(a.Fragment,null,a.createElement(n.M,{...J},a.createElement(r.P,null,a.createElement(f.Us,{showFiltersSideBySide:!0,...O}),a.createElement(c.T,{...V},a.createElement(X.n,{idPrefix:"package-table",isTop:!0,paginationProps:Y})))),a.createElement(d.X,{...M,"aria-label":"Package table"},a.createElement(E.d,null,a.createElement(p.Tr,null,a.createElement(F.Ze,{...N},a.createElement(h.Th,{...R({columnKey:"name"})}),a.createElement(h.Th,{...R({columnKey:"namespace"})}),a.createElement(h.Th,{...R({columnKey:"affectedVersions"})}),a.createElement(h.Th,{...R({columnKey:"advisory"})}),a.createElement(h.Th,{...R({columnKey:"context"})}),a.createElement(h.Th,{...R({columnKey:"status"})})))),a.createElement(F.nJ,{isLoading:!1,isError:void 0,isNoData:0===x.length,numRenderedColumns:$},L?.map(((e,t)=>a.createElement(y.N,{key:e.basePurl.purl},a.createElement(p.Tr,{...z({item:e})},a.createElement(F.Oi,{...N,item:e,rowIndex:t},a.createElement(v.Td,{width:25,modifier:"truncate",...j({columnKey:"name"})},a.createElement(s.$n,{size:"sm",variant:s.Ak.secondary,onClick:()=>w("showPackage",e)},e.decomposedPurl?e.decomposedPurl?.name:e.basePurl.purl)),a.createElement(v.Td,{width:15,modifier:"truncate",...j({columnKey:"namespace"})},e.decomposedPurl?.namespace),a.createElement(v.Td,{width:10,...j({columnKey:"affectedVersions"})},a.createElement(i.J,{color:"grey"},e.versionRange)),a.createElement(v.Td,{width:15,modifier:"truncate",...j({columnKey:"advisory"})},a.createElement(s.$n,{size:"sm",variant:s.Ak.secondary,onClick:()=>w("showAdvisory",e)},e.advisory.identifier)),a.createElement(v.Td,{width:25,modifier:"truncate",...j({columnKey:"context"})},a.createElement(q,{value:e.context})),a.createElement(v.Td,{width:10,modifier:"truncate",...j({columnKey:"status"})},a.createElement(i.J,null,e.status.charAt(0).toUpperCase()+e.status.slice(1).replace("_"," ")))))))))),a.createElement(X.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:Y}),a.createElement(K.q,{isExpanded:null!==P,onCloseClick:()=>b(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:a.createElement(a.Fragment,null,"showPackage"===P&&a.createElement(u.n,null,a.createElement(m.h,{headingLevel:"h2",size:"lg",className:o.A.mtXs},"Package")),"showAdvisory"===P&&a.createElement(u.n,null,a.createElement(m.h,{headingLevel:"h2",size:"lg",className:o.A.mtXs},"Advisory")))},"showPackage"===P&&a.createElement(a.Fragment,null,k?.decomposedPurl&&a.createElement(I,{decomposedPurl:k?.decomposedPurl})),"showAdvisory"===P&&a.createElement(a.Fragment,null,k?.advisory&&a.createElement(g.c,{advisoryId:k?.advisory.uuid}))))}},69935:(e,t,l)=>{l.d(t,{Yu:()=>o,vy:()=>m});var a=l(7616),n=l(3715),r=l(77347),c=l(40752),s=l(81230),i=(l(70611),l(24808));const u="advisories",m=e=>{const{data:t,isLoading:l,error:n}=(0,a.I)({queryKey:[u,e],queryFn:()=>(0,c.ai)({client:r.S,path:{key:e}}),enabled:void 0!==e});return{advisory:t?.data,isFetching:l,fetchError:n}},o=()=>{const e=(0,n.jE)();return(0,i.v)({parallel:!0,uploadFn:(e,t)=>(0,s.hP)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[u]})}})}},74932:(e,t,l)=>{l.d(t,{WJ:()=>u,o5:()=>o,uN:()=>m});var a=l(7616),n=l(26667),r=l(77347),c=l(40752),s=l(70611);const i="vulnerabilities",u=(e={},t=!1)=>{const{data:l,isLoading:n,error:u,refetch:m}=(0,a.I)({queryKey:[i,e],queryFn:()=>(0,c.NI)({client:r.S,query:{...(0,s.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:e},isFetching:n,fetchError:u,refetch:m}},m=e=>{const{data:t,isLoading:l,error:n}=(0,a.I)({queryKey:[i,e],queryFn:()=>(0,c.wk)({client:r.S,path:{id:e}})});return{vulnerability:t?.data,isFetching:l,fetchError:n}},o=(e,t)=>(0,n.n)({mutationFn:async e=>{const t=(0,c.ms)({client:r.S,path:{id:e}});return(await t).data},mutationKey:[i],onSuccess:e,onError:t})}}]);
//# sourceMappingURL=495.9c1b5cf4.min.js.map