"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[32],{81230:(e,a,t)=>{t.d(a,{J4:()=>i,hP:()=>c});var r=t(64917),o=t(86820);t(63260);const s="/api",n=s+"/v1/advisory",l=s+"/v1/sbom",d=e=>{let a="application/json";return(e.name.endsWith(".bz2")||e.name.endsWith(".gz"))&&(a="application/json+bzip2"),a},c=(e,a)=>{const t=e.get(o.fs);return r.A.post(`${n}`,t,{...a,headers:{"Content-Type":d(t)}})},i=(e,a)=>{const t=e.get(o.fs);return r.A.post(`${l}`,t,{...a,headers:{"Content-Type":d(t)}})}},24808:(e,a,t)=>{t.d(a,{v:()=>d});var r=t(63696),o=t(64917),s=t(86820);const n="cancelled",l=(e,a)=>{switch(a.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},status:"queued",cancelFn:a.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},progress:a.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file),status:"complete",response:a.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file),status:"complete",error:a.payload.error,wasCancelled:a.payload.error?.message===n})};case"removeUpload":{const t=new Map(e.uploads);return t.delete(a.payload.file),{...e,uploads:t}}default:throw new Error}},d=({parallel:e,uploadFn:a,onSuccess:t,onError:d})=>{const[c,i]=r.useReducer(l,{uploads:new Map});return{uploads:c.uploads,handleUpload:r=>{const l=[];for(let e=0;e<r.length;e++){const a=r[e],c=new FormData;c.set(s.fs,a);const p=o.A.CancelToken.source(),u={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{const t=e.total??1,r=e.loaded/t*100;i({type:"updateUploadProgress",payload:{file:a,progress:Math.round(r)}})},cancelToken:p.token};i({type:"queueUpload",payload:{file:a,cancelFn:p}});const m={formData:c,config:u,thenFn:e=>{i({type:"finishUploadSuccessfully",payload:{file:a,response:e}}),t&&t(e,a)},catchFn:e=>{i({type:"finishUploadWithError",payload:{file:a,error:e}}),e.message!==n&&d&&d(e,a)}};l.push(m)}e?l.forEach((e=>{a(e.formData,e.config).then(e.thenFn).catch(e.catchFn)})):l.reduce((async(e,t)=>(await e,a(t.formData,t.config).then(t.thenFn).catch(t.catchFn))),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(n)},handleRemoveUpload:e=>{i({type:"removeUpload",payload:{file:e}})}}}},34023:(e,a,t)=>{t.r(a),t.d(a,{default:()=>C});var r=t(63696),o=t(68430),s=t(1180),n=t(72785),l=t(17327),d=t(71603),c=t(16459),i=t(71592),p=t(40111),u=t(10015),m=t(36227),h=t(69935),y=t(91728),f=t(77868),g=t(64335),E=t(93954),v=t(85773),F=t(99205),U=t(18381),q=t(1865),w=t(94279),b=t(16172),S=t(56279),M=t(84608);const k=({uploads:e,handleUpload:a,handleRemoveUpload:t,extractSuccessMessage:o,extractErrorMessage:s})=>{const[n,l]=r.useState(!1),[d,c]=r.useState("inProgress"),[i,p]=r.useState([]);!n&&e.size>0&&l(!0),r.useEffect((()=>{const a=Array.from(e.values());a.some((e=>"inProgress"===e.status))?c("inProgress"):a.every((e=>"complete"===e.status))?c("success"):c("danger")}),[e]);const u=Array.from(e.values()).filter((e=>e.response)).length;return r.createElement(r.Fragment,null,r.createElement(f.w,{onFileDrop:(e,t)=>{a(t)},dropzoneProps:{accept:{"application/xml":[".json",".bz2",".gz"]},onDropRejected:e=>{p(e)},useFsAccessApi:!1}},r.createElement(g.x,{titleIcon:r.createElement(M.Ay,null),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2, .gz"}),n&&r.createElement(E.y,{statusToggleText:`${u} of ${e.size} files uploaded`,statusToggleIcon:d},Array.from(e.entries()).map((([e,a],n)=>r.createElement(v.L,{fileIcon:r.createElement(S.Ay,null),file:e,key:`${e.name}-${n}`,onClearClick:()=>{[e].forEach((e=>{t(e)}))},progressValue:a.progress,progressVariant:a.error?"danger":a.response?"success":void 0,progressHelperText:a.error?r.createElement(F.E,{isLiveRegion:!0},r.createElement(U.j,{variant:"error"},s(a.error))):a.response?r.createElement(F.E,{isLiveRegion:!0},r.createElement(U.j,{variant:"default"},o(a.response))):void 0})))),r.createElement(q.a,{isOpen:i.length>0,title:"Unsupported files",titleIconVariant:"warning",showClose:!0,"aria-label":"unsupported file upload attempted",onClose:()=>p([]),variant:"small"},r.createElement(w.B8,null,i.map(((e,a)=>r.createElement(b.c,{key:a},e.file.name)))))))},C=()=>{const{uploads:e,handleUpload:a,handleRemoveUpload:t}=(0,y.sn)(),{uploads:f,handleUpload:g,handleRemoveUpload:E}=(0,h.Yu)();return r.createElement(r.Fragment,null,r.createElement(o.d8,{variant:o.zC.light},r.createElement(s.n,null,r.createElement(n.E,{component:"h1"},"Upload"))),r.createElement(o.d8,null,r.createElement(l.Z,null,r.createElement(d.b,null,r.createElement(c.t,{defaultActiveKey:0},r.createElement(i.o,{eventKey:0,title:r.createElement(p.V,null,"SBOM")},r.createElement(u.J,{id:"upload-sbom-tab-content"},r.createElement(m.b,{hasPadding:!0},r.createElement(k,{uploads:e,handleUpload:a,handleRemoveUpload:t,extractSuccessMessage:e=>`${e.data.document_id} uploaded`,extractErrorMessage:e=>e.response?.data?e.message:"Error while uploading file"})))),r.createElement(i.o,{eventKey:1,title:r.createElement(p.V,null,"Advisory")},r.createElement(u.J,{id:"upload-advisory-tab-content"},r.createElement(m.b,{hasPadding:!0},r.createElement(k,{uploads:f,handleUpload:g,handleRemoveUpload:E,extractSuccessMessage:e=>`${e.data.document_id} uploaded`,extractErrorMessage:e=>e.response?.data?e.message:"Error while uploading file"})))))))))}},69935:(e,a,t)=>{t.d(a,{VH:()=>p,Yu:()=>m,vy:()=>u});var r=t(7616),o=t(3715),s=t(77347),n=t(40752),l=t(81230),d=t(70611),c=t(24808);const i="advisories",p=(e={},a=!1)=>{const{data:t,isLoading:o,error:l,refetch:c}=(0,r.I)({queryKey:[i,e],queryFn:()=>(0,n.YM)({client:s.S,query:{...(0,d.kd)(e)}}),refetchInterval:!a&&5e3});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:e??e},isFetching:o,fetchError:l||null,refetch:c}},u=e=>{const{data:a,isLoading:t,error:o}=(0,r.I)({queryKey:[i,e],queryFn:()=>(0,n.ai)({client:s.S,path:{key:e}}),enabled:void 0!==e});return{advisory:a?.data,isFetching:t,fetchError:o}},m=()=>{const e=(0,o.jE)();return(0,c.v)({parallel:!0,uploadFn:(e,a)=>(0,l.hP)(e,a),onSuccess:()=>{e.invalidateQueries({queryKey:[i]})}})}},91728:(e,a,t)=>{t.d(a,{DH:()=>y,Qr:()=>h,i$:()=>p,rj:()=>u,sn:()=>m});var r=t(7616),o=t(3715),s=t(77347),n=t(40752),l=t(24808),d=t(81230),c=t(70611);const i="sboms",p=(e={},a=!1)=>{const{data:t,isLoading:o,error:l,refetch:d}=(0,r.I)({queryKey:[i,e],queryFn:()=>(0,n.z1)({client:s.S,query:{...(0,c.kd)(e)}}),refetchInterval:!a&&5e3});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:e??e},isFetching:o,fetchError:l,refetch:d}},u=e=>{const{data:a,isLoading:t,error:o}=(0,r.I)({queryKey:[i,e],queryFn:()=>(0,n.a7)({client:s.S,path:{id:e}}),enabled:void 0!==e});return{sbom:a?.data,isFetching:t,fetchError:o}},m=()=>{const e=(0,o.jE)();return(0,l.v)({parallel:!0,uploadFn:(e,a)=>(0,d.J4)(e,a),onSuccess:()=>{e.invalidateQueries({queryKey:[i]})}})},h=(e,a={})=>{const{data:t,isLoading:o,error:l,refetch:d}=(0,r.I)({queryKey:[i,"by-package",e,a],queryFn:()=>(0,n.m9)({client:s.S,query:{id:e,...(0,c.kd)(a)}})});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:a??a},isFetching:o,fetchError:l,refetch:d}},y=e=>{const{data:a,isLoading:t,error:o}=(0,r.I)({queryKey:[i,e,"advisory"],queryFn:()=>(0,n.bj)({client:s.S,path:{id:e}})});return{advisories:a?.data||[],isFetching:t,fetchError:o}}}}]);
//# sourceMappingURL=32.3683ce5a.min.js.map