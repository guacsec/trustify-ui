"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[53],{24417:(e,t,r)=>{r.d(t,{a:()=>c});var a=r(63696),n=r(59394),l=r(23338),i=r(75855);const c=e=>e.isFetching?a.createElement(n.a,null,a.createElement(l.y,null)):e.fetchError?a.createElement(i.q,null):e.children},33872:(e,t,r)=>{r.r(t),r.d(t,{default:()=>D});var a=r(63696),n=r(49348),l=r(2620),i=r(68430),c=r(98261),s=r(75530),o=r(48783),m=r(80876),u=r(24417),d=r(52302),E=r(69935),h=r(47883);r(70160);const v=({source:e,isFetching:t,fetchError:r,height:n="sizeToFit"})=>{const[l,i]=a.useMemo((()=>e?"object"==typeof e?[JSON.stringify(e,null,2),h.T.json]:"string"==typeof e?[e,h.T.plaintext]:["Not supported format",h.T.plaintext]:[e,void 0]),[e]);return a.createElement(a.Fragment,null,a.createElement(u.a,{isFetching:t,fetchError:r},l&&a.createElement(h.B,{isDarkTheme:!0,isLineNumbersVisible:!0,isReadOnly:!0,isMinimapVisible:!0,isLanguageLabelVisible:!0,code:l??"",language:i,height:n})))},y=({advisoryId:e,height:t="sizeToFit"})=>{const{source:r,isFetching:n,fetchError:l}=(0,E.qF)(e);return a.createElement(a.Fragment,null,a.createElement(v,{source:r,isFetching:n,fetchError:l,height:t}))};var g=r(23713),f=r(38914),p=r(57901),b=r(76072),F=r(97299),k=r(17327),S=r(64361),N=r(71603),q=r(65753),C=r(24974),I=r(21639),K=r(3939),_=r(77635),w=r(40360),A=r(10410),T=r(80254),L=r(88112),O=r(85278),j=r(94279),x=r(16172),B=r(20061);const V=({value:e})=>a.createElement(j.B8,{isPlain:!0},e.map(((e,t)=>a.createElement(x.c,{key:t},a.createElement(B.Ck,{isReadOnly:!0,hoverTip:"Copy",clickTip:"Copied"},e)))));var Z=r(67837),H=r(50705);const J=({advisory:e})=>{const{pushNotification:t}=a.useContext(H.K),[r,n]=a.useState(!1),{mutate:l}=(0,E.uJ)((()=>{}),(e=>{t({title:"Error while updating labels",variant:"danger"})}));return a.createElement(a.Fragment,null,a.createElement(f.B,{hasGutter:!0},a.createElement(p.a,null,a.createElement(b.x,{hasGutter:!0},a.createElement(F.E,{md:4},a.createElement(k.Z,{isFullHeight:!0},a.createElement(S.Z,null,"General view"),a.createElement(N.b,null,a.createElement(T.V,{advisory:e})))),a.createElement(F.E,{md:4},a.createElement(k.Z,{isFullHeight:!0},a.createElement(S.Z,null,"Issuer"),a.createElement(N.b,null,a.createElement(L.N,{value:e})))),a.createElement(F.E,{md:4},a.createElement(k.Z,{isFullHeight:!0},a.createElement(S.Z,null,"System"),a.createElement(N.b,null,a.createElement(q.B,null,a.createElement(C.W,null,a.createElement(I.X,null,"Hashes"),a.createElement(K.d,null,e.hashes&&a.createElement(V,{value:e.hashes}))),a.createElement(C.W,null,a.createElement(I.X,null,"Labels ","",a.createElement(_.$n,{variant:_.Ak.link,size:"sm",icon:a.createElement(A.Ay,null),iconPosition:"end",onClick:()=>n(!0)},"Edit")),a.createElement(K.d,null,a.createElement("div",{className:"pf-v5-c-form"},a.createElement(w.g,null,a.createElement("div",{className:"pf-v5-c-form-control",style:{padding:10}},e.labels&&a.createElement(Z.g,{defaultIsOpen:!0,value:e.labels}))))))))))))),r&&a.createElement(O.x,{resourceName:e.identifier,value:e.labels??{},onSave:t=>{(t=>{l({...e,labels:t})})(t),n(!1)},onClose:()=>n(!1)}))};var z=r(32343);const D=()=>{const e=(0,m.Lu)(m.vO.ADVISORY_ID),{advisory:t,isFetching:r,fetchError:h}=(0,E.vy)(e),{downloadAdvisory:v}=(0,g.m)();return a.createElement(a.Fragment,null,a.createElement(i.d8,{variant:"light"},a.createElement(l.A,{breadcrumbs:a.createElement(c.Q,null,a.createElement(s.J,{key:"advisories"},a.createElement(n.N_,{to:"/advisories"},"Advisories")),a.createElement(s.J,{isActive:!0},"Advisory details")),actionButtons:[{children:a.createElement(a.Fragment,null,a.createElement(o.Ay,null)," Download"),variant:"secondary",onClick:()=>{e&&v(e,`${t?.identifier}.json`)}}],pageHeading:{title:t?.identifier??"",label:t?.average_severity?{children:a.createElement(d.h,{value:t.average_severity}),isCompact:!0}:void 0},tabs:[{eventKey:"overview",title:"Overview",children:a.createElement("div",{className:"pf-v5-u-m-md"},a.createElement(u.a,{isFetching:r,fetchError:h},t&&a.createElement(J,{advisory:t})))},{eventKey:"vulnerabilities",title:"Vulnerabilities",children:a.createElement("div",{className:"pf-v5-u-m-md"},a.createElement(u.a,{isFetching:r,fetchError:h},a.createElement(z.j,{enableToolbar:!0,vulnerabilities:t?.vulnerabilities||[]})))},{eventKey:"source",title:"Source",children:a.createElement("div",{className:"pf-v5-u-m-md"},e&&a.createElement(y,{advisoryId:e,height:"645px"}))}]})))}},70160:(e,t,r)=>{r.d(t,{l6:()=>v,rj:()=>h,i$:()=>E,Qr:()=>f,cF:()=>g,sn:()=>y});var a=r(7616),n=r(26667),l=r(3715),i=r(24808),c=r(40752),s=r(77347);const o=async e=>(await e).data;var m=r(81230),u=r(70611);const d="sboms",E=(e={},t=!1)=>{const{data:r,isLoading:n,error:l,refetch:i}=(0,a.I)({queryKey:[d,e],queryFn:()=>(0,c.z1)({client:s.S,query:{...(0,u.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:r?.data.items||[],total:r?.data.total??0,params:e},isFetching:n,fetchError:l,refetch:i}},h=e=>{const{data:t,isLoading:r,error:n}=(0,a.I)({queryKey:[d,e],queryFn:async()=>o((0,c.a7)({client:s.S,path:{id:e}})),enabled:void 0!==e});return{sbom:t,isFetching:r,fetchError:n}},v=(e,t)=>(0,n.n)({mutationFn:async e=>o((0,c.bS)({client:s.S,path:{id:e}})),mutationKey:[d],onSuccess:t,onError:e}),y=()=>{const e=(0,l.jE)();return(0,i.v)({parallel:!0,uploadFn:(e,t)=>(0,m.J4)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[d]})}})},g=(e,t)=>(0,n.n)({mutationFn:e=>o((0,c.aB)({client:s.S,path:{id:e.id},body:e.labels})),mutationKey:[d],onSuccess:e,onError:t}),f=(e,t={})=>{const{data:r,isLoading:n,error:l,refetch:i}=(0,a.I)({queryKey:[d,"by-package",e,t],queryFn:()=>o((0,c.m9)({client:s.S,query:{id:e,...(0,u.kd)(t)}}))});return{result:{data:r?.items||[],total:r?.total??0,params:t},isFetching:n,fetchError:l,refetch:i}}}}]);
//# sourceMappingURL=53.e230d6c1.min.js.map