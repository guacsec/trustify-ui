"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[32],{36509:(e,t,r)=>{r.d(t,{E:()=>c});var s=r(34629),i=r(63696);const a={circle:"pf-m-circle",square:"pf-m-square",widthSm:"pf-m-width-sm",widthMd:"pf-m-width-md",widthLg:"pf-m-width-lg",width_25:"pf-m-width-25",width_33:"pf-m-width-33",width_50:"pf-m-width-50",width_66:"pf-m-width-66",width_75:"pf-m-width-75",heightSm:"pf-m-height-sm",heightMd:"pf-m-height-md",heightLg:"pf-m-height-lg",height_25:"pf-m-height-25",height_33:"pf-m-height-33",height_50:"pf-m-height-50",height_66:"pf-m-height-66",height_75:"pf-m-height-75",height_100:"pf-m-height-100",text_4xl:"pf-m-text-4xl",text_3xl:"pf-m-text-3xl",text_2xl:"pf-m-text-2xl",textXl:"pf-m-text-xl",textLg:"pf-m-text-lg",textMd:"pf-m-text-md",textSm:"pf-m-text-sm"};var n=r(62634);const l="--pf-v5-c-skeleton--Height",o="--pf-v5-c-skeleton--Width",c=e=>{var{className:t,width:r,height:c,fontSize:u,shape:d,screenreaderText:h}=e,m=(0,s.__rest)(e,["className","width","height","fontSize","shape","screenreaderText"]);const p=u?Object.values(a).find((e=>e===`pf-m-text-${u}`)):void 0;return i.createElement("div",Object.assign({},m,{className:(0,n.A)("pf-v5-c-skeleton",u&&p,"circle"===d&&a.circle,"square"===d&&a.square,t)},(r||c)&&{style:Object.assign({[o]:r||void 0,[l]:c||void 0},m.style)}),i.createElement("span",{className:"pf-v5-screen-reader"},h))};c.displayName="Skeleton"},86361:(e,t,r)=>{r.d(t,{u:()=>s});const s={name:"--pf-v5-global--danger-color--100",value:"#c9190b",var:"var(--pf-v5-global--danger-color--100)"}},19174:(e,t,r)=>{r.d(t,{n:()=>s});const s={name:"--pf-v5-global--info-color--100",value:"#2b9af3",var:"var(--pf-v5-global--info-color--100)"}},44304:(e,t,r)=>{r.d(t,{p:()=>s});const s={name:"--pf-v5-global--palette--black-400",value:"#b8bbbe",var:"var(--pf-v5-global--palette--black-400)"}},53359:(e,t,r)=>{r.d(t,{c:()=>s});const s={name:"--pf-v5-global--palette--purple-400",value:"#8476d1",var:"var(--pf-v5-global--palette--purple-400)"}},53820:(e,t,r)=>{r.d(t,{H:()=>s});const s={name:"--pf-v5-global--warning-color--100",value:"#f0ab00",var:"var(--pf-v5-global--warning-color--100)"}},28644:(e,t,r)=>{r.d(t,{n:()=>u});var s=r(63696),i=r(28338),a=r(70045),n=r(13867),l=r(86099),o=r(55399),c=r(11848);const u=({severities:e})=>{const t=Object.values(e).reduce(((e,t)=>e+t),0);return s.createElement(i.s,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},s.createElement(a.Z,{style:{minWidth:15,textAlign:l.pG}},t),s.createElement(n.c,{orientation:{default:"vertical"}}),s.createElement(a.Z,null,s.createElement(i.s,null,Object.entries(e).filter((([e,t])=>t>0)).sort((0,o.Sx)((([e,t])=>e))).reverse().map((([e,t],r)=>s.createElement(a.Z,{key:r,spacer:{default:"spacerXs"}},s.createElement(i.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},s.createElement(a.Z,null,s.createElement(c.h,{value:e,hideLabel:!0})),s.createElement(a.Z,null,t))))))))}},89101:(e,t,r)=>{r.d(t,{U:()=>c,n:()=>u});var s=r(63696),i=r(91728);const a=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,n={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},l={vulnerabilityStatus:{affected:{...n},fixed:{...n},not_affected:{...n},known_not_affected:{...n}}},o=e=>{const t=e.flatMap((e=>(e.status??[]).map((t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))).reduce(((e,t)=>{const r=e.find((e=>a(e,t)));if(r)return[...e.filter((e=>!a(e,r))),{...r,relatedPackages:[...r.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];{const r={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};return[...e,r]}}),[]))),r=t.reduce(((e,t)=>{const r=t.vulnerabilityStatus,s=t.vulnerability.average_severity,i=e.vulnerabilityStatus[r];return{...e,vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:i.total+1,severities:{...i.severities,[s]:i.severities[s]+1}}}}}),l);return{vulnerabilities:t,summary:r}},c=e=>{const{advisories:t,isFetching:r,fetchError:a}=(0,i.DH)(e);return{data:s.useMemo((()=>o(t||[])),[t]),isFetching:r,fetchError:a}},u=e=>{const{advisories:t,isFetching:r,fetchError:a}=(0,i.zY)(e);return{data:s.useMemo((()=>(t??[]).map((e=>o(e||[])))),[t]),isFetching:r,fetchError:a}}},36390:(e,t,r)=>{r.d(t,{L:()=>c,c:()=>u});var s=r(63696),i=r(87043),a=r(86820),n=r(70611),l=r(5098),o=r(91728);const c=s.createContext({}),u=({children:e})=>{const t=(0,n.MM)({tableName:"sbom",persistenceKeyPrefix:a.rt.sboms,persistTo:"urlParams",columnNames:{name:"Name",version:"Version",supplier:"Supplier",published:"Created on",packages:"Dependencies",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","published"],isFilterEnabled:!0,filterCategories:[{categoryKey:a._G,title:"Filter text",placeholderText:"Search",type:i.RJ.search},{categoryKey:"published",title:"Created on",type:i.RJ.dateRange}],isExpansionEnabled:!1}),{result:{data:r,total:u},isFetching:d,fetchError:h}=(0,o.i$)((0,n.Ng)({...t,hubSortFieldKeys:{name:"name",published:"published"}})),m=(0,n.PB)({...t,idProperty:"id",currentPageItems:r,totalItemCount:u,isLoading:d,selectionState:(0,l.$)({items:r,isEqual:(e,t)=>e.id===t.id})});return s.createElement(c.Provider,{value:{totalItemCount:u,isFetching:d,fetchError:h,tableControls:m}},e)}},48989:(e,t,r)=>{r.d(t,{Y:()=>S});var s=r(63696),i=r(49348),a=r(40319),n=r(16646),l=r(9425),o=r(77819),c=r(28516),u=r(3629),d=r(62101),h=r(1349),m=r(62520),p=r(91271),f=r(34066),b=r(36509),v=r(93962),g=r(24417),y=r(28644),E=r(89101);const w=({sbomId:e})=>{const{data:t,isFetching:r,fetchError:i}=(0,E.U)(e);return s.createElement(g.a,{isFetching:r,fetchError:i,isFetchingState:s.createElement(b.E,{screenreaderText:"Loading contents"}),fetchErrorState:s.createElement(v.J,{color:"red"},"Error")},s.createElement(y.n,{severities:t.summary.vulnerabilityStatus.affected.severities}))};var x=r(36390);const S=({})=>{const{isFetching:e,fetchError:t,totalItemCount:r,tableControls:b}=s.useContext(x.L),{numRenderedColumns:v,currentPageItems:g,propHelpers:{paginationProps:y,tableProps:E,getThProps:S,getTrProps:k,getTdProps:q},expansionDerivedState:{isCellExpanded:C}}=b,{downloadSBOM:R}=(0,p.m)();return s.createElement(s.Fragment,null,s.createElement(a.X,{...E,"aria-label":"sbom-table"},s.createElement(n.d,null,s.createElement(l.Tr,null,s.createElement(m.Ze,{...b},s.createElement(o.Th,{...S({columnKey:"name"})}),s.createElement(o.Th,{...S({columnKey:"version"})}),s.createElement(o.Th,{...S({columnKey:"supplier"})}),s.createElement(o.Th,{...S({columnKey:"published"})}),s.createElement(o.Th,{...S({columnKey:"packages"})}),s.createElement(o.Th,{...S({columnKey:"vulnerabilities"})})))),s.createElement(m.nJ,{isLoading:e,isError:!!t,isNoData:0===r,numRenderedColumns:v},g.map(((e,t)=>s.createElement(c.N,{key:e.id,isExpanded:C(e)},s.createElement(l.Tr,{...k({item:e})},s.createElement(m.Oi,{...b,item:e,rowIndex:t},s.createElement(u.Td,{width:25,...q({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t})},s.createElement(i.k2,{to:`/sboms/${e.id}`},e.name)),s.createElement(u.Td,{width:15,modifier:"truncate",...q({columnKey:"version"})},e.described_by.map((e=>e.version)).filter((e=>e)).join(", ")),s.createElement(u.Td,{width:20,modifier:"truncate",...q({columnKey:"supplier"})},e.authors.join(", ")),s.createElement(u.Td,{width:10,...q({columnKey:"published"})},(0,f.Yq)(e.published)),s.createElement(u.Td,{width:10,...q({columnKey:"packages"})},e.number_of_packages),s.createElement(u.Td,{width:20,...q({columnKey:"vulnerabilities"})},s.createElement(w,{sbomId:e.id})),s.createElement(u.Td,{isActionCell:!0},s.createElement(d.G,{items:[{title:"Download",onClick:()=>{R(e.id,`${e.name}.json`)}}]}))))))))),s.createElement(h.n,{idPrefix:"sbom-table",isTop:!1,isCompact:!0,paginationProps:y}))}},91728:(e,t,r)=>{r.d(t,{DH:()=>b,Qr:()=>f,i$:()=>h,rj:()=>m,sn:()=>p,zY:()=>v});var s=r(39155),i=r(3715),a=r(55037),n=r(77347),l=r(40752),o=r(24808),c=r(81230),u=r(70611);const d="sboms",h=(e={},t=!1)=>{const{data:r,isLoading:i,error:a,refetch:o}=(0,s.I)({queryKey:[d,e],queryFn:()=>(0,l.z1E)({client:n.S,query:{...(0,u.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e??e},isFetching:i,fetchError:a,refetch:o}},m=e=>{const{data:t,isLoading:r,error:i}=(0,s.I)({queryKey:[d,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,l.a7Q)({client:n.S,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:r,fetchError:i}},p=()=>{const e=(0,i.jE)();return(0,o.v)({parallel:!0,uploadFn:(e,t)=>(0,c.J4)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[d]})}})},f=(e,t={})=>{const{data:r,isLoading:i,error:a,refetch:o}=(0,s.I)({queryKey:["SBOMsQueryKeysss","by-package",e,t],queryFn:()=>(0,l.m9i)({client:n.S,query:{id:e,...(0,u.kd)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t??t},isFetching:i,fetchError:a,refetch:o}},b=e=>{const{data:t,isLoading:r,error:i}=(0,s.I)({queryKey:[d,e,"advisory"],queryFn:()=>(0,l.bjx)({client:n.S,path:{id:e}})});return{advisories:t?.data||[],isFetching:r,fetchError:i}},v=e=>{const t=(0,a.E)({queries:e.map((e=>({queryKey:[d,e,"advisory"],queryFn:()=>(0,l.bjx)({client:n.S,path:{id:e}})})))});return{advisories:t.map((({data:e})=>e?.data||[])),isFetching:t.some((({isLoading:e})=>e)),fetchError:t.map((({error:e})=>e))}}},55037:(e,t,r)=>{r.d(t,{E:()=>b});var s=r(63696),i=r(13403),a=r(50653),n=r(47794),l=r(19106);function o(e,t){return e.filter((e=>!t.includes(e)))}var c=class extends n.Q{#e;#t;#r;#s;#i;#a;#n;#l;constructor(e,t,r){super(),this.#e=e,this.#s=r,this.#r=[],this.#i=[],this.#t=[],this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.#i.forEach((e=>{e.subscribe((t=>{this.#o(e,t)}))}))}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#i.forEach((e=>{e.destroy()}))}setQueries(e,t,r){this.#r=e,this.#s=t,i.j.batch((()=>{const e=this.#i,t=this.#c(this.#r);t.forEach((e=>e.observer.setOptions(e.defaultedQueryOptions,r)));const s=t.map((e=>e.observer)),i=s.map((e=>e.getCurrentResult())),a=s.some(((t,r)=>t!==e[r]));(e.length!==s.length||a)&&(this.#i=s,this.#t=i,this.hasListeners()&&(o(e,s).forEach((e=>{e.destroy()})),o(s,e).forEach((e=>{e.subscribe((t=>{this.#o(e,t)}))})),this.#u()))}))}getCurrentResult(){return this.#t}getQueries(){return this.#i.map((e=>e.getCurrentQuery()))}getObservers(){return this.#i}getOptimisticResult(e,t){const r=this.#c(e).map((e=>e.observer.getOptimisticResult(e.defaultedQueryOptions)));return[r,e=>this.#d(e??r,t),()=>this.#h(r,e)]}#h(e,t){const r=this.#c(t);return r.map(((t,s)=>{const i=e[s];return t.defaultedQueryOptions.notifyOnChangeProps?i:t.observer.trackResult(i,(e=>{r.forEach((t=>{t.observer.trackProp(e)}))}))}))}#d(e,t){return t?(this.#a&&this.#t===this.#l&&t===this.#n||(this.#n=t,this.#l=this.#t,this.#a=(0,l.BH)(this.#a,t(e))),this.#a):e}#c(e){const t=new Map(this.#i.map((e=>[e.options.queryHash,e]))),r=[];return e.forEach((e=>{const s=this.#e.defaultQueryOptions(e),i=t.get(s.queryHash);if(i)r.push({defaultedQueryOptions:s,observer:i});else{const e=this.#i.find((e=>e.options.queryHash===s.queryHash));r.push({defaultedQueryOptions:s,observer:e??new a.$(this.#e,s)})}})),r.sort(((t,r)=>e.findIndex((e=>e.queryHash===t.defaultedQueryOptions.queryHash))-e.findIndex((e=>e.queryHash===r.defaultedQueryOptions.queryHash))))}#o(e,t){const r=this.#i.indexOf(e);-1!==r&&(this.#t=function(e,t,r){const s=e.slice(0);return s[t]=r,s}(this.#t,r,t),this.#u())}#u(){this.hasListeners()&&this.#a!==this.#d(this.#h(this.#t,this.#r),this.#s?.combine)&&i.j.batch((()=>{this.listeners.forEach((e=>{e(this.#t)}))}))}},u=r(3715),d=r(57860),h=r(57202),m=r(23500),p=r(26737),f=r(908);function b({queries:e,...t},r){const n=(0,u.jE)(r),l=(0,d.w)(),o=(0,h.h)(),b=s.useMemo((()=>e.map((e=>{const t=n.defaultQueryOptions(e);return t._optimisticResults=l?"isRestoring":"optimistic",t}))),[e,n,l]);b.forEach((e=>{(0,p.jv)(e),(0,m.LJ)(e,o)})),(0,m.wZ)(o);const[v]=s.useState((()=>new c(n,b,t))),[g,y,E]=v.getOptimisticResult(b,t.combine);s.useSyncExternalStore(s.useCallback((e=>l?f.l:v.subscribe(i.j.batchCalls(e))),[v,l]),(()=>v.getCurrentResult()),(()=>v.getCurrentResult())),s.useEffect((()=>{v.setQueries(b,t,{listeners:!1})}),[b,t,v]);const w=g.some(((e,t)=>(0,p.EU)(b[t],e)))?g.flatMap(((e,t)=>{const r=b[t];if(r){const t=new a.$(n,r);if((0,p.EU)(r,e))return(0,p.iL)(r,t,o);(0,p.nE)(e,l)&&(0,p.iL)(r,t,o)}return[]})):[];if(w.length>0)throw Promise.all(w);const x=g.find(((e,t)=>{const r=b[t];return r&&(0,m.$1)({result:e,errorResetBoundary:o,throwOnError:r.throwOnError,query:n.getQueryCache().get(r.queryHash)})}));if(x?.error)throw x.error;return y(E())}}}]);
//# sourceMappingURL=32.3554d89c.min.js.map