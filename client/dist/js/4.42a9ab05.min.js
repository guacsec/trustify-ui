"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[4],{38139:(e,t,l)=>{l.d(t,{g:()=>c});var n=l(34629),r=l(63696),a=l(62634),i=l(36373);const c=e=>{var{children:t=null}=e,l=(0,n.__rest)(e,["children"]);return r.createElement("div",Object.assign({},l,{className:(0,a.A)(i.A.tableExpandableRowContent)}),t)};c.displayName="ExpandableRowContent"},14472:(e,t,l)=>{l.r(t),l.d(t,{default:()=>g});var n=l(63696),r=l(68430),a=l(1180),i=l(72785),c=l(14310),o=l(1159),m=l(20653),s=l(35048),u=l(4433),d=l(33273),E=l(1349);const p=({})=>{const{tableControls:e}=n.useContext(c.u),{propHelpers:{toolbarProps:t,filterToolbarProps:l,paginationToolbarItemProps:r,paginationProps:a}}=e;return n.createElement(m.M,{...t},n.createElement(s.P,null,n.createElement(d.Us,{...l}),n.createElement(u.T,{...r},n.createElement(E.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:a}))))},g=()=>n.createElement(n.Fragment,null,n.createElement(r.d8,{variant:r.zC.light},n.createElement(a.n,null,n.createElement(i.E,{component:"h1"},"Vulnerabilities"))),n.createElement(r.d8,null,n.createElement("div",{style:{backgroundColor:"var(--pf-v5-global--BackgroundColor--100)"}},n.createElement(c.y,null,n.createElement(p,null),n.createElement(o.fk,null)))))},14310:(e,t,l)=>{l.d(t,{u:()=>m,y:()=>s});var n=l(63696),r=l(33273),a=l(86820),i=l(70611),c=l(5098),o=l(74932);const m=n.createContext({}),s=({children:e})=>{const t=(0,i.MM)({tableName:"vulnerability",persistenceKeyPrefix:a.rt.vulnerabilities,columnNames:{identifier:"Name",title:"Description",severity:"CVSS",published:"Published",packages:"Packages",sboms:"SBOMs"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"average_severity",title:"CVSS",placeholderText:"CVSS",type:r.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:l,total:s},isFetching:u,fetchError:d}=(0,o.WJ)((0,i.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score"}})),E=(0,i.PB)({...t,idProperty:"identifier",currentPageItems:l,totalItemCount:s,isLoading:u,selectionState:(0,c.$)({items:l,isEqual:(e,t)=>e.identifier===t.identifier})});return n.createElement(m.Provider,{value:{totalItemCount:s,isFetching:u,fetchError:d,tableControls:E}},e)}},1159:(e,t,l)=>{l.d(t,{fk:()=>_});var n=l(63696),r=l(49348),a=l(76072),i=l(97299),c=l(17327),o=l(64361),m=l(71603),s=l(65753),u=l(24974),d=l(21639),E=l(3939),p=l(85578),g=l(16646),b=l(31065),h=l(77819),v=l(28516),y=l(3629),f=l(62101),C=l(38139),T=l(24417),P=l(50705),x=l(52302),w=l(1349),k=l(62520),F=l(74932),K=l(34066),I=l(70400),N=l(48703),S=l(14310);const _=()=>{const{pushNotification:e}=n.useContext(P.K),{isFetching:t,fetchError:l,totalItemCount:T,tableControls:I}=n.useContext(S.u),N=(0,F.o5)((t=>{e({title:`The Vulnerability ${t.identifier} was deleted`,variant:"danger"})}),(t=>{e({title:"Error occurred while deleting the vulnerability",variant:"danger"})})),{numRenderedColumns:_,currentPageItems:R,propHelpers:{paginationProps:V,tableProps:X,getThProps:q,getTrProps:B,getTdProps:Y,getExpandedContentTdProps:H},expansionDerivedState:{isCellExpanded:O}}=I;return n.createElement(n.Fragment,null,n.createElement(p.X,{...X,"aria-label":"Vulnerability table"},n.createElement(g.d,null,n.createElement(b.Tr,null,n.createElement(k.Ze,{...I},n.createElement(h.Th,{...q({columnKey:"identifier"})}),n.createElement(h.Th,{...q({columnKey:"title"})}),n.createElement(h.Th,{...q({columnKey:"severity"})}),n.createElement(h.Th,{...q({columnKey:"published"})}),n.createElement(h.Th,{...q({columnKey:"packages"})}),n.createElement(h.Th,{...q({columnKey:"sboms"})})))),n.createElement(k.nJ,{isLoading:t,isError:!!l,isNoData:0===T,numRenderedColumns:_},R.map(((e,t)=>n.createElement(v.N,{key:e.identifier,isExpanded:O(e)},n.createElement(b.Tr,{...B({item:e})},n.createElement(k.Oi,{...I,item:e,rowIndex:t},n.createElement(y.Td,{width:15,...Y({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},n.createElement(r.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),n.createElement(y.Td,{width:45,modifier:"truncate",...Y({columnKey:"title"})},e.title||e.description),n.createElement(y.Td,{width:10,...Y({columnKey:"severity"})},e.average_severity&&n.createElement(x.h,{value:e.average_severity})),n.createElement(y.Td,{width:10,...Y({columnKey:"published"})},(0,K.Yq)(e.published)),n.createElement(y.Td,{width:10,modifier:"truncate",...Y({columnKey:"packages",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"Packages"),n.createElement(y.Td,{width:10,modifier:"truncate",...Y({columnKey:"sboms",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"SBOMs"),n.createElement(y.Td,{isActionCell:!0},n.createElement(f.G,{items:[{title:"Delete",onClick:()=>N.mutate(e.identifier)}]})))),O(e)?n.createElement(b.Tr,{isExpanded:!0},n.createElement(y.Td,{...H({item:e})},n.createElement(C.g,null,n.createElement("div",{className:"pf-v5-u-m-md"},O(e,"identifier")?n.createElement(n.Fragment,null,n.createElement(a.x,{hasGutter:!0},n.createElement(i.E,{md:8},n.createElement(c.Z,{isFullHeight:!0,isCompact:!0},n.createElement(o.Z,null,"General view"),n.createElement(m.b,null,n.createElement(s.B,{columnModifier:{default:"2Col"}},n.createElement(u.W,null,n.createElement(d.X,null,"Published"),n.createElement(E.d,null,(0,K.Yq)(e.published))),n.createElement(u.W,null,n.createElement(d.X,null,"Modified"),n.createElement(E.d,null,(0,K.Yq)(e.modified))),n.createElement(u.W,null,n.createElement(d.X,null,"Released"),n.createElement(E.d,null,(0,K.Yq)(e.released))),n.createElement(u.W,null,n.createElement(d.X,null,"Withdrawn"),n.createElement(E.d,null,(0,K.Yq)(e.withdrawn))))))),n.createElement(i.E,{md:4},n.createElement(c.Z,{isFullHeight:!0,isCompact:!0},n.createElement(o.Z,null,"Additional info"),n.createElement(m.b,null,n.createElement(s.B,null,n.createElement(u.W,null,n.createElement(d.X,null,"CWE"),n.createElement(E.d,null,"item.cwe")),n.createElement(u.W,null,n.createElement(d.X,null,"Non normative"),n.createElement(E.d,null,e.normative?"Yes":"No")))))))):null,O(e,"packages")?n.createElement(n.Fragment,null,n.createElement(W,{vulnerabilityId:e.identifier})):null,O(e,"sboms")?n.createElement(n.Fragment,null,n.createElement(M,{vulnerabilityId:e.identifier})):null)))):null))))),n.createElement(w.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:V}))},W=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:r}=(0,F.uN)(e);return n.createElement(T.a,{isFetching:l,fetchError:r},n.createElement(I.n,{variant:"compact",initialItemsPerPage:5,advisories:t?.advisories??[]}))},M=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:r}=(0,F.uN)(e);return n.createElement(T.a,{isFetching:l,fetchError:r},n.createElement(N.m,{variant:"compact",advisories:t?.advisories??[]}))}}}]);
//# sourceMappingURL=4.42a9ab05.min.js.map