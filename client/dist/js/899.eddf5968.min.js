"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[899],{55399:(e,a,t)=>{t.d(a,{Kb:()=>i,Sx:()=>d,YT:()=>c});var r=t(44304),n=t(19174),l=t(53820),o=t(8742),s=t(53359);const i={none:{name:"None",color:r.p,progressProps:{variant:void 0}},low:{name:"Low",color:n.n,progressProps:{variant:void 0}},medium:{name:"Medium",color:l.H,progressProps:{variant:"warning"}},high:{name:"High",color:o.u,progressProps:{variant:"danger"}},critical:{name:"Critical",color:s.c,progressProps:{variant:"danger"}}},c=e=>{switch(e){case"low":return 1;case"medium":return 2;case"high":return 3;case"critical":return 4;default:return 0}};function d(e){return(a,t)=>c(e(a))-c(e(t))}},81230:(e,a,t)=>{t.d(a,{J4:()=>d,hP:()=>c});var r=t(64917),n=t(86820);t(63260);const l="/api",o=l+"/v1/advisory",s=l+"/v1/sbom",i=e=>{let a="application/json";return(e.name.endsWith(".bz2")||e.name.endsWith(".gz"))&&(a="application/json+bzip2"),a},c=(e,a)=>{const t=e.get(n.fs);return r.A.post(`${o}`,t,{...a,headers:{"Content-Type":i(t)}})},d=(e,a)=>{const t=e.get(n.fs);return r.A.post(`${s}`,t,{...a,headers:{"Content-Type":i(t)}})}},24417:(e,a,t)=>{t.d(a,{a:()=>s});var r=t(63696),n=t(59394),l=t(99135),o=t(75855);const s=e=>e.isFetching?e.isFetchingState||r.createElement(n.a,null,r.createElement(l.y,null)):e.fetchError?e.fetchErrorState||r.createElement(o.q,null):e.children},52302:(e,a,t)=>{t.d(a,{h:()=>c});var r=t(63696),n=t(28338),l=t(70045),o=t(26615),s=t(93914),i=t(55399);const c=({value:e,hideLabel:a})=>{const t=i.Kb[e],c=e.charAt(0).toUpperCase()+e.slice(1);return r.createElement(n.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},r.createElement(l.Z,null,a?r.createElement(o.m,{content:c},r.createElement(s.Ay,{color:t.color.value})):r.createElement(s.Ay,{color:t.color.value})),!a&&r.createElement(l.Z,null,c))}},1349:(e,a,t)=>{t.d(a,{n:()=>l});var r=t(63696),n=t(84348);const l=({paginationProps:e,isTop:a,isCompact:t=!1,noMargin:l=!1,idPrefix:o=""})=>r.createElement(n.d,{id:`${o?`${o}-`:""}pagination-${a?"top":"bottom"}`,variant:a?n.A.top:n.A.bottom,isCompact:t,...e,widgetId:"pagination-id"})},75855:(e,a,t)=>{t.d(a,{q:()=>d});var r=t(63696),n=t(63863),l=t(97157),o=t(2408),s=t(92411),i=t(60087),c=t(45960);const d=()=>r.createElement(n.p,{variant:n.s.sm},r.createElement(l.q,{icon:i.Ay,color:c.D.value}),r.createElement(o.h,{headingLevel:"h2",size:"lg"},"Unable to connect"),r.createElement(s.h,null,"There was an error retrieving data. Check your connection and try again."))},62520:(e,a,t)=>{t.d(a,{nJ:()=>g,Ze:()=>E,Oi:()=>b});var r=t(63696),n=t(59394),l=t(99135),o=t(28516),s=t(9425),i=t(3629),c=t(75855),d=t(63863),u=t(97157),p=t(2408),m=t(92411),h=t(28469);const y=({title:e,description:a})=>r.createElement(d.p,{variant:d.s.sm},r.createElement(u.q,{icon:h.Ay}),r.createElement(p.h,{headingLevel:"h2",size:"lg"},e),a&&r.createElement(m.h,null,a)),f=()=>r.createElement(y,{title:"No data available",description:"No data available to be shown here."}),g=({numRenderedColumns:e,isLoading:a=!1,isError:t=!1,isNoData:d=!1,errorEmptyState:u=null,noDataEmptyState:p=null,children:m})=>r.createElement(r.Fragment,null,a?r.createElement(o.N,null,r.createElement(s.Tr,null,r.createElement(i.Td,{colSpan:e},r.createElement(n.a,null,r.createElement(l.y,{size:"xl"}))))):t?r.createElement(o.N,{"aria-label":"Table error"},r.createElement(s.Tr,null,r.createElement(i.Td,{colSpan:e},r.createElement(n.a,null,u||r.createElement(c.q,null))))):d?r.createElement(o.N,{"aria-label":"Table error"},r.createElement(s.Tr,null,r.createElement(i.Td,{colSpan:e},r.createElement(n.a,null,p||r.createElement(f,null))))):m);var v=t(77819);const E=({numColumnsBeforeData:e,numColumnsAfterData:a,children:t})=>r.createElement(r.Fragment,null,Array(e).fill(null).map(((e,a)=>r.createElement(v.Th,{screenReaderText:`before-data-${a}`,key:a}))),t,Array(a).fill(null).map(((e,a)=>r.createElement(v.Th,{screenReaderText:`after-data-${a}`,key:a})))),b=({isExpansionEnabled:e=!1,expandableVariant:a,isSelectionEnabled:t=!1,propHelpers:{getSingleExpandButtonTdProps:n,getSelectCheckboxTdProps:l},item:o,rowIndex:s,children:c})=>r.createElement(r.Fragment,null,e&&"single"===a?r.createElement(i.Td,{...n({item:o,rowIndex:s})}):null,t?r.createElement(i.Td,{...l({item:o,rowIndex:s})}):null,c)},91271:(e,a,t)=>{t.d(a,{m:()=>o});var r=t(22249),n=t(77347),l=t(40752);const o=()=>({downloadAdvisory:(e,a)=>{(0,l.Mu)({client:n.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((t=>{(0,r.saveAs)(new Blob([t.data]),a||`${e}.json`)}))},downloadSBOM:(e,a)=>{(0,l.K0)({client:n.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((t=>{(0,r.saveAs)(new Blob([t.data]),a||`${e}.json`)}))}})},89101:(e,a,t)=>{t.d(a,{U:()=>i});var r=t(63696),n=t(77347),l=t(40752),o=t(91728);const s={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},i=e=>{const{advisories:a,isFetching:t,fetchError:i}=(0,o.DH)(e),[c,d]=r.useState([]),[u,p]=r.useState(new Map),[m,h]=r.useState(!1);r.useEffect((()=>{if(0===a.length)return;const e=(a??[]).flatMap((e=>(e.status??[]).map((a=>({vulnerabilityId:a.vulnerability_id,status:a.status,packages:a.packages||[],advisory:{...e}}))))).filter((e=>"affected"===e.status)).reduce(((e,a)=>e.find((e=>e.vulnerabilityId===a.vulnerabilityId&&e.advisory.uuid===a.advisory.uuid))?e:[...e,a]),[]);d(e),h(!0),Promise.all(e.map((async e=>(await(0,l.wk)({client:n.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const a=e.reduce(((e,a)=>a?[...e,a]:e),[]),t=new Map;a.forEach((e=>{t.set(e.identifier,e)})),p(t),h(!1)}))}),[a]);const y=r.useMemo((()=>c.map((e=>({...e,vulnerability:u.get(e.vulnerabilityId)})))),[c,u]),f=r.useMemo((()=>y.reduce(((e,a)=>{if(a.vulnerability?.average_severity){const t=a.vulnerability?.average_severity;return{...e,total:e.total+1,severities:{...e.severities,[t]:e.severities[t]+1}}}return e}),s)),[y]);return{isFetching:t||m,fetchError:i,vulnerabilities:y,summary:f}}},24808:(e,a,t)=>{t.d(a,{v:()=>i});var r=t(63696),n=t(64917),l=t(86820);const o="cancelled",s=(e,a)=>{switch(a.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},status:"queued",cancelFn:a.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},progress:a.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file),status:"complete",response:a.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file),status:"complete",error:a.payload.error,wasCancelled:a.payload.error?.message===o})};case"removeUpload":{const t=new Map(e.uploads);return t.delete(a.payload.file),{...e,uploads:t}}default:throw new Error}},i=({parallel:e,uploadFn:a,onSuccess:t,onError:i})=>{const[c,d]=r.useReducer(s,{uploads:new Map});return{uploads:c.uploads,handleUpload:r=>{const s=[];for(let e=0;e<r.length;e++){const a=r[e],c=new FormData;c.set(l.fs,a);const u=n.A.CancelToken.source(),p={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{const t=e.total??1,r=e.loaded/t*100;d({type:"updateUploadProgress",payload:{file:a,progress:Math.round(r)}})},cancelToken:u.token};d({type:"queueUpload",payload:{file:a,cancelFn:u}});const m={formData:c,config:p,thenFn:e=>{d({type:"finishUploadSuccessfully",payload:{file:a,response:e}}),t&&t(e,a)},catchFn:e=>{d({type:"finishUploadWithError",payload:{file:a,error:e}}),e.message!==o&&i&&i(e,a)}};s.push(m)}e?s.forEach((e=>{a(e.formData,e.config).then(e.thenFn).catch(e.catchFn)})):s.reduce((async(e,t)=>(await e,a(t.formData,t.config).then(t.thenFn).catch(t.catchFn))),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(o)},handleRemoveUpload:e=>{d({type:"removeUpload",payload:{file:e}})}}}},17993:(e,a,t)=>{t.d(a,{Lx:()=>i,Si:()=>c,sl:()=>d});var r=t(7616),n=t(77347),l=t(40752),o=t(70611);const s="packages",i=(e={},a=!1)=>{const{data:t,isLoading:i,error:c,refetch:d}=(0,r.I)({queryKey:[s,e],queryFn:()=>(0,l.UD)({client:n.S,query:{...(0,o.kd)(e)}}),refetchInterval:!a&&5e3});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:e},isFetching:i,fetchError:c,refetch:d}},c=e=>{const{data:a,isLoading:t,error:o}=(0,r.I)({queryKey:[s,e],queryFn:()=>(0,l.Y0)({client:n.S,path:{key:e}})});return{pkg:a?.data,isFetching:t,fetchError:o}},d=(e,a={})=>{const{data:t,isLoading:i,error:c,refetch:d}=(0,r.I)({queryKey:[s,"by-sbom",e,a],queryFn:()=>(0,l.Ad)({client:n.S,path:{id:e},query:{...(0,o.kd)(a)}})});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:a},isFetching:i,fetchError:c,refetch:d}}},91728:(e,a,t)=>{t.d(a,{DH:()=>y,Qr:()=>h,i$:()=>u,rj:()=>p,sn:()=>m});var r=t(7616),n=t(3715),l=t(77347),o=t(40752),s=t(24808),i=t(81230),c=t(70611);const d="sboms",u=(e={},a=!1)=>{const{data:t,isLoading:n,error:s,refetch:i}=(0,r.I)({queryKey:[d,e],queryFn:()=>(0,o.z1)({client:l.S,query:{...(0,c.kd)(e)}}),refetchInterval:!a&&5e3});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:e??e},isFetching:n,fetchError:s,refetch:i}},p=e=>{const{data:a,isLoading:t,error:n}=(0,r.I)({queryKey:[d,e],queryFn:()=>(0,o.a7)({client:l.S,path:{id:e}}),enabled:void 0!==e});return{sbom:a?.data,isFetching:t,fetchError:n}},m=()=>{const e=(0,n.jE)();return(0,s.v)({parallel:!0,uploadFn:(e,a)=>(0,i.J4)(e,a),onSuccess:()=>{e.invalidateQueries({queryKey:[d]})}})},h=(e,a={})=>{const{data:t,isLoading:n,error:s,refetch:i}=(0,r.I)({queryKey:[d,"by-package",e,a],queryFn:()=>(0,o.m9)({client:l.S,query:{id:e,...(0,c.kd)(a)}})});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:a??a},isFetching:n,fetchError:s,refetch:i}},y=e=>{const{data:a,isLoading:t,error:n}=(0,r.I)({queryKey:[d,e,"advisory"],queryFn:()=>(0,o.bj)({client:l.S,path:{id:e}})});return{advisories:a?.data||[],isFetching:t,fetchError:n}}}}]);
//# sourceMappingURL=899.eddf5968.min.js.map