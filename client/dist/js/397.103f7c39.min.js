"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[397],{17327:(e,t,a)=>{a.d(t,{E:()=>c,Z:()=>o});var l=a(34629),r=a(63696),i=a(41775),n=a(62634),s=a(1850);const c=r.createContext({cardId:"",registerTitleId:()=>{},isExpanded:!1,isClickable:!1,isSelectable:!1,isSelected:!1,isClicked:!1,isDisabled:!1}),o=e=>{var{children:t,id:a="",className:d,component:u="div",isCompact:m=!1,isSelectable:p=!1,isClickable:f=!1,isDisabled:b=!1,isSelectableRaised:h=!1,isSelected:y=!1,isClicked:E=!1,isDisabledRaised:v=!1,isFlat:g=!1,isExpanded:C=!1,isRounded:S=!1,isLarge:T=!1,isFullHeight:k=!1,isPlain:P=!1,ouiaId:F,ouiaSafe:_=!0,hasSelectableInput:x=!1,selectableInputAriaLabel:I,onSelectableInputChange:K=()=>{}}=e,A=(0,l.__rest)(e,["children","id","className","component","isCompact","isSelectable","isClickable","isDisabled","isSelectableRaised","isSelected","isClicked","isDisabledRaised","isFlat","isExpanded","isRounded","isLarge","isFullHeight","isPlain","ouiaId","ouiaSafe","hasSelectableInput","selectableInputAriaLabel","onSelectableInputChange"]);const R=u,N=(0,s.iK)(o.displayName,F,_),[w,D]=r.useState(""),[V,M]=r.useState();m&&T&&(console.warn("Card: Cannot use isCompact with isLarge. Defaulting to isCompact"),T=!1);const L=r.useRef(!1);return r.useEffect((()=>{I?M({"aria-label":I}):w?M({"aria-labelledby":w}):x&&!L.current&&(M({}),console.warn("If no CardTitle component is passed as a child of Card the selectableInputAriaLabel prop must be passed"))}),[x,I,w]),r.createElement(c.Provider,{value:{cardId:a,registerTitleId:e=>{D(e),L.current=!!e},isExpanded:C,isClickable:f,isSelectable:p,isSelected:y,isClicked:E,isDisabled:b,hasSelectableInput:x}},x&&r.createElement("input",Object.assign({className:"pf-v5-screen-reader",id:`${a}-input`},V,{type:"checkbox",checked:y,onChange:e=>K(e,a),disabled:v,tabIndex:-1})),r.createElement(R,Object.assign({id:a,className:(0,n.A)(i.A.card,m&&i.A.modifiers.compact,C&&i.A.modifiers.expanded,g&&i.A.modifiers.flat,S&&i.A.modifiers.rounded,T&&i.A.modifiers.displayLg,k&&i.A.modifiers.fullHeight,P&&i.A.modifiers.plain,v?(0,n.A)(i.A.modifiers.nonSelectableRaised):h?(0,n.A)(i.A.modifiers.selectableRaised,y&&i.A.modifiers.selectedRaised):p&&f?(0,n.A)(i.A.modifiers.selectable,i.A.modifiers.clickable,(y||E)&&i.A.modifiers.current):p?(0,n.A)(i.A.modifiers.selectable,y&&i.A.modifiers.selected):f?(0,n.A)(i.A.modifiers.clickable,E&&i.A.modifiers.current):"",b&&i.A.modifiers.disabled,d),tabIndex:h?"0":void 0},A,N),t))};o.displayName="Card"},71603:(e,t,a)=>{a.d(t,{b:()=>s});var l=a(34629),r=a(63696),i=a(41775),n=a(62634);const s=e=>{var{children:t,className:a,component:s="div",isFilled:c=!0}=e,o=(0,l.__rest)(e,["children","className","component","isFilled"]);const d=s;return r.createElement(d,Object.assign({className:(0,n.A)(i.A.cardBody,!c&&i.A.modifiers.noFill,a)},o),t)};s.displayName="CardBody"},38914:(e,t,a)=>{a.d(t,{B:()=>s});var l=a(34629),r=a(63696),i=a(13364),n=a(62634);const s=e=>{var{hasGutter:t=!1,className:a="",children:s=null,component:c="div"}=e,o=(0,l.__rest)(e,["hasGutter","className","children","component"]);const d=c;return r.createElement(d,Object.assign({},o,{className:(0,n.A)(i.A.stack,t&&i.A.modifiers.gutter,a)}),s)};s.displayName="Stack"},57901:(e,t,a)=>{a.d(t,{a:()=>s});var l=a(34629),r=a(63696),i=a(13364),n=a(62634);const s=e=>{var{isFilled:t=!1,className:a="",children:s=null}=e,c=(0,l.__rest)(e,["isFilled","className","children"]);return r.createElement("div",Object.assign({},c,{className:(0,n.A)(i.A.stackItem,t&&i.A.modifiers.fill,a)}),s)};s.displayName="StackItem"},16177:(e,t,a)=>{a.d(t,{a:()=>i});var l=a(63696),r=a(93962);const i=({value:e})=>l.createElement(l.Fragment,null,Object.entries(e).map((([e,t],a)=>l.createElement(r.J,{key:a,isCompact:!0},`${e}=${t}`))))},68248:(e,t,a)=>{a.d(t,{f:()=>s});var l=a(63696),r=a(74932);const i=(e,t)=>e.sbom.id===t.sbom.id&&e.sbomStatus===t.sbomStatus,n={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0}},s=e=>{const{vulnerability:t,isFetching:a,fetchError:s}=(0,r.uN)(e);return{data:l.useMemo((()=>(e=>{const t=e.flatMap((e=>(e.sboms??[]).flatMap((t=>t.status.map((a=>({sbom:{...t,version:t.version||null},sbomStatus:a,advisory:e}))))).reduce(((e,t)=>{const a=e.find((e=>i(e,t)));if(a)return[...e.filter((e=>!i(e,a))),{...a,relatedPackages:[...a.relatedPackages,{advisory:t.advisory}]}];{const a={sbom:t.sbom,sbomStatus:t.sbomStatus,relatedPackages:[{advisory:t.advisory}]};return[...e,a]}}),[]))),a=t.reduce(((e,t)=>{const a=t.sbomStatus;return{...e,total:e.total+1,sbomStatus:{...e.sbomStatus,[a]:e.sbomStatus[a]+1}}}),n);return{sboms:t,summary:a}})(t?.advisories||[])),[t]),isFetching:a,fetchError:s}}},7602:(e,t,a)=>{a.d(t,{R:()=>o,r:()=>d});var l=a(63696),r=a(87043),i=a(86820),n=a(70611),s=a(5098),c=a(69935);const o=l.createContext({}),d=({children:e})=>{const t=(0,n.MM)({tableName:"advisory",persistenceKeyPrefix:i.rt.advisories,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Title",severity:"Aggregated Severity",modified:"Revision",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","severity","modified"],isFilterEnabled:!0,filterCategories:[{categoryKey:i._G,title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:r.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"modified",title:"Revision",type:r.RJ.dateRange}],isExpansionEnabled:!1}),{result:{data:a,total:d},isFetching:u,fetchError:m}=(0,c.VH)((0,n.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score",modified:"modified"}})),p=(0,n.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:d,isLoading:u,selectionState:(0,s.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return l.createElement(o.Provider,{value:{totalItemCount:d,isFetching:u,fetchError:m,tableControls:p}},e)}},7123:(e,t,a)=>{a.d(t,{q:()=>g});var l=a(63696),r=a(49348),i=a(40319),n=a(16646),s=a(9425),c=a(77819),o=a(28516),d=a(3629),u=a(62101),m=a(50705),p=a(1349),f=a(62520),b=a(91271),h=a(11848),y=a(28644),E=a(34066),v=a(7602);const g=({})=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:g}=l.useContext(v.R),{pushNotification:C}=l.useContext(m.K),{numRenderedColumns:S,currentPageItems:T,propHelpers:{paginationProps:k,tableProps:P,getThProps:F,getTrProps:_,getTdProps:x},expansionDerivedState:{isCellExpanded:I}}=g,{downloadAdvisory:K}=(0,b.m)();return l.createElement(l.Fragment,null,l.createElement(i.X,{...P,"aria-label":"advisory-table"},l.createElement(n.d,null,l.createElement(s.Tr,null,l.createElement(f.Ze,{...g},l.createElement(c.Th,{...F({columnKey:"identifier"})}),l.createElement(c.Th,{...F({columnKey:"title"})}),l.createElement(c.Th,{...F({columnKey:"severity"})}),l.createElement(c.Th,{...F({columnKey:"modified"})}),l.createElement(c.Th,{...F({columnKey:"vulnerabilities"})})))),l.createElement(f.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:S},T.map(((e,t)=>{const a=e.vulnerabilities.reduce(((e,t)=>({...e,[t.severity]:e[t.severity]+1})),{critical:0,high:0,medium:0,low:0,none:0});return l.createElement(o.N,{key:e.identifier,isExpanded:I(e)},l.createElement(s.Tr,{..._({item:e})},l.createElement(f.Oi,{...g,item:e,rowIndex:t},l.createElement(d.Td,{width:15,...x({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},l.createElement(r.k2,{to:`/advisories/${e.uuid}`},e.identifier)),l.createElement(d.Td,{width:40,modifier:"truncate",...x({columnKey:"title"})},e.title),l.createElement(d.Td,{width:15,modifier:"truncate",...x({columnKey:"severity"})},e.average_severity&&l.createElement(h.h,{value:e.average_severity})),l.createElement(d.Td,{width:10,...x({columnKey:"modified"})},(0,E.Yq)(e.modified)),l.createElement(d.Td,{width:20,...x({columnKey:"vulnerabilities"})},l.createElement(y.n,{severities:a})),l.createElement(d.Td,{isActionCell:!0},l.createElement(u.G,{items:[{title:"Download",onClick:()=>{K(e.uuid,`${e.identifier}.json`)}}]})))))})))),l.createElement(p.n,{idPrefix:"advisory-table",isTop:!1,isCompact:!0,paginationProps:k}))}},30426:(e,t,a)=>{a.d(t,{Y:()=>d,a:()=>u});var l=a(63696),r=a(87043),i=a(86820),n=a(70611),s=a(5098),c=a(17993),o=a(34066);const d=l.createContext({}),u=({children:e})=>{const t=(0,n.MM)({tableName:"packages",persistenceKeyPrefix:i.rt.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:i._G,title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:r.RJ.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:r.RJ.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:a,total:u},isFetching:m,fetchError:p}=(0,c.Lx)((0,n.Ng)({...t,hubSortFieldKeys:{}})),f=l.useMemo((()=>a.map((e=>({...e,decomposedPurl:(0,o.fe)(e.purl)})))),[a]),b=(0,n.PB)({...t,idProperty:"uuid",currentPageItems:f,totalItemCount:u,isLoading:m,selectionState:(0,s.$)({items:f,isEqual:(e,t)=>e.uuid===t.uuid})});return l.createElement(d.Provider,{value:{totalItemCount:u,isFetching:m,fetchError:p,tableControls:b}},e)}},53646:(e,t,a)=>{a.d(t,{N:()=>k});var l=a(63696),r=a(49348),i=a(40319),n=a(16646),s=a(9425),c=a(77819),o=a(28516),d=a(3629),u=a(16177),m=a(1349),p=a(62520),f=a(36509),b=a(93962),h=a(24417),y=a(28644),E=a(77347),v=a(40752),g=a(17993);const C={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},S=({packageId:e})=>{const{summary:t,isFetching:a,fetchError:r}=(e=>{const{pkg:t,isFetching:a,fetchError:r}=(0,g.Si)(e),[i,n]=l.useState([]),[s,c]=l.useState(new Map),[o,d]=l.useState(!1);l.useEffect((()=>{if(!t||0===t.advisories.length)return;const e=(t?.advisories??[]).flatMap((e=>(e.status??[]).map((t=>({vulnerabilityId:t.vulnerability.identifier,status:t.status,advisory:e}))))).filter((e=>"affected"===e.status)).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]);n(e),d(!0),Promise.all(e.map((async e=>(await(0,v.wk)({client:E.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),a=new Map;t.forEach((e=>{a.set(e.identifier,e)})),c(a),d(!1)}))}),[t]);const u=l.useMemo((()=>i.map((e=>({...e,vulnerability:s.get(e.vulnerabilityId)})))),[i,s]),m=l.useMemo((()=>u.reduce(((e,t)=>{if(t.vulnerability?.average_severity){const a=t.vulnerability?.average_severity;return{...e,total:e.total+1,severities:{...e.severities,[a]:e.severities[a]+1}}}return e}),C)),[u]);return{isFetching:a||o,fetchError:r,vulnerabilities:u,summary:m}})(e);return l.createElement(h.a,{isFetching:a,fetchError:r,isFetchingState:l.createElement(f.E,{screenreaderText:"Loading contents"}),fetchErrorState:l.createElement(b.J,{color:"red"},"Error")},l.createElement(y.n,{severities:t.severities}))};var T=a(30426);const k=()=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:f}=l.useContext(T.Y),{numRenderedColumns:b,currentPageItems:h,propHelpers:{paginationProps:y,tableProps:E,getThProps:v,getTrProps:g,getTdProps:C},expansionDerivedState:{isCellExpanded:k}}=f;return l.createElement(l.Fragment,null,l.createElement(i.X,{...E,"aria-label":"Package table"},l.createElement(n.d,null,l.createElement(s.Tr,null,l.createElement(p.Ze,{...f},l.createElement(c.Th,{...v({columnKey:"name"})}),l.createElement(c.Th,{...v({columnKey:"namespace"})}),l.createElement(c.Th,{...v({columnKey:"version"})}),l.createElement(c.Th,{...v({columnKey:"type"})}),l.createElement(c.Th,{...v({columnKey:"path"})}),l.createElement(c.Th,{...v({columnKey:"qualifiers"})}),l.createElement(c.Th,{...v({columnKey:"vulnerabilities"})})))),l.createElement(p.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:b},h.map(((e,t)=>l.createElement(o.N,{key:e.uuid},l.createElement(s.Tr,{...g({item:e})},l.createElement(p.Oi,{...f,item:e,rowIndex:t},l.createElement(d.Td,{width:15,...C({columnKey:"name"})},l.createElement(r.k2,{to:`/packages/${e.uuid}`},e.decomposedPurl?e.decomposedPurl?.name:e.purl)),l.createElement(d.Td,{width:15,modifier:"truncate",...C({columnKey:"namespace"})},e.decomposedPurl?.namespace),l.createElement(d.Td,{width:10,modifier:"truncate",...C({columnKey:"version"})},e.decomposedPurl?.version),l.createElement(d.Td,{width:10,modifier:"truncate",...C({columnKey:"type"})},e.decomposedPurl?.type),l.createElement(d.Td,{width:10,modifier:"truncate",...C({columnKey:"path"})},e.decomposedPurl?.path),l.createElement(d.Td,{width:20,...C({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&l.createElement(u.a,{value:e.decomposedPurl?.qualifiers})),l.createElement(d.Td,{width:20,...C({columnKey:"vulnerabilities"})},l.createElement(S,{packageId:e.uuid}))))))))),l.createElement(m.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:y}))}},41112:(e,t,a)=>{a.r(t),a.d(t,{default:()=>se});var l=a(63696),r=a(69673),i=a(68430),n=a(20653),s=a(35048),c=a(56918),o=a(1180),d=a(72785),u=a(4433),m=a(66174),p=a(54518),f=a(48281),b=a(17327),h=a(71603),y=a(16459),E=a(71592),v=a(40111),g=a(96178),C=a(70414),S=a(8210),T=a(38914),k=a(57901),P=a(77635),F=a(87043),_=a(58897),x=a(71273),I=a(51463);const K=({category:e,filterValue:t,setFilterValue:a,isNumeric:r,isDisabled:i=!1})=>{const[n,s]=l.useState(t?.[0]||"");l.useEffect((()=>{s(t?.[0]||"")}),[t]);const c=()=>{const e=n.trim();a(e?[e.replace(/\s+/g," ")]:[])},o=`${e.categoryKey}-input`;return l.createElement(_.M,null,l.createElement(x.ks,{name:o,id:"search-input",type:r?"number":"search",onChange:(e,t)=>s(t),"aria-label":`${e.title} filter`,value:n,placeholder:e.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||c()},isDisabled:i}),l.createElement(P.$n,{variant:P.Ak.control,id:"search-button","aria-label":"search button for search input",onClick:c,isDisabled:i},l.createElement(I.Ay,null)))};var A=a(34629);const R="pf-m-standalone",N="pf-m-disabled";var w=a(62634),D=a(1850);class V extends l.Component{constructor(e){super(e),this.handleChange=e=>{this.props.onChange(e,e.currentTarget.checked)},e.label||e["aria-label"]||console.error("Radio:","Radio requires an aria-label to be specified"),this.state={ouiaStateId:(0,D.X)(V.displayName)}}render(){const e=this.props,{"aria-label":t,checked:a,className:r,inputClassName:i,defaultChecked:n,isLabelWrapped:s,isLabelBeforeButton:c,isChecked:o,isDisabled:d,isValid:u,label:m,onChange:p,description:f,body:b,ouiaId:h,ouiaSafe:y=!0,component:E}=e,v=(0,A.__rest)(e,["aria-label","checked","className","inputClassName","defaultChecked","isLabelWrapped","isLabelBeforeButton","isChecked","isDisabled","isValid","label","onChange","description","body","ouiaId","ouiaSafe","component"]);v.id||console.error("Radio:","id is required to make input accessible");const g=l.createElement("input",Object.assign({},v,{className:(0,w.A)("pf-v5-c-radio__input",i),type:"radio",onChange:this.handleChange,"aria-invalid":!u,disabled:d,checked:a||o},void 0===a&&{defaultChecked:n},!m&&{"aria-label":t},(0,D.Bs)(V.displayName,void 0!==h?h:this.state.ouiaStateId,y))),C=s&&!E||"label"===E,S=C?"span":"label",T=m?l.createElement(S,{className:(0,w.A)("pf-v5-c-radio__label",d&&N),htmlFor:C?void 0:v.id},m):null,k=null!=E?E:C?"label":"div";return l.createElement(k,{className:(0,w.A)("pf-v5-c-radio",!m&&R,r),htmlFor:C?v.id:void 0},c?l.createElement(l.Fragment,null,T,g):l.createElement(l.Fragment,null,g,T),f&&l.createElement("span",{className:(0,w.A)("pf-v5-c-radio__description")},f),b&&l.createElement("span",{className:(0,w.A)("pf-v5-c-radio__body")},b))}}V.displayName="Radio",V.defaultProps={className:"",isDisabled:!1,isValid:!0,onChange:()=>{}};const M=({category:e,filterValue:t,setFilterValue:a,isDisabled:r=!1})=>l.createElement(l.Fragment,null,e.selectOptions.map((({label:i,value:n,optionProps:s={}},c)=>{const o=t?.includes(n)||!1;return l.createElement(V,{isDisabled:r,key:c,id:`radio-${c}`,name:"radio",isLabelWrapped:!0,label:i,isChecked:o,onChange:()=>{(t=>{const l=(r=t,e.selectOptions.find((({value:e})=>e===r)));var r;a(l?[t]:null)})(n)}})})));var L=a(58365);const O=({category:e,filterValue:t,setFilterValue:a,isDisabled:r=!1})=>{const[i,n]=l.useState(Array.isArray(e.selectOptions)?e.selectOptions:[]);l.useEffect((()=>{n(Array.isArray(e.selectOptions)?e.selectOptions:[])}),[e.selectOptions]);const s=Array.isArray(i)?i:Object.values(i).flatMap((e=>e));return l.createElement(l.Fragment,null,s.map((({label:r,value:i,optionProps:n={}},s)=>l.createElement(L.S,{key:s,id:`checkbox-${s}-${e.categoryKey}`,isLabelWrapped:!0,label:r,isChecked:t?.includes(i),onChange:()=>{(e=>{if(e&&"No results"!==e){let l;l=t&&t.includes(e)?t.filter((t=>t!==e)):t?[...t,e]:[e],a(l)}})(i)}}))))};var q=a(46721),J=a(40360),B=a(23277),H=a(78109),$=a(66341);const Y=({category:e,filterValue:t,setFilterValue:a,isDisabled:r=!1})=>{const i=t??[],[n,s]=(i?.filter((e=>(0,$.Ce)((0,$.P1)(e)))),(0,l.useState)()),[c,o]=(0,l.useState)();return l.useEffect((()=>{if(t?.[0]){const[e,a]=(0,$.P1)(t?.[0]);s(e.toDate()),o(a.toDate())}else s(void 0),o(void 0)}),[t]),l.createElement(q.l,null,l.createElement(J.g,{role:"group",isInline:!0,label:"From"},l.createElement(B.l,{value:n?(0,$.ak)(n):"",dateFormat:$.ak,dateParse:$.sy,onChange:(e,t)=>{(0,$.Fz)(t)&&(s((0,$.sy)(t)),o(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:r})),l.createElement(J.g,{role:"group",isInline:!0,label:"To"},l.createElement(B.l,{value:c?(0,$.ak)(c):"",onChange:(e,t)=>{if((0,$.Fz)(t)){const e=(0,$.sy)(t);o(e);const l=(0,$.Kg)(n,e);l&&a([l])}},isDisabled:r||!(0,H.v)(n),dateFormat:$.ak,dateParse:$.sy,invalidFormatText:"",rangeStart:n,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})))},G=({category:e,...t})=>e.type===F.RJ.select?l.createElement(M,{category:e,...t}):e.type===F.RJ.search||e.type===F.RJ.numsearch?l.createElement(K,{category:e,isNumeric:e.type===F.RJ.numsearch,...t}):e.type===F.RJ.multiselect?l.createElement(O,{category:e,...t}):e.type===F.RJ.dateRange?l.createElement(Y,{category:e,...t}):null,j=({filterCategories:e,filterValues:t,setFilterValues:a,isDisabled:r=!1,omitFilterCategoryKeys:i=[]})=>l.createElement(l.Fragment,null,l.createElement(T.B,{hasGutter:!0},l.createElement(k.a,null,l.createElement(P.$n,{variant:"link",isInline:!0,onClick:()=>{const l=e.filter((e=>void 0===i.find((t=>t===e.categoryKey)))).reduce(((e,t)=>({...e,[t.categoryKey]:void 0})),{});a({...t,...l})}},"Clear all filters")),e.filter((e=>void 0===i.find((t=>t===e.categoryKey)))).map((e=>l.createElement(k.a,{key:e.categoryKey},l.createElement(T.B,{hasGutter:!0},l.createElement(k.a,null,l.createElement(o.n,null,l.createElement(d.E,{component:"h4"},e.title))),l.createElement(k.a,null,l.createElement(G,{category:e,filterValue:t[e.categoryKey],setFilterValue:l=>((e,l)=>a({...t,[e.categoryKey]:l}))(e,l),isDisabled:r,isSidebar:!0}))))))));var W=a(86820),Z=a(30426),X=a(36390),z=a(14310),Q=a(7602);function U(e,t){return{Component:e,props:t}}const ee=[U(X.c,{}),U(Z.a,{}),U(z.y,{}),U(Q.r,{})],te=(ae=ee,({children:e})=>{const t=l.createElement(l.Fragment,null,e);return ae.reduceRight(((e,{Component:t,props:a={}})=>l.createElement(t,{...a},e)),t)});var ae,le=a(7123),re=a(53646),ie=a(90676),ne=a(86416);const se=()=>l.createElement(te,null,l.createElement(ce,null)),ce=()=>{const{tableControls:e}=l.useContext(X.L),{tableControls:t}=l.useContext(Z.Y),{tableControls:a}=l.useContext(z.u),{tableControls:T}=l.useContext(Q.R),{totalItemCount:k,tableControls:{propHelpers:{filterPanelProps:P}}}=l.useContext(X.L),{totalItemCount:F,tableControls:{propHelpers:{filterPanelProps:_}}}=l.useContext(Z.Y),{totalItemCount:x,tableControls:{propHelpers:{filterPanelProps:I}}}=l.useContext(z.u),{totalItemCount:K,tableControls:{propHelpers:{filterPanelProps:A}}}=l.useContext(Q.R),[R,N]=l.useState(e.filterState.filterValues[W._G]?.[0]||""),[w,D]=l.useState(0),V=l.createRef();return l.createElement(l.Fragment,null,l.createElement(i.d8,{variant:i.zC.light},l.createElement(n.M,{isStatic:!0},l.createElement(s.P,null,l.createElement(c.$,{align:{default:"alignLeft"}},l.createElement(o.n,null,l.createElement(d.E,{component:"h1"},"Search Results"))),l.createElement(c.$,{variant:"icon-button-group",align:{default:"alignRight"}},l.createElement(c.$,{visibility:{default:"hidden",lg:"visible"}},l.createElement(u.T,{widths:{default:"500px"}},l.createElement(m.D,{placeholder:"Search for an SBOM, Package, or Vulnerability",value:R,onChange:(e,t)=>(e=>{N(e)})(t),onClear:()=>{N("")},onKeyDown:l=>{l.key&&"Enter"!==l.key||(e.filterState.setFilterValues({...e.filterState.filterValues,[W._G]:[R]}),t.filterState.setFilterValues({...t.filterState.filterValues,[W._G]:[R]}),a.filterState.setFilterValues({...a.filterState.filterValues,[W._G]:[R]}),T.filterState.setFilterValues({...T.filterState.filterValues,[W._G]:[R]}))}}))))))),l.createElement(i.d8,null,l.createElement(p.B,{hasGutter:!0},l.createElement(f.o,null,l.createElement(b.Z,{isFullHeight:!0},l.createElement(h.b,{style:{width:241}},0===w?l.createElement(j,{omitFilterCategoryKeys:[""],...P}):1===w?l.createElement(j,{omitFilterCategoryKeys:[""],..._}):2===w?l.createElement(j,{omitFilterCategoryKeys:[""],...I}):3===w?l.createElement(j,{omitFilterCategoryKeys:[""],...A}):null))),l.createElement(f.o,{isFilled:!0},l.createElement(y.t,{isBox:!0,activeKey:w,onSelect:(e,t)=>{D(t)},"aria-label":"Tabs",role:"region"},l.createElement(E.o,{eventKey:0,title:l.createElement(v.V,null,"SBOMs","  ",l.createElement(g.E,{screenReaderText:"Search Result Count"},k)),actions:l.createElement(l.Fragment,null,l.createElement(C.o,{"aria-label":"SBOM help popover",ref:V},l.createElement(S.Ay,null)),(M=V,l.createElement(r.A,{bodyContent:l.createElement("div",null,"Software Bill of Materials for Products and Containers."),position:"right",triggerRef:M})))},l.createElement(ie.Y,null)),l.createElement(E.o,{eventKey:1,title:l.createElement(v.V,null,"Packages","  ",l.createElement(g.E,{screenReaderText:"Search Result Count"},F))},l.createElement(re.N,null)),l.createElement(E.o,{eventKey:2,title:l.createElement(v.V,null,"CVEs","  ",l.createElement(g.E,{screenReaderText:"Search Result Count"},x))},l.createElement(ne.f,null)),l.createElement(E.o,{eventKey:3,title:l.createElement(v.V,null,"Advisories","  ",l.createElement(g.E,{screenReaderText:"Advisory Result Count"},x))},l.createElement(le.q,null)))))));var M}},14310:(e,t,a)=>{a.d(t,{u:()=>o,y:()=>d});var l=a(63696),r=a(87043),i=a(86820),n=a(70611),s=a(5098),c=a(74932);const o=l.createContext({}),d=({children:e})=>{const t=(0,n.MM)({tableName:"vulnerability",persistenceKeyPrefix:i.rt.vulnerabilities,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Description",severity:"CVSS",published:"Date published",sboms:"Related documents"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["published","severity"],isFilterEnabled:!0,filterCategories:[{categoryKey:i._G,title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"average_severity",title:"CVSS",placeholderText:"CVSS",type:r.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"published",title:"Created on",type:r.RJ.dateRange}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:a,total:d},isFetching:u,fetchError:m}=(0,c.WJ)((0,n.Ng)({...t,hubSortFieldKeys:{severity:"average_severity",published:"published"}})),p=(0,n.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:d,isLoading:u,selectionState:(0,s.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return l.createElement(o.Provider,{value:{totalItemCount:d,isFetching:u,fetchError:m,tableControls:p}},e)}},86416:(e,t,a)=>{a.d(t,{f:()=>S});var l=a(63696),r=a(49348),i=a(40319),n=a(16646),s=a(9425),c=a(77819),o=a(28516),d=a(3629),u=a(11848),m=a(1349),p=a(62520),f=a(23560),b=a(34066),h=a(36509),y=a(93962),E=a(24417),v=a(68248);const g=({vulnerabilityId:e})=>{const{data:t,isFetching:a,fetchError:r}=(0,v.f)(e);return l.createElement(E.a,{isFetching:a,fetchError:r,isFetchingState:l.createElement(h.E,{screenreaderText:"Loading contents"}),fetchErrorState:l.createElement(y.J,{color:"red"},"Error")},t.summary.sbomStatus.affected)};var C=a(14310);const S=()=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:h}=l.useContext(C.u),{numRenderedColumns:y,currentPageItems:E,propHelpers:{paginationProps:v,tableProps:S,getThProps:T,getTrProps:k,getTdProps:P}}=h;return l.createElement(l.Fragment,null,l.createElement(i.X,{...S,"aria-label":"Vulnerability table"},l.createElement(n.d,null,l.createElement(s.Tr,null,l.createElement(p.Ze,{...h},l.createElement(c.Th,{...T({columnKey:"identifier"})}),l.createElement(c.Th,{...T({columnKey:"title"})}),l.createElement(c.Th,{...T({columnKey:"severity"})}),l.createElement(c.Th,{...T({columnKey:"published"})}),l.createElement(c.Th,{...T({columnKey:"sboms"})})))),l.createElement(p.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:y},E.map(((e,t)=>l.createElement(o.N,{key:e.identifier},l.createElement(s.Tr,{...k({item:e})},l.createElement(p.Oi,{...h,item:e,rowIndex:t},l.createElement(d.Td,{width:15,...P({columnKey:"identifier",item:e,rowIndex:t})},l.createElement(r.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),l.createElement(d.Td,{width:45,modifier:"truncate",...P({columnKey:"title"})},l.createElement(f.j,{vulnerability:e})),l.createElement(d.Td,{width:10,...P({columnKey:"severity"})},e.average_severity&&l.createElement(u.h,{value:e.average_severity})),l.createElement(d.Td,{width:10,...P({columnKey:"published"})},(0,b.Yq)(e.published)),l.createElement(d.Td,{width:10,...P({columnKey:"sboms",item:e,rowIndex:t})},l.createElement(g,{vulnerabilityId:e.identifier}))))))))),l.createElement(m.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:v}))}},69935:(e,t,a)=>{a.d(t,{VH:()=>u,Yu:()=>p,vy:()=>m});var l=a(39155),r=a(3715),i=a(77347),n=a(40752),s=a(81230),c=a(70611),o=a(24808);const d="advisories",u=(e={},t=!1)=>{const{data:a,isLoading:r,error:s,refetch:o}=(0,l.I)({queryKey:[d,e],queryFn:()=>(0,n.YM)({client:i.S,query:{...(0,c.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e??e},isFetching:r,fetchError:s||null,refetch:o}},m=e=>{const{data:t,isLoading:a,error:r}=(0,l.I)({queryKey:[d,e],queryFn:()=>(0,n.ai)({client:i.S,path:{key:e}}),enabled:void 0!==e});return{advisory:t?.data,isFetching:a,fetchError:r}},p=()=>{const e=(0,r.jE)();return(0,o.v)({parallel:!0,uploadFn:(e,t)=>(0,s.hP)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[d]})}})}},74932:(e,t,a)=>{a.d(t,{WJ:()=>c,uN:()=>o});var l=a(39155),r=a(77347),i=a(40752),n=a(70611);const s="vulnerabilities",c=(e={},t=!1)=>{const{data:a,isLoading:c,error:o,refetch:d}=(0,l.I)({queryKey:[s,e],queryFn:()=>(0,i.NI)({client:r.S,query:{...(0,n.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e},isFetching:c,fetchError:o,refetch:d}},o=e=>{const{data:t,isLoading:a,error:n}=(0,l.I)({queryKey:[s,e],queryFn:()=>(0,i.wk)({client:r.S,path:{id:e}})});return{vulnerability:t?.data,isFetching:a,fetchError:n}}},41775:(e,t,a)=>{a.d(t,{A:()=>l});const l={card:"pf-v5-c-card",cardActions:"pf-v5-c-card__actions",cardBody:"pf-v5-c-card__body",cardExpandableContent:"pf-v5-c-card__expandable-content",cardFooter:"pf-v5-c-card__footer",cardHeader:"pf-v5-c-card__header",cardHeaderMain:"pf-v5-c-card__header-main",cardHeaderToggle:"pf-v5-c-card__header-toggle",cardHeaderToggleIcon:"pf-v5-c-card__header-toggle-icon",cardSelectableActions:"pf-v5-c-card__selectable-actions",cardSrInput:"pf-v5-c-card__sr-input",cardTitle:"pf-v5-c-card__title",cardTitleText:"pf-v5-c-card__title-text",check:"pf-v5-c-check",checkInput:"pf-v5-c-check__input",checkLabel:"pf-v5-c-check__label",dirRtl:"pf-v5-m-dir-rtl",divider:"pf-v5-c-divider",modifiers:{selectable:"pf-m-selectable",clickable:"pf-m-clickable",selected:"pf-m-selected",current:"pf-m-current",disabled:"pf-m-disabled",hoverableRaised:"pf-m-hoverable-raised",selectableRaised:"pf-m-selectable-raised",nonSelectableRaised:"pf-m-non-selectable-raised",selectedRaised:"pf-m-selected-raised",compact:"pf-m-compact",displayLg:"pf-m-display-lg",flat:"pf-m-flat",plain:"pf-m-plain",rounded:"pf-m-rounded",expanded:"pf-m-expanded",fullHeight:"pf-m-full-height",toggleRight:"pf-m-toggle-right",noOffset:"pf-m-no-offset",noFill:"pf-m-no-fill"},radio:"pf-v5-c-radio",radioInput:"pf-v5-c-radio__input",radioLabel:"pf-v5-c-radio__label",themeDark:"pf-v5-theme-dark"}},13364:(e,t,a)=>{a.d(t,{A:()=>l});const l={modifiers:{fill:"pf-m-fill",gutter:"pf-m-gutter"},stack:"pf-v5-l-stack",stackItem:"pf-v5-l-stack__item"}}}]);
//# sourceMappingURL=397.103f7c39.min.js.map