"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[907],{65753:(e,t,l)=>{l.d(t,{B:()=>u});var a=l(34629),i=l(63696),n=l(62634),r=l(91106),s=l(44551);const o="--pf-v5-c-description-list--GridTemplateColumns--min",c="--pf-v5-c-description-list__term--width",m="--pf-v5-c-description-list--m-horizontal__term--width",d=(e,t)=>{const l=t;return Object.keys(l||{}).reduce(((t,a)=>"default"===a?Object.assign(Object.assign({},t),{[e]:l[a]}):Object.assign(Object.assign({},t),{[`${e}-on-${a}`]:l[a]})),{})},u=e=>{var{className:t="",children:l=null,isHorizontal:u=!1,isAutoColumnWidths:p,isAutoFit:h,isInlineGrid:E,isCompact:b,isFluid:f,isFillColumns:g,displaySize:y="default",columnModifier:v,autoFitMinModifier:A,termWidth:C,horizontalTermWidthModifier:T,orientation:x,style:N}=e,_=(0,a.__rest)(e,["className","children","isHorizontal","isAutoColumnWidths","isAutoFit","isInlineGrid","isCompact","isFluid","isFillColumns","displaySize","columnModifier","autoFitMinModifier","termWidth","horizontalTermWidthModifier","orientation","style"]);return h&&A&&(N=Object.assign(Object.assign({},N),d(o,A))),C&&(N=Object.assign(Object.assign({},N),{[c]:C})),u&&T&&(N=Object.assign(Object.assign({},N),d(m,T))),i.createElement("dl",Object.assign({className:(0,n.A)(r.A.descriptionList,(u||f)&&r.A.modifiers.horizontal,p&&r.A.modifiers.autoColumnWidths,h&&r.A.modifiers.autoFit,(0,s.ay)(v,r.A),(0,s.ay)(x,r.A),E&&r.A.modifiers.inlineGrid,b&&r.A.modifiers.compact,f&&r.A.modifiers.fluid,g&&r.A.modifiers.fillColumns,"lg"===y&&r.A.modifiers.displayLg,"2xl"===y&&r.A.modifiers.display_2xl,t),style:N},_),l)};u.displayName="DescriptionList"},3939:(e,t,l)=>{l.d(t,{d:()=>s});var a=l(34629),i=l(63696),n=l(91106),r=l(62634);const s=e=>{var{children:t=null,className:l}=e,s=(0,a.__rest)(e,["children","className"]);return i.createElement("dd",Object.assign({className:(0,r.A)(n.A.descriptionListDescription,l)},s),i.createElement("div",{className:(0,r.A)(n.A.descriptionListText)},t))};s.displayName="DescriptionListDescription"},24974:(e,t,l)=>{l.d(t,{W:()=>s});var a=l(34629),i=l(63696),n=l(91106),r=l(62634);const s=e=>{var{className:t,children:l}=e,s=(0,a.__rest)(e,["className","children"]);return i.createElement("div",Object.assign({className:(0,r.A)(n.A.descriptionListGroup,t)},s),l)};s.displayName="DescriptionListGroup"},21639:(e,t,l)=>{l.d(t,{X:()=>s});var a=l(34629),i=l(63696),n=l(91106),r=l(62634);const s=e=>{var{children:t,className:l,icon:s}=e,o=(0,a.__rest)(e,["children","className","icon"]);return i.createElement("dt",Object.assign({className:(0,r.A)(n.A.descriptionListTerm,l)},o),s?i.createElement("span",{className:(0,r.A)(n.A.descriptionListTermIcon)},s):null,i.createElement("span",{className:(0,r.A)(n.A.descriptionListText)},t))};s.displayName="DescriptionListTerm"},23546:(e,t,l)=>{l.d(t,{o:()=>h});var a=l(34629),i=l(63696),n=l(96660),r=l(42577),s=l(62634),o=l(77635),c=l(891),m=l(85310),d=l(84632),u=l(44551),p=l(40066);class h extends i.Component{constructor(e){super(e),this.headingRef=i.createRef(),this.toggleCollapse=()=>{this.setState((e=>({isOpen:!e.isOpen,isTooltipVisible:Boolean(this.headingRef.current&&this.headingRef.current.offsetWidth<this.headingRef.current.scrollWidth)})))},this.state={isOpen:this.props.defaultIsOpen,isTooltipVisible:!1}}componentDidMount(){this.setState({isTooltipVisible:Boolean(this.headingRef.current&&this.headingRef.current.offsetWidth<this.headingRef.current.scrollWidth)})}renderLabel(e){const{categoryName:t,tooltipPosition:l}=this.props,{isTooltipVisible:a}=this.state;return a?i.createElement(m.m,{position:l,content:t},i.createElement("span",{tabIndex:0,ref:this.headingRef,className:(0,s.A)(n.A.labelGroupLabel)},i.createElement("span",{"aria-hidden":"true",id:e},t))):i.createElement("span",{ref:this.headingRef,className:(0,s.A)(n.A.labelGroupLabel),"aria-hidden":"true",id:e},t)}render(){const e=this.props,{categoryName:t,children:l,className:m,isClosable:h,isCompact:E,closeBtnAriaLabel:b,"aria-label":f,onClick:g,numLabels:y,expandedText:v,collapsedText:A,defaultIsOpen:C,tooltipPosition:T,isVertical:x,isEditable:N,hasEditableTextArea:_,editableTextAreaProps:O,addLabelControl:L}=e,P=(0,a.__rest)(e,["categoryName","children","className","isClosable","isCompact","closeBtnAriaLabel","aria-label","onClick","numLabels","expandedText","collapsedText","defaultIsOpen","tooltipPosition","isVertical","isEditable","hasEditableTextArea","editableTextAreaProps","addLabelControl"]),{isOpen:S}=this.state,I=i.Children.toArray(l),k=I.length,w=(0,u.ou)(A,{remaining:k-y}),F=e=>{const l=S?I:I.slice(0,y),a=i.createElement(i.Fragment,null,t&&this.renderLabel(e),i.createElement("ul",Object.assign({className:(0,s.A)(n.A.labelGroupList)},t&&{"aria-labelledby":e},!t&&{"aria-label":f},{role:"list"},P),l.map(((e,t)=>i.createElement("li",{className:(0,s.A)(n.A.labelGroupListItem),key:t},e))),k>y&&i.createElement("li",{className:(0,s.A)(n.A.labelGroupListItem)},i.createElement(c.J,{isOverflowLabel:!0,onClick:this.toggleCollapse,className:(0,s.A)(E&&r.A.modifiers.compact)},S?v:w)),L&&i.createElement("li",{className:(0,s.A)(n.A.labelGroupListItem)},L),N&&_&&i.createElement("li",{className:(0,s.A)(n.A.labelGroupListItem,n.A.modifiers.textarea)},i.createElement("textarea",Object.assign({className:(0,s.A)(n.A.labelGroupTextarea),rows:1,tabIndex:0},O))))),u=i.createElement("div",{className:(0,s.A)(n.A.labelGroupClose)},i.createElement(o.$n,{variant:"plain","aria-label":b,onClick:g,id:`remove_group_${e}`,"aria-labelledby":`remove_group_${e} ${e}`},i.createElement(d.Ay,{"aria-hidden":"true"})));return i.createElement("div",{className:(0,s.A)(n.A.labelGroup,m,t&&n.A.modifiers.category,x&&n.A.modifiers.vertical,N&&n.A.modifiers.editable)},i.createElement("div",{className:(0,s.A)(n.A.labelGroupMain)},a),h&&u)};return 0===k&&void 0===L?null:i.createElement(p.N,null,(e=>F(this.props.id||e)))}}h.displayName="LabelGroup",h.defaultProps={expandedText:"Show Less",collapsedText:"${remaining} more",categoryName:"",defaultIsOpen:!1,numLabels:3,isClosable:!1,isCompact:!1,onClick:e=>{},closeBtnAriaLabel:"Close label group",tooltipPosition:"top","aria-label":"Label group category",isVertical:!1,isEditable:!1,hasEditableTextArea:!1}},71743:(e,t,l)=>{l.d(t,{P:()=>u});var a=l(34629),i=l(63696);const n="pf-v5-c-truncate__end",r="pf-v5-c-truncate__start";var s,o=l(62634),c=l(85310);!function(e){e.start="start",e.end="end",e.middle="middle"}(s||(s={}));const m={start:n,end:r},d=(e,t)=>[e.slice(0,e.length-t),e.slice(-t)],u=e=>{var{className:t,position:l="end",tooltipPosition:u="top",trailingNumChars:p=7,content:h}=e,E=(0,a.__rest)(e,["className","position","tooltipPosition","trailingNumChars","content"]);return i.createElement(c.m,{position:u,content:h},i.createElement("span",Object.assign({className:(0,o.A)("pf-v5-c-truncate",t)},E),(l===s.end||l===s.start)&&i.createElement("span",{className:m[l]},h,l===s.start&&i.createElement(i.Fragment,null,"â€Ž")),l===s.middle&&h.slice(0,h.length-p).length>12&&i.createElement(i.Fragment,null,i.createElement("span",{className:r},d(h,p)[0]),i.createElement("span",{className:n},d(h,p)[1])),l===s.middle&&h.slice(0,h.length-p).length<=12&&h))};u.displayName="Truncate"},78833:(e,t,l)=>{l.d(t,{Y:()=>E});var a=l(63696),i=l(49348),n=l(34066),r=l(65753),s=l(24974),o=l(21639),c=l(3939),m=l(77635),d=l(92939),u=l(22671),p=l(67837),h=l(24417);const E=({sbomId:e})=>{const{sbom:t,isFetching:l,fetchError:E}=(0,u.rj)(e);return a.createElement(h.a,{isFetching:l,fetchError:E},a.createElement(r.B,null,a.createElement(s.W,null,a.createElement(o.X,null,"Name"),a.createElement(c.d,null,a.createElement(m.$n,{variant:"link",isInline:!0,icon:a.createElement(d.Ay,null)},a.createElement(i.k2,{to:`/sboms/${e}`},t?.name)))),a.createElement(s.W,null,a.createElement(o.X,null,"Published"),a.createElement(c.d,null,(0,n.Yq)(t?.published))),a.createElement(s.W,null,a.createElement(o.X,null,"Labels"),a.createElement(c.d,null,t?.labels&&a.createElement(p.g,{defaultIsOpen:!0,value:t?.labels})))))}},40124:(e,t,l)=>{l.r(t),l.d(t,{default:()=>J});var a=l(63696),i=l(49348),n=l(68430),r=l(98261),s=l(75530),o=l(1180),c=l(72785),m=l(23665),d=l(70414),u=l(8210),p=l(2620),h=l(80876),E=l(17993),b=l(34066),f=l(20653),g=l(35048),y=l(4433),v=l(77635),A=l(28341),C=l(341),T=l(85578),x=l(16646),N=l(31065),_=l(77819),O=l(28516),L=l(3629),P=l(86820),S=l(33273),I=l(67837),k=l(77307),w=l(78833),F=l(1349),z=l(62520),K=l(70611),M=l(5098),G=l(22671);const j=({packageId:e})=>{const[t,l]=a.useState(null),[i,n]=a.useState(null),r=(0,K.MM)({tableName:"sboms",persistenceKeyPrefix:P.rt.sboms_by_package,columnNames:{name:"Name",published:"Published",labels:"Labels"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:S.RJ.search}]}),{result:{data:s,total:c},isFetching:m,fetchError:d}=(0,G.Qr)(e,(0,K.Ng)({...r,hubSortFieldKeys:{}})),u=(0,K.PB)({...r,idProperty:"id",currentPageItems:s,totalItemCount:c,isLoading:m,selectionState:(0,M.$)({items:s,isEqual:(e,t)=>e.id===t.id})}),{numRenderedColumns:p,currentPageItems:h,propHelpers:{toolbarProps:E,filterToolbarProps:j,paginationToolbarItemProps:$,paginationProps:R,tableProps:W,getThProps:V,getTrProps:B,getTdProps:X}}=u;return a.createElement(a.Fragment,null,a.createElement(f.M,{...E},a.createElement(g.P,null,a.createElement(S.Us,{showFiltersSideBySide:!0,...j}),a.createElement(y.T,{...$},a.createElement(F.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:R})))),a.createElement(T.X,{...W,"aria-label":"SBOM table"},a.createElement(x.d,null,a.createElement(N.Tr,null,a.createElement(z.Ze,{...u},a.createElement(_.Th,{...V({columnKey:"name"})}),a.createElement(_.Th,{...V({columnKey:"published"})}),a.createElement(_.Th,{...V({columnKey:"labels"})})))),a.createElement(z.nJ,{isLoading:m,isError:!!d,isNoData:0===c,numRenderedColumns:p},h?.map((e=>a.createElement(O.N,{key:e.id},a.createElement(N.Tr,{...B({item:e})},a.createElement(L.Td,{width:35,...X({columnKey:"name"})},a.createElement(v.$n,{size:"sm",variant:v.Ak.secondary,onClick:()=>{return t=e,l("showSbom"),void n(t);var t}},e.name)),a.createElement(L.Td,{width:10,modifier:"truncate",...X({columnKey:"published"})},(0,b.Yq)(e.published)),a.createElement(L.Td,{width:35,modifier:"truncate",...X({columnKey:"labels"})},e.labels&&a.createElement(I.g,{value:e.labels})))))))),a.createElement(F.n,{idPrefix:"sboms-table",isTop:!1,isCompact:!0,paginationProps:R}),a.createElement(k.q,{isExpanded:null!==t,onCloseClick:()=>l(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:a.createElement(a.Fragment,null,"showSbom"===t&&a.createElement(o.n,null,a.createElement(A.h,{headingLevel:"h2",size:"lg",className:C.A.mtXs},"Advisory")))},"showSbom"===t&&a.createElement(a.Fragment,null,i&&a.createElement(w.Y,{sbomId:i.id}))))};var $=l(891),R=l(81230),W=l(80863),V=l(52302),B=l(15311),X=l(38574);const D=({packageId:e})=>{const[t,l]=a.useState(null),[i,n]=a.useState(null),r=(e,t)=>{l(e),n(t)},{pkg:s,isFetching:c,fetchError:m}=(0,E.Si)(e),[d,u]=a.useState([]),[p,h]=a.useState(new Map),[b,P]=a.useState(!1),[I,w]=a.useState(new Set);a.useEffect((()=>{const e=(s?.advisories??[]).flatMap((e=>e.status.map((t=>({vulnerabilityId:t.vulnerability.identifier,status:t.status,context:{...t.context},advisory:{...e}}))))).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]),t=new Set;e.forEach((e=>t.add(e.status))),u(e),w(t),P(!0),Promise.all(e.map((e=>(0,R.ld)(e.vulnerabilityId))).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),l=new Map;t.forEach((e=>l.set(e.identifier,e))),h(l),P(!1)}))}),[s]);const M=a.useMemo((()=>d.map((e=>({...e,vulnerability:p.get(e.vulnerabilityId)})))),[d,p]),G=(0,B.f)(M,(e=>`${e.vulnerabilityId}-${e.advisory.identifier}-${e.advisory.uuid}`)),j=(0,K.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:G,isLoading:!1,columnNames:{identifier:"Identifier",title:"Title",severity:"Severity",advisory:"Advisory",context:"Context",status:"Status"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.vulnerabilityId}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:S.RJ.search,getItemValue:e=>e.vulnerabilityId},{categoryKey:"status",title:"Status",placeholderText:"Status",type:S.RJ.multiselect,selectOptions:Array.from(I).map((e=>({value:e,label:e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")}))),matcher:(e,t)=>t.status===e}],isExpansionEnabled:!1}),{currentPageItems:D,numRenderedColumns:J,propHelpers:{toolbarProps:q,filterToolbarProps:H,paginationToolbarItemProps:Y,paginationProps:U,tableProps:Q,getThProps:Z,getTrProps:ee,getTdProps:te},expansionDerivedState:{isCellExpanded:le}}=j;return a.createElement(a.Fragment,null,a.createElement(f.M,{...q},a.createElement(g.P,null,a.createElement(S.Us,{showFiltersSideBySide:!0,...H}),a.createElement(y.T,{...Y},a.createElement(F.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:U})))),a.createElement(T.X,{...Q,"aria-label":"vulnerability table"},a.createElement(x.d,null,a.createElement(N.Tr,null,a.createElement(z.Ze,{...j},a.createElement(_.Th,{...Z({columnKey:"identifier"})}),a.createElement(_.Th,{...Z({columnKey:"title"})}),a.createElement(_.Th,{...Z({columnKey:"severity"})}),a.createElement(_.Th,{...Z({columnKey:"advisory"})}),a.createElement(_.Th,{...Z({columnKey:"context"})}),a.createElement(_.Th,{...Z({columnKey:"status"})})))),a.createElement(z.nJ,{isLoading:c||b,isError:!!m,isNoData:0===G.length,numRenderedColumns:J},D?.map(((e,t)=>a.createElement(O.N,{key:e._ui_unique_id,isExpanded:le(e)},a.createElement(N.Tr,{...ee({item:e})},a.createElement(z.Oi,{...j,item:e,rowIndex:t},a.createElement(L.Td,{width:15,...te({columnKey:"identifier"})},a.createElement(v.$n,{size:"sm",variant:v.Ak.secondary,onClick:()=>r("showVulnerability",e)},e.vulnerabilityId)),a.createElement(L.Td,{width:35,modifier:"truncate",...te({columnKey:"title"})},e.vulnerability?.title),a.createElement(L.Td,{width:10,...te({columnKey:"severity"})},e.vulnerability?.average_severity&&a.createElement(V.h,{value:e.vulnerability.average_severity})),a.createElement(L.Td,{width:15,modifier:"truncate",...te({columnKey:"advisory"})},a.createElement(v.$n,{size:"sm",variant:v.Ak.secondary,onClick:()=>r("showAdvisory",e)},e.advisory.identifier)),a.createElement(L.Td,{width:25,modifier:"truncate",...te({columnKey:"context"})},e.context.cpe),a.createElement(L.Td,{width:10,modifier:"truncate",...te({columnKey:"status"})},a.createElement($.J,null,e.status.charAt(0).toUpperCase()+e.status.slice(1).replace("_"," ")))))))))),a.createElement(F.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:U}),a.createElement(k.q,{isExpanded:null!==t,onCloseClick:()=>l(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:a.createElement(a.Fragment,null,"showVulnerability"===t&&a.createElement(o.n,null,a.createElement(A.h,{headingLevel:"h2",size:"lg",className:C.A.mtXs},"Vulnerability")),"showAdvisory"===t&&a.createElement(o.n,null,a.createElement(A.h,{headingLevel:"h2",size:"lg",className:C.A.mtXs},"Advisory")))},"showVulnerability"===t&&a.createElement(a.Fragment,null,i?.advisory&&a.createElement(X.J,{vulnerabilityId:i?.vulnerabilityId}))," ","showAdvisory"===t&&a.createElement(a.Fragment,null,i?.advisory&&a.createElement(W.c,{advisoryId:i?.advisory.uuid}))))},J=()=>{const e=(0,h.Lu)(h.vO.PACKAGE_ID),{pkg:t}=(0,E.Si)(e),l=a.useMemo((()=>t?(0,b.fe)(t.purl):void 0),[t]);return a.createElement(a.Fragment,null,a.createElement(n.d8,{variant:"light"},a.createElement(p.A,{breadcrumbs:a.createElement(r.Q,null,a.createElement(s.J,{key:"packages"},a.createElement(i.N_,{to:"/packages"},"Packages")),a.createElement(s.J,{isActive:!0},"Package details")),pageHeading:{title:l?.name??e??"",iconAfterTitle:t?a.createElement(o.n,null,a.createElement(c.E,{component:"pre"},`version: ${l?.version}`)):void 0,label:t?{children:t?`type=${l?.type}`:"",isCompact:!0}:void 0},actionButtons:[],tabs:[{eventKey:"vulnerabilities",title:"Vulnerabilities",children:a.createElement("div",{className:"pf-v5-u-m-md"},e&&a.createElement(D,{packageId:e})),actions:a.createElement(a.Fragment,null,a.createElement(m.A,{bodyContent:a.createElement("div",null,"Vulnerabilities ",a.createElement("strong",null,"associated")," to the current package."),position:"top"},a.createElement(d.o,null,a.createElement(u.Ay,null))))},{eventKey:"sboms",title:"SBOMs",children:a.createElement("div",{className:"pf-v5-u-m-md"},e&&a.createElement(j,{packageId:e})),actions:a.createElement(a.Fragment,null,a.createElement(m.A,{bodyContent:a.createElement("div",null,"SBOMs that ",a.createElement("strong",null,"contain")," the current package."),position:"top"},a.createElement(d.o,null,a.createElement(u.Ay,null))))}]})))}},91106:(e,t,l)=>{l.d(t,{A:()=>a});const a={card:"pf-v5-c-card",descriptionList:"pf-v5-c-description-list",descriptionListDescription:"pf-v5-c-description-list__description",descriptionListGroup:"pf-v5-c-description-list__group",descriptionListTerm:"pf-v5-c-description-list__term",descriptionListTermIcon:"pf-v5-c-description-list__term-icon",descriptionListText:"pf-v5-c-description-list__text",modifiers:{inlineGrid:"pf-m-inline-grid",autoColumnWidths:"pf-m-auto-column-widths",autoFit:"pf-m-auto-fit",compact:"pf-m-compact",fluid:"pf-m-fluid",fillColumns:"pf-m-fill-columns",displayLg:"pf-m-display-lg",display_2xl:"pf-m-display-2xl",helpText:"pf-m-help-text","1Col":"pf-m-1-col","2Col":"pf-m-2-col","3Col":"pf-m-3-col",horizontal:"pf-m-horizontal",vertical:"pf-m-vertical","1ColOnSm":"pf-m-1-col-on-sm","2ColOnSm":"pf-m-2-col-on-sm","3ColOnSm":"pf-m-3-col-on-sm",horizontalOnSm:"pf-m-horizontal-on-sm",verticalOnSm:"pf-m-vertical-on-sm","1ColOnMd":"pf-m-1-col-on-md","2ColOnMd":"pf-m-2-col-on-md","3ColOnMd":"pf-m-3-col-on-md",horizontalOnMd:"pf-m-horizontal-on-md",verticalOnMd:"pf-m-vertical-on-md","1ColOnLg":"pf-m-1-col-on-lg","2ColOnLg":"pf-m-2-col-on-lg","3ColOnLg":"pf-m-3-col-on-lg",horizontalOnLg:"pf-m-horizontal-on-lg",verticalOnLg:"pf-m-vertical-on-lg","1ColOnXl":"pf-m-1-col-on-xl","2ColOnXl":"pf-m-2-col-on-xl","3ColOnXl":"pf-m-3-col-on-xl",horizontalOnXl:"pf-m-horizontal-on-xl",verticalOnXl:"pf-m-vertical-on-xl","1ColOn_2xl":"pf-m-1-col-on-2xl","2ColOn_2xl":"pf-m-2-col-on-2xl","3ColOn_2xl":"pf-m-3-col-on-2xl",horizontalOn_2xl:"pf-m-horizontal-on-2xl",verticalOn_2xl:"pf-m-vertical-on-2xl"}}}}]);
//# sourceMappingURL=907.c2a9cb24.min.js.map