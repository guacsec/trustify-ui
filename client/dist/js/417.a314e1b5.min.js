"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[417],{93962:(e,t,a)=>{a.d(t,{J:()=>x});var n=a(34629),l=a(63696);const r="pf-v5-c-label__content",i="pf-m-compact",c="pf-m-blue",s="pf-m-green",o="pf-m-orange",m="pf-m-red",u="pf-m-purple",d="pf-m-cyan",E="pf-m-gold",p="pf-m-outline",b="pf-m-overflow",f="pf-m-editable-active",v="pf-m-disabled",g="pf-m-editable";var y=a(77635),h=a(26615),P=a(62634),T=a(53025),S=a(99847);const k="--pf-v5-c-label__text--MaxWidth",C={blue:c,cyan:d,green:s,orange:o,purple:u,red:m,gold:E,grey:""},x=e=>{var{children:t,className:a="",color:c="grey",variant:s="filled",isCompact:o=!1,isDisabled:m=!1,isEditable:u=!1,editableProps:d,textMaxWidth:E,tooltipPosition:x,icon:F,onClose:B,onClick:_,onEditCancel:N,onEditComplete:A,closeBtn:I,closeBtnAriaLabel:M,closeBtnProps:O,href:w,isOverflowLabel:K,render:L}=e,q=(0,n.__rest)(e,["children","className","color","variant","isCompact","isDisabled","isEditable","editableProps","textMaxWidth","tooltipPosition","icon","onClose","onClick","onEditCancel","onEditComplete","closeBtn","closeBtnAriaLabel","closeBtnProps","href","isOverflowLabel","render"]);const[D,j]=(0,l.useState)(!1),[$,R]=(0,l.useState)(t),V=l.useRef(),W=l.useRef();l.useEffect((()=>(document.addEventListener("mousedown",X),document.addEventListener("keydown",Z),()=>{document.removeEventListener("mousedown",X),document.removeEventListener("keydown",Z)}))),l.useEffect((()=>{_&&w?console.warn("Link labels cannot have onClick passed, this results in invalid HTML. Please remove either the href or onClick prop."):_&&u&&console.warn("Editable labels cannot have onClick passed, clicking starts the label edit process. Please remove either the isEditable or onClick prop.")}),[_,w,u]);const X=e=>{D&&W&&W.current&&!W.current.contains(e.target)&&(W.current.value&&A&&A(e,W.current.value),j(!1))},Z=e=>{var a,n;const l=e.key;if((D||V&&V.current&&V.current.contains(e.target))&&(!D||W&&W.current&&W.current.contains(e.target))&&(!D||"Enter"!==l&&"Tab"!==l||(e.preventDefault(),e.stopImmediatePropagation(),W.current.value&&A&&A(e,W.current.value),j(!1),null===(a=null==V?void 0:V.current)||void 0===a||a.focus()),D&&"Escape"===l&&(e.preventDefault(),e.stopImmediatePropagation(),W.current.value&&(W.current.value=t,N&&N(e,t)),j(!1),null===(n=null==V?void 0:V.current)||void 0===n||n.focus()),!D&&"Enter"===l)){e.preventDefault(),e.stopImmediatePropagation(),j(!0);const t=e.target,a=document.createRange(),n=window.getSelection();a.selectNodeContents(t),a.collapse(!1),n.removeAllRanges(),n.addRange(a)}},Y=(w||_)&&m,H=l.createElement(y.$n,Object.assign({type:"button",variant:"plain",onClick:B,"aria-label":M||`Close ${t}`},Y&&{isDisabled:!0},O),l.createElement(T.Ay,null)),z=l.createElement("span",{className:(0,P.A)("pf-v5-c-label__actions")},I||H),J=l.createRef(),G=l.useRef(),[Q,U]=l.useState(!1);(0,S.E)((()=>{const e=u?V:J;D||U(e.current&&e.current.offsetWidth<e.current.scrollWidth)}),[D]);const ee=l.createElement(l.Fragment,null,F&&l.createElement("span",{className:(0,P.A)("pf-v5-c-label__icon")},F),l.createElement("span",Object.assign({ref:J,className:(0,P.A)("pf-v5-c-label__text")},E&&{style:{[k]:E}}),t));l.useEffect((()=>{D&&W&&W.current&&W.current.focus()}),[W,D]);let te="span";w?te="a":(u||_&&!K)&&(te="button");const ae={type:"button",onClick:_},ne="button"===te,le=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({className:(0,P.A)(r)},Q&&{tabIndex:0}),w&&{href:w}),w&&m&&{onClick:e=>e.preventDefault()}),ne&&ae),u&&Object.assign({ref:V,onClick:e=>{j(!0),e.stopPropagation()}},d)),Y&&ne&&{disabled:!0}),Y&&w&&{tabIndex:-1,"aria-disabled":!0});let re=l.createElement(te,Object.assign({},le),ee);L?re=l.createElement(l.Fragment,null,Q&&l.createElement(h.m,{triggerRef:G,content:t,position:x}),L({className:r,content:ee,componentRef:G})):Q&&(re=l.createElement(h.m,{content:t,position:x},re));const ie=K?"button":"span";return l.createElement(ie,Object.assign({},q,{className:(0,P.A)("pf-v5-c-label",Y&&v,C[c],"outline"===s&&p,K&&b,o&&i,u&&g,D&&f,a),onClick:K?_:void 0},"button"===ie&&{type:"button"}),!D&&re,!D&&B&&z,D&&l.createElement("input",Object.assign({className:(0,P.A)(r),type:"text",id:"editable-input",ref:W,value:$,onChange:()=>{R(W.current.value)}},d)))};x.displayName="Label"},94279:(e,t,a)=>{a.d(t,{B8:()=>m});var n,l,r,i=a(34629),c=a(63696),s=a(38740),o=a(62634);!function(e){e.number="1",e.lowercaseLetter="a",e.uppercaseLetter="A",e.lowercaseRomanNumber="i",e.uppercaseRomanNumber="I"}(n||(n={})),function(e){e.inline="inline"}(l||(l={})),function(e){e.ol="ol",e.ul="ul"}(r||(r={}));const m=e=>{var{className:t="",children:a=null,variant:l=null,isBordered:m=!1,isPlain:u=!1,iconSize:d="default",type:E=n.number,ref:p=null,component:b=r.ul}=e,f=(0,i.__rest)(e,["className","children","variant","isBordered","isPlain","iconSize","type","ref","component"]);return b===r.ol?c.createElement("ol",Object.assign({ref:p,type:E},u&&{role:"list"},f,{className:(0,o.A)(s.A.list,l&&s.A.modifiers[l],m&&s.A.modifiers.bordered,u&&s.A.modifiers.plain,d&&"large"===d&&s.A.modifiers.iconLg,t)}),a):c.createElement("ul",Object.assign({ref:p},u&&{role:"list"},f,{className:(0,o.A)(s.A.list,l&&s.A.modifiers[l],m&&s.A.modifiers.bordered,u&&s.A.modifiers.plain,d&&"large"===d&&s.A.modifiers.iconLg,t)}),a)};m.displayName="List"},16172:(e,t,a)=>{a.d(t,{c:()=>c});var n=a(34629),l=a(63696),r=a(38740),i=a(62634);const c=e=>{var{icon:t=null,children:a=null}=e,c=(0,n.__rest)(e,["icon","children"]);return l.createElement("li",Object.assign({className:(0,i.A)(t&&r.A.listItem)},c),t&&l.createElement("span",{className:(0,i.A)(r.A.listItemIcon)},t),a)};c.displayName="ListItem"},48783:(e,t,a)=>{a.d(t,{Ay:()=>n});const n=(0,a(32791).w)({name:"DownloadIcon",height:512,width:512,svgPath:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",yOffset:0,xOffset:0})},38139:(e,t,a)=>{a.d(t,{g:()=>c});var n=a(34629),l=a(63696),r=a(62634),i=a(89863);const c=e=>{var{children:t=null}=e,a=(0,n.__rest)(e,["children"]);return l.createElement("div",Object.assign({},a,{className:(0,r.A)(i.A.tableExpandableRowContent)}),t)};c.displayName="ExpandableRowContent"},16177:(e,t,a)=>{a.d(t,{a:()=>r});var n=a(63696),l=a(93962);const r=({value:e})=>n.createElement(n.Fragment,null,Object.entries(e).map((([e,t],a)=>n.createElement(l.J,{key:a,isCompact:!0},`${e}=${t}`))))},27473:(e,t,a)=>{a.d(t,{Y:()=>i});var n=a(63696),l=a(18045),r=a(55399);const i=({vulnerabilitiesSummary:e})=>{const t=n.useMemo((()=>Object.keys(e.severities).map((t=>{const a=t,n=e.severities[a],l=r.Kb[a];return{severity:a,count:n,label:l.name,color:l.color.value}})).sort((0,r.Sx)((e=>e.severity)))),[e]);return n.createElement("div",{style:{height:"230px",maxWidth:"350px"}},n.createElement(l.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${e.total}`,subTitle:"Total vulnerabilities",width:350,legendData:t.map((({label:e,count:t})=>({name:`${e}: ${t}`}))),data:t.map((({label:e,count:t})=>({x:e,y:t}))),labels:({datum:e})=>`${e.x}: ${e.y}`,colorScale:t.map((({color:e})=>e))}))}},89101:(e,t,a)=>{a.d(t,{U:()=>o,n:()=>m});var n=a(63696),l=a(91728);const r=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,i={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:{...i},fixed:{...i},not_affected:{...i},known_not_affected:{...i}}},s=e=>{const t=e.flatMap((e=>(e.status??[]).map((t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))).reduce(((e,t)=>{const a=e.find((e=>r(e,t)));if(a)return[...e.filter((e=>!r(e,a))),{...a,relatedPackages:[...a.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];{const a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};return[...e,a]}}),[]))),a=t.reduce(((e,t)=>{const a=t.vulnerabilityStatus,n=t.vulnerability.average_severity,l=e.vulnerabilityStatus[a];return{...e,vulnerabilityStatus:{...e.vulnerabilityStatus,[a]:{total:l.total+1,severities:{...l.severities,[n]:l.severities[n]+1}}}}}),c);return{vulnerabilities:t,summary:a}},o=e=>{const{advisories:t,isFetching:a,fetchError:r}=(0,l.DH)(e);return{data:n.useMemo((()=>s(t||[])),[t]),isFetching:a,fetchError:r}},m=e=>{const{advisories:t,isFetching:a,fetchError:r}=(0,l.zY)(e);return{data:n.useMemo((()=>(t??[]).map((e=>s(e||[])))),[t]),isFetching:a,fetchError:r}}},14671:(e,t,a)=>{a.r(t),a.d(t,{default:()=>be});var n=a(63696),l=a(68430),r=a(54518),i=a(48281),c=a(28338),s=a(70045),o=a(1180),m=a(72785),u=a(93962),d=a(77635),E=a(16459),p=a(71592),b=a(40111),f=a(70414),v=a(69673),g=a(10015),y=a(48783),h=a(8210),P=a(80876),T=a(24417),S=a(91271),k=a(91728),C=a(70028),x=a(76072),F=a(97299),B=a(17327),_=a(64361),N=a(71603),A=a(65753),I=a(24974),M=a(21639),O=a(3939),w=a(94279),K=a(16172),L=a(34066);const q=({sbom:e})=>n.createElement(x.x,{hasGutter:!0},n.createElement(F.E,{md:4},n.createElement(B.Z,{isFullHeight:!0},n.createElement(_.Z,null,"Metadata"),n.createElement(N.b,null,n.createElement(A.B,null,n.createElement(I.W,null,n.createElement(M.X,null,"Name"),n.createElement(O.d,{"aria-label":"SBOM's name"},e.name)),n.createElement(I.W,null,n.createElement(M.X,null,"Namespace"),n.createElement(O.d,{"aria-label":"SBOM's namespace"},e.document_id)),n.createElement(I.W,null,n.createElement(M.X,null,"Data License"),n.createElement(O.d,{"aria-label":"SBOM's license"},e.data_licenses.join(", "))))))),n.createElement(F.E,{md:4},n.createElement(B.Z,{isFullHeight:!0},n.createElement(_.Z,null,"Creation"),n.createElement(N.b,null,n.createElement(A.B,null,n.createElement(I.W,null,n.createElement(M.X,null,"Created"),n.createElement(O.d,{"aria-label":"SBOM's creation date"},(0,L.Yq)(e.published))),n.createElement(I.W,null,n.createElement(M.X,null,"Creator"),n.createElement(O.d,{"aria-label":"SBOM's creator"},e.authors)))))),n.createElement(F.E,{md:4},n.createElement(B.Z,{isFullHeight:!0},n.createElement(_.Z,null,"Statistics"),n.createElement(N.b,null,n.createElement(A.B,null,n.createElement(I.W,null,n.createElement(M.X,null,"Size"),n.createElement(O.d,null,(0,C.A)(e.size))),n.createElement(I.W,null,n.createElement(M.X,null,"Packages"),n.createElement(O.d,null,e.number_of_packages)))))),n.createElement(F.E,{md:12},n.createElement(B.Z,{isFullHeight:!0},n.createElement(_.Z,null,"Package"),n.createElement(N.b,null,n.createElement(A.B,null,n.createElement(I.W,null,n.createElement(M.X,null,"Name"),n.createElement(O.d,null,e.name)),n.createElement(I.W,null,n.createElement(M.X,null,"Version"),n.createElement(O.d,null,e.described_by.map((e=>e.version)).join(", "))),n.createElement(I.W,null,n.createElement(M.X,null,"External References"),n.createElement(O.d,null,n.createElement(w.B8,null,e.described_by.flatMap((e=>e.cpe)).map(((e,t)=>n.createElement(K.c,{key:t},e))),n.createElement(K.c,null,e.described_by.flatMap((e=>e.purl)).map((e=>e.purl)))))))))));var D=a(49348),j=a(20653),$=a(35048),R=a(4433),V=a(341),W=a(40319),X=a(16646),Z=a(9425),Y=a(77819),H=a(28516),z=a(3629),J=a(38139),G=a(87043),Q=a(16177),U=a(1349),ee=a(62520),te=a(70611),ae=a(17993);const ne=({sbomId:e})=>{const{result:{data:t},isFetching:a,fetchError:l}=(0,ae.sl)(e,{page:{pageNumber:1,itemsPerPage:0}}),r=(0,n.useMemo)((()=>t.flatMap((e=>e.purl)).map((e=>({...e,decomposedPurl:(0,L.fe)(e.purl)})))),[t]),i=(0,te.vY)({tableName:"package-table",idProperty:"uuid",items:r,isLoading:a,columnNames:{name:"Name",version:"Version",qualifiers:"Qualifiers"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","version"],getSortValues:e=>({name:`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`,version:e.version.version}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter tex",type:G.RJ.search,placeholderText:"Filter",getItemValue:e=>`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`||""}],isExpansionEnabled:!0,expandableVariant:"single"}),{currentPageItems:o,numRenderedColumns:m,propHelpers:{toolbarProps:d,filterToolbarProps:E,paginationToolbarItemProps:p,paginationProps:b,tableProps:f,getThProps:v,getTrProps:g,getTdProps:y,getExpandedContentTdProps:h},expansionDerivedState:{isCellExpanded:P}}=i;return n.createElement(n.Fragment,null,n.createElement(j.M,{...d},n.createElement($.P,null,n.createElement(G.Us,{showFiltersSideBySide:!0,...E}),n.createElement(R.T,{...p},n.createElement(U.n,{idPrefix:"package-table",isTop:!0,paginationProps:b})))),n.createElement(W.X,{...f,"aria-label":"Package table"},n.createElement(X.d,null,n.createElement(Z.Tr,null,n.createElement(ee.Ze,{...i},n.createElement(Y.Th,{...v({columnKey:"name"})}),n.createElement(Y.Th,{...v({columnKey:"version"})}),n.createElement(Y.Th,{...v({columnKey:"qualifiers"})})))),n.createElement(ee.nJ,{isLoading:a,isError:!!l,isNoData:0===r?.length,numRenderedColumns:m},o?.map(((e,t)=>n.createElement(H.N,{key:e.uuid},n.createElement(Z.Tr,{...g({item:e})},n.createElement(ee.Oi,{...i,item:e,rowIndex:t},n.createElement(z.Td,{width:30,...y({columnKey:"name"})},n.createElement(c.s,null,n.createElement(s.Z,{spacer:{default:"spacerSm"}},`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`),n.createElement(s.Z,null,n.createElement(u.J,{isCompact:!0,color:"blue"},e.decomposedPurl?.type)))),n.createElement(z.Td,{width:20,...y({columnKey:"version"})},e.decomposedPurl?.version),n.createElement(z.Td,{width:50,...y({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&n.createElement(Q.a,{value:e.decomposedPurl?.qualifiers})))),P(e)?n.createElement(Z.Tr,{isExpanded:!0},n.createElement(z.Td,null),n.createElement(z.Td,{...h({item:e}),className:V.A.pyLg},n.createElement(J.g,null,n.createElement(A.B,{columnModifier:{default:"3Col"}},n.createElement(I.W,null,n.createElement(M.X,null,"Packages"),n.createElement(O.d,null,n.createElement(w.B8,null,n.createElement(K.c,null,n.createElement(D.N_,{to:`/packages/${e.uuid}`},e.purl))))),n.createElement(I.W,null,n.createElement(M.X,null,"Base package"),n.createElement(O.d,null,e.base.purl)),n.createElement(I.W,null,n.createElement(M.X,null,"Versions"),n.createElement(O.d,null,n.createElement(w.B8,null,n.createElement(K.c,null,e.version.version)))))))):null))))),n.createElement(U.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:b}))};var le=a(95285),re=a.n(le),ie=a(38914),ce=a(57901),se=a(55399),oe=a(27473),me=a(11848),ue=a(23560),de=a(89101),Ee=a(15311);const pe=({sbomId:e})=>{const{sbom:t,isFetching:a,fetchError:l}=(0,k.rj)(e),{data:{vulnerabilities:r,summary:i},isFetching:c,fetchError:s}=(0,de.U)(e),o=n.useMemo((()=>r.filter((e=>"affected"===e.vulnerabilityStatus))),[r]),m=n.useMemo((()=>o.map((e=>{const t=e.relatedPackages.flatMap((e=>e.packages));return{...e,summary:{totalPackages:t.length,allPackages:t}}}))),[o]),u=(0,Ee.f)(m,(e=>`${e.vulnerability.identifier}-${e.vulnerabilityStatus}`)),d=(0,te.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:u,isLoading:c,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>({id:e.vulnerability.identifier,cvss:(0,se.YT)(e.vulnerability.average_severity),affectedDependencies:e.summary.totalPackages,published:e.vulnerability?.published?re()(e.vulnerability.published).valueOf():0,updated:e.vulnerability?.modified?re()(e.vulnerability.modified).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:E,numRenderedColumns:p,propHelpers:{toolbarProps:b,filterToolbarProps:f,paginationToolbarItemProps:v,paginationProps:g,tableProps:y,getThProps:h,getTrProps:P,getTdProps:S,getExpandedContentTdProps:C},expansionDerivedState:{isCellExpanded:_}}=d;return n.createElement(n.Fragment,null,n.createElement(ie.B,{hasGutter:!0},n.createElement(ce.a,null,n.createElement(B.Z,null,n.createElement(N.b,null,n.createElement(T.a,{isFetching:a||c,fetchError:l},n.createElement(x.x,{hasGutter:!0},n.createElement(F.E,{md:6},n.createElement(oe.Y,{vulnerabilitiesSummary:i.vulnerabilityStatus.affected})),n.createElement(F.E,{md:6},n.createElement(A.B,null,n.createElement(I.W,null,n.createElement(M.X,null,"Name"),n.createElement(O.d,null,t?.name)),n.createElement(I.W,null,n.createElement(M.X,null,"Version"),n.createElement(O.d,null,t?.described_by.map((e=>e.version)).join(", "))),n.createElement(I.W,null,n.createElement(M.X,null,"Creation date"),n.createElement(O.d,null,(0,L.Yq)(t?.published)))))))))),n.createElement(ce.a,null,n.createElement(j.M,{...b},n.createElement($.P,null,n.createElement(R.T,{...v},n.createElement(U.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:g})))),n.createElement(W.X,{...y,"aria-label":"Vulnerability table"},n.createElement(X.d,null,n.createElement(Z.Tr,null,n.createElement(ee.Ze,{...d},n.createElement(Y.Th,{...h({columnKey:"id"})}),n.createElement(Y.Th,{...h({columnKey:"description"})}),n.createElement(Y.Th,{...h({columnKey:"cvss"})}),n.createElement(Y.Th,{...h({columnKey:"affectedDependencies"})}),n.createElement(Y.Th,{...h({columnKey:"published"})}),n.createElement(Y.Th,{...h({columnKey:"updated"})})))),n.createElement(ee.nJ,{isLoading:c,isError:!!s,isNoData:0===u.length,numRenderedColumns:p},E?.map(((e,t)=>n.createElement(H.N,{key:e._ui_unique_id,isExpanded:_(e)},n.createElement(Z.Tr,{...P({item:e})},n.createElement(ee.Oi,{...d,item:e,rowIndex:t},n.createElement(z.Td,{width:15,...S({columnKey:"id"})},n.createElement(D.N_,{to:`/vulnerabilities/${e.vulnerability.identifier}`},e.vulnerability.identifier)),n.createElement(z.Td,{width:35,modifier:"truncate",...S({columnKey:"description"})},e.vulnerability&&n.createElement(ue.j,{vulnerability:e.vulnerability})),n.createElement(z.Td,{width:10,...S({columnKey:"cvss"})},e.vulnerability.average_severity&&n.createElement(me.h,{value:e.vulnerability.average_severity})),n.createElement(z.Td,{width:15,modifier:"truncate",...S({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:t})},e.summary.totalPackages),n.createElement(z.Td,{width:10,modifier:"truncate",...S({columnKey:"published"})},(0,L.Yq)(e.vulnerability?.published)),n.createElement(z.Td,{width:10,modifier:"truncate",...S({columnKey:"updated"})},(0,L.Yq)(e.vulnerability?.modified)))),_(e)?n.createElement(Z.Tr,{isExpanded:!0},n.createElement(z.Td,{...C({item:e})},n.createElement(J.g,null,_(e,"affectedDependencies")?n.createElement(n.Fragment,null,n.createElement(W.X,{variant:"compact"},n.createElement(X.d,null,n.createElement(Z.Tr,null,n.createElement(Y.Th,null,"Type"),n.createElement(Y.Th,null,"Namespace"),n.createElement(Y.Th,null,"Name"),n.createElement(Y.Th,null,"Version"),n.createElement(Y.Th,null,"Path"),n.createElement(Y.Th,null,"Qualifiers"))),n.createElement(H.N,null,e.summary.allPackages.flatMap((e=>e.name&&0==e.purl.length?[{parentName:e.name}]:e.purl.map((t=>({parentName:e.name,purlSummary:t}))))).map(((e,t)=>{if(e.purlSummary){const a=(0,L.fe)(e.purlSummary.purl);return n.createElement(Z.Tr,{key:`${t}-purl`},n.createElement(z.Td,null,a?.type),n.createElement(z.Td,null,a?.namespace),n.createElement(z.Td,null,n.createElement(D.N_,{to:`/packages/${e.purlSummary.uuid}`},a?.name)),n.createElement(z.Td,null,a?.version),n.createElement(z.Td,null,a?.path),n.createElement(z.Td,null,a?.qualifiers&&n.createElement(Q.a,{value:a?.qualifiers})))}return n.createElement(Z.Tr,{key:`${t}-name`},n.createElement(z.Td,null),n.createElement(z.Td,null),n.createElement(z.Td,null,e.parentName),n.createElement(z.Td,null),n.createElement(z.Td,null),n.createElement(z.Td,null))}))))):null))):null))))),n.createElement(U.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:g}))))},be=()=>{const[e,t]=n.useState(0),a=n.createRef(),C=n.createRef(),x=n.createRef(),F=n.createRef(),B=(0,P.Lu)(P.vO.SBOM_ID),{sbom:_,isFetching:N,fetchError:A}=(0,k.rj)(B),{downloadSBOM:I}=(0,S.m)();return n.createElement(n.Fragment,null,n.createElement(l.d8,{variant:"light"},n.createElement(r.B,null,n.createElement(i.o,{isFilled:!0},n.createElement(c.s,null,n.createElement(s.Z,{spacer:{default:"spacerSm"}},n.createElement(o.n,null,n.createElement(m.E,{component:"h1"},_?.name??B??""))),n.createElement(s.Z,null,_?.labels.type&&n.createElement(u.J,{color:"blue"},_?.labels.type)))),n.createElement(i.o,null,!N&&n.createElement(d.$n,{variant:"secondary",icon:n.createElement(y.Ay,null),onClick:()=>{B&&I(B,_?.name?`${_?.name}.json`:`${B}.json`)}},"Download")))),n.createElement(l.d8,{type:"nav"},n.createElement(E.t,{mountOnEnter:!0,activeKey:e,onSelect:(e,a)=>{t(a)},"aria-label":"Tabs that contain the SBOM information",role:"region"},n.createElement(p.o,{eventKey:0,title:n.createElement(b.V,null,"Info"),tabContentId:"refTabInfoSection",tabContentRef:a}),n.createElement(p.o,{eventKey:1,title:n.createElement(b.V,null,"Packages"),tabContentId:"refTabPackagesSection",tabContentRef:C}),n.createElement(p.o,{eventKey:2,title:n.createElement(b.V,null,"Vulnerabilities"),tabContentId:"refVulnerabilitiesSection",tabContentRef:x,actions:n.createElement(n.Fragment,null,n.createElement(f.o,{ref:F},n.createElement(h.Ay,null)),n.createElement(v.A,{triggerRef:F,bodyContent:n.createElement("div",null,"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed.")}))}))),n.createElement(l.d8,null,n.createElement(g.J,{eventKey:0,id:"refTabInfoSection",ref:a,"aria-label":"Information of the SBOM"},n.createElement(T.a,{isFetching:N,fetchError:A},_&&n.createElement(q,{sbom:_}))),n.createElement(g.J,{eventKey:1,id:"refTabPackagesSection",ref:C,"aria-label":"Packages within the SBOM",hidden:!0},B&&n.createElement(ne,{sbomId:B})),n.createElement(g.J,{eventKey:2,id:"refVulnerabilitiesSection",ref:x,"aria-label":"Vulnerabilities within the SBOM",hidden:!0},B&&n.createElement(pe,{sbomId:B}))))}},17993:(e,t,a)=>{a.d(t,{Lx:()=>s,Si:()=>o,sl:()=>m});var n=a(39155),l=a(77347),r=a(40752),i=a(70611);const c="packages",s=(e={},t=!1)=>{const{data:a,isLoading:s,error:o,refetch:m}=(0,n.I)({queryKey:[c,e],queryFn:()=>(0,r.UD8)({client:l.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e},isFetching:s,fetchError:o,refetch:m}},o=e=>{const{data:t,isLoading:a,error:i}=(0,n.I)({queryKey:[c,e],queryFn:()=>(0,r.Y06)({client:l.S,path:{key:e}})});return{pkg:t?.data,isFetching:a,fetchError:i}},m=(e,t={})=>{const{data:a,isLoading:s,error:o,refetch:m}=(0,n.I)({queryKey:[c,"by-sbom",e,t],queryFn:()=>(0,r.Ad7)({client:l.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:t},isFetching:s,fetchError:o,refetch:m}}},91728:(e,t,a)=>{a.d(t,{DH:()=>f,Qr:()=>b,i$:()=>d,rj:()=>E,sn:()=>p,zY:()=>v});var n=a(39155),l=a(3715),r=a(55037),i=a(77347),c=a(40752),s=a(24808),o=a(81230),m=a(70611);const u="sboms",d=(e={},t=!1)=>{const{data:a,isLoading:l,error:r,refetch:s}=(0,n.I)({queryKey:[u,e],queryFn:()=>(0,c.z1E)({client:i.S,query:{...(0,m.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e??e},isFetching:l,fetchError:r,refetch:s}},E=e=>{const{data:t,isLoading:a,error:l}=(0,n.I)({queryKey:[u,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,c.a7Q)({client:i.S,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:a,fetchError:l}},p=()=>{const e=(0,l.jE)();return(0,s.v)({parallel:!0,uploadFn:(e,t)=>(0,o.J4)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[u]})}})},b=(e,t={})=>{const{data:a,isLoading:l,error:r,refetch:s}=(0,n.I)({queryKey:["SBOMsQueryKeysss","by-package",e,t],queryFn:()=>(0,c.m9i)({client:i.S,query:{id:e,...(0,m.kd)(t)}})});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:t??t},isFetching:l,fetchError:r,refetch:s}},f=e=>{const{data:t,isLoading:a,error:l}=(0,n.I)({queryKey:[u,e,"advisory"],queryFn:()=>(0,c.bjx)({client:i.S,path:{id:e}})});return{advisories:t?.data||[],isFetching:a,fetchError:l}},v=e=>{const t=(0,r.E)({queries:e.map((e=>({queryKey:[u,e,"advisory"],queryFn:()=>(0,c.bjx)({client:i.S,path:{id:e}})})))});return{advisories:t.map((({data:e})=>e?.data||[])),isFetching:t.some((({isLoading:e})=>e)),fetchError:t.map((({error:e})=>e))}}},15311:(e,t,a)=>{a.d(t,{f:()=>r});var n=a(63696),l=a(86820);const r=(e,t)=>(0,n.useMemo)((()=>e&&0!==e.length?e.map((e=>({...e,[l.FA]:t(e)}))):[]),[e,t])},38740:(e,t,a)=>{a.d(t,{A:()=>n});const n={list:"pf-v5-c-list",listItem:"pf-v5-c-list__item",listItemIcon:"pf-v5-c-list__item-icon",modifiers:{iconLg:"pf-m-icon-lg",plain:"pf-m-plain",inline:"pf-m-inline",bordered:"pf-m-bordered"}}},70028:(e,t,a)=>{a.d(t,{A:()=>s});const n=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],l=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],r=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],i=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],c=(e,t,a)=>{let n=e;return"string"==typeof t||Array.isArray(t)?n=e.toLocaleString(t,a):!0!==t&&void 0===a||(n=e.toLocaleString(void 0,a)),n};function s(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);const a=(t={bits:!1,binary:!1,space:!0,...t}).bits?t.binary?i:r:t.binary?l:n,s=t.space?" ":"";if(t.signed&&0===e)return` 0${s}${a[0]}`;const o=e<0,m=o?"-":t.signed?"+":"";let u;if(o&&(e=-e),void 0!==t.minimumFractionDigits&&(u={minimumFractionDigits:t.minimumFractionDigits}),void 0!==t.maximumFractionDigits&&(u={maximumFractionDigits:t.maximumFractionDigits,...u}),e<1)return m+c(e,t.locale,u)+s+a[0];const d=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),a.length-1);return e/=(t.binary?1024:1e3)**d,u||(e=e.toPrecision(3)),m+c(Number(e),t.locale,u)+s+a[d]}}}]);
//# sourceMappingURL=417.a314e1b5.min.js.map