"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[994],{17327:(e,t,a)=>{a.d(t,{E:()=>o,Z:()=>c});var r=a(34629),l=a(63696),i=a(41775),n=a(62634),s=a(1850);const o=l.createContext({cardId:"",registerTitleId:()=>{},isExpanded:!1,isClickable:!1,isSelectable:!1,isSelected:!1,isClicked:!1,isDisabled:!1}),c=e=>{var{children:t,id:a="",className:d,component:u="div",isCompact:m=!1,isSelectable:p=!1,isClickable:f=!1,isDisabled:y=!1,isSelectableRaised:b=!1,isSelected:h=!1,isClicked:v=!1,isDisabledRaised:E=!1,isFlat:g=!1,isExpanded:C=!1,isRounded:k=!1,isLarge:S=!1,isFullHeight:P=!1,isPlain:T=!1,ouiaId:F,ouiaSafe:x=!0,hasSelectableInput:_=!1,selectableInputAriaLabel:I,onSelectableInputChange:K=()=>{}}=e,R=(0,r.__rest)(e,["children","id","className","component","isCompact","isSelectable","isClickable","isDisabled","isSelectableRaised","isSelected","isClicked","isDisabledRaised","isFlat","isExpanded","isRounded","isLarge","isFullHeight","isPlain","ouiaId","ouiaSafe","hasSelectableInput","selectableInputAriaLabel","onSelectableInputChange"]);const w=u,A=(0,s.iK)(c.displayName,F,x),[N,L]=l.useState(""),[D,V]=l.useState();m&&S&&(console.warn("Card: Cannot use isCompact with isLarge. Defaulting to isCompact"),S=!1);const M=l.useRef(!1);return l.useEffect((()=>{I?V({"aria-label":I}):N?V({"aria-labelledby":N}):_&&!M.current&&(V({}),console.warn("If no CardTitle component is passed as a child of Card the selectableInputAriaLabel prop must be passed"))}),[_,I,N]),l.createElement(o.Provider,{value:{cardId:a,registerTitleId:e=>{L(e),M.current=!!e},isExpanded:C,isClickable:f,isSelectable:p,isSelected:h,isClicked:v,isDisabled:y,hasSelectableInput:_}},_&&l.createElement("input",Object.assign({className:"pf-v5-screen-reader",id:`${a}-input`},D,{type:"checkbox",checked:h,onChange:e=>K(e,a),disabled:E,tabIndex:-1})),l.createElement(w,Object.assign({id:a,className:(0,n.A)(i.A.card,m&&i.A.modifiers.compact,C&&i.A.modifiers.expanded,g&&i.A.modifiers.flat,k&&i.A.modifiers.rounded,S&&i.A.modifiers.displayLg,P&&i.A.modifiers.fullHeight,T&&i.A.modifiers.plain,E?(0,n.A)(i.A.modifiers.nonSelectableRaised):b?(0,n.A)(i.A.modifiers.selectableRaised,h&&i.A.modifiers.selectedRaised):p&&f?(0,n.A)(i.A.modifiers.selectable,i.A.modifiers.clickable,(h||v)&&i.A.modifiers.current):p?(0,n.A)(i.A.modifiers.selectable,h&&i.A.modifiers.selected):f?(0,n.A)(i.A.modifiers.clickable,v&&i.A.modifiers.current):"",y&&i.A.modifiers.disabled,d),tabIndex:b?"0":void 0},R,A),t))};c.displayName="Card"},71603:(e,t,a)=>{a.d(t,{b:()=>s});var r=a(34629),l=a(63696),i=a(41775),n=a(62634);const s=e=>{var{children:t,className:a,component:s="div",isFilled:o=!0}=e,c=(0,r.__rest)(e,["children","className","component","isFilled"]);const d=s;return l.createElement(d,Object.assign({className:(0,n.A)(i.A.cardBody,!o&&i.A.modifiers.noFill,a)},c),t)};s.displayName="CardBody"},38914:(e,t,a)=>{a.d(t,{B:()=>s});var r=a(34629),l=a(63696),i=a(13364),n=a(62634);const s=e=>{var{hasGutter:t=!1,className:a="",children:s=null,component:o="div"}=e,c=(0,r.__rest)(e,["hasGutter","className","children","component"]);const d=o;return l.createElement(d,Object.assign({},c,{className:(0,n.A)(i.A.stack,t&&i.A.modifiers.gutter,a)}),s)};s.displayName="Stack"},57901:(e,t,a)=>{a.d(t,{a:()=>s});var r=a(34629),l=a(63696),i=a(13364),n=a(62634);const s=e=>{var{isFilled:t=!1,className:a="",children:s=null}=e,o=(0,r.__rest)(e,["isFilled","className","children"]);return l.createElement("div",Object.assign({},o,{className:(0,n.A)(i.A.stackItem,t&&i.A.modifiers.fill,a)}),s)};s.displayName="StackItem"},16177:(e,t,a)=>{a.d(t,{a:()=>i});var r=a(63696),l=a(93962);const i=({value:e})=>r.createElement(r.Fragment,null,Object.entries(e).map((([e,t],a)=>r.createElement(l.J,{key:a,isCompact:!0},`${e}=${t}`))))},68248:(e,t,a)=>{a.d(t,{f:()=>s});var r=a(63696),l=a(74932);const i=(e,t)=>e.sbom.id===t.sbom.id&&e.sbomStatus===t.sbomStatus,n={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0}},s=e=>{const{vulnerability:t,isFetching:a,fetchError:s}=(0,l.uN)(e);return{data:r.useMemo((()=>(e=>{const t=e.flatMap((e=>(e.sboms??[]).flatMap((t=>t.status.map((a=>({sbom:{...t,version:t.version||null},sbomStatus:a,advisory:e}))))).reduce(((e,t)=>{const a=e.find((e=>i(e,t)));if(a)return[...e.filter((e=>!i(e,a))),{...a,relatedPackages:[...a.relatedPackages,{advisory:t.advisory}]}];{const a={sbom:t.sbom,sbomStatus:t.sbomStatus,relatedPackages:[{advisory:t.advisory}]};return[...e,a]}}),[]))),a=t.reduce(((e,t)=>{const a=t.sbomStatus;return{...e,total:e.total+1,sbomStatus:{...e.sbomStatus,[a]:e.sbomStatus[a]+1}}}),n);return{sboms:t,summary:a}})(t?.advisories||[])),[t]),isFetching:a,fetchError:s}}},7602:(e,t,a)=>{a.d(t,{R:()=>c,r:()=>d});var r=a(63696),l=a(87043),i=a(86820),n=a(70611),s=a(5098),o=a(69935);const c=r.createContext({}),d=({children:e})=>{const t=(0,n.MM)({tableName:"advisory",persistenceKeyPrefix:i.rt.advisories,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Title",severity:"Aggregated Severity",modified:"Revision",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","severity","modified"],isFilterEnabled:!0,filterCategories:[{categoryKey:i._G,title:"Filter text",placeholderText:"Search",type:l.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:l.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"modified",title:"Revision",type:l.RJ.dateRange}],isExpansionEnabled:!1}),{result:{data:a,total:d},isFetching:u,fetchError:m}=(0,o.VH)((0,n.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score",modified:"modified"}})),p=(0,n.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:d,isLoading:u,selectionState:(0,s.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return r.createElement(c.Provider,{value:{totalItemCount:d,isFetching:u,fetchError:m,tableControls:p}},e)}},7123:(e,t,a)=>{a.d(t,{q:()=>g});var r=a(63696),l=a(49348),i=a(40319),n=a(16646),s=a(9425),o=a(77819),c=a(28516),d=a(3629),u=a(62101),m=a(50705),p=a(1349),f=a(62520),y=a(91271),b=a(11848),h=a(28644),v=a(34066),E=a(7602);const g=({})=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:g}=r.useContext(E.R),{pushNotification:C}=r.useContext(m.K),{numRenderedColumns:k,currentPageItems:S,propHelpers:{paginationProps:P,tableProps:T,getThProps:F,getTrProps:x,getTdProps:_},expansionDerivedState:{isCellExpanded:I}}=g,{downloadAdvisory:K}=(0,y.m)();return r.createElement(r.Fragment,null,r.createElement(i.X,{...T,"aria-label":"advisory-table"},r.createElement(n.d,null,r.createElement(s.Tr,null,r.createElement(f.Ze,{...g},r.createElement(o.Th,{...F({columnKey:"identifier"})}),r.createElement(o.Th,{...F({columnKey:"title"})}),r.createElement(o.Th,{...F({columnKey:"severity"})}),r.createElement(o.Th,{...F({columnKey:"modified"})}),r.createElement(o.Th,{...F({columnKey:"vulnerabilities"})})))),r.createElement(f.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:k},S.map(((e,t)=>{const a=e.vulnerabilities.reduce(((e,t)=>({...e,[t.severity]:e[t.severity]+1})),{critical:0,high:0,medium:0,low:0,none:0});return r.createElement(c.N,{key:e.identifier,isExpanded:I(e)},r.createElement(s.Tr,{...x({item:e})},r.createElement(f.Oi,{...g,item:e,rowIndex:t},r.createElement(d.Td,{width:15,..._({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},r.createElement(l.k2,{to:`/advisories/${e.uuid}`},e.identifier)),r.createElement(d.Td,{width:40,modifier:"truncate",..._({columnKey:"title"})},e.title),r.createElement(d.Td,{width:15,modifier:"truncate",..._({columnKey:"severity"})},e.average_severity&&r.createElement(b.h,{value:e.average_severity})),r.createElement(d.Td,{width:10,..._({columnKey:"modified"})},(0,v.Yq)(e.modified)),r.createElement(d.Td,{width:20,..._({columnKey:"vulnerabilities"})},r.createElement(h.n,{severities:a})),r.createElement(d.Td,{isActionCell:!0},r.createElement(u.G,{items:[{title:"Download",onClick:()=>{K(e.uuid,`${e.identifier}.json`)}}]})))))})))),r.createElement(p.n,{idPrefix:"advisory-table",isTop:!1,isCompact:!0,paginationProps:P}))}},30426:(e,t,a)=>{a.d(t,{Y:()=>d,a:()=>u});var r=a(63696),l=a(87043),i=a(86820),n=a(70611),s=a(5098),o=a(17993),c=a(34066);const d=r.createContext({}),u=({children:e})=>{const t=(0,n.MM)({tableName:"packages",persistenceKeyPrefix:i.rt.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:i._G,title:"Filter text",placeholderText:"Search",type:l.RJ.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:l.RJ.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:l.RJ.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:a,total:u},isFetching:m,fetchError:p}=(0,o.Lx)((0,n.Ng)({...t,hubSortFieldKeys:{}})),f=r.useMemo((()=>a.map((e=>({...e,decomposedPurl:(0,c.fe)(e.purl)})))),[a]),y=(0,n.PB)({...t,idProperty:"uuid",currentPageItems:f,totalItemCount:u,isLoading:m,selectionState:(0,s.$)({items:f,isEqual:(e,t)=>e.uuid===t.uuid})});return r.createElement(d.Provider,{value:{totalItemCount:u,isFetching:m,fetchError:p,tableControls:y}},e)}},53646:(e,t,a)=>{a.d(t,{N:()=>P});var r=a(63696),l=a(49348),i=a(40319),n=a(16646),s=a(9425),o=a(77819),c=a(28516),d=a(3629),u=a(16177),m=a(1349),p=a(62520),f=a(36509),y=a(93962),b=a(24417),h=a(28644),v=a(77347),E=a(40752),g=a(17993);const C={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},k=({packageId:e})=>{const{summary:t,isFetching:a,fetchError:l}=(e=>{const{pkg:t,isFetching:a,fetchError:l}=(0,g.Si)(e),[i,n]=r.useState([]),[s,o]=r.useState(new Map),[c,d]=r.useState(!1);r.useEffect((()=>{if(!t||0===t.advisories.length)return;const e=(t?.advisories??[]).flatMap((e=>(e.status??[]).map((t=>({vulnerabilityId:t.vulnerability.identifier,status:t.status,advisory:e}))))).filter((e=>"affected"===e.status)).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]);n(e),d(!0),Promise.all(e.map((async e=>(await(0,E.wk)({client:v.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),a=new Map;t.forEach((e=>{a.set(e.identifier,e)})),o(a),d(!1)}))}),[t]);const u=r.useMemo((()=>i.map((e=>({...e,vulnerability:s.get(e.vulnerabilityId)})))),[i,s]),m=r.useMemo((()=>u.reduce(((e,t)=>{if(t.vulnerability?.average_severity){const a=t.vulnerability?.average_severity;return{...e,total:e.total+1,severities:{...e.severities,[a]:e.severities[a]+1}}}return e}),C)),[u]);return{isFetching:a||c,fetchError:l,vulnerabilities:u,summary:m}})(e);return r.createElement(b.a,{isFetching:a,fetchError:l,isFetchingState:r.createElement(f.E,{screenreaderText:"Loading contents"}),fetchErrorState:r.createElement(y.J,{color:"red"},"Error")},r.createElement(h.n,{severities:t.severities}))};var S=a(30426);const P=()=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:f}=r.useContext(S.Y),{numRenderedColumns:y,currentPageItems:b,propHelpers:{paginationProps:h,tableProps:v,getThProps:E,getTrProps:g,getTdProps:C},expansionDerivedState:{isCellExpanded:P}}=f;return r.createElement(r.Fragment,null,r.createElement(i.X,{...v,"aria-label":"Package table"},r.createElement(n.d,null,r.createElement(s.Tr,null,r.createElement(p.Ze,{...f},r.createElement(o.Th,{...E({columnKey:"name"})}),r.createElement(o.Th,{...E({columnKey:"namespace"})}),r.createElement(o.Th,{...E({columnKey:"version"})}),r.createElement(o.Th,{...E({columnKey:"type"})}),r.createElement(o.Th,{...E({columnKey:"path"})}),r.createElement(o.Th,{...E({columnKey:"qualifiers"})}),r.createElement(o.Th,{...E({columnKey:"vulnerabilities"})})))),r.createElement(p.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:y},b.map(((e,t)=>r.createElement(c.N,{key:e.uuid},r.createElement(s.Tr,{...g({item:e})},r.createElement(p.Oi,{...f,item:e,rowIndex:t},r.createElement(d.Td,{width:15,...C({columnKey:"name"})},r.createElement(l.k2,{to:`/packages/${e.uuid}`},e.decomposedPurl?e.decomposedPurl?.name:e.purl)),r.createElement(d.Td,{width:15,modifier:"truncate",...C({columnKey:"namespace"})},e.decomposedPurl?.namespace),r.createElement(d.Td,{width:10,modifier:"truncate",...C({columnKey:"version"})},e.decomposedPurl?.version),r.createElement(d.Td,{width:10,modifier:"truncate",...C({columnKey:"type"})},e.decomposedPurl?.type),r.createElement(d.Td,{width:10,modifier:"truncate",...C({columnKey:"path"})},e.decomposedPurl?.path),r.createElement(d.Td,{width:20,...C({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&r.createElement(u.a,{value:e.decomposedPurl?.qualifiers})),r.createElement(d.Td,{width:20,...C({columnKey:"vulnerabilities"})},r.createElement(k,{packageId:e.uuid}))))))))),r.createElement(m.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:h}))}},62107:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ke});var r=a(63696),l=a(68430),i=a(20653),n=a(35048),s=a(56918),o=a(1180),c=a(72785),d=a(4433),u=a(86820),m=a(68792),p=a(60876),f=a(51522),y=a(65841),b=a(66174),h=a(66129),v=a(93962),E=a(69935),g=a(17993),C=a(91728),k=a(74932),S=a(49348);const P=e=>r.createElement(S.N_,{key:e.id,to:e.navLink,style:{textDecoration:"none"}},r.createElement(m.D,{itemId:e.id,description:e.description},e.title," ",r.createElement(v.J,{color:e.typeColor},e.type)));function T(e,t){let a=e.filter((e=>e.id.toLowerCase().startsWith(t.toLowerCase())||e.title?.toLowerCase().startsWith(t.toLowerCase())||e.description?.toLowerCase().startsWith(t.toLowerCase()))).map(P);return a=a.length>10?a.slice(0,10):[...a,...e.filter((e=>!e.id.startsWith(t.toLowerCase())&&e.id.includes(t.toLowerCase()))).map(P)].slice(0,10),a}const F=({filterFunction:e=T,onChangeSearch:t})=>{const{list:a,defaultValue:l}=function(){const e={filters:[{field:u._G,operator:"~",value:""}],page:{pageNumber:1,itemsPerPage:10}},{result:{data:t}}=(0,E.VH)({...e}),{result:{data:a}}=(0,g.Lx)({...e}),{result:{data:r}}=(0,C.i$)({...e}),{result:{data:l}}=(0,k.WJ)({...e}),i=[],n=t.map((e=>({id:e.identifier,title:e.identifier,description:e.title?.substring(0,75),navLink:`/advisories/${e.uuid}`,type:"Advisory",typeColor:"blue"}))),s=a.map((e=>({id:e.uuid,title:e.purl,navLink:`/packages/${e.uuid}`,type:"Package",typeColor:"cyan"}))),o=r.map((e=>({id:e.id,title:e.name,description:e.authors.join(", "),navLink:`/sboms/${e.id}`,type:"SBOM",typeColor:"purple"}))),c=l.map((e=>({id:e.identifier,title:e.identifier,description:e.description?.substring(0,75),navLink:`/vulnerabilities/${e.identifier}`,type:"CVE",typeColor:"orange"})));return i.push(...n,...s,...o,...c),{list:i,defaultValue:""}}(),[i,n]=r.useState(l),[s,o]=r.useState([]),[c,d]=r.useState(!1),m=r.useRef(null),v=r.useRef(null);r.useEffect((()=>{const e=e=>{if(c&&m.current&&m.current===e.target)if("Escape"===e.key)d(!1),m.current.focus();else if("ArrowDown"===e.key||"ArrowUp"===e.key){const t=v.current?.querySelector("li > button:not(:disabled)");t&&t?.focus(),e.preventDefault()}else"Tab"!==e.key&&"Enter"!==e.key&&"Space"!==e.key||(d(!1),"Enter"!==e.key&&"Space"!==e.key||e.preventDefault());else c&&v.current?.contains(e.target)&&"Tab"===e.key&&(e.preventDefault(),d(!1),m.current?.focus())},t=e=>{c&&v&&v.current&&!v.current.contains(e.target)&&d(!1)};return window.addEventListener("keydown",e),window.addEventListener("click",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("click",t)}}),[c]);const S=r.createElement(p.W,{ref:v,style:{maxWidth:"450px"}},r.createElement(f.r,null,r.createElement(y.c,null,s))),P=r.createElement(b.D,{placeholder:"Search for an SBOM, Package, or Vulnerability",value:i,onChange:(t,r)=>(t=>{if(""!==t&&m&&m.current&&m.current.contains(document.activeElement)){d(!0);const r=e(a,t);d(r.length>0),o(r)}else d(!1);n(t)})(r),onClear:()=>{n("")},onSearch:()=>{t(i)},onKeyDown:e=>{!e.key||e.key},ref:m,id:"autocomplete-search"});return r.createElement(h.N,{trigger:P,triggerRef:m,popper:S,popperRef:v,isVisible:c,enableFlip:!1,appendTo:()=>document.querySelector("#autocomplete-search")})};var x=a(30426),_=a(36390),I=a(14310),K=a(7602);function R(e,t){return{Component:e,props:t}}const w=[R(_.c,{}),R(x.a,{}),R(I.y,{}),R(K.r,{})],A=(N=w,({children:e})=>{const t=r.createElement(r.Fragment,null,e);return N.reduceRight(((e,{Component:t,props:a={}})=>r.createElement(t,{...a},e)),t)});var N,L=a(69673),D=a(54518),V=a(48281),M=a(17327),O=a(71603),q=a(16459),J=a(71592),$=a(40111),B=a(96178),H=a(70414),Y=a(53646),G=a(7123),W=a(90676),j=a(86416),Z=a(8210),X=a(38914),z=a(57901),Q=a(77635),U=a(87043),ee=a(58897),te=a(71273),ae=a(51463);const re=({category:e,filterValue:t,setFilterValue:a,isNumeric:l,isDisabled:i=!1})=>{const[n,s]=r.useState(t?.[0]||"");r.useEffect((()=>{s(t?.[0]||"")}),[t]);const o=()=>{const e=n.trim();a(e?[e.replace(/\s+/g," ")]:[])},c=`${e.categoryKey}-input`;return r.createElement(ee.M,null,r.createElement(te.ks,{name:c,id:"search-input",type:l?"number":"search",onChange:(e,t)=>s(t),"aria-label":`${e.title} filter`,value:n,placeholder:e.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||o()},isDisabled:i}),r.createElement(Q.$n,{variant:Q.Ak.control,id:"search-button","aria-label":"search button for search input",onClick:o,isDisabled:i},r.createElement(ae.Ay,null)))};var le=a(34629);const ie="pf-m-standalone",ne="pf-m-disabled";var se=a(62634),oe=a(1850);class ce extends r.Component{constructor(e){super(e),this.handleChange=e=>{this.props.onChange(e,e.currentTarget.checked)},e.label||e["aria-label"]||console.error("Radio:","Radio requires an aria-label to be specified"),this.state={ouiaStateId:(0,oe.X)(ce.displayName)}}render(){const e=this.props,{"aria-label":t,checked:a,className:l,inputClassName:i,defaultChecked:n,isLabelWrapped:s,isLabelBeforeButton:o,isChecked:c,isDisabled:d,isValid:u,label:m,onChange:p,description:f,body:y,ouiaId:b,ouiaSafe:h=!0,component:v}=e,E=(0,le.__rest)(e,["aria-label","checked","className","inputClassName","defaultChecked","isLabelWrapped","isLabelBeforeButton","isChecked","isDisabled","isValid","label","onChange","description","body","ouiaId","ouiaSafe","component"]);E.id||console.error("Radio:","id is required to make input accessible");const g=r.createElement("input",Object.assign({},E,{className:(0,se.A)("pf-v5-c-radio__input",i),type:"radio",onChange:this.handleChange,"aria-invalid":!u,disabled:d,checked:a||c},void 0===a&&{defaultChecked:n},!m&&{"aria-label":t},(0,oe.Bs)(ce.displayName,void 0!==b?b:this.state.ouiaStateId,h))),C=s&&!v||"label"===v,k=C?"span":"label",S=m?r.createElement(k,{className:(0,se.A)("pf-v5-c-radio__label",d&&ne),htmlFor:C?void 0:E.id},m):null,P=null!=v?v:C?"label":"div";return r.createElement(P,{className:(0,se.A)("pf-v5-c-radio",!m&&ie,l),htmlFor:C?E.id:void 0},o?r.createElement(r.Fragment,null,S,g):r.createElement(r.Fragment,null,g,S),f&&r.createElement("span",{className:(0,se.A)("pf-v5-c-radio__description")},f),y&&r.createElement("span",{className:(0,se.A)("pf-v5-c-radio__body")},y))}}ce.displayName="Radio",ce.defaultProps={className:"",isDisabled:!1,isValid:!0,onChange:()=>{}};const de=({category:e,filterValue:t,setFilterValue:a,isDisabled:l=!1})=>r.createElement(r.Fragment,null,e.selectOptions.map((({label:i,value:n,optionProps:s={}},o)=>{const c=t?.includes(n)||!1;return r.createElement(ce,{isDisabled:l,key:o,id:`radio-${o}`,name:"radio",isLabelWrapped:!0,label:i,isChecked:c,onChange:()=>{(t=>{const r=(l=t,e.selectOptions.find((({value:e})=>e===l)));var l;a(r?[t]:null)})(n)}})})));var ue=a(58365);const me=({category:e,filterValue:t,setFilterValue:a,isDisabled:l=!1})=>{const[i,n]=r.useState(Array.isArray(e.selectOptions)?e.selectOptions:[]);r.useEffect((()=>{n(Array.isArray(e.selectOptions)?e.selectOptions:[])}),[e.selectOptions]);const s=Array.isArray(i)?i:Object.values(i).flatMap((e=>e));return r.createElement(r.Fragment,null,s.map((({label:l,value:i,optionProps:n={}},s)=>r.createElement(ue.S,{key:s,id:`checkbox-${s}-${e.categoryKey}`,isLabelWrapped:!0,label:l,isChecked:t?.includes(i),onChange:()=>{(e=>{if(e&&"No results"!==e){let r;r=t&&t.includes(e)?t.filter((t=>t!==e)):t?[...t,e]:[e],a(r)}})(i)}}))))};var pe=a(46721),fe=a(40360),ye=a(23277),be=a(78109),he=a(66341);const ve=({category:e,filterValue:t,setFilterValue:a,isDisabled:l=!1})=>{const i=t??[],[n,s]=(i?.filter((e=>(0,he.Ce)((0,he.P1)(e)))),(0,r.useState)()),[o,c]=(0,r.useState)();return r.useEffect((()=>{if(t?.[0]){const[e,a]=(0,he.P1)(t?.[0]);s(e.toDate()),c(a.toDate())}else s(void 0),c(void 0)}),[t]),r.createElement(pe.l,null,r.createElement(fe.g,{role:"group",isInline:!0,label:"From"},r.createElement(ye.l,{value:n?(0,he.ak)(n):"",dateFormat:he.ak,dateParse:he.sy,onChange:(e,t)=>{(0,he.Fz)(t)&&(s((0,he.sy)(t)),c(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:l})),r.createElement(fe.g,{role:"group",isInline:!0,label:"To"},r.createElement(ye.l,{value:o?(0,he.ak)(o):"",onChange:(e,t)=>{if((0,he.Fz)(t)){const e=(0,he.sy)(t);c(e);const r=(0,he.Kg)(n,e);r&&a([r])}},isDisabled:l||!(0,be.v)(n),dateFormat:he.ak,dateParse:he.sy,invalidFormatText:"",rangeStart:n,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})))},Ee=({category:e,...t})=>e.type===U.RJ.select?r.createElement(de,{category:e,...t}):e.type===U.RJ.search||e.type===U.RJ.numsearch?r.createElement(re,{category:e,isNumeric:e.type===U.RJ.numsearch,...t}):e.type===U.RJ.multiselect?r.createElement(me,{category:e,...t}):e.type===U.RJ.dateRange?r.createElement(ve,{category:e,...t}):null,ge=({filterCategories:e,filterValues:t,setFilterValues:a,isDisabled:l=!1,omitFilterCategoryKeys:i=[]})=>r.createElement(r.Fragment,null,r.createElement(X.B,{hasGutter:!0},r.createElement(z.a,null,r.createElement(Q.$n,{variant:"link",isInline:!0,onClick:()=>{const r=e.filter((e=>void 0===i.find((t=>t===e.categoryKey)))).reduce(((e,t)=>({...e,[t.categoryKey]:void 0})),{});a({...t,...r})}},"Clear all filters")),e.filter((e=>void 0===i.find((t=>t===e.categoryKey)))).map((e=>r.createElement(z.a,{key:e.categoryKey},r.createElement(X.B,{hasGutter:!0},r.createElement(z.a,null,r.createElement(o.n,null,r.createElement(c.E,{component:"h4"},e.title))),r.createElement(z.a,null,r.createElement(Ee,{category:e,filterValue:t[e.categoryKey],setFilterValue:r=>((e,r)=>a({...t,[e.categoryKey]:r}))(e,r),isDisabled:l,isSidebar:!0})))))))),Ce=({advisoryTable:e,filterPanelProps:t,packageTable:a,packageTotalCount:l,sbomTable:i,sbomTotalCount:n,vulnerabilityTable:s,vulnerabilityTotalCount:o})=>{const[c,d]=r.useState(0),{advisoryFilterPanelProps:u,packageFilterPanelProps:m,sbomFilterPanelProps:p,vulnerabilityFilterPanelProps:f}=t,y=r.createRef();return r.createElement(D.B,{hasGutter:!0},r.createElement(V.o,null,r.createElement(M.Z,{isFullHeight:!0},r.createElement(O.b,{style:{width:241}},0===c?r.createElement(ge,{omitFilterCategoryKeys:[""],...p}):1===c?r.createElement(ge,{omitFilterCategoryKeys:[""],...m}):2===c?r.createElement(ge,{omitFilterCategoryKeys:[""],...f}):3===c?r.createElement(ge,{omitFilterCategoryKeys:[""],...u}):null))),r.createElement(V.o,{isFilled:!0},r.createElement(q.t,{isBox:!0,activeKey:c,onSelect:(e,t)=>{d(t)},"aria-label":"Tabs",role:"region"},r.createElement(J.o,{eventKey:0,title:r.createElement($.V,null,"SBOMs","  ",r.createElement(B.E,{screenReaderText:"Search Result Count"},n)),actions:r.createElement(r.Fragment,null,r.createElement(H.o,{"aria-label":"SBOM help popover",ref:y},r.createElement(Z.Ay,null)),(b=y,r.createElement(L.A,{bodyContent:r.createElement("div",null,"Software Bill of Materials for Products and Containers."),position:"right",triggerRef:b})))},i??r.createElement(W.Y,null)),r.createElement(J.o,{eventKey:1,title:r.createElement($.V,null,"Packages","  ",r.createElement(B.E,{screenReaderText:"Search Result Count"},l))},a??r.createElement(Y.N,null)),r.createElement(J.o,{eventKey:2,title:r.createElement($.V,null,"CVEs","  ",r.createElement(B.E,{screenReaderText:"Search Result Count"},o))},s??r.createElement(j.f,null)),r.createElement(J.o,{eventKey:3,title:r.createElement($.V,null,"Advisories","  ",r.createElement(B.E,{screenReaderText:"Advisory Result Count"},o))},e??r.createElement(G.q,null)))));var b},ke=({searchBodyOverride:e})=>r.createElement(A,null,r.createElement(Se,{searchBodyOverride:e})),Se=({searchBodyOverride:e})=>{const{tableControls:t}=r.useContext(_.L),{tableControls:a}=r.useContext(x.Y),{tableControls:m}=r.useContext(I.u),{tableControls:p}=r.useContext(K.R),{totalItemCount:f,tableControls:{propHelpers:{filterPanelProps:y}}}=r.useContext(_.L),{totalItemCount:b,tableControls:{propHelpers:{filterPanelProps:h}}}=r.useContext(x.Y),{totalItemCount:v,tableControls:{propHelpers:{filterPanelProps:E}}}=r.useContext(I.u),{totalItemCount:g,tableControls:{propHelpers:{filterPanelProps:C}}}=r.useContext(K.R),k={advisoryFilterPanelProps:C,packageFilterPanelProps:h,sbomFilterPanelProps:y,vulnerabilityFilterPanelProps:E},S=r.createElement(Ce,{filterPanelProps:k,packageTotalCount:b,sbomTotalCount:f,vulnerabilityTotalCount:v});return r.createElement(r.Fragment,null,r.createElement(l.d8,{variant:l.zC.light},r.createElement(i.M,{isStatic:!0},r.createElement(n.P,null,r.createElement(s.$,{align:{default:"alignLeft"}},r.createElement(o.n,null,r.createElement(c.E,{component:"h1"},"Search Results"))),r.createElement(s.$,{variant:"icon-button-group",align:{default:"alignRight"}},r.createElement(s.$,{visibility:{default:"hidden",lg:"visible"}},r.createElement(d.T,{widths:{default:"500px"}},r.createElement(F,{onChangeSearch:e=>{null!=e&&(t.filterState.setFilterValues({...t.filterState.filterValues,[u._G]:[e]}),a.filterState.setFilterValues({...a.filterState.filterValues,[u._G]:[e]}),m.filterState.setFilterValues({...m.filterState.filterValues,[u._G]:[e]}),p.filterState.setFilterValues({...p.filterState.filterValues,[u._G]:[e]}))}}))))))),r.createElement(l.d8,null,e||S))}},14310:(e,t,a)=>{a.d(t,{u:()=>c,y:()=>d});var r=a(63696),l=a(87043),i=a(86820),n=a(70611),s=a(5098),o=a(74932);const c=r.createContext({}),d=({children:e})=>{const t=(0,n.MM)({tableName:"vulnerability",persistenceKeyPrefix:i.rt.vulnerabilities,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Description",severity:"CVSS",published:"Date published",sboms:"Related documents"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["published","severity"],isFilterEnabled:!0,filterCategories:[{categoryKey:i._G,title:"Filter text",placeholderText:"Search",type:l.RJ.search},{categoryKey:"average_severity",title:"CVSS",placeholderText:"CVSS",type:l.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"published",title:"Created on",type:l.RJ.dateRange}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:a,total:d},isFetching:u,fetchError:m}=(0,o.WJ)((0,n.Ng)({...t,hubSortFieldKeys:{severity:"average_severity",published:"published"}})),p=(0,n.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:d,isLoading:u,selectionState:(0,s.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return r.createElement(c.Provider,{value:{totalItemCount:d,isFetching:u,fetchError:m,tableControls:p}},e)}},86416:(e,t,a)=>{a.d(t,{f:()=>k});var r=a(63696),l=a(49348),i=a(40319),n=a(16646),s=a(9425),o=a(77819),c=a(28516),d=a(3629),u=a(11848),m=a(1349),p=a(62520),f=a(23560),y=a(34066),b=a(36509),h=a(93962),v=a(24417),E=a(68248);const g=({vulnerabilityId:e})=>{const{data:t,isFetching:a,fetchError:l}=(0,E.f)(e);return r.createElement(v.a,{isFetching:a,fetchError:l,isFetchingState:r.createElement(b.E,{screenreaderText:"Loading contents"}),fetchErrorState:r.createElement(h.J,{color:"red"},"Error")},t.summary.sbomStatus.affected)};var C=a(14310);const k=()=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:b}=r.useContext(C.u),{numRenderedColumns:h,currentPageItems:v,propHelpers:{paginationProps:E,tableProps:k,getThProps:S,getTrProps:P,getTdProps:T}}=b;return r.createElement(r.Fragment,null,r.createElement(i.X,{...k,"aria-label":"Vulnerability table"},r.createElement(n.d,null,r.createElement(s.Tr,null,r.createElement(p.Ze,{...b},r.createElement(o.Th,{...S({columnKey:"identifier"})}),r.createElement(o.Th,{...S({columnKey:"title"})}),r.createElement(o.Th,{...S({columnKey:"severity"})}),r.createElement(o.Th,{...S({columnKey:"published"})}),r.createElement(o.Th,{...S({columnKey:"sboms"})})))),r.createElement(p.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:h},v.map(((e,t)=>r.createElement(c.N,{key:e.identifier},r.createElement(s.Tr,{...P({item:e})},r.createElement(p.Oi,{...b,item:e,rowIndex:t},r.createElement(d.Td,{width:15,...T({columnKey:"identifier",item:e,rowIndex:t})},r.createElement(l.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),r.createElement(d.Td,{width:45,modifier:"truncate",...T({columnKey:"title"})},r.createElement(f.j,{vulnerability:e})),r.createElement(d.Td,{width:10,...T({columnKey:"severity"})},e.average_severity&&r.createElement(u.h,{value:e.average_severity})),r.createElement(d.Td,{width:10,...T({columnKey:"published"})},(0,y.Yq)(e.published)),r.createElement(d.Td,{width:10,...T({columnKey:"sboms",item:e,rowIndex:t})},r.createElement(g,{vulnerabilityId:e.identifier}))))))))),r.createElement(m.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:E}))}},69935:(e,t,a)=>{a.d(t,{VH:()=>u,Yu:()=>p,vy:()=>m});var r=a(39155),l=a(3715),i=a(77347),n=a(40752),s=a(81230),o=a(70611),c=a(24808);const d="advisories",u=(e={},t=!1)=>{const{data:a,isLoading:l,error:s,refetch:c}=(0,r.I)({queryKey:[d,e],queryFn:()=>(0,n.YM)({client:i.S,query:{...(0,o.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e??e},isFetching:l,fetchError:s||null,refetch:c}},m=e=>{const{data:t,isLoading:a,error:l}=(0,r.I)({queryKey:[d,e],queryFn:()=>(0,n.ai)({client:i.S,path:{key:e}}),enabled:void 0!==e});return{advisory:t?.data,isFetching:a,fetchError:l}},p=()=>{const e=(0,l.jE)();return(0,c.v)({parallel:!0,uploadFn:(e,t)=>(0,s.hP)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[d]})}})}},74932:(e,t,a)=>{a.d(t,{WJ:()=>o,uN:()=>c});var r=a(39155),l=a(77347),i=a(40752),n=a(70611);const s="vulnerabilities",o=(e={},t=!1)=>{const{data:a,isLoading:o,error:c,refetch:d}=(0,r.I)({queryKey:[s,e],queryFn:()=>(0,i.NI)({client:l.S,query:{...(0,n.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e},isFetching:o,fetchError:c,refetch:d}},c=e=>{const{data:t,isLoading:a,error:n}=(0,r.I)({queryKey:[s,e],queryFn:()=>(0,i.wk)({client:l.S,path:{id:e}})});return{vulnerability:t?.data,isFetching:a,fetchError:n}}},41775:(e,t,a)=>{a.d(t,{A:()=>r});const r={card:"pf-v5-c-card",cardActions:"pf-v5-c-card__actions",cardBody:"pf-v5-c-card__body",cardExpandableContent:"pf-v5-c-card__expandable-content",cardFooter:"pf-v5-c-card__footer",cardHeader:"pf-v5-c-card__header",cardHeaderMain:"pf-v5-c-card__header-main",cardHeaderToggle:"pf-v5-c-card__header-toggle",cardHeaderToggleIcon:"pf-v5-c-card__header-toggle-icon",cardSelectableActions:"pf-v5-c-card__selectable-actions",cardSrInput:"pf-v5-c-card__sr-input",cardTitle:"pf-v5-c-card__title",cardTitleText:"pf-v5-c-card__title-text",check:"pf-v5-c-check",checkInput:"pf-v5-c-check__input",checkLabel:"pf-v5-c-check__label",dirRtl:"pf-v5-m-dir-rtl",divider:"pf-v5-c-divider",modifiers:{selectable:"pf-m-selectable",clickable:"pf-m-clickable",selected:"pf-m-selected",current:"pf-m-current",disabled:"pf-m-disabled",hoverableRaised:"pf-m-hoverable-raised",selectableRaised:"pf-m-selectable-raised",nonSelectableRaised:"pf-m-non-selectable-raised",selectedRaised:"pf-m-selected-raised",compact:"pf-m-compact",displayLg:"pf-m-display-lg",flat:"pf-m-flat",plain:"pf-m-plain",rounded:"pf-m-rounded",expanded:"pf-m-expanded",fullHeight:"pf-m-full-height",toggleRight:"pf-m-toggle-right",noOffset:"pf-m-no-offset",noFill:"pf-m-no-fill"},radio:"pf-v5-c-radio",radioInput:"pf-v5-c-radio__input",radioLabel:"pf-v5-c-radio__label",themeDark:"pf-v5-theme-dark"}},13364:(e,t,a)=>{a.d(t,{A:()=>r});const r={modifiers:{fill:"pf-m-fill",gutter:"pf-m-gutter"},stack:"pf-v5-l-stack",stackItem:"pf-v5-l-stack__item"}}}]);
//# sourceMappingURL=994.7ea41efc.min.js.map