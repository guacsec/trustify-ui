"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[586],{13506:(e,t,a)=>{a.d(t,{T:()=>i});var l=a(63696),r=a(77635),n=a(33364);const i=({isOpen:e,title:t,titleIconVariant:a,message:i,confirmBtnLabel:s,cancelBtnLabel:c,inProgress:o,confirmBtnVariant:u,onClose:m,onConfirm:d,onCancel:E})=>{const p=l.createElement(r.$n,{id:"confirm-dialog-button",key:"confirm","aria-label":"confirm",variant:u,isDisabled:o,onClick:d},s),y=E?l.createElement(r.$n,{key:"cancel",id:"confirm-cancel-button","aria-label":"cancel",variant:r.Ak.link,isDisabled:o,onClick:E},c):void 0;return l.createElement(n.a,{id:"confirm-dialog",variant:n.d.small,title:t,titleIconVariant:a,isOpen:e,onClose:m,"aria-label":"Confirm dialog",actions:E?[p,y]:[p]},i)}},28644:(e,t,a)=>{a.d(t,{n:()=>u});var l=a(63696),r=a(28338),n=a(70045),i=a(9369),s=a(86099),c=a(55399),o=a(52302);const u=({severities:e})=>{const t=Object.values(e).reduce(((e,t)=>e+t),0);return l.createElement(r.s,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},l.createElement(n.Z,{style:{minWidth:15,textAlign:s.pG}},t),l.createElement(i.c,{orientation:{default:"vertical"}}),l.createElement(n.Z,null,l.createElement(r.s,null,Object.entries(e).filter((([e,t])=>t>0)).sort((0,c.Sx)((([e,t])=>e))).reverse().map((([e,t],a)=>l.createElement(n.Z,{key:a,spacer:{default:"spacerXs"}},l.createElement(r.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},l.createElement(n.Z,null,l.createElement(o.h,{value:e,hideLabel:!0})),l.createElement(n.Z,null,t))))))))}},91271:(e,t,a)=>{a.d(t,{m:()=>i});var l=a(22249),r=a(77347),n=a(40752);const i=()=>({downloadAdvisory:(e,t)=>{(0,n.Mu)({client:r.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,l.saveAs)(new Blob([a.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,n.K0)({client:r.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,l.saveAs)(new Blob([a.data]),t||`${e}.json`)}))}})},4878:(e,t,a)=>{a.d(t,{r:()=>c});var l=a(63696),r=a(77347),n=a(40752),i=a(91728);const s={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},c=e=>{const{advisories:t,isFetching:a,fetchError:c}=(0,i.DH)(e),[o,u]=l.useState([]),[m,d]=l.useState(new Map),[E,p]=l.useState(!1);l.useEffect((()=>{if(0===t.length)return;const e=(t??[]).flatMap((e=>(e.status??[]).map((t=>({vulnerabilityId:t.vulnerability_id,status:t.status,packages:t.packages||[],advisory:{...e}}))))).filter((e=>"affected"===e.status)).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]);u(e),p(!0),Promise.all(e.map((async e=>(await(0,n.wk)({client:r.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),a=new Map;t.forEach((e=>{a.set(e.identifier,e)})),d(a),p(!1)}))}),[t]);const y=l.useMemo((()=>o.map((e=>({...e,vulnerability:m.get(e.vulnerabilityId)})))),[o,m]),h=l.useMemo((()=>y.reduce(((e,t)=>{if(t.vulnerability?.average_severity){const a=t.vulnerability?.average_severity;return{...e,total:e.total+1,severities:{...e.severities,[a]:e.severities[a]+1}}}return e}),s)),[y]);return{isFetching:a||E,fetchError:c,vulnerabilities:y,summary:h}}},30426:(e,t,a)=>{a.d(t,{Y:()=>u,a:()=>m});var l=a(63696),r=a(87043),n=a(86820),i=a(70611),s=a(5098),c=a(17993),o=a(34066);const u=l.createContext({}),m=({children:e})=>{const t=(0,i.MM)({tableName:"packages",persistenceKeyPrefix:n.rt.packages,columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:r.RJ.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:r.RJ.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:a,total:m},isFetching:d,fetchError:E}=(0,c.Lx)((0,i.Ng)({...t,hubSortFieldKeys:{}})),p=l.useMemo((()=>a.map((e=>({...e,decomposedPurl:(0,o.fe)(e.purl)})))),[a]),y=(0,i.PB)({...t,idProperty:"uuid",currentPageItems:p,totalItemCount:m,isLoading:d,selectionState:(0,s.$)({items:p,isEqual:(e,t)=>e.uuid===t.uuid})});return l.createElement(u.Provider,{value:{totalItemCount:m,isFetching:d,fetchError:E,tableControls:y}},e)}},67475:(e,t,a)=>{a.d(t,{N:()=>S});var l=a(63696),r=a(49348),n=a(85578),i=a(16646),s=a(31065),c=a(77819),o=a(28516),u=a(3629),m=a(16177),d=a(1349),E=a(62520),p=a(1459),y=a(891),h=a(24417),g=a(28644),b=a(77347),v=a(40752),f=a(17993);const C={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},T=({packageId:e})=>{const{summary:t,isFetching:a,fetchError:r}=(e=>{const{pkg:t,isFetching:a,fetchError:r}=(0,f.Si)(e),[n,i]=l.useState([]),[s,c]=l.useState(new Map),[o,u]=l.useState(!1);l.useEffect((()=>{if(!t||0===t.advisories.length)return;const e=(t?.advisories??[]).flatMap((e=>(e.status??[]).map((t=>({vulnerabilityId:t.vulnerability.identifier,status:t.status,advisory:e}))))).filter((e=>"affected"===e.status)).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]);i(e),u(!0),Promise.all(e.map((async e=>(await(0,v.wk)({client:b.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),a=new Map;t.forEach((e=>{a.set(e.identifier,e)})),c(a),u(!1)}))}),[t]);const m=l.useMemo((()=>n.map((e=>({...e,vulnerability:s.get(e.vulnerabilityId)})))),[n,s]),d=l.useMemo((()=>m.reduce(((e,t)=>{if(t.vulnerability?.average_severity){const a=t.vulnerability?.average_severity;return{...e,total:e.total+1,severities:{...e.severities,[a]:e.severities[a]+1}}}return e}),C)),[m]);return{isFetching:a||o,fetchError:r,vulnerabilities:m,summary:d}})(e);return l.createElement(h.a,{isFetching:a,fetchError:r,isFetchingState:l.createElement(p.E,{screenreaderText:"Loading contents"}),fetchErrorState:l.createElement(y.J,{color:"red"},"Error")},l.createElement(g.n,{severities:t.severities}))};var P=a(30426);const S=()=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:p}=l.useContext(P.Y),{numRenderedColumns:y,currentPageItems:h,propHelpers:{paginationProps:g,tableProps:b,getThProps:v,getTrProps:f,getTdProps:C},expansionDerivedState:{isCellExpanded:S}}=p;return l.createElement(l.Fragment,null,l.createElement(n.X,{...b,"aria-label":"Package table"},l.createElement(i.d,null,l.createElement(s.Tr,null,l.createElement(E.Ze,{...p},l.createElement(c.Th,{...v({columnKey:"name"})}),l.createElement(c.Th,{...v({columnKey:"namespace"})}),l.createElement(c.Th,{...v({columnKey:"version"})}),l.createElement(c.Th,{...v({columnKey:"type"})}),l.createElement(c.Th,{...v({columnKey:"path"})}),l.createElement(c.Th,{...v({columnKey:"qualifiers"})}),l.createElement(c.Th,{...v({columnKey:"vulnerabilities"})})))),l.createElement(E.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:y},h.map(((e,t)=>l.createElement(o.N,{key:e.uuid},l.createElement(s.Tr,{...f({item:e})},l.createElement(E.Oi,{...p,item:e,rowIndex:t},l.createElement(u.Td,{width:15,...C({columnKey:"name"})},l.createElement(r.k2,{to:`/packages/${e.uuid}`},e.decomposedPurl?e.decomposedPurl?.name:e.purl)),l.createElement(u.Td,{width:15,modifier:"truncate",...C({columnKey:"namespace"})},e.decomposedPurl?.namespace),l.createElement(u.Td,{width:10,modifier:"truncate",...C({columnKey:"version"})},e.decomposedPurl?.version),l.createElement(u.Td,{width:10,modifier:"truncate",...C({columnKey:"type"})},e.decomposedPurl?.type),l.createElement(u.Td,{width:10,modifier:"truncate",...C({columnKey:"path"})},e.decomposedPurl?.path),l.createElement(u.Td,{width:20,...C({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&l.createElement(m.a,{value:e.decomposedPurl?.qualifiers})),l.createElement(u.Td,{width:20,...C({columnKey:"vulnerabilities"})},l.createElement(T,{packageId:e.uuid}))))))))),l.createElement(d.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:g}))}},36390:(e,t,a)=>{a.d(t,{L:()=>o,c:()=>u});var l=a(63696),r=a(87043),n=a(86820),i=a(70611),s=a(5098),c=a(91728);const o=l.createContext({}),u=({children:e})=>{const t=(0,i.MM)({tableName:"sbom",persistenceKeyPrefix:n.rt.sboms,columnNames:{name:"Name",version:"Version",supplier:"Supplier",published:"Created on",packages:"Dependencies",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","published"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"published",title:"Created on",type:r.RJ.dateRange}],isExpansionEnabled:!1}),{result:{data:a,total:u},isFetching:m,fetchError:d}=(0,c.i$)((0,i.Ng)({...t,hubSortFieldKeys:{name:"name",published:"published"}})),E=(0,i.PB)({...t,idProperty:"id",currentPageItems:a,totalItemCount:u,isLoading:m,selectionState:(0,s.$)({items:a,isEqual:(e,t)=>e.id===t.id})});return l.createElement(o.Provider,{value:{totalItemCount:u,isFetching:m,fetchError:d,tableControls:E}},e)}},59013:(e,t,a)=>{a.d(t,{Y:()=>w});var l=a(63696),r=a(49348),n=a(77635),i=a(85578),s=a(16646),c=a(31065),o=a(77819),u=a(28516),m=a(3629),d=a(62101),E=a(13506),p=a(50705),y=a(17993);const h=({sbomId:e})=>{const{result:{total:t}}=(0,y.sl)(e,{page:{pageNumber:1,itemsPerPage:1}});return l.createElement(l.Fragment,null,t)};var g=a(1349),b=a(62520),v=a(91271),f=a(91728),C=a(34066),T=a(1459),P=a(891),S=a(24417),x=a(28644),K=a(4878);const F=({sbomId:e})=>{const{summary:t,isFetching:a,fetchError:r}=(0,K.r)(e);return l.createElement(S.a,{isFetching:a,fetchError:r,isFetchingState:l.createElement(T.E,{screenreaderText:"Loading contents"}),fetchErrorState:l.createElement(P.J,{color:"red"},"Error")},l.createElement(x.n,{severities:t.severities}))};var k=a(36390);const w=({})=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:y}=l.useContext(k.L),{pushNotification:T}=l.useContext(p.K),[P,S]=l.useState(null),[x,K]=l.useState(null),{mutate:w}=(0,f.l6)((e=>{T({title:`The SBOM ${e.name} was deleted`,variant:"success"})}),(e=>{T({title:"Error occurred while deleting the SBOM",variant:"danger"})})),{numRenderedColumns:I,currentPageItems:M,propHelpers:{paginationProps:D,tableProps:V,getThProps:N,getTrProps:R,getTdProps:O},expansionDerivedState:{isCellExpanded:A}}=y,{downloadSBOM:B}=(0,v.m)();return l.createElement(l.Fragment,null,l.createElement(i.X,{...V,"aria-label":"sbom-table"},l.createElement(s.d,null,l.createElement(c.Tr,null,l.createElement(b.Ze,{...y},l.createElement(o.Th,{...N({columnKey:"name"})}),l.createElement(o.Th,{...N({columnKey:"version"})}),l.createElement(o.Th,{...N({columnKey:"supplier"})}),l.createElement(o.Th,{...N({columnKey:"published"})}),l.createElement(o.Th,{...N({columnKey:"packages"})}),l.createElement(o.Th,{...N({columnKey:"vulnerabilities"})})))),l.createElement(b.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:I},M.map(((e,t)=>l.createElement(u.N,{key:e.id,isExpanded:A(e)},l.createElement(c.Tr,{...R({item:e})},l.createElement(b.Oi,{...y,item:e,rowIndex:t},l.createElement(m.Td,{width:25,...O({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t})},l.createElement(r.k2,{to:`/sboms/${e.id}`},e.name)),l.createElement(m.Td,{width:15,modifier:"truncate",...O({columnKey:"version"})},e.described_by.map((e=>e.version)).filter((e=>e)).join(", ")),l.createElement(m.Td,{width:20,modifier:"truncate",...O({columnKey:"supplier"})},e.authors.join(", ")),l.createElement(m.Td,{width:10,...O({columnKey:"published"})},(0,C.Yq)(e.published)),l.createElement(m.Td,{width:10,...O({columnKey:"packages"})},l.createElement(h,{sbomId:e.id})),l.createElement(m.Td,{width:20,...O({columnKey:"vulnerabilities"})},l.createElement(F,{sbomId:e.id})),l.createElement(m.Td,{isActionCell:!0},l.createElement(d.G,{items:[{title:"Download",onClick:()=>{B(e.id,`${e.name}.json`)}},{title:"Delete",onClick:()=>{return t=e,S("delete"),void K(t);var t}}]}))))))))),l.createElement(g.n,{idPrefix:"sbom-table",isTop:!1,isCompact:!0,paginationProps:D}),l.createElement(E.T,{title:`Delete ${x?.name}`,titleIconVariant:"warning",isOpen:"delete"===P,message:"Are you sure you want to delete this SBOM? This action cannot be undone.","aria-label":"Delete SBOM",confirmBtnVariant:n.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>S(null),onClose:()=>S(null),onConfirm:()=>{x&&w(x.id),S(null)}}))}},98436:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var l=a(63696),r=a(23665),n=a(68430),i=a(20653),s=a(35048),c=a(56918),o=a(1180),u=a(72785),m=a(4433),d=a(65991),E=a(76072),p=a(97299),y=a(17327),h=a(71603),g=a(87294),b=a(71592),v=a(40111),f=a(79893),C=a(70414),T=a(8210),P=a(38914),S=a(57901),x=a(77635),K=a(87043),F=a(58897),k=a(23857),w=a(51463);const I=({category:e,filterValue:t,setFilterValue:a,isNumeric:r,isDisabled:n=!1})=>{const[i,s]=l.useState(t?.[0]||"");l.useEffect((()=>{s(t?.[0]||"")}),[t]);const c=()=>{const e=i.trim();a(e?[e.replace(/\s+/g," ")]:[])},o=`${e.categoryKey}-input`;return l.createElement(F.M,null,l.createElement(k.ks,{name:o,id:"search-input",type:r?"number":"search",onChange:(e,t)=>s(t),"aria-label":`${e.title} filter`,value:i,placeholder:e.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||c()},isDisabled:n}),l.createElement(x.$n,{variant:x.Ak.control,id:"search-button","aria-label":"search button for search input",onClick:c,isDisabled:n},l.createElement(w.Ay,null)))};var M=a(11493);const D=({category:e,filterValue:t,setFilterValue:a,isDisabled:r=!1})=>l.createElement(l.Fragment,null,e.selectOptions.map((({label:n,value:i,optionProps:s={}},c)=>{const o=t?.includes(i)||!1;return l.createElement(M.s,{isDisabled:r,key:c,id:`radio-${c}`,name:"radio",isLabelWrapped:!0,label:n,isChecked:o,onChange:()=>{(t=>{const l=(r=t,e.selectOptions.find((({value:e})=>e===r)));var r;a(l?[t]:null)})(i)}})})));var V=a(58365);const N=({category:e,filterValue:t,setFilterValue:a,isDisabled:r=!1})=>{const[n,i]=l.useState(Array.isArray(e.selectOptions)?e.selectOptions:[]);l.useEffect((()=>{i(Array.isArray(e.selectOptions)?e.selectOptions:[])}),[e.selectOptions]);const s=Array.isArray(n)?n:Object.values(n).flatMap((e=>e));return l.createElement(l.Fragment,null,s.map((({label:r,value:n,optionProps:i={}},s)=>l.createElement(V.S,{key:s,id:`checkbox-${s}-${e.categoryKey}`,isLabelWrapped:!0,label:r,isChecked:t?.includes(n),onChange:()=>{(e=>{if(e&&"No results"!==e){let l;l=t&&t.includes(e)?t.filter((t=>t!==e)):t?[...t,e]:[e],a(l)}})(n)}}))))};var R=a(46721),O=a(40360),A=a(86282),B=a(78109),L=a(66341);const $=({category:e,filterValue:t,setFilterValue:a,isDisabled:r=!1})=>{const n=t??[],[i,s]=(n?.filter((e=>(0,L.Ce)((0,L.P1)(e)))),(0,l.useState)()),[c,o]=(0,l.useState)();return l.useEffect((()=>{if(t?.[0]){const[e,a]=(0,L.P1)(t?.[0]);s(e.toDate()),o(a.toDate())}else s(void 0),o(void 0)}),[t]),l.createElement(R.l,null,l.createElement(O.g,{role:"group",isInline:!0,label:"From"},l.createElement(A.l,{value:i?(0,L.ak)(i):"",dateFormat:L.ak,dateParse:L.sy,onChange:(e,t)=>{(0,L.Fz)(t)&&(s((0,L.sy)(t)),o(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:r})),l.createElement(O.g,{role:"group",isInline:!0,label:"To"},l.createElement(A.l,{value:c?(0,L.ak)(c):"",onChange:(e,t)=>{if((0,L.Fz)(t)){const e=(0,L.sy)(t);o(e);const l=(0,L.Kg)(i,e);l&&a([l])}},isDisabled:r||!(0,B.v)(i),dateFormat:L.ak,dateParse:L.sy,invalidFormatText:"",rangeStart:i,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})))},q=({category:e,...t})=>e.type===K.RJ.select?l.createElement(D,{category:e,...t}):e.type===K.RJ.search||e.type===K.RJ.numsearch?l.createElement(I,{category:e,isNumeric:e.type===K.RJ.numsearch,...t}):e.type===K.RJ.multiselect?l.createElement(N,{category:e,...t}):e.type===K.RJ.dateRange?l.createElement($,{category:e,...t}):null,Y=({filterCategories:e,filterValues:t,setFilterValues:a,isDisabled:r=!1,omitFilterCategoryKeys:n=[]})=>l.createElement(l.Fragment,null,l.createElement(P.B,{hasGutter:!0},l.createElement(S.a,null,l.createElement(x.$n,{variant:"link",isInline:!0,onClick:()=>{const l=e.filter((e=>void 0===n.find((t=>t===e.categoryKey)))).reduce(((e,t)=>({...e,[t.categoryKey]:void 0})),{});a({...t,...l})}},"Clear all filters")),e.filter((e=>void 0===n.find((t=>t===e.categoryKey)))).map((e=>l.createElement(S.a,{key:e.categoryKey},l.createElement(P.B,{hasGutter:!0},l.createElement(S.a,null,l.createElement(o.n,null,l.createElement(u.E,{component:"h4"},e.title))),l.createElement(S.a,null,l.createElement(q,{category:e,filterValue:t[e.categoryKey],setFilterValue:l=>((e,l)=>a({...t,[e.categoryKey]:l}))(e,l),isDisabled:r,isSidebar:!0}))))))));var J=a(30426),_=a(36390),W=a(14310);function Z(e,t){return{Component:e,props:t}}const H=[Z(_.c,{}),Z(J.a,{}),Z(W.y,{})],X=(j=H,({children:e})=>{const t=l.createElement(l.Fragment,null,e);return j.reduceRight(((e,{Component:t,props:a={}})=>l.createElement(t,{...a},e)),t)});var j,G=a(67475),z=a(59013),Q=a(1159);const U=()=>l.createElement(X,null,l.createElement(ee,null)),ee=()=>{const{tableControls:e}=l.useContext(_.L),{tableControls:t}=l.useContext(J.Y),{tableControls:a}=l.useContext(W.u),{totalItemCount:P,tableControls:{propHelpers:{filterPanelProps:S}}}=l.useContext(_.L),{totalItemCount:x,tableControls:{propHelpers:{filterPanelProps:K}}}=l.useContext(J.Y),{totalItemCount:F,tableControls:{propHelpers:{filterPanelProps:k}}}=l.useContext(W.u),[w,I]=l.useState(""),[M,D]=l.useState(0),V=l.createRef();return l.createElement(l.Fragment,null,l.createElement(n.d8,{variant:n.zC.light},l.createElement(i.M,{isStatic:!0},l.createElement(s.P,null,l.createElement(c.$,{align:{default:"alignLeft"}},l.createElement(o.n,null,l.createElement(u.E,{component:"h1"},"Search"))),l.createElement(c.$,{variant:"icon-button-group",align:{default:"alignRight"}},l.createElement(c.$,{visibility:{default:"hidden",lg:"visible"}},l.createElement(m.T,{widths:{default:"500px"}},l.createElement(d.D,{placeholder:"Search for an SBOM, Package, or Vulnerability",value:w,onChange:(e,t)=>(e=>{I(e)})(t),onClear:()=>{I("")},onKeyDown:l=>{l.key&&"Enter"!==l.key||(e.filterState.setFilterValues({...e.filterState.filterValues,"":[w]}),t.filterState.setFilterValues({...t.filterState.filterValues,"":[w]}),a.filterState.setFilterValues({...a.filterState.filterValues,"":[w]}))}}))))))),l.createElement(n.d8,null,l.createElement(E.x,{hasGutter:!0},l.createElement(p.E,{md:2},l.createElement(y.Z,{isFullHeight:!0},l.createElement(h.b,null,0===M?l.createElement(Y,{omitFilterCategoryKeys:[""],...S}):1===M?l.createElement(Y,{omitFilterCategoryKeys:[""],...K}):2===M?l.createElement(Y,{omitFilterCategoryKeys:[""],...k}):null))),l.createElement(p.E,{md:10},l.createElement(g.t,{isBox:!0,activeKey:M,onSelect:(e,t)=>{D(t)},"aria-label":"Tabs",role:"region"},l.createElement(b.o,{eventKey:0,title:l.createElement(v.V,null,"SBOMs","  ",l.createElement(f.E,{screenReaderText:"Search Result Count"},P)),actions:l.createElement(l.Fragment,null,l.createElement(C.o,{"aria-label":"SBOM help popover",ref:V},l.createElement(T.Ay,null)),(N=V,l.createElement(r.A,{bodyContent:l.createElement("div",null,"Software Bill of Materials for Products and Containers."),position:"right",triggerRef:N})))},l.createElement(z.Y,null)),l.createElement(b.o,{eventKey:1,title:l.createElement(v.V,null,"Packages","  ",l.createElement(f.E,{screenReaderText:"Search Result Count"},x))},l.createElement(G.N,null)),l.createElement(b.o,{eventKey:2,title:l.createElement(v.V,null,"Vulnerabilities","  ",l.createElement(f.E,{screenReaderText:"Search Result Count"},F))},l.createElement(Q.fk,null)))))));var N}},14310:(e,t,a)=>{a.d(t,{u:()=>o,y:()=>u});var l=a(63696),r=a(87043),n=a(86820),i=a(70611),s=a(5098),c=a(74932);const o=l.createContext({}),u=({children:e})=>{const t=(0,i.MM)({tableName:"vulnerability",persistenceKeyPrefix:n.rt.vulnerabilities,columnNames:{identifier:"Name",title:"Description",severity:"CVSS",published:"Published",packages:"Packages",sboms:"SBOMs"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"average_severity",title:"CVSS",placeholderText:"CVSS",type:r.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:a,total:u},isFetching:m,fetchError:d}=(0,c.WJ)((0,i.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score"}})),E=(0,i.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:u,isLoading:m,selectionState:(0,s.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return l.createElement(o.Provider,{value:{totalItemCount:u,isFetching:m,fetchError:d,tableControls:E}},e)}},1159:(e,t,a)=>{a.d(t,{fk:()=>D});var l=a(63696),r=a(49348),n=a(76072),i=a(97299),s=a(17327),c=a(64361),o=a(71603),u=a(65753),m=a(24974),d=a(21639),E=a(3939),p=a(85578),y=a(16646),h=a(31065),g=a(77819),b=a(28516),v=a(3629),f=a(62101),C=a(38139),T=a(24417),P=a(50705),S=a(52302),x=a(1349),K=a(62520),F=a(74932),k=a(34066),w=a(70400),I=a(65636),M=a(14310);const D=()=>{const{pushNotification:e}=l.useContext(P.K),{isFetching:t,fetchError:a,totalItemCount:T,tableControls:w}=l.useContext(M.u),I=(0,F.o5)((t=>{e({title:`The Vulnerability ${t.identifier} was deleted`,variant:"danger"})}),(t=>{e({title:"Error occurred while deleting the vulnerability",variant:"danger"})})),{numRenderedColumns:D,currentPageItems:R,propHelpers:{paginationProps:O,tableProps:A,getThProps:B,getTrProps:L,getTdProps:$,getExpandedContentTdProps:q},expansionDerivedState:{isCellExpanded:Y}}=w;return l.createElement(l.Fragment,null,l.createElement(p.X,{...A,"aria-label":"Vulnerability table"},l.createElement(y.d,null,l.createElement(h.Tr,null,l.createElement(K.Ze,{...w},l.createElement(g.Th,{...B({columnKey:"identifier"})}),l.createElement(g.Th,{...B({columnKey:"title"})}),l.createElement(g.Th,{...B({columnKey:"severity"})}),l.createElement(g.Th,{...B({columnKey:"published"})}),l.createElement(g.Th,{...B({columnKey:"packages"})}),l.createElement(g.Th,{...B({columnKey:"sboms"})})))),l.createElement(K.nJ,{isLoading:t,isError:!!a,isNoData:0===T,numRenderedColumns:D},R.map(((e,t)=>l.createElement(b.N,{key:e.identifier,isExpanded:Y(e)},l.createElement(h.Tr,{...L({item:e})},l.createElement(K.Oi,{...w,item:e,rowIndex:t},l.createElement(v.Td,{width:15,...$({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},l.createElement(r.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),l.createElement(v.Td,{width:45,modifier:"truncate",...$({columnKey:"title"})},e.title||e.description),l.createElement(v.Td,{width:10,...$({columnKey:"severity"})},e.average_severity&&l.createElement(S.h,{value:e.average_severity})),l.createElement(v.Td,{width:10,...$({columnKey:"published"})},(0,k.Yq)(e.published)),l.createElement(v.Td,{width:10,modifier:"truncate",...$({columnKey:"packages",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"Packages"),l.createElement(v.Td,{width:10,modifier:"truncate",...$({columnKey:"sboms",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"SBOMs"),l.createElement(v.Td,{isActionCell:!0},l.createElement(f.G,{items:[{title:"Delete",onClick:()=>I.mutate(e.identifier)}]})))),Y(e)?l.createElement(h.Tr,{isExpanded:!0},l.createElement(v.Td,{...q({item:e})},l.createElement(C.g,null,l.createElement("div",{className:"pf-v5-u-m-md"},Y(e,"identifier")?l.createElement(l.Fragment,null,l.createElement(n.x,{hasGutter:!0},l.createElement(i.E,{md:8},l.createElement(s.Z,{isFullHeight:!0,isCompact:!0},l.createElement(c.Z,null,"General view"),l.createElement(o.b,null,l.createElement(u.B,{columnModifier:{default:"2Col"}},l.createElement(m.W,null,l.createElement(d.X,null,"Published"),l.createElement(E.d,null,(0,k.Yq)(e.published))),l.createElement(m.W,null,l.createElement(d.X,null,"Modified"),l.createElement(E.d,null,(0,k.Yq)(e.modified))),l.createElement(m.W,null,l.createElement(d.X,null,"Released"),l.createElement(E.d,null,(0,k.Yq)(e.released))),l.createElement(m.W,null,l.createElement(d.X,null,"Withdrawn"),l.createElement(E.d,null,(0,k.Yq)(e.withdrawn))))))),l.createElement(i.E,{md:4},l.createElement(s.Z,{isFullHeight:!0,isCompact:!0},l.createElement(c.Z,null,"Additional info"),l.createElement(o.b,null,l.createElement(u.B,null,l.createElement(m.W,null,l.createElement(d.X,null,"CWE"),l.createElement(E.d,null,"item.cwe")),l.createElement(m.W,null,l.createElement(d.X,null,"Non normative"),l.createElement(E.d,null,e.normative?"Yes":"No")))))))):null,Y(e,"packages")?l.createElement(l.Fragment,null,l.createElement(V,{vulnerabilityId:e.identifier})):null,Y(e,"sboms")?l.createElement(l.Fragment,null,l.createElement(N,{vulnerabilityId:e.identifier})):null)))):null))))),l.createElement(x.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:O}))},V=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:a,fetchError:r}=(0,F.uN)(e);return l.createElement(T.a,{isFetching:a,fetchError:r},l.createElement(w.n,{variant:"compact",initialItemsPerPage:5,advisories:t?.advisories??[]}))},N=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:a,fetchError:r}=(0,F.uN)(e);return l.createElement(T.a,{isFetching:a,fetchError:r},l.createElement(I.m,{variant:"compact",advisories:t?.advisories??[]}))}},17993:(e,t,a)=>{a.d(t,{Lx:()=>c,Si:()=>o,sl:()=>u});var l=a(7616),r=a(77347),n=a(40752),i=a(70611);const s="packages",c=(e={},t=!1)=>{const{data:a,isLoading:c,error:o,refetch:u}=(0,l.I)({queryKey:[s,e],queryFn:()=>(0,n.UD)({client:r.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e},isFetching:c,fetchError:o,refetch:u}},o=e=>{const{data:t,isLoading:a,error:i}=(0,l.I)({queryKey:[s,e],queryFn:()=>(0,n.Y0)({client:r.S,path:{key:e}})});return{pkg:t?.data,isFetching:a,fetchError:i}},u=(e,t={})=>{const{data:a,isLoading:c,error:o,refetch:u}=(0,l.I)({queryKey:[s,"by-sbom",e,t],queryFn:()=>(0,n.Ad)({client:r.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:t},isFetching:c,fetchError:o,refetch:u}}}}]);
//# sourceMappingURL=586.27fef1a0.min.js.map