"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[159],{16177:(e,t,l)=>{l.d(t,{a:()=>r});var n=l(63696),a=l(891);const r=({value:e})=>n.createElement(n.Fragment,null,Object.entries(e).map((([e,t],l)=>n.createElement(a.J,{key:l,isCompact:!0},`${e}=${t}`))))},16017:(e,t,l)=>{l.r(t),l.d(t,{default:()=>H});var n=l(63696),a=l(68430),r=l(1180),i=l(72785),c=l(13867),m=l(16459),s=l(71592),o=l(40111),u=l(69673),d=l(70414),E=l(8210),p=l(80876),v=l(24417),h=l(52302),y=l(74932),g=l(20653),f=l(35048),P=l(4433),b=l(77635),T=l(2408),w=l(341),C=l(40319),A=l(16646),K=l(9425),k=l(77819),F=l(28516),S=l(3629),N=l(80863),x=l(87043),V=l(77307),X=l(1349),_=l(62520),I=l(70611),W=l(34066);const M=({variant:e,advisories:t})=>{const[l,a]=n.useState(null),[i,c]=n.useState(null),m=(0,I.vY)({variant:e,tableName:"advisory-table",idProperty:"uuid",items:t,isLoading:!1,columnNames:{identifier:"Name",title:"Description",severity:"CVSS",published:"Published",modified:"Modified"},hasActionsColumn:!1,isSortEnabled:!1,isPaginationEnabled:!0,initialItemsPerPage:10,isFilterEnabled:!1}),{currentPageItems:s,numRenderedColumns:o,propHelpers:{toolbarProps:u,filterToolbarProps:d,paginationToolbarItemProps:E,paginationProps:p,tableProps:v,getThProps:y,getTrProps:M,getTdProps:q}}=m;return n.createElement(n.Fragment,null,m.isFilterEnabled&&n.createElement(g.M,{...u},n.createElement(f.P,null,n.createElement(x.Us,{showFiltersSideBySide:!0,...d}),n.createElement(P.T,{...E},n.createElement(X.n,{idPrefix:"advisory-table",isTop:!0,paginationProps:p})))),n.createElement(C.X,{...v,"aria-label":"Advisory table"},n.createElement(A.d,null,n.createElement(K.Tr,null,n.createElement(_.Ze,{...m},n.createElement(k.Th,{...y({columnKey:"identifier"})}),n.createElement(k.Th,{...y({columnKey:"title"})}),n.createElement(k.Th,{...y({columnKey:"severity"})}),n.createElement(k.Th,{...y({columnKey:"published"})}),n.createElement(k.Th,{...y({columnKey:"modified"})})))),n.createElement(_.nJ,{isLoading:!1,isError:void 0,isNoData:0===t.length,numRenderedColumns:o},n.createElement(F.N,null,s?.map((e=>n.createElement(K.Tr,{key:e.identifier,...M({item:e})},n.createElement(S.Td,{width:15,...q({columnKey:"identifier"})},n.createElement(b.$n,{size:"sm",variant:b.Ak.secondary,onClick:()=>{return t=e,a("showAdvisory"),void c(t);var t}},e.identifier)),n.createElement(S.Td,{width:50,modifier:"truncate",...q({columnKey:"title"})},e.title),n.createElement(S.Td,{width:10,modifier:"truncate",...q({columnKey:"severity"})},e.severity&&n.createElement(h.h,{value:e.severity})),n.createElement(S.Td,{width:10,modifier:"truncate",...q({columnKey:"published"})},(0,W.Yq)(e.published)),n.createElement(S.Td,{width:10,modifier:"truncate",...q({columnKey:"modified"})},(0,W.Yq)(e.modified)))))))),n.createElement(X.n,{idPrefix:"advisory-table",isTop:!1,isCompact:!0,paginationProps:p}),n.createElement(V.q,{isExpanded:null!==l,onCloseClick:()=>a(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:n.createElement(n.Fragment,null,"showAdvisory"===l&&n.createElement(r.n,null,n.createElement(T.h,{headingLevel:"h2",size:"lg",className:w.A.mtXs},"Advisory")))},"showAdvisory"===l&&n.createElement(n.Fragment,null,i&&n.createElement(N.c,{advisoryId:i?.uuid}))))};var q=l(65753),R=l(24974),L=l(21639),Y=l(3939);const z=({vulnerability:e})=>n.createElement(n.Fragment,null,n.createElement(r.n,null,n.createElement(i.E,null,e.title||e.description)),n.createElement("br",null),n.createElement(q.B,{columnModifier:{default:"2Col"}},n.createElement(R.W,null,n.createElement(L.X,null,"Published"),n.createElement(Y.d,null,(0,W.Yq)(e.published))),n.createElement(R.W,null,n.createElement(L.X,null,"Modified"),n.createElement(Y.d,null,(0,W.Yq)(e.modified))),n.createElement(R.W,null,n.createElement(L.X,null,"Released"),n.createElement(Y.d,null,(0,W.Yq)(e.released))),n.createElement(R.W,null,n.createElement(L.X,null,"Withdrawn"),n.createElement(Y.d,null,(0,W.Yq)(e.withdrawn))),n.createElement(R.W,null,n.createElement(L.X,null,"CWEs"),n.createElement(Y.d,null,"vulnerability.cwes")),n.createElement(R.W,null,n.createElement(L.X,null,"Non normative"),n.createElement(Y.d,null,e.normative?"Yes":"No"))));var B=l(891),O=l(16177);const $=({decomposedPurl:e})=>n.createElement(q.B,null,n.createElement(R.W,null,n.createElement(L.X,null,"Name"),n.createElement(Y.d,null,e.name)),n.createElement(R.W,null,n.createElement(L.X,null,"Namespace"),n.createElement(Y.d,null,e.namespace)),n.createElement(R.W,null,n.createElement(L.X,null,"Type"),n.createElement(Y.d,null,e.type)),e.version&&n.createElement(R.W,null,n.createElement(L.X,null,"Version"),n.createElement(Y.d,null,e.version)),e.path&&n.createElement(R.W,null,n.createElement(L.X,null,"Path"),n.createElement(Y.d,null,e.path)),e.qualifiers&&n.createElement(R.W,null,n.createElement(L.X,null,"Qualifiers"),n.createElement(Y.d,null,n.createElement(O.a,{value:e.qualifiers}))));var J=l(15311);const U=({value:e})=>{if(!e)return null;let t=e;return t.cpe?t.cpe:e.purl},D=({variant:e,initialItemsPerPage:t,advisories:l})=>{const[a,i]=n.useState(null),[c,m]=n.useState(null),s=(e,t)=>{i(e),m(t)},o=n.useMemo((()=>l.flatMap((e=>Object.entries(e.purls??{}).flatMap((([t,l])=>l.map((l=>{const n=l.base_purl;return{basePurl:{...n},advisory:{...e},status:t,context:l.context,versionRange:l.version,decomposedPurl:(0,W.fe)(n.purl)}}))))))),[l]),u=(0,J.f)(o,(e=>`${e.basePurl.purl}-${e.advisory.identifier}-${e.status}`)),d=n.useMemo((()=>{const e=new Set;return o.forEach((t=>e.add(t.status))),e}),[o]),E=(0,I.vY)({variant:e,tableName:"package-table",idProperty:"_ui_unique_id",items:u,isLoading:!1,columnNames:{name:"Name",namespace:"Namespace",affectedVersions:"Affected version",advisory:"Advisory",context:"Context",status:"Status"},hasActionsColumn:!1,isSortEnabled:!1,sortableColumns:["name"],getSortValues:e=>({name:e.decomposedPurl?.name??e.basePurl.purl}),isPaginationEnabled:!0,initialItemsPerPage:t,isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:x.RJ.search,getItemValue:e=>e.decomposedPurl?.name??e.basePurl.purl},{categoryKey:"status",title:"Status",placeholderText:"Status",type:x.RJ.multiselect,selectOptions:Array.from(d).map((e=>({value:e,label:e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")}))),matcher:(e,t)=>t.status===e}],isExpansionEnabled:!1}),{currentPageItems:p,numRenderedColumns:v,propHelpers:{toolbarProps:h,filterToolbarProps:y,paginationToolbarItemProps:M,paginationProps:q,tableProps:R,getThProps:L,getTrProps:Y,getTdProps:z}}=E;return n.createElement(n.Fragment,null,n.createElement(g.M,{...h},n.createElement(f.P,null,n.createElement(x.Us,{showFiltersSideBySide:!0,...y}),n.createElement(P.T,{...M},n.createElement(X.n,{idPrefix:"package-table",isTop:!0,paginationProps:q})))),n.createElement(C.X,{...R,"aria-label":"Package table"},n.createElement(A.d,null,n.createElement(K.Tr,null,n.createElement(_.Ze,{...E},n.createElement(k.Th,{...L({columnKey:"name"})}),n.createElement(k.Th,{...L({columnKey:"namespace"})}),n.createElement(k.Th,{...L({columnKey:"affectedVersions"})}),n.createElement(k.Th,{...L({columnKey:"advisory"})}),n.createElement(k.Th,{...L({columnKey:"context"})}),n.createElement(k.Th,{...L({columnKey:"status"})})))),n.createElement(_.nJ,{isLoading:!1,isError:void 0,isNoData:0===o.length,numRenderedColumns:v},p?.map(((e,t)=>n.createElement(F.N,{key:e.basePurl.purl},n.createElement(K.Tr,{...Y({item:e})},n.createElement(_.Oi,{...E,item:e,rowIndex:t},n.createElement(S.Td,{width:25,modifier:"truncate",...z({columnKey:"name"})},n.createElement(b.$n,{size:"sm",variant:b.Ak.secondary,onClick:()=>s("showPackage",e)},e.decomposedPurl?e.decomposedPurl?.name:e.basePurl.purl)),n.createElement(S.Td,{width:15,modifier:"truncate",...z({columnKey:"namespace"})},e.decomposedPurl?.namespace),n.createElement(S.Td,{width:10,...z({columnKey:"affectedVersions"})},n.createElement(B.J,{color:"grey"},e.versionRange)),n.createElement(S.Td,{width:15,modifier:"truncate",...z({columnKey:"advisory"})},n.createElement(b.$n,{size:"sm",variant:b.Ak.secondary,onClick:()=>s("showAdvisory",e)},e.advisory.identifier)),n.createElement(S.Td,{width:25,modifier:"truncate",...z({columnKey:"context"})},n.createElement(U,{value:e.context})),n.createElement(S.Td,{width:10,modifier:"truncate",...z({columnKey:"status"})},n.createElement(B.J,null,e.status.charAt(0).toUpperCase()+e.status.slice(1).replace("_"," ")))))))))),n.createElement(X.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:q}),n.createElement(V.q,{isExpanded:null!==a,onCloseClick:()=>i(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:n.createElement(n.Fragment,null,"showPackage"===a&&n.createElement(r.n,null,n.createElement(T.h,{headingLevel:"h2",size:"lg",className:w.A.mtXs},"Package")),"showAdvisory"===a&&n.createElement(r.n,null,n.createElement(T.h,{headingLevel:"h2",size:"lg",className:w.A.mtXs},"Advisory")))},"showPackage"===a&&n.createElement(n.Fragment,null,c?.decomposedPurl&&n.createElement($,{decomposedPurl:c?.decomposedPurl})),"showAdvisory"===a&&n.createElement(n.Fragment,null,c?.advisory&&n.createElement(N.c,{advisoryId:c?.advisory.uuid}))))};var j=l(65636);const H=()=>{const e=(0,p.Lu)(p.vO.VULNERABILITY_ID),[t,l]=(0,n.useState)(0),{vulnerability:g,isFetching:f,fetchError:P}=(0,y.uN)(e);return n.createElement(n.Fragment,null,n.createElement(a.d8,{variant:a.zC.light},n.createElement(r.n,null,n.createElement(i.E,{component:"h1"},g?.identifier??"",g?.average_severity?n.createElement(h.h,{value:g.average_severity}):n.createElement(n.Fragment,null))),n.createElement("div",{className:"pf-v5-u-m-md"},n.createElement(v.a,{isFetching:f,fetchError:P},g&&n.createElement(z,{vulnerability:g})))),n.createElement(c.c,{component:"div"}),n.createElement(a.d8,{padding:{default:"padding"}},n.createElement(m.t,{activeKey:t,"aria-label":"CVE detail tabs",onSelect:(e,t)=>{l(t)},role:"region"},n.createElement(s.o,{eventKey:0,title:n.createElement(o.V,null,"SBOMs"),"aria-label":"Related SBOMs for this CVE",actions:n.createElement(n.Fragment,null,n.createElement(u.A,{bodyContent:n.createElement("div",null,"SBOMs that are ",n.createElement("strong",null,"mentioned")," in the current Vulnerability."),position:"top"},n.createElement(d.o,null,n.createElement(E.Ay,null))))},n.createElement("div",{className:"pf-v5-u-m-md"},n.createElement(v.a,{isFetching:f,fetchError:P},g&&n.createElement(j.m,{advisories:g.advisories})))),n.createElement(s.o,{eventKey:1,title:n.createElement(o.V,null,"Advisories"),"aria-label":"Advisories that explain the current Vulnerability",actions:n.createElement(n.Fragment,null,n.createElement(u.A,{bodyContent:n.createElement("div",null,"Advisories that explain the current Vulnerability"),position:"top"},n.createElement(d.o,null,n.createElement(E.Ay,null))))},n.createElement("div",{className:"pf-v5-u-m-md"},n.createElement(v.a,{isFetching:f,fetchError:P},g&&n.createElement(M,{advisories:g.advisories})))),n.createElement(s.o,{eventKey:2,title:n.createElement(o.V,null,"Packages"),actions:n.createElement(n.Fragment,null,n.createElement(u.A,{bodyContent:n.createElement("div",null,"Packages that are ",n.createElement("strong",null,"mentioned")," in the current Vulnerability."),position:"top"},n.createElement(d.o,null,n.createElement(E.Ay,null))))},n.createElement("div",{className:"pf-v5-u-m-md"},n.createElement(v.a,{isFetching:f,fetchError:P},g&&n.createElement(D,{advisories:g.advisories})))))))}}}]);
//# sourceMappingURL=159.e9d69b17.min.js.map