"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[535],{80404:(e,t,l)=>{l.r(t),l.d(t,{default:()=>le});var a=l(63696),n=l(49348),r=l(68430),i=l(98261),s=l(75530),c=l(1180),o=l(72785),m=l(23665),u=l(70414),d=l(8210),E=l(71523),y=l(80876),p=l(17993),h=l(34066),v=l(20653),b=l(35048),g=l(4433),f=l(77635),P=l(28341),T=l(341),S=l(85578),w=l(16646),k=l(31065),I=l(77819),C=l(28516),K=l(3629),x=l(86820),A=l(33273),F=l(67837),_=l(77307),q=l(78833),N=l(1349),L=l(62520),M=l(70611),X=l(5098),$=l(91728);const W=({packageId:e})=>{const[t,l]=a.useState(null),[n,r]=a.useState(null),i=(0,M.MM)({tableName:"sboms",persistenceKeyPrefix:x.rt.sboms_by_package,columnNames:{name:"Name",published:"Published",labels:"Labels"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:A.RJ.search}]}),{result:{data:s,total:o},isFetching:m,fetchError:u}=(0,$.Qr)(e,(0,M.Ng)({...i,hubSortFieldKeys:{}})),d=(0,M.PB)({...i,idProperty:"id",currentPageItems:s,totalItemCount:o,isLoading:m,selectionState:(0,X.$)({items:s,isEqual:(e,t)=>e.id===t.id})}),{numRenderedColumns:E,currentPageItems:y,propHelpers:{toolbarProps:p,filterToolbarProps:W,paginationToolbarItemProps:z,paginationProps:B,tableProps:J,getThProps:R,getTrProps:V,getTdProps:Y}}=d;return a.createElement(a.Fragment,null,a.createElement(v.M,{...p},a.createElement(b.P,null,a.createElement(A.Us,{showFiltersSideBySide:!0,...W}),a.createElement(g.T,{...z},a.createElement(N.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:B})))),a.createElement(S.X,{...J,"aria-label":"SBOM table"},a.createElement(w.d,null,a.createElement(k.Tr,null,a.createElement(L.Ze,{...d},a.createElement(I.Th,{...R({columnKey:"name"})}),a.createElement(I.Th,{...R({columnKey:"published"})}),a.createElement(I.Th,{...R({columnKey:"labels"})})))),a.createElement(L.nJ,{isLoading:m,isError:!!u,isNoData:0===o,numRenderedColumns:E},y?.map((e=>a.createElement(C.N,{key:e.id},a.createElement(k.Tr,{...V({item:e})},a.createElement(K.Td,{width:35,...Y({columnKey:"name"})},a.createElement(f.$n,{size:"sm",variant:f.Ak.secondary,onClick:()=>{return t=e,l("showSbom"),void r(t);var t}},e.name)),a.createElement(K.Td,{width:10,modifier:"truncate",...Y({columnKey:"published"})},(0,h.Yq)(e.published)),a.createElement(K.Td,{width:35,modifier:"truncate",...Y({columnKey:"labels"})},e.labels&&a.createElement(F.g,{value:e.labels})))))))),a.createElement(N.n,{idPrefix:"sboms-table",isTop:!1,isCompact:!0,paginationProps:B}),a.createElement(_.q,{isExpanded:null!==t,onCloseClick:()=>l(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:a.createElement(a.Fragment,null,"showSbom"===t&&a.createElement(c.n,null,a.createElement(P.h,{headingLevel:"h2",size:"lg",className:T.A.mtXs},"Advisory")))},"showSbom"===t&&a.createElement(a.Fragment,null,n&&a.createElement(q.Y,{sbomId:n.id}))))};var z=l(891),B=l(77347),J=l(40752),R=l(80863),V=l(52302),Y=l(74932),O=l(65753),D=l(24974),U=l(21639),H=l(3939),Q=l(92939),Z=l(24417);const G=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:r}=(0,Y.uN)(e);return a.createElement(Z.a,{isFetching:l,fetchError:r},a.createElement(O.B,null,a.createElement(D.W,null,a.createElement(U.X,null,"Identifier"),a.createElement(H.d,null,a.createElement(f.$n,{variant:"link",isInline:!0,icon:a.createElement(Q.Ay,null)},a.createElement(n.k2,{to:`/vulnerabilities/${t?.identifier}`},t?.identifier)))),a.createElement(D.W,null,a.createElement(U.X,null,"Severity"),a.createElement(H.d,null,t?.average_severity&&a.createElement(V.h,{value:t?.average_severity}))),a.createElement(D.W,null,a.createElement(U.X,null,"Title"),a.createElement(H.d,null,t?.title||t?.description)),a.createElement(D.W,null,a.createElement(U.X,null,"CWE"),a.createElement(H.d,null,"vulnerability?.cwe")),a.createElement(D.W,null,a.createElement(U.X,null,"Published"),a.createElement(H.d,null,(0,h.Yq)(t?.published))),a.createElement(D.W,null,a.createElement(U.X,null,"Modified"),a.createElement(H.d,null,(0,h.Yq)(t?.modified))),a.createElement(D.W,null,a.createElement(U.X,null,"Withdrawn"),a.createElement(H.d,null,(0,h.Yq)(t?.withdrawn))),a.createElement(D.W,null,a.createElement(U.X,null,"Released"),a.createElement(H.d,null,(0,h.Yq)(t?.released)))))};var j=l(15311),ee=l(70400);const te=({packageId:e})=>{const[t,l]=a.useState(null),[n,r]=a.useState(null),i=(e,t)=>{l(e),r(t)},{pkg:s,isFetching:o,fetchError:m}=(0,p.Si)(e),[u,d]=a.useState([]),[E,y]=a.useState(new Map),[h,x]=a.useState(!1),[F,q]=a.useState(new Set);a.useEffect((()=>{const e=(s?.advisories??[]).flatMap((e=>e.status.map((t=>({vulnerabilityId:t.vulnerability.identifier,status:t.status,context:t.context,advisory:e}))))).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]),t=new Set;e.forEach((e=>t.add(e.status))),d(e),q(t),x(!0),Promise.all(e.map((async e=>(await(0,J.wk)({client:B.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),l=new Map;t.forEach((e=>l.set(e.identifier,e))),y(l),x(!1)}))}),[s]);const X=a.useMemo((()=>u.map((e=>({...e,vulnerability:E.get(e.vulnerabilityId)})))),[u,E]),$=(0,j.f)(X,(e=>`${e.vulnerabilityId}-${e.advisory.identifier}-${e.advisory.uuid}`)),W=(0,M.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:$,isLoading:!1,columnNames:{identifier:"Identifier",title:"Title",severity:"Severity",advisory:"Advisory",context:"Context",status:"Status"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.vulnerabilityId}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:A.RJ.search,getItemValue:e=>e.vulnerabilityId},{categoryKey:"status",title:"Status",placeholderText:"Status",type:A.RJ.multiselect,selectOptions:Array.from(F).map((e=>({value:e,label:e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")}))),matcher:(e,t)=>t.status===e}],isExpansionEnabled:!1}),{currentPageItems:Y,numRenderedColumns:O,propHelpers:{toolbarProps:D,filterToolbarProps:U,paginationToolbarItemProps:H,paginationProps:Q,tableProps:Z,getThProps:te,getTrProps:le,getTdProps:ae},expansionDerivedState:{isCellExpanded:ne}}=W;return a.createElement(a.Fragment,null,a.createElement(v.M,{...D},a.createElement(b.P,null,a.createElement(A.Us,{showFiltersSideBySide:!0,...U}),a.createElement(g.T,{...H},a.createElement(N.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:Q})))),a.createElement(S.X,{...Z,"aria-label":"vulnerability table"},a.createElement(w.d,null,a.createElement(k.Tr,null,a.createElement(L.Ze,{...W},a.createElement(I.Th,{...te({columnKey:"identifier"})}),a.createElement(I.Th,{...te({columnKey:"title"})}),a.createElement(I.Th,{...te({columnKey:"severity"})}),a.createElement(I.Th,{...te({columnKey:"advisory"})}),a.createElement(I.Th,{...te({columnKey:"context"})}),a.createElement(I.Th,{...te({columnKey:"status"})})))),a.createElement(L.nJ,{isLoading:o||h,isError:!!m,isNoData:0===$.length,numRenderedColumns:O},Y?.map(((e,t)=>a.createElement(C.N,{key:e._ui_unique_id,isExpanded:ne(e)},a.createElement(k.Tr,{...le({item:e})},a.createElement(L.Oi,{...W,item:e,rowIndex:t},a.createElement(K.Td,{width:15,...ae({columnKey:"identifier"})},a.createElement(f.$n,{size:"sm",variant:f.Ak.secondary,onClick:()=>i("showVulnerability",e)},e.vulnerabilityId)),a.createElement(K.Td,{width:35,modifier:"truncate",...ae({columnKey:"title"})},e.vulnerability?.title),a.createElement(K.Td,{width:10,...ae({columnKey:"severity"})},e.vulnerability?.average_severity&&a.createElement(V.h,{value:e.vulnerability.average_severity})),a.createElement(K.Td,{width:15,modifier:"truncate",...ae({columnKey:"advisory"})},a.createElement(f.$n,{size:"sm",variant:f.Ak.secondary,onClick:()=>i("showAdvisory",e)},e.advisory.identifier)),a.createElement(K.Td,{width:25,modifier:"truncate",...ae({columnKey:"context"})},a.createElement(ee.L,{value:e.context})),a.createElement(K.Td,{width:10,modifier:"truncate",...ae({columnKey:"status"})},a.createElement(z.J,null,e.status.charAt(0).toUpperCase()+e.status.slice(1).replace("_"," ")))))))))),a.createElement(N.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:Q}),a.createElement(_.q,{isExpanded:null!==t,onCloseClick:()=>l(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:a.createElement(a.Fragment,null,"showVulnerability"===t&&a.createElement(c.n,null,a.createElement(P.h,{headingLevel:"h2",size:"lg",className:T.A.mtXs},"Vulnerability")),"showAdvisory"===t&&a.createElement(c.n,null,a.createElement(P.h,{headingLevel:"h2",size:"lg",className:T.A.mtXs},"Advisory")))},"showVulnerability"===t&&a.createElement(a.Fragment,null,n?.advisory&&a.createElement(G,{vulnerabilityId:n?.vulnerabilityId}))," ","showAdvisory"===t&&a.createElement(a.Fragment,null,n?.advisory&&a.createElement(R.c,{advisoryId:n?.advisory.uuid}))))},le=()=>{const e=(0,y.Lu)(y.vO.PACKAGE_ID),{pkg:t}=(0,p.Si)(e),l=a.useMemo((()=>t?(0,h.fe)(t.purl):void 0),[t]);return a.createElement(a.Fragment,null,a.createElement(r.d8,{variant:"light"},a.createElement(E.A,{breadcrumbs:a.createElement(i.Q,null,a.createElement(s.J,{key:"packages"},a.createElement(n.N_,{to:"/packages"},"Packages")),a.createElement(s.J,{isActive:!0},"Package details")),pageHeading:{title:l?.name??e??"",iconAfterTitle:t?a.createElement(c.n,null,a.createElement(o.E,{component:"pre"},`version: ${l?.version}`)):void 0,label:t?{children:t?`type=${l?.type}`:"",isCompact:!0}:void 0},actionButtons:[],tabs:[{eventKey:"vulnerabilities",title:"Vulnerabilities",children:a.createElement("div",{className:"pf-v5-u-m-md"},e&&a.createElement(te,{packageId:e})),actions:a.createElement(a.Fragment,null,a.createElement(m.A,{bodyContent:a.createElement("div",null,"Vulnerabilities ",a.createElement("strong",null,"associated")," to the current package."),position:"top"},a.createElement(u.o,null,a.createElement(d.Ay,null))))},{eventKey:"sboms",title:"SBOMs",children:a.createElement("div",{className:"pf-v5-u-m-md"},e&&a.createElement(W,{packageId:e})),actions:a.createElement(a.Fragment,null,a.createElement(m.A,{bodyContent:a.createElement("div",null,"SBOMs that ",a.createElement("strong",null,"contain")," the current package."),position:"top"},a.createElement(u.o,null,a.createElement(d.Ay,null))))}]})))}},17993:(e,t,l)=>{l.d(t,{Lx:()=>c,Si:()=>o,sl:()=>m});var a=l(7616),n=l(77347),r=l(40752),i=l(70611);const s="packages",c=(e={},t=!1)=>{const{data:l,isLoading:c,error:o,refetch:m}=(0,a.I)({queryKey:[s,e],queryFn:()=>(0,r.UD)({client:n.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:e},isFetching:c,fetchError:o,refetch:m}},o=e=>{const{data:t,isLoading:l,error:i}=(0,a.I)({queryKey:[s,e],queryFn:()=>(0,r.Y0)({client:n.S,path:{key:e}})});return{pkg:t?.data,isFetching:l,fetchError:i}},m=(e,t={})=>{const{data:l,isLoading:c,error:o,refetch:m}=(0,a.I)({queryKey:[s,"by-sbom",e,t],queryFn:()=>(0,r.Ad)({client:n.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:t},isFetching:c,fetchError:o,refetch:m}}}}]);
//# sourceMappingURL=535.e18b9c7c.min.js.map