"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[395],{16177:(e,t,l)=>{l.d(t,{a:()=>r});var n=l(63696),a=l(93962);const r=({value:e})=>n.createElement(n.Fragment,null,Object.entries(e).map((([e,t],l)=>n.createElement(a.J,{key:l,isCompact:!0},`${e}=${t}`))))},23560:(e,t,l)=>{l.d(t,{j:()=>a});var n=l(63696);const a=({vulnerability:e})=>n.createElement("p",null,e.withdrawn&&n.createElement("em",null,"Rejected:Â "),e.title||e.description)},14671:(e,t,l)=>{l.r(t),l.d(t,{default:()=>Ee});var n=l(63696),a=l(68430),r=l(54518),c=l(48281),i=l(28338),m=l(70045),u=l(1180),o=l(72785),s=l(93962),d=l(77635),E=l(16459),p=l(71592),b=l(40111),g=l(70414),h=l(69673),f=l(10015),y=l(48783),v=l(8210),T=l(80876),P=l(24417),C=l(91271),x=l(91728),S=l(70028),K=l(76072),k=l(97299),_=l(17327),F=l(64361),I=l(71603),w=l(65753),$=l(24974),B=l(21639),N=l(3939),V=l(94279),X=l(16172),M=l(34066);const W=({sbom:e})=>n.createElement(K.x,{hasGutter:!0},n.createElement(k.E,{md:4},n.createElement(_.Z,{isFullHeight:!0},n.createElement(F.Z,null,"Metadata"),n.createElement(I.b,null,n.createElement(w.B,null,n.createElement($.W,null,n.createElement(B.X,null,"Name"),n.createElement(N.d,null,e.name)),n.createElement($.W,null,n.createElement(B.X,null,"Namespace"),n.createElement(N.d,null,e.document_id)),n.createElement($.W,null,n.createElement(B.X,null,"Data License"),n.createElement(N.d,null,e.data_licenses.join(", "))))))),n.createElement(k.E,{md:4},n.createElement(_.Z,{isFullHeight:!0},n.createElement(F.Z,null,"Creation"),n.createElement(I.b,null,n.createElement(w.B,null,n.createElement($.W,null,n.createElement(B.X,null,"Created"),n.createElement(N.d,null,(0,M.Yq)(e.published))),n.createElement($.W,null,n.createElement(B.X,null,"Creator"),n.createElement(N.d,null,e.authors)))))),n.createElement(k.E,{md:4},n.createElement(_.Z,{isFullHeight:!0},n.createElement(F.Z,null,"Statistics"),n.createElement(I.b,null,n.createElement(w.B,null,n.createElement($.W,null,n.createElement(B.X,null,"Size"),n.createElement(N.d,null,(0,S.A)(e.size))),n.createElement($.W,null,n.createElement(B.X,null,"Packages"),n.createElement(N.d,null,e.number_of_packages)))))),n.createElement(k.E,{md:12},n.createElement(_.Z,{isFullHeight:!0},n.createElement(F.Z,null,"Package"),n.createElement(I.b,null,n.createElement(w.B,null,n.createElement($.W,null,n.createElement(B.X,null,"Name"),n.createElement(N.d,null,e.name)),n.createElement($.W,null,n.createElement(B.X,null,"Version"),n.createElement(N.d,null,e.described_by.map((e=>e.version)).join(", "))),n.createElement($.W,null,n.createElement(B.X,null,"External References"),n.createElement(N.d,null,n.createElement(V.B8,null,e.described_by.flatMap((e=>e.cpe)).map((e=>n.createElement(X.c,null,e))),n.createElement(X.c,null,e.described_by.flatMap((e=>e.purl)).map((e=>e.purl)))))))))));var R=l(49348),Z=l(20653),O=l(35048),q=l(4433),D=l(341),j=l(40319),A=l(16646),J=l(9425),H=l(77819),L=l(28516),Y=l(3629),G=l(38139),U=l(87043),z=l(16177),Q=l(1349),ee=l(62520),te=l(70611),le=l(17993);const ne=({sbomId:e})=>{const{result:{data:t},isFetching:l,fetchError:a}=(0,le.sl)(e,{page:{pageNumber:1,itemsPerPage:0}}),r=(0,n.useMemo)((()=>t.flatMap((e=>e.purl)).map((e=>({...e,decomposedPurl:(0,M.fe)(e.purl)})))),[t]),c=(0,te.vY)({tableName:"package-table",idProperty:"uuid",items:r,isLoading:l,columnNames:{name:"Name",version:"Version",qualifiers:"Qualifiers"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","version"],getSortValues:e=>({name:`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`,version:e.version.version}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter tex",type:U.RJ.search,placeholderText:"Filter",getItemValue:e=>`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`||""}],isExpansionEnabled:!0,expandableVariant:"single"}),{currentPageItems:u,numRenderedColumns:o,propHelpers:{toolbarProps:d,filterToolbarProps:E,paginationToolbarItemProps:p,paginationProps:b,tableProps:g,getThProps:h,getTrProps:f,getTdProps:y,getExpandedContentTdProps:v},expansionDerivedState:{isCellExpanded:T}}=c;return n.createElement(n.Fragment,null,n.createElement(Z.M,{...d},n.createElement(O.P,null,n.createElement(U.Us,{showFiltersSideBySide:!0,...E}),n.createElement(q.T,{...p},n.createElement(Q.n,{idPrefix:"package-table",isTop:!0,paginationProps:b})))),n.createElement(j.X,{...g,"aria-label":"Package table"},n.createElement(A.d,null,n.createElement(J.Tr,null,n.createElement(ee.Ze,{...c},n.createElement(H.Th,{...h({columnKey:"name"})}),n.createElement(H.Th,{...h({columnKey:"version"})}),n.createElement(H.Th,{...h({columnKey:"qualifiers"})})))),n.createElement(ee.nJ,{isLoading:l,isError:!!a,isNoData:0===r?.length,numRenderedColumns:o},u?.map(((e,t)=>n.createElement(L.N,{key:e.uuid},n.createElement(J.Tr,{...f({item:e})},n.createElement(ee.Oi,{...c,item:e,rowIndex:t},n.createElement(Y.Td,{width:30,...y({columnKey:"name"})},n.createElement(i.s,null,n.createElement(m.Z,{spacer:{default:"spacerSm"}},`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`),n.createElement(m.Z,null,n.createElement(s.J,{isCompact:!0,color:"blue"},e.decomposedPurl?.type)))),n.createElement(Y.Td,{width:20,...y({columnKey:"version"})},e.decomposedPurl?.version),n.createElement(Y.Td,{width:50,...y({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&n.createElement(z.a,{value:e.decomposedPurl?.qualifiers})))),T(e)?n.createElement(J.Tr,{isExpanded:!0},n.createElement(Y.Td,null),n.createElement(Y.Td,{...v({item:e}),className:D.A.pyLg},n.createElement(G.g,null,n.createElement(w.B,{columnModifier:{default:"3Col"}},n.createElement($.W,null,n.createElement(B.X,null,"Packages"),n.createElement(N.d,null,n.createElement(V.B8,null,n.createElement(X.c,null,n.createElement(R.N_,{to:`/packages/${e.uuid}`},e.purl))))),n.createElement($.W,null,n.createElement(B.X,null,"Base package"),n.createElement(N.d,null,e.base.purl)),n.createElement($.W,null,n.createElement(B.X,null,"Versions"),n.createElement(N.d,null,n.createElement(V.B8,null,n.createElement(X.c,null,e.version.version)))))))):null))))),n.createElement(Q.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:b}))};var ae=l(51257),re=l(38914),ce=l(57901),ie=l(55399),me=l(52302),ue=l(23560),oe=l(89101),se=l(15311);const de=({sbomId:e})=>{const{sbom:t,isFetching:l,fetchError:a}=(0,x.rj)(e),{vulnerabilities:r,summary:c,isFetching:i,fetchError:m}=(0,oe.U)(e),u=(0,se.f)(r,(e=>`${e.vulnerabilityId}-${e.advisory.identifier}-${e.advisory.uuid}`)),o=(0,te.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:u,isLoading:i,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id"],isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:s,numRenderedColumns:d,propHelpers:{toolbarProps:E,filterToolbarProps:p,paginationToolbarItemProps:b,paginationProps:g,tableProps:h,getThProps:f,getTrProps:y,getTdProps:v,getExpandedContentTdProps:T},expansionDerivedState:{isCellExpanded:C}}=o,S=n.useMemo((()=>Object.keys(c.severities).map((e=>{const t=e,l=c.severities[t],n=ie.Kb[t];return{severity:t,count:l,label:n.name,color:n.color.value}})).sort((0,ie.Sx)((e=>e.severity)))),[c]);return n.createElement(n.Fragment,null,n.createElement(re.B,{hasGutter:!0},n.createElement(ce.a,null,n.createElement(_.Z,null,n.createElement(I.b,null,n.createElement(P.a,{isFetching:i||l},n.createElement(K.x,{hasGutter:!0},n.createElement(k.E,{md:6},n.createElement("div",{style:{height:"230px",width:"350px"}},n.createElement(ae.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${c.total}`,subTitle:"Total vulnerabilities",width:350,legendData:S.map((({label:e,count:t})=>({name:`${e}: ${t}`}))),data:S.map((({label:e,count:t})=>({x:e,y:t}))),labels:({datum:e})=>`${e.x}: ${e.y}`,colorScale:S.map((({color:e})=>e))}))),n.createElement(k.E,{md:6},n.createElement(w.B,null,n.createElement($.W,null,n.createElement(B.X,null,"Name"),n.createElement(N.d,null,t?.name)),n.createElement($.W,null,n.createElement(B.X,null,"Version"),n.createElement(N.d,null,t?.described_by.map((e=>e.version)).join(", "))),n.createElement($.W,null,n.createElement(B.X,null,"Creation date"),n.createElement(N.d,null,(0,M.Yq)(t?.published)))))))))),n.createElement(ce.a,null,n.createElement(Z.M,{...E},n.createElement(O.P,null,n.createElement(q.T,{...b},n.createElement(Q.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:g})))),n.createElement(j.X,{...h,"aria-label":"Vulnerability table"},n.createElement(A.d,null,n.createElement(J.Tr,null,n.createElement(ee.Ze,{...o},n.createElement(H.Th,{...f({columnKey:"id"})}),n.createElement(H.Th,{...f({columnKey:"description"})}),n.createElement(H.Th,{...f({columnKey:"cvss"})}),n.createElement(H.Th,{...f({columnKey:"affectedDependencies"})}),n.createElement(H.Th,{...f({columnKey:"published"})}),n.createElement(H.Th,{...f({columnKey:"updated"})})))),n.createElement(ee.nJ,{isLoading:i,isError:!!m,isNoData:0===u.length,numRenderedColumns:d},s?.map(((e,t)=>n.createElement(L.N,{key:e._ui_unique_id,isExpanded:C(e)},n.createElement(J.Tr,{...y({item:e})},n.createElement(ee.Oi,{...o,item:e,rowIndex:t},n.createElement(Y.Td,{width:15,...v({columnKey:"id"})},n.createElement(R.N_,{to:`/vulnerabilities/${e.vulnerabilityId}`},e.vulnerabilityId)),n.createElement(Y.Td,{width:35,modifier:"truncate",...v({columnKey:"description"})},e.vulnerability&&n.createElement(ue.j,{vulnerability:e.vulnerability})),n.createElement(Y.Td,{width:10,...v({columnKey:"cvss"})},e.vulnerability?.average_severity&&n.createElement(me.h,{value:e.vulnerability.average_severity})),n.createElement(Y.Td,{width:15,modifier:"truncate",...v({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:t})},e.packages.length),n.createElement(Y.Td,{width:10,modifier:"truncate",...v({columnKey:"published"})},(0,M.Yq)(e.vulnerability?.published)),n.createElement(Y.Td,{width:10,modifier:"truncate",...v({columnKey:"updated"})},(0,M.Yq)(e.vulnerability?.modified)))),C(e)?n.createElement(J.Tr,{isExpanded:!0},n.createElement(Y.Td,{...T({item:e})},n.createElement(G.g,null,C(e,"affectedDependencies")?n.createElement(n.Fragment,null,n.createElement(j.X,{variant:"compact"},n.createElement(A.d,null,n.createElement(J.Tr,null,n.createElement(H.Th,null,"Type"),n.createElement(H.Th,null,"Namespace"),n.createElement(H.Th,null,"Name"),n.createElement(H.Th,null,"Version"),n.createElement(H.Th,null,"Path"),n.createElement(H.Th,null,"Qualifiers"))),n.createElement(L.N,null,e.packages.flatMap((e=>e.purl)).map(((e,t)=>{const l=(0,M.fe)(e.purl);return n.createElement(J.Tr,{key:t},n.createElement(Y.Td,null,l?.type),n.createElement(Y.Td,null,l?.namespace),n.createElement(Y.Td,null,l?.name),n.createElement(Y.Td,null,l?.version),n.createElement(Y.Td,null,l?.path),n.createElement(Y.Td,null,l?.qualifiers&&n.createElement(z.a,{value:l?.qualifiers})))}))))):null))):null))))),n.createElement(Q.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:g}))))},Ee=()=>{const[e,t]=n.useState(0),l=n.createRef(),S=n.createRef(),K=n.createRef(),k=n.createRef(),_=(0,T.Lu)(T.vO.SBOM_ID),{sbom:F,isFetching:I,fetchError:w}=(0,x.rj)(_),{downloadSBOM:$}=(0,C.m)();return n.createElement(n.Fragment,null,n.createElement(a.d8,{variant:"light"},n.createElement(r.B,null,n.createElement(c.o,{isFilled:!0},n.createElement(i.s,null,n.createElement(m.Z,{spacer:{default:"spacerSm"}},n.createElement(u.n,null,n.createElement(o.E,{component:"h1"},F?.name??_??""))),n.createElement(m.Z,null,F?.labels.type&&n.createElement(s.J,{color:"blue"},F?.labels.type)))),n.createElement(c.o,null,!I&&n.createElement(d.$n,{variant:"secondary",icon:n.createElement(y.Ay,null),onClick:()=>{_&&$(_,F?.name?`${F?.name}.json`:`${_}.json`)}},"Download")))),n.createElement(a.d8,{type:"nav"},n.createElement(E.t,{mountOnEnter:!0,activeKey:e,onSelect:(e,l)=>{t(l)},"aria-label":"Tabs that contain the SBOM information",role:"region"},n.createElement(p.o,{eventKey:0,title:n.createElement(b.V,null,"Info"),tabContentId:"refTabInfoSection",tabContentRef:l}),n.createElement(p.o,{eventKey:1,title:n.createElement(b.V,null,"Packages"),tabContentId:"refTabPackagesSection",tabContentRef:S}),n.createElement(p.o,{eventKey:2,title:n.createElement(b.V,null,"Vulnerabilities"),tabContentId:"refVulnerabilitiesSection",tabContentRef:K,actions:n.createElement(n.Fragment,null,n.createElement(g.o,{ref:k},n.createElement(v.Ay,null)),n.createElement(h.A,{triggerRef:k,bodyContent:n.createElement("div",null,"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed.")}))}))),n.createElement(a.d8,null,n.createElement(f.J,{eventKey:0,id:"refTabInfoSection",ref:l,"aria-label":"Information of the SBOM"},n.createElement(P.a,{isFetching:I,fetchError:w},F&&n.createElement(W,{sbom:F}))),n.createElement(f.J,{eventKey:1,id:"refTabPackagesSection",ref:S,"aria-label":"Packages within the SBOM",hidden:!0},_&&n.createElement(ne,{sbomId:_})),n.createElement(f.J,{eventKey:2,id:"refVulnerabilitiesSection",ref:K,"aria-label":"Vulnerabilities within the SBOM",hidden:!0},_&&n.createElement(de,{sbomId:_}))))}},15311:(e,t,l)=>{l.d(t,{f:()=>r});var n=l(63696),a=l(86820);const r=(e,t)=>(0,n.useMemo)((()=>e&&0!==e.length?e.map((e=>({...e,[a.FA]:t(e)}))):[]),[e,t])}}]);
//# sourceMappingURL=395.7827f4d8.min.js.map