import type { Meta, StoryObj } from "@storybook/react";
import React from "react";
import { BrowserRouter } from "react-router-dom";
import { AdvisoriesByVulnerability } from "./advisories-by-vulnerability";

const meta = {
  title: "Components/vulnerability-details/advisories-by-vulnerability.tsx",
  component: AdvisoriesByVulnerability,
  parameters: {
    layout: "fullscreen",
  },
  tags: ["autodocs"],
  decorators: [
    (Story) => (
      <BrowserRouter>
        <Story />
      </BrowserRouter>
    ),
  ],
} satisfies Meta<typeof AdvisoriesByVulnerability>;

export default meta;
type Story = StoryObj<typeof meta>;

export const EmptyState: Story = {
  args: {
    isFetching: false,
    advisories: [],
  },
};

export const PrimaryState: Story = {
  args: {
    isFetching: false,
    advisories: [
      {
        uuid: "urn:uuid:753e8448-2086-4908-a027-1f1a7b95fa6a",
        identifier: "CVE-2024-8391",
        issuer: {
          id: "9cf89bf3-ef8d-44ba-87a8-66a324795996",
          name: "eclipse",
          cpe_key: null,
          website: null,
        },
        published: "2024-09-04T15:27:58.478Z",
        modified: "2024-09-04T17:40:20.318Z",
        withdrawn: null,
        title:
          "Eclipse Vert.x gRPC server does not limit the maximum message size",
        labels: {
          type: "cve",
          file: "2024/8xxx/CVE-2024-8391.json",
          importer: "cve",
          source: "https://github.com/CVEProject/cvelistV5",
        },
        severity: null,
        score: null,
        cvss3_scores: [],
        purls: {
          affected: [
            {
              base_purl: {
                uuid: "af66fc9c-65d5-5b36-a169-7a417641fb69",
                purl: "pkg://maven/io.vertx/vertx-grpc-server",
              },
              version: "[4.3.0,4.5.10)",
              context: null,
            },
          ],
        },
        number_of_vulnerabilities: 1,
        sboms: [],
      },
    ],
  },
};
