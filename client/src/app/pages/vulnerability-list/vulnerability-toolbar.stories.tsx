import type { Meta, StoryObj } from "@storybook/react";
import React from "react";
import { VulnerabilityToolbar } from "./vulnerability-toolbar";
import { VulnerabilitySearchContext } from "./vulnerability-context";

const meta = {
  title: "Components/VulnerabilityList/VulnerabilityToolbar",
  component: VulnerabilityToolbar,
  tags: ["autodocs"],
  decorators: [
    (Story, { parameters }) => {
      const { contextDefaultValue } = parameters;
      return (
        <VulnerabilitySearchContext.Provider value={contextDefaultValue}>
          <Story />
        </VulnerabilitySearchContext.Provider>
      );
    },
  ],
} satisfies Meta<typeof VulnerabilityToolbar>;

export default meta;
type Story = StoryObj<typeof meta>;

const customContextData = {
  tableControls: {
    propHelpers: {
      toolbarProps: {
        className: "",
        collapseListedFiltersBreakpoint: "xl",
        clearFiltersButtonText: "Clear all filters",
      },
      tableProps: {
        isExpandable: true,
      },
      filterToolbarProps: {
        filterCategories: [
          {
            categoryKey: "",
            title: "Filter text",
            placeholderText: "Search",
            type: "search",
          },
          {
            categoryKey: "average_severity",
            title: "CVSS",
            placeholderText: "CVSS",
            type: "multiselect",
            selectOptions: [
              {
                value: "none",
                label: "None",
              },
              {
                value: "low",
                label: "Low",
              },
              {
                value: "medium",
                label: "Medium",
              },
              {
                value: "high",
                label: "High",
              },
              {
                value: "critical",
                label: "Critical",
              },
            ],
          },
        ],
        filterValues: {},
      },
      filterPanelProps: {
        filterCategories: [
          {
            categoryKey: "",
            title: "Filter text",
            placeholderText: "Search",
            type: "search",
          },
          {
            categoryKey: "average_severity",
            title: "CVSS",
            placeholderText: "CVSS",
            type: "multiselect",
            selectOptions: [
              {
                value: "none",
                label: "None",
              },
              {
                value: "low",
                label: "Low",
              },
              {
                value: "medium",
                label: "Medium",
              },
              {
                value: "high",
                label: "High",
              },
              {
                value: "critical",
                label: "Critical",
              },
            ],
          },
        ],
        filterValues: {},
      },
      paginationProps: {
        itemCount: 106717,
        perPage: 10,
        page: 1,
      },
      paginationToolbarItemProps: {
        variant: "pagination",
        align: {
          default: "alignRight",
        },
      },
      toolbarBulkSelectorProps: {
        areAllSelected: false,
        selectedRows: [],
        paginationProps: {
          itemCount: 106717,
          perPage: 10,
          page: 1,
        },
        currentPageItems: [
          {
            normative: true,
            identifier: "CVE-2012-2055",
            title:
              'GitHub Enterprise before 20120304 does not properly restrict the use of a hash to provide values for a model\'s attributes, which allows remote attackers to set the public_key[user_id] value via a modified URL for the public-key update form, related to a "mass assignment" vulnerability.',
            description:
              'GitHub Enterprise before 20120304 does not properly restrict the use of a hash to provide values for a model\'s attributes, which allows remote attackers to set the public_key[user_id] value via a modified URL for the public-key update form, related to a "mass assignment" vulnerability.',
            reserved: "2012-04-04T00:00:00Z",
            published: "2012-04-04T10:00:00Z",
            modified: "2024-08-06T19:17:27.693Z",
            withdrawn: null,
            discovered: null,
            released: null,
            cwes: [],
            average_severity: null,
            average_score: null,
            advisories: [
              {
                uuid: "urn:uuid:688edfe3-b1e7-4591-b7c0-83b5be458f29",
                identifier: "CVE-2012-2055",
                issuer: {
                  id: "3bc1fd81-9c49-4df6-9edb-2fc18d49f283",
                  name: "mitre",
                  cpe_key: null,
                  website: null,
                },
                published: "2012-04-04T10:00:00Z",
                modified: "2024-08-06T19:17:27.693Z",
                withdrawn: null,
                title:
                  'GitHub Enterprise before 20120304 does not properly restrict the use of a hash to provide values for a model\'s attributes, which allows remote attackers to set the public_key[user_id] value via a modified URL for the public-key update form, related to a "mass assignment" vulnerability.',
                labels: {
                  importer: "cve",
                  file: "2012/2xxx/CVE-2012-2055.json",
                  type: "cve",
                  source: "https://github.com/CVEProject/cvelistV5",
                },
                severity: null,
                score: null,
              },
            ],
          },
          {
            normative: true,
            identifier: "CVE-2012-2054",
            title:
              'Redmine before 1.3.2 does not properly restrict the use of a hash to provide values for a model\'s attributes, which allows remote attackers to set attributes in the (1) Comment, (2) Document, (3) IssueCategory, (4) MembersController, (5) Message, (6) News, (7) TimeEntry, (8) Version, (9) Wiki, (10) UserPreference, or (11) Board model via a modified URL, related to a "mass assignment" vulnerability, a different vulnerability than CVE-2012-0327.',
            description:
              'Redmine before 1.3.2 does not properly restrict the use of a hash to provide values for a model\'s attributes, which allows remote attackers to set attributes in the (1) Comment, (2) Document, (3) IssueCategory, (4) MembersController, (5) Message, (6) News, (7) TimeEntry, (8) Version, (9) Wiki, (10) UserPreference, or (11) Board model via a modified URL, related to a "mass assignment" vulnerability, a different vulnerability than CVE-2012-0327.',
            reserved: "2012-04-04T00:00:00Z",
            published: "2012-04-04T10:00:00Z",
            modified: "2024-09-16T20:17:00.137Z",
            withdrawn: null,
            discovered: null,
            released: null,
            cwes: [],
            average_severity: null,
            average_score: null,
            advisories: [
              {
                uuid: "urn:uuid:13125ed4-a02b-4c81-a689-9b9cd13d13c9",
                identifier: "CVE-2012-2054",
                issuer: {
                  id: "3bc1fd81-9c49-4df6-9edb-2fc18d49f283",
                  name: "mitre",
                  cpe_key: null,
                  website: null,
                },
                published: "2012-04-04T10:00:00Z",
                modified: "2024-09-16T20:17:00.137Z",
                withdrawn: null,
                title:
                  'Redmine before 1.3.2 does not properly restrict the use of a hash to provide values for a model\'s attributes, which allows remote attackers to set attributes in the (1) Comment, (2) Document, (3) IssueCategory, (4) MembersController, (5) Message, (6) News, (7) TimeEntry, (8) Version, (9) Wiki, (10) UserPreference, or (11) Board model via a modified URL, related to a "mass assignment" vulnerability, a different vulnerability than CVE-2012-0327.',
                labels: {
                  source: "https://github.com/CVEProject/cvelistV5",
                  importer: "cve",
                  file: "2012/2xxx/CVE-2012-2054.json",
                  type: "cve",
                },
                severity: null,
                score: null,
              },
            ],
          },
          {
            normative: true,
            identifier: "CVE-2012-2053",
            title:
              "The sudoers file in the Linux system configuration in F5 FirePass 6.0.0 through 6.1.0 and 7.0.0 does not require a password for executing commands as root, which allows local users to gain privileges via the sudo program, as demonstrated by the user account that executes PHP scripts, a different vulnerability than CVE-2012-1777.",
            description:
              "The sudoers file in the Linux system configuration in F5 FirePass 6.0.0 through 6.1.0 and 7.0.0 does not require a password for executing commands as root, which allows local users to gain privileges via the sudo program, as demonstrated by the user account that executes PHP scripts, a different vulnerability than CVE-2012-1777.",
            reserved: "2012-04-03T00:00:00Z",
            published: "2012-04-04T10:00:00Z",
            modified: "2024-08-06T19:17:27.65Z",
            withdrawn: null,
            discovered: null,
            released: null,
            cwes: [],
            average_severity: null,
            average_score: null,
            advisories: [
              {
                uuid: "urn:uuid:254f8858-e103-4502-8c24-5294cb091789",
                identifier: "CVE-2012-2053",
                issuer: {
                  id: "3bc1fd81-9c49-4df6-9edb-2fc18d49f283",
                  name: "mitre",
                  cpe_key: null,
                  website: null,
                },
                published: "2012-04-04T10:00:00Z",
                modified: "2024-08-06T19:17:27.65Z",
                withdrawn: null,
                title:
                  "The sudoers file in the Linux system configuration in F5 FirePass 6.0.0 through 6.1.0 and 7.0.0 does not require a password for executing commands as root, which allows local users to gain privileges via the sudo program, as demonstrated by the user account that executes PHP scripts, a different vulnerability than CVE-2012-1777.",
                labels: {
                  file: "2012/2xxx/CVE-2012-2053.json",
                  type: "cve",
                  source: "https://github.com/CVEProject/cvelistV5",
                  importer: "cve",
                },
                severity: null,
                score: null,
              },
            ],
          },
          {
            normative: true,
            identifier: "CVE-2012-2215",
            title:
              "Directory traversal vulnerability in the Preboot Service in Novell ZENworks Configuration Management (ZCM) 11.1 and 11.1a allows remote attackers to read arbitrary files via an opcode 0x21 request.",
            description:
              "Directory traversal vulnerability in the Preboot Service in Novell ZENworks Configuration Management (ZCM) 11.1 and 11.1a allows remote attackers to read arbitrary files via an opcode 0x21 request.",
            reserved: "2012-04-09T00:00:00Z",
            published: "2012-04-09T21:00:00Z",
            modified: "2024-08-06T19:26:09.074Z",
            withdrawn: null,
            discovered: null,
            released: null,
            cwes: [],
            average_severity: null,
            average_score: null,
            advisories: [
              {
                uuid: "urn:uuid:4dada0af-ab37-4da4-83e6-dfdaabc46257",
                identifier: "CVE-2012-2215",
                issuer: {
                  id: "3bc1fd81-9c49-4df6-9edb-2fc18d49f283",
                  name: "mitre",
                  cpe_key: null,
                  website: null,
                },
                published: "2012-04-09T21:00:00Z",
                modified: "2024-08-06T19:26:09.074Z",
                withdrawn: null,
                title:
                  "Directory traversal vulnerability in the Preboot Service in Novell ZENworks Configuration Management (ZCM) 11.1 and 11.1a allows remote attackers to read arbitrary files via an opcode 0x21 request.",
                labels: {
                  file: "2012/2xxx/CVE-2012-2215.json",
                  type: "cve",
                  source: "https://github.com/CVEProject/cvelistV5",
                  importer: "cve",
                },
                severity: null,
                score: null,
              },
            ],
          },
          {
            normative: true,
            identifier: "CVE-2012-2156",
            title:
              "Multiple cross-site scripting (XSS) vulnerabilities in Plume CMS 1.2.4 and earlier allow remote attackers to inject arbitrary web script or HTML via (1) the u_email parameter (aka Authors Email field) to manager/users.php, (2) the u_realname parameter (aka Authors Name field) to manager/users.php, or (3) the c_author parameter (aka Author field) in an ADD A COMMENT section.",
            description:
              "Multiple cross-site scripting (XSS) vulnerabilities in Plume CMS 1.2.4 and earlier allow remote attackers to inject arbitrary web script or HTML via (1) the u_email parameter (aka Authors Email field) to manager/users.php, (2) the u_realname parameter (aka Authors Name field) to manager/users.php, or (3) the c_author parameter (aka Author field) in an ADD A COMMENT section.",
            reserved: "2012-04-04T00:00:00Z",
            published: "2012-04-11T10:00:00Z",
            modified: "2024-08-06T19:26:07.776Z",
            withdrawn: null,
            discovered: null,
            released: null,
            cwes: [],
            average_severity: null,
            average_score: null,
            advisories: [
              {
                uuid: "urn:uuid:29ee07f7-4f84-40bc-ae80-5b791b08c05f",
                identifier: "CVE-2012-2156",
                issuer: {
                  id: "3bc1fd81-9c49-4df6-9edb-2fc18d49f283",
                  name: "mitre",
                  cpe_key: null,
                  website: null,
                },
                published: "2012-04-11T10:00:00Z",
                modified: "2024-08-06T19:26:07.776Z",
                withdrawn: null,
                title:
                  "Multiple cross-site scripting (XSS) vulnerabilities in Plume CMS 1.2.4 and earlier allow remote attackers to inject arbitrary web script or HTML via (1) the u_email parameter (aka Authors Email field) to manager/users.php, (2) the u_realname parameter (aka Authors Name field) to manager/users.php, or (3) the c_author parameter (aka Author field) in an ADD A COMMENT section.",
                labels: {
                  type: "cve",
                  importer: "cve",
                  source: "https://github.com/CVEProject/cvelistV5",
                  file: "2012/2xxx/CVE-2012-2156.json",
                },
                severity: null,
                score: null,
              },
            ],
          },
          {
            normative: true,
            identifier: "CVE-2012-2223",
            title:
              "The xplat agent in Novell ZENworks Configuration Management (ZCM) 10.3.x before 10.3.4 and 11.x before 11.2 enables the HTTP TRACE method, which might make it easier for remote attackers to conduct cross-site tracing (XST) attacks via unspecified vectors.",
            description:
              "The xplat agent in Novell ZENworks Configuration Management (ZCM) 10.3.x before 10.3.4 and 11.x before 11.2 enables the HTTP TRACE method, which might make it easier for remote attackers to conduct cross-site tracing (XST) attacks via unspecified vectors.",
            reserved: "2012-04-11T00:00:00Z",
            published: "2012-04-11T10:00:00Z",
            modified: "2024-08-06T19:26:08.954Z",
            withdrawn: null,
            discovered: null,
            released: null,
            cwes: [],
            average_severity: null,
            average_score: null,
            advisories: [
              {
                uuid: "urn:uuid:297d67e0-b508-40f4-8aaf-277ec423f9bb",
                identifier: "CVE-2012-2223",
                issuer: {
                  id: "3bc1fd81-9c49-4df6-9edb-2fc18d49f283",
                  name: "mitre",
                  cpe_key: null,
                  website: null,
                },
                published: "2012-04-11T10:00:00Z",
                modified: "2024-08-06T19:26:08.954Z",
                withdrawn: null,
                title:
                  "The xplat agent in Novell ZENworks Configuration Management (ZCM) 10.3.x before 10.3.4 and 11.x before 11.2 enables the HTTP TRACE method, which might make it easier for remote attackers to conduct cross-site tracing (XST) attacks via unspecified vectors.",
                labels: {
                  source: "https://github.com/CVEProject/cvelistV5",
                  type: "cve",
                  importer: "cve",
                  file: "2012/2xxx/CVE-2012-2223.json",
                },
                severity: null,
                score: null,
              },
            ],
          },
          {
            normative: true,
            identifier: "CVE-2012-2224",
            title:
              'Xunlei Thunder before 7.2.6 allows remote attackers to execute arbitrary code via a crafted file, related to a "DLL injection vulnerability."',
            description:
              'Xunlei Thunder before 7.2.6 allows remote attackers to execute arbitrary code via a crafted file, related to a "DLL injection vulnerability."',
            reserved: "2012-04-11T00:00:00Z",
            published: "2012-04-11T10:00:00Z",
            modified: "2024-08-06T19:26:09.029Z",
            withdrawn: null,
            discovered: null,
            released: null,
            cwes: [],
            average_severity: null,
            average_score: null,
            advisories: [
              {
                uuid: "urn:uuid:45078715-1f2f-4f19-87db-c4e5e5666198",
                identifier: "CVE-2012-2224",
                issuer: {
                  id: "3bc1fd81-9c49-4df6-9edb-2fc18d49f283",
                  name: "mitre",
                  cpe_key: null,
                  website: null,
                },
                published: "2012-04-11T10:00:00Z",
                modified: "2024-08-06T19:26:09.029Z",
                withdrawn: null,
                title:
                  'Xunlei Thunder before 7.2.6 allows remote attackers to execute arbitrary code via a crafted file, related to a "DLL injection vulnerability."',
                labels: {
                  importer: "cve",
                  file: "2012/2xxx/CVE-2012-2224.json",
                  source: "https://github.com/CVEProject/cvelistV5",
                  type: "cve",
                },
                severity: null,
                score: null,
              },
            ],
          },
          {
            normative: true,
            identifier: "CVE-2012-2210",
            title:
              "The Sony Bravia TV KDL-32CX525 allows remote attackers to cause a denial of service (configuration outage or device crash) via a flood of TCP SYN packets, as demonstrated by hping, a related issue to CVE-1999-0116.",
            description:
              "The Sony Bravia TV KDL-32CX525 allows remote attackers to cause a denial of service (configuration outage or device crash) via a flood of TCP SYN packets, as demonstrated by hping, a related issue to CVE-1999-0116.",
            reserved: "2012-04-04T00:00:00Z",
            published: "2012-04-11T10:00:00Z",
            modified: "2024-08-06T19:26:09.004Z",
            withdrawn: null,
            discovered: null,
            released: null,
            cwes: [],
            average_severity: null,
            average_score: null,
            advisories: [
              {
                uuid: "urn:uuid:962cb8ac-ae47-4e79-b00f-c1cf128f39b0",
                identifier: "CVE-2012-2210",
                issuer: {
                  id: "3bc1fd81-9c49-4df6-9edb-2fc18d49f283",
                  name: "mitre",
                  cpe_key: null,
                  website: null,
                },
                published: "2012-04-11T10:00:00Z",
                modified: "2024-08-06T19:26:09.004Z",
                withdrawn: null,
                title:
                  "The Sony Bravia TV KDL-32CX525 allows remote attackers to cause a denial of service (configuration outage or device crash) via a flood of TCP SYN packets, as demonstrated by hping, a related issue to CVE-1999-0116.",
                labels: {
                  type: "cve",
                  file: "2012/2xxx/CVE-2012-2210.json",
                  importer: "cve",
                  source: "https://github.com/CVEProject/cvelistV5",
                },
                severity: null,
                score: null,
              },
            ],
          },
          {
            normative: true,
            identifier: "CVE-2012-2225",
            title:
              "360zip 1.93beta allows remote attackers to execute arbitrary code via vectors related to file browsing and file extraction.",
            description:
              "360zip 1.93beta allows remote attackers to execute arbitrary code via vectors related to file browsing and file extraction.",
            reserved: "2012-04-11T00:00:00Z",
            published: "2012-04-11T10:00:00Z",
            modified: "2024-08-06T19:26:08.912Z",
            withdrawn: null,
            discovered: null,
            released: null,
            cwes: [],
            average_severity: null,
            average_score: null,
            advisories: [
              {
                uuid: "urn:uuid:129b04e4-83c6-4092-a592-0e470ee2adaf",
                identifier: "CVE-2012-2225",
                issuer: {
                  id: "3bc1fd81-9c49-4df6-9edb-2fc18d49f283",
                  name: "mitre",
                  cpe_key: null,
                  website: null,
                },
                published: "2012-04-11T10:00:00Z",
                modified: "2024-08-06T19:26:08.912Z",
                withdrawn: null,
                title:
                  "360zip 1.93beta allows remote attackers to execute arbitrary code via vectors related to file browsing and file extraction.",
                labels: {
                  importer: "cve",
                  type: "cve",
                  file: "2012/2xxx/CVE-2012-2225.json",
                  source: "https://github.com/CVEProject/cvelistV5",
                },
                severity: null,
                score: null,
              },
            ],
          },
          {
            normative: true,
            identifier: "CVE-2012-2230",
            title:
              "Cloudera Manager 3.7.x before 3.7.5 and Service and Configuration Manager 3.5, when Kerberos is not enabled, does not properly install taskcontroller.cfg, which allows remote authenticated users to impersonate arbitrary user accounts via unspecified vectors, a different vulnerability than CVE-2012-1574.",
            description:
              "Cloudera Manager 3.7.x before 3.7.5 and Service and Configuration Manager 3.5, when Kerberos is not enabled, does not properly install taskcontroller.cfg, which allows remote authenticated users to impersonate arbitrary user accounts via unspecified vectors, a different vulnerability than CVE-2012-1574.",
            reserved: "2012-04-12T00:00:00Z",
            published: "2012-04-12T10:00:00Z",
            modified: "2024-08-06T19:26:08.997Z",
            withdrawn: null,
            discovered: null,
            released: null,
            cwes: [],
            average_severity: null,
            average_score: null,
            advisories: [
              {
                uuid: "urn:uuid:dc310f12-70ac-4ada-a936-2d4cda202a0d",
                identifier: "CVE-2012-2230",
                issuer: {
                  id: "3bc1fd81-9c49-4df6-9edb-2fc18d49f283",
                  name: "mitre",
                  cpe_key: null,
                  website: null,
                },
                published: "2012-04-12T10:00:00Z",
                modified: "2024-08-06T19:26:08.997Z",
                withdrawn: null,
                title:
                  "Cloudera Manager 3.7.x before 3.7.5 and Service and Configuration Manager 3.5, when Kerberos is not enabled, does not properly install taskcontroller.cfg, which allows remote authenticated users to impersonate arbitrary user accounts via unspecified vectors, a different vulnerability than CVE-2012-1574.",
                labels: {
                  type: "cve",
                  importer: "cve",
                  file: "2012/2xxx/CVE-2012-2230.json",
                  source: "https://github.com/CVEProject/cvelistV5",
                },
                severity: null,
                score: null,
              },
            ],
          },
        ],
      },
    },
  },
};

export const PrimaryState: Story = {
  args: {},
  parameters: {
    contextDefaultValue: customContextData,
  },
};
