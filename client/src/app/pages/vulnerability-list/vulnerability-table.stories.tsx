import type { Meta, StoryObj } from "@storybook/react";
import React, { createContext, useContext } from "react";
import { BrowserRouter } from "react-router-dom";
import { VulnerabilityTable } from "./vulnerability-table";
import {
  IVulnerabilitySearchContext,
  VulnerabilitySearchContext,
} from "./vulnerability-context";

const contextDefaultValue = {} as IVulnerabilitySearchContext;

const customTableControls = {
  currentPageItems: 10,
  numRenderedColumns: 3,
  tableName: "My little table",
  columnNames: {
    identifier: "",
  },
};

const myTableControls = [
  {
    normative: true,
    identifier: "CVE-2012-2000",
    title:
      "Multiple unspecified vulnerabilities in HP System Health Application and Command Line Utilities before 9.0.0 allow remote attackers to execute arbitrary code via unknown vectors.",
    description:
      "Multiple unspecified vulnerabilities in HP System Health Application and Command Line Utilities before 9.0.0 allow remote attackers to execute arbitrary code via unknown vectors.",
    reserved: "2012-04-02T00:00:00Z",
    published: "2012-05-02T21:00:00Z",
    modified: "2024-08-06T19:17:27.757Z",
    withdrawn: null,
    discovered: null,
    released: null,
    cwes: [],
    average_severity: null,
    average_score: null,
    advisories: [
      {
        uuid: "urn:uuid:0022ae6d-dc8a-4a99-9d68-6997eea8add4",
        identifier: "CVE-2012-2000",
        issuer: {
          id: "59233971-e451-43da-ba38-13cd0951aa1d",
          name: "hp",
          cpe_key: null,
          website: null,
        },
        published: "2012-05-02T21:00:00Z",
        modified: "2024-08-06T19:17:27.757Z",
        withdrawn: null,
        title:
          "Multiple unspecified vulnerabilities in HP System Health Application and Command Line Utilities before 9.0.0 allow remote attackers to execute arbitrary code via unknown vectors.",
        labels: {
          file: "2012/2xxx/CVE-2012-2000.json",
          type: "cve",
          importer: "cve",
          source: "https://github.com/CVEProject/cvelistV5",
        },
        severity: null,
        score: null,
      },
    ],
  },
  {
    normative: true,
    identifier: "CVE-2012-2001",
    title:
      "Cross-site scripting (XSS) vulnerability in HP SNMP Agents for Linux before 9.0.0 allows remote attackers to inject arbitrary web script or HTML via unspecified vectors.",
    description:
      "Cross-site scripting (XSS) vulnerability in HP SNMP Agents for Linux before 9.0.0 allows remote attackers to inject arbitrary web script or HTML via unspecified vectors.",
    reserved: "2012-04-02T00:00:00Z",
    published: "2012-05-02T22:00:00Z",
    modified: "2024-08-06T19:17:27.691Z",
    withdrawn: null,
    discovered: null,
    released: null,
    cwes: [],
    average_severity: null,
    average_score: null,
    advisories: [
      {
        uuid: "urn:uuid:977b41a3-1057-466f-aa8c-679bb62e8e3c",
        identifier: "CVE-2012-2001",
        issuer: {
          id: "59233971-e451-43da-ba38-13cd0951aa1d",
          name: "hp",
          cpe_key: null,
          website: null,
        },
        published: "2012-05-02T22:00:00Z",
        modified: "2024-08-06T19:17:27.691Z",
        withdrawn: null,
        title:
          "Cross-site scripting (XSS) vulnerability in HP SNMP Agents for Linux before 9.0.0 allows remote attackers to inject arbitrary web script or HTML via unspecified vectors.",
        labels: {
          file: "2012/2xxx/CVE-2012-2001.json",
          source: "https://github.com/CVEProject/cvelistV5",
          type: "cve",
          importer: "cve",
        },
        severity: null,
        score: null,
      },
    ],
  },
  {
    normative: true,
    identifier: "CVE-2012-2002",
    title:
      "Open redirect vulnerability in HP SNMP Agents for Linux before 9.0.0 allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via unspecified vectors.",
    description:
      "Open redirect vulnerability in HP SNMP Agents for Linux before 9.0.0 allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via unspecified vectors.",
    reserved: "2012-04-02T00:00:00Z",
    published: "2012-05-02T22:00:00Z",
    modified: "2024-08-06T19:17:27.684Z",
    withdrawn: null,
    discovered: null,
    released: null,
    cwes: [],
    average_severity: null,
    average_score: null,
    advisories: [
      {
        uuid: "urn:uuid:cd3c0923-0392-4792-a35d-9618a85a2cb8",
        identifier: "CVE-2012-2002",
        issuer: {
          id: "59233971-e451-43da-ba38-13cd0951aa1d",
          name: "hp",
          cpe_key: null,
          website: null,
        },
        published: "2012-05-02T22:00:00Z",
        modified: "2024-08-06T19:17:27.684Z",
        withdrawn: null,
        title:
          "Open redirect vulnerability in HP SNMP Agents for Linux before 9.0.0 allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via unspecified vectors.",
        labels: {
          source: "https://github.com/CVEProject/cvelistV5",
          file: "2012/2xxx/CVE-2012-2002.json",
          type: "cve",
          importer: "cve",
        },
        severity: null,
        score: null,
      },
    ],
  },
  {
    normative: true,
    identifier: "CVE-2012-2003",
    title:
      "Cross-site request forgery (CSRF) vulnerability in HP Insight Management Agents before 9.0.0.0 on Windows Server 2003 and 2008 allows remote attackers to hijack the authentication of unspecified victims via unknown vectors.",
    description:
      "Cross-site request forgery (CSRF) vulnerability in HP Insight Management Agents before 9.0.0.0 on Windows Server 2003 and 2008 allows remote attackers to hijack the authentication of unspecified victims via unknown vectors.",
    reserved: "2012-04-02T00:00:00Z",
    published: "2012-05-02T22:00:00Z",
    modified: "2024-08-06T19:17:27.747Z",
    withdrawn: null,
    discovered: null,
    released: null,
    cwes: [],
    average_severity: null,
    average_score: null,
    advisories: [
      {
        uuid: "urn:uuid:f3f25a24-5b0c-44ef-b63b-e00b7eabe1c3",
        identifier: "CVE-2012-2003",
        issuer: {
          id: "59233971-e451-43da-ba38-13cd0951aa1d",
          name: "hp",
          cpe_key: null,
          website: null,
        },
        published: "2012-05-02T22:00:00Z",
        modified: "2024-08-06T19:17:27.747Z",
        withdrawn: null,
        title:
          "Cross-site request forgery (CSRF) vulnerability in HP Insight Management Agents before 9.0.0.0 on Windows Server 2003 and 2008 allows remote attackers to hijack the authentication of unspecified victims via unknown vectors.",
        labels: {
          source: "https://github.com/CVEProject/cvelistV5",
          type: "cve",
          importer: "cve",
          file: "2012/2xxx/CVE-2012-2003.json",
        },
        severity: null,
        score: null,
      },
    ],
  },
  {
    normative: true,
    identifier: "CVE-2012-2004",
    title:
      "Open redirect vulnerability in HP Insight Management Agents before 9.0.0.0 on Windows Server 2003 and 2008 allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via unspecified vectors.",
    description:
      "Open redirect vulnerability in HP Insight Management Agents before 9.0.0.0 on Windows Server 2003 and 2008 allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via unspecified vectors.",
    reserved: "2012-04-02T00:00:00Z",
    published: "2012-05-02T22:00:00Z",
    modified: "2024-08-06T19:17:27.626Z",
    withdrawn: null,
    discovered: null,
    released: null,
    cwes: [],
    average_severity: null,
    average_score: null,
    advisories: [
      {
        uuid: "urn:uuid:296f83e7-7c80-4a1d-bd7e-78a64c8c34b5",
        identifier: "CVE-2012-2004",
        issuer: {
          id: "59233971-e451-43da-ba38-13cd0951aa1d",
          name: "hp",
          cpe_key: null,
          website: null,
        },
        published: "2012-05-02T22:00:00Z",
        modified: "2024-08-06T19:17:27.626Z",
        withdrawn: null,
        title:
          "Open redirect vulnerability in HP Insight Management Agents before 9.0.0.0 on Windows Server 2003 and 2008 allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via unspecified vectors.",
        labels: {
          type: "cve",
          source: "https://github.com/CVEProject/cvelistV5",
          file: "2012/2xxx/CVE-2012-2004.json",
          importer: "cve",
        },
        severity: null,
        score: null,
      },
    ],
  },
  {
    normative: true,
    identifier: "CVE-2012-2005",
    title:
      "Cross-site scripting (XSS) vulnerability in HP Insight Management Agents before 9.0.0.0 on Windows Server 2003 and 2008 allows remote attackers to inject arbitrary web script or HTML via unspecified vectors.",
    description:
      "Cross-site scripting (XSS) vulnerability in HP Insight Management Agents before 9.0.0.0 on Windows Server 2003 and 2008 allows remote attackers to inject arbitrary web script or HTML via unspecified vectors.",
    reserved: "2012-04-02T00:00:00Z",
    published: "2012-05-02T22:00:00Z",
    modified: "2024-08-06T19:17:27.745Z",
    withdrawn: null,
    discovered: null,
    released: null,
    cwes: [],
    average_severity: null,
    average_score: null,
    advisories: [
      {
        uuid: "urn:uuid:e84a45c3-0e4b-4cd9-a69a-160cf50f807a",
        identifier: "CVE-2012-2005",
        issuer: {
          id: "59233971-e451-43da-ba38-13cd0951aa1d",
          name: "hp",
          cpe_key: null,
          website: null,
        },
        published: "2012-05-02T22:00:00Z",
        modified: "2024-08-06T19:17:27.745Z",
        withdrawn: null,
        title:
          "Cross-site scripting (XSS) vulnerability in HP Insight Management Agents before 9.0.0.0 on Windows Server 2003 and 2008 allows remote attackers to inject arbitrary web script or HTML via unspecified vectors.",
        labels: {
          type: "cve",
          file: "2012/2xxx/CVE-2012-2005.json",
          source: "https://github.com/CVEProject/cvelistV5",
          importer: "cve",
        },
        severity: null,
        score: null,
      },
    ],
  },
  {
    normative: true,
    identifier: "CVE-2012-2006",
    title:
      "Unspecified vulnerability in HP Insight Management Agents before 9.0.0.0 on Windows Server 2003 and 2008 allows remote attackers to modify data or cause a denial of service via unknown vectors.",
    description:
      "Unspecified vulnerability in HP Insight Management Agents before 9.0.0.0 on Windows Server 2003 and 2008 allows remote attackers to modify data or cause a denial of service via unknown vectors.",
    reserved: "2012-04-02T00:00:00Z",
    published: "2012-05-02T22:00:00Z",
    modified: "2024-08-06T19:17:27.763Z",
    withdrawn: null,
    discovered: null,
    released: null,
    cwes: [],
    average_severity: null,
    average_score: null,
    advisories: [
      {
        uuid: "urn:uuid:ec4d61f8-1d40-4900-a277-2bee18e8acf4",
        identifier: "CVE-2012-2006",
        issuer: {
          id: "59233971-e451-43da-ba38-13cd0951aa1d",
          name: "hp",
          cpe_key: null,
          website: null,
        },
        published: "2012-05-02T22:00:00Z",
        modified: "2024-08-06T19:17:27.763Z",
        withdrawn: null,
        title:
          "Unspecified vulnerability in HP Insight Management Agents before 9.0.0.0 on Windows Server 2003 and 2008 allows remote attackers to modify data or cause a denial of service via unknown vectors.",
        labels: {
          source: "https://github.com/CVEProject/cvelistV5",
          importer: "cve",
          file: "2012/2xxx/CVE-2012-2006.json",
          type: "cve",
        },
        severity: null,
        score: null,
      },
    ],
  },
  {
    normative: true,
    identifier: "CVE-2012-2007",
    title:
      "SQL injection vulnerability in HP Performance Insight for Networks 5.3.x, 5.41, 5.41.001, and 5.41.002 allows remote attackers to execute arbitrary SQL commands via unspecified vectors.",
    description:
      "SQL injection vulnerability in HP Performance Insight for Networks 5.3.x, 5.41, 5.41.001, and 5.41.002 allows remote attackers to execute arbitrary SQL commands via unspecified vectors.",
    reserved: "2012-04-02T00:00:00Z",
    published: "2012-05-09T10:00:00Z",
    modified: "2024-08-06T19:17:27.709Z",
    withdrawn: null,
    discovered: null,
    released: null,
    cwes: [],
    average_severity: null,
    average_score: null,
    advisories: [
      {
        uuid: "urn:uuid:b14fa42d-4257-4fd7-83d7-07a58f581a72",
        identifier: "CVE-2012-2007",
        issuer: {
          id: "59233971-e451-43da-ba38-13cd0951aa1d",
          name: "hp",
          cpe_key: null,
          website: null,
        },
        published: "2012-05-09T10:00:00Z",
        modified: "2024-08-06T19:17:27.709Z",
        withdrawn: null,
        title:
          "SQL injection vulnerability in HP Performance Insight for Networks 5.3.x, 5.41, 5.41.001, and 5.41.002 allows remote attackers to execute arbitrary SQL commands via unspecified vectors.",
        labels: {
          file: "2012/2xxx/CVE-2012-2007.json",
          source: "https://github.com/CVEProject/cvelistV5",
          type: "cve",
          importer: "cve",
        },
        severity: null,
        score: null,
      },
    ],
  },
  {
    normative: true,
    identifier: "CVE-2012-2008",
    title:
      "Cross-site scripting (XSS) vulnerability in HP Performance Insight for Networks 5.3.x, 5.41, 5.41.001, and 5.41.002 allows remote attackers to inject arbitrary web script or HTML via unspecified vectors.",
    description:
      "Cross-site scripting (XSS) vulnerability in HP Performance Insight for Networks 5.3.x, 5.41, 5.41.001, and 5.41.002 allows remote attackers to inject arbitrary web script or HTML via unspecified vectors.",
    reserved: "2012-04-02T00:00:00Z",
    published: "2012-05-09T10:00:00Z",
    modified: "2024-08-06T19:17:27.822Z",
    withdrawn: null,
    discovered: null,
    released: null,
    cwes: [],
    average_severity: null,
    average_score: null,
    advisories: [
      {
        uuid: "urn:uuid:ee11791d-7395-491d-befb-b2314a700aa7",
        identifier: "CVE-2012-2008",
        issuer: {
          id: "59233971-e451-43da-ba38-13cd0951aa1d",
          name: "hp",
          cpe_key: null,
          website: null,
        },
        published: "2012-05-09T10:00:00Z",
        modified: "2024-08-06T19:17:27.822Z",
        withdrawn: null,
        title:
          "Cross-site scripting (XSS) vulnerability in HP Performance Insight for Networks 5.3.x, 5.41, 5.41.001, and 5.41.002 allows remote attackers to inject arbitrary web script or HTML via unspecified vectors.",
        labels: {
          type: "cve",
          importer: "cve",
          source: "https://github.com/CVEProject/cvelistV5",
          file: "2012/2xxx/CVE-2012-2008.json",
        },
        severity: null,
        score: null,
      },
    ],
  },
  {
    normative: true,
    identifier: "CVE-2012-2009",
    title:
      "Unspecified vulnerability in HP Performance Insight for Networks 5.3.x, 5.41, 5.41.001, and 5.41.002 allows remote authenticated users to gain privileges via unknown vectors.",
    description:
      "Unspecified vulnerability in HP Performance Insight for Networks 5.3.x, 5.41, 5.41.001, and 5.41.002 allows remote authenticated users to gain privileges via unknown vectors.",
    reserved: "2012-04-02T00:00:00Z",
    published: "2012-05-09T10:00:00Z",
    modified: "2024-08-06T19:17:27.75Z",
    withdrawn: null,
    discovered: null,
    released: null,
    cwes: [],
    average_severity: null,
    average_score: null,
    advisories: [
      {
        uuid: "urn:uuid:7799ce4d-d2d7-486b-a3fb-62e627dbef06",
        identifier: "CVE-2012-2009",
        issuer: {
          id: "59233971-e451-43da-ba38-13cd0951aa1d",
          name: "hp",
          cpe_key: null,
          website: null,
        },
        published: "2012-05-09T10:00:00Z",
        modified: "2024-08-06T19:17:27.75Z",
        withdrawn: null,
        title:
          "Unspecified vulnerability in HP Performance Insight for Networks 5.3.x, 5.41, 5.41.001, and 5.41.002 allows remote authenticated users to gain privileges via unknown vectors.",
        labels: {
          source: "https://github.com/CVEProject/cvelistV5",
          type: "cve",
          file: "2012/2xxx/CVE-2012-2009.json",
          importer: "cve",
        },
        severity: null,
        score: null,
      },
    ],
  },
];

export const EmptyContext = createContext(contextDefaultValue);

export const NonEmptyContext = createContext({
  isFetching: false,
  fetchError: "",
  tableControls: myTableControls,
  totalItemCount: 3,
});

const meta = {
  title: "Components/vulnerability-list/vulnerability-table.tsx",
  component: VulnerabilityTable,
  tags: ["autodocs"],
  decorators: [
    (Story, { parameters }) => {
      const { contextDefaultValue } = parameters;
      return (
        <BrowserRouter>
          <VulnerabilitySearchContext.Provider value={contextDefaultValue}>
            <Story />
          </VulnerabilitySearchContext.Provider>
        </BrowserRouter>
      );
    },
  ],
  excludeStories: /.*(Empty|NonEmpty)Context$/,
} satisfies Meta<typeof VulnerabilityTable>;

export default meta;
type Story = StoryObj<typeof meta>;

export const NoMock: Story = {};

export const EmptyState: Story = {
  //   args: {
  //     tableControls: {
  //       numRenderedColumns: 5,
  //       currentPageItems: [],
  //     },
  //   },
  parameters: {
    contextDefaultValue: EmptyContext,
  },
};

export const PrimaryState: Story = {
  // override params
  parameters: {
    contextDefaultValue: NonEmptyContext,
  },
};
